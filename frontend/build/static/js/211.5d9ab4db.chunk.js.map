{"version":3,"file":"static/js/211.5d9ab4db.chunk.js","mappings":"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","sources":["pages/CheckInHistoryPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { db } from '../services/firebase';\r\nimport { collection, query, where, getDocs, orderBy, limit, startAfter, doc, getDoc } from 'firebase/firestore';\r\nimport { formatDistanceToNow, format } from 'date-fns';\r\n\r\nconst ITEMS_PER_PAGE = 20;\r\n\r\nconst CheckInHistoryPage = () => {\r\n  const navigate = useNavigate();\r\n  const { currentUser, userData } = useAuth();\r\n  const [history, setHistory] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [loadingMore, setLoadingMore] = useState(false);\r\n  const [filter, setFilter] = useState('all'); // all, completed, alerted\r\n  const [lastDoc, setLastDoc] = useState(null);\r\n  const [hasMore, setHasMore] = useState(true);\r\n  const [expandedItems, setExpandedItems] = useState(new Set());\r\n  const [bestieNames, setBestieNames] = useState({});\r\n\r\n  useEffect(() => {\r\n    loadHistory();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [currentUser, filter]);\r\n\r\n  // Fetch bestie names\r\n  useEffect(() => {\r\n    const fetchBestieNames = async () => {\r\n      const uniqueBestieIds = new Set();\r\n      history.forEach(checkIn => {\r\n        if (checkIn.bestieIds) {\r\n          checkIn.bestieIds.forEach(id => uniqueBestieIds.add(id));\r\n        }\r\n      });\r\n\r\n      setBestieNames(prevNames => {\r\n        const names = { ...prevNames };\r\n        const promises = [];\r\n\r\n        for (const bestieId of uniqueBestieIds) {\r\n          if (!names[bestieId]) {\r\n            promises.push(\r\n              getDoc(doc(db, 'users', bestieId))\r\n                .then(bestieDoc => {\r\n                  if (bestieDoc.exists()) {\r\n                    const bestieData = bestieDoc.data();\r\n                    names[bestieId] = bestieData.displayName || 'Unknown';\r\n                  } else {\r\n                    names[bestieId] = 'Unknown';\r\n                  }\r\n                })\r\n                .catch(error => {\r\n                  console.error('Error fetching bestie name:', error);\r\n                  names[bestieId] = 'Unknown';\r\n                })\r\n            );\r\n          }\r\n        }\r\n\r\n        if (promises.length > 0) {\r\n          Promise.all(promises).then(() => setBestieNames({ ...names }));\r\n        }\r\n\r\n        return names;\r\n      });\r\n    };\r\n\r\n    if (history.length > 0) {\r\n      fetchBestieNames();\r\n    }\r\n  }, [history]);\r\n\r\n  const loadHistory = async (loadMore = false) => {\r\n    if (!currentUser) return;\r\n\r\n    if (loadMore) {\r\n      setLoadingMore(true);\r\n    } else {\r\n      setLoading(true);\r\n      setHistory([]);\r\n      setLastDoc(null);\r\n      setHasMore(true);\r\n    }\r\n\r\n    try {\r\n      let q = query(\r\n        collection(db, 'checkins'),\r\n        where('userId', '==', currentUser.uid),\r\n        orderBy('createdAt', 'desc'),\r\n        limit(ITEMS_PER_PAGE)\r\n      );\r\n\r\n      if (filter === 'completed') {\r\n        q = query(\r\n          collection(db, 'checkins'),\r\n          where('userId', '==', currentUser.uid),\r\n          where('status', '==', 'completed'),\r\n          orderBy('createdAt', 'desc'),\r\n          limit(ITEMS_PER_PAGE)\r\n        );\r\n      } else if (filter === 'alerted') {\r\n        q = query(\r\n          collection(db, 'checkins'),\r\n          where('userId', '==', currentUser.uid),\r\n          where('status', '==', 'alerted'),\r\n          orderBy('createdAt', 'desc'),\r\n          limit(ITEMS_PER_PAGE)\r\n        );\r\n      }\r\n\r\n      // If loading more, start after the last document\r\n      if (loadMore && lastDoc) {\r\n        q = query(q, startAfter(lastDoc));\r\n      }\r\n\r\n      const snapshot = await getDocs(q);\r\n      const checkIns = [];\r\n      snapshot.forEach((doc) => {\r\n        checkIns.push({ id: doc.id, ...doc.data() });\r\n      });\r\n\r\n      // Update state\r\n      if (loadMore) {\r\n        setHistory(prev => [...prev, ...checkIns]);\r\n      } else {\r\n        setHistory(checkIns);\r\n      }\r\n\r\n      // Update pagination state\r\n      setLastDoc(snapshot.docs[snapshot.docs.length - 1] || null);\r\n      setHasMore(checkIns.length === ITEMS_PER_PAGE);\r\n\r\n      setLoading(false);\r\n      setLoadingMore(false);\r\n    } catch (error) {\r\n      console.error('Error loading history:', error);\r\n      if (!loadMore) setHistory([]);\r\n      setLoading(false);\r\n      setLoadingMore(false);\r\n    }\r\n  };\r\n\r\n  const handleLoadMore = () => {\r\n    loadHistory(true);\r\n  };\r\n\r\n  const toggleExpanded = (id) => {\r\n    const newExpanded = new Set(expandedItems);\r\n    if (newExpanded.has(id)) {\r\n      newExpanded.delete(id);\r\n    } else {\r\n      newExpanded.add(id);\r\n    }\r\n    setExpandedItems(newExpanded);\r\n  };\r\n\r\n  const getStatusBadge = (status) => {\r\n    switch (status) {\r\n      case 'completed':\r\n        return <span className=\"badge badge-success\">‚úÖ Safe</span>;\r\n      case 'alerted':\r\n        return <span className=\"badge badge-warning\">üö® Alerted</span>;\r\n      case 'active':\r\n        return <span className=\"badge badge-primary\">‚è∞ Active</span>;\r\n      default:\r\n        return <span className=\"badge\">Unknown</span>;\r\n    }\r\n  };\r\n\r\n  const formatDuration = (minutes) => {\r\n    if (minutes < 60) return `${minutes}m`;\r\n    const hours = Math.floor(minutes / 60);\r\n    const mins = minutes % 60;\r\n    return mins > 0 ? `${hours}h ${mins}m` : `${hours}h`;\r\n  };\r\n\r\n  const hasExpandableContent = (checkIn) => {\r\n    return (checkIn.notes || checkIn.meetingWith || checkIn.socialMediaLinks ||\r\n            checkIn.gpsCoords || checkIn.photoURLs?.length > 0 ||\r\n            checkIn.bestieIds?.length > 0 || checkIn.alertTime ||\r\n            checkIn.completedAt || checkIn.alertedAt);\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-pattern dark:bg-dark-pattern\">\r\n        <div className=\"flex items-center justify-center py-20\">\r\n          <div className=\"spinner\"></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-pattern dark:bg-dark-pattern\">\r\n\r\n      <div className=\"max-w-4xl mx-auto p-4 pb-20\">\r\n        {/* Back Button - Top */}\r\n        <button\r\n          onClick={() => navigate(-1)}\r\n          className=\"flex items-center gap-2 text-primary dark:text-dark-primary hover:underline mb-4 font-semibold\"\r\n        >\r\n          <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n          </svg>\r\n          Back\r\n        </button>\r\n\r\n        {/* Header */}\r\n        <div className=\"mb-6\">\r\n          <h1 className=\"text-3xl font-display text-text-primary dark:text-dark-text-primary mb-2\">Check-in History</h1>\r\n          <p className=\"text-text-secondary dark:text-dark-text-secondary\">\r\n            View all your past check-ins\r\n          </p>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        <div className=\"flex gap-2 mb-6 overflow-x-auto pb-2\">\r\n          <button\r\n            onClick={() => setFilter('all')}\r\n            className={`px-4 py-2 rounded-full font-semibold whitespace-nowrap transition-all ${\r\n              filter === 'all'\r\n                ? 'bg-primary text-white'\r\n                : 'bg-white dark:bg-dark-card text-text-primary dark:text-dark-text-primary hover:bg-gray-50 dark:hover:bg-dark-hover'\r\n            }`}\r\n          >\r\n            All\r\n          </button>\r\n          <button\r\n            onClick={() => setFilter('completed')}\r\n            className={`px-4 py-2 rounded-full font-semibold whitespace-nowrap transition-all ${\r\n              filter === 'completed'\r\n                ? 'bg-success text-white'\r\n                : 'bg-white dark:bg-dark-card text-text-primary dark:text-dark-text-primary hover:bg-gray-50 dark:hover:bg-dark-hover'\r\n            }`}\r\n          >\r\n            ‚úÖ Safe\r\n          </button>\r\n          <button\r\n            onClick={() => setFilter('alerted')}\r\n            className={`px-4 py-2 rounded-full font-semibold whitespace-nowrap transition-all ${\r\n              filter === 'alerted'\r\n                ? 'bg-warning text-white'\r\n                : 'bg-white dark:bg-dark-card text-text-primary dark:text-dark-text-primary hover:bg-gray-50 dark:hover:bg-dark-hover'\r\n            }`}\r\n          >\r\n            üö® Alerted\r\n          </button>\r\n        </div>\r\n\r\n        {/* Stats Summary - loads from user document (efficient!) */}\r\n        <div className=\"card dark:bg-dark-card p-6 mb-6\">\r\n          <div className=\"grid grid-cols-3 gap-4\">\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-display text-primary dark:text-dark-primary\">\r\n                {userData?.stats?.totalCheckIns || 0}\r\n              </div>\r\n              <div className=\"text-sm text-text-secondary dark:text-dark-text-secondary\">Total</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-display text-success dark:text-dark-success\">\r\n                {userData?.stats?.completedCheckIns || 0}\r\n              </div>\r\n              <div className=\"text-sm text-text-secondary dark:text-dark-text-secondary\">Completed</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-display text-warning dark:text-dark-warning\">\r\n                {userData?.stats?.alertedCheckIns || 0}\r\n              </div>\r\n              <div className=\"text-sm text-text-secondary dark:text-dark-text-secondary\">Alerted</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* History List */}\r\n        {history.length === 0 ? (\r\n          <div className=\"card dark:bg-dark-card p-12 text-center\">\r\n            <div className=\"text-6xl mb-4\">üìã</div>\r\n            <h2 className=\"text-2xl font-display text-text-primary dark:text-dark-text-primary mb-2\">\r\n              No check-ins yet\r\n            </h2>\r\n            <p className=\"text-text-secondary dark:text-dark-text-secondary\">\r\n              Your check-in history will appear here\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <>\r\n            <div className=\"space-y-4\">\r\n              {history.map((checkIn) => {\r\n                const isExpanded = expandedItems.has(checkIn.id);\r\n                const canExpand = hasExpandableContent(checkIn);\r\n\r\n                return (\r\n                  <div\r\n                    key={checkIn.id}\r\n                    className={`card dark:bg-dark-card p-4 md:p-6 transition-all ${canExpand ? 'cursor-pointer hover:shadow-lg' : ''}`}\r\n                    onClick={() => canExpand && toggleExpanded(checkIn.id)}\r\n                  >\r\n                    <div className=\"flex items-start justify-between mb-3\">\r\n                      <div className=\"flex-1\">\r\n                        <div className=\"flex items-center gap-2 mb-1 flex-wrap\">\r\n                          <h3 className=\"font-display text-lg text-text-primary dark:text-dark-text-primary\">\r\n                            {checkIn.location || 'No location'}\r\n                          </h3>\r\n                          {getStatusBadge(checkIn.status)}\r\n                        </div>\r\n                        <div className=\"text-sm text-text-secondary dark:text-dark-text-secondary\">\r\n                          {checkIn.createdAt?.toDate ? formatDistanceToNow(checkIn.createdAt.toDate(), { addSuffix: true }) : 'Unknown time'}\r\n                        </div>\r\n                      </div>\r\n                      {canExpand && (\r\n                        <button\r\n                          className=\"text-primary dark:text-dark-primary ml-2 flex-shrink-0\"\r\n                          onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            toggleExpanded(checkIn.id);\r\n                          }}\r\n                        >\r\n                          <svg\r\n                            className={`w-6 h-6 transition-transform ${isExpanded ? 'rotate-180' : ''}`}\r\n                            fill=\"none\"\r\n                            stroke=\"currentColor\"\r\n                            viewBox=\"0 0 24 24\"\r\n                          >\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n                          </svg>\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4 text-sm mb-3\">\r\n                      <div>\r\n                        <div className=\"text-text-secondary dark:text-dark-text-secondary\">Duration</div>\r\n                        <div className=\"font-semibold text-text-primary dark:text-dark-text-primary\">\r\n                          {checkIn.duration ? formatDuration(checkIn.duration) : 'N/A'}\r\n                        </div>\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"text-text-secondary dark:text-dark-text-secondary\">Besties Notified</div>\r\n                        <div className=\"font-semibold text-text-primary dark:text-dark-text-primary\">\r\n                          {checkIn.bestieIds?.length || 0}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Expandable Details */}\r\n                    {isExpanded && (\r\n                      <div className=\"mt-4 pt-4 border-t border-gray-200 dark:border-dark-border space-y-3 animate-fade-in\">\r\n                        {/* Exact Timestamps */}\r\n                        <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3\">\r\n                          <div className=\"text-xs font-semibold text-text-secondary dark:text-dark-text-secondary mb-2\">\r\n                            Timestamps\r\n                          </div>\r\n                          <div className=\"space-y-1 text-sm\">\r\n                            {checkIn.createdAt?.toDate && (\r\n                              <div className=\"flex justify-between\">\r\n                                <span className=\"text-text-secondary dark:text-dark-text-secondary\">Created:</span>\r\n                                <span className=\"font-medium text-text-primary dark:text-dark-text-primary\">\r\n                                  {format(checkIn.createdAt.toDate(), 'MMM d, yyyy h:mm a')}\r\n                                </span>\r\n                              </div>\r\n                            )}\r\n                            {checkIn.alertTime?.toDate && (\r\n                              <div className=\"flex justify-between\">\r\n                                <span className=\"text-text-secondary dark:text-dark-text-secondary\">Alert Time:</span>\r\n                                <span className=\"font-medium text-text-primary dark:text-dark-text-primary\">\r\n                                  {format(checkIn.alertTime.toDate(), 'MMM d, yyyy h:mm a')}\r\n                                </span>\r\n                              </div>\r\n                            )}\r\n                            {checkIn.completedAt?.toDate && (\r\n                              <div className=\"flex justify-between\">\r\n                                <span className=\"text-success dark:text-dark-success\">‚úÖ Completed:</span>\r\n                                <span className=\"font-medium text-success dark:text-dark-success\">\r\n                                  {format(checkIn.completedAt.toDate(), 'MMM d, yyyy h:mm a')}\r\n                                </span>\r\n                              </div>\r\n                            )}\r\n                            {checkIn.alertedAt?.toDate && (\r\n                              <div className=\"flex justify-between\">\r\n                                <span className=\"text-warning dark:text-dark-warning\">üö® Alerted:</span>\r\n                                <span className=\"font-medium text-warning dark:text-dark-warning\">\r\n                                  {format(checkIn.alertedAt.toDate(), 'MMM d, yyyy h:mm a')}\r\n                                </span>\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n\r\n                        {/* Besties List */}\r\n                        {checkIn.bestieIds && checkIn.bestieIds.length > 0 && (\r\n                          <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3\">\r\n                            <div className=\"text-xs font-semibold text-text-secondary dark:text-dark-text-secondary mb-2\">\r\n                              Notified Besties\r\n                            </div>\r\n                            <div className=\"flex flex-wrap gap-2\">\r\n                              {checkIn.bestieIds.map((bestieId) => (\r\n                                <span\r\n                                  key={bestieId}\r\n                                  className=\"inline-flex items-center gap-1 px-2 py-1 bg-primary/10 text-primary dark:bg-primary/20 dark:text-dark-primary rounded-full text-sm\"\r\n                                >\r\n                                  üë§ {bestieNames[bestieId] || 'Loading...'}\r\n                                </span>\r\n                              ))}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n\r\n                        {/* Notes */}\r\n                        {checkIn.notes && (\r\n                          <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3\">\r\n                            <div className=\"text-xs font-semibold text-text-secondary dark:text-dark-text-secondary mb-2\">\r\n                              Notes\r\n                            </div>\r\n                            <div className=\"text-sm text-text-primary dark:text-dark-text-primary italic\">\r\n                              \"{checkIn.notes}\"\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n\r\n                        {/* Meeting With */}\r\n                        {checkIn.meetingWith && (\r\n                          <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3\">\r\n                            <div className=\"text-xs font-semibold text-text-secondary dark:text-dark-text-secondary mb-2\">\r\n                              Meeting With\r\n                            </div>\r\n                            <div className=\"text-sm text-text-primary dark:text-dark-text-primary\">\r\n                              {checkIn.meetingWith}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n\r\n                        {/* Social Media Links */}\r\n                        {checkIn.socialMediaLinks && (\r\n                          <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3\">\r\n                            <div className=\"text-xs font-semibold text-text-secondary dark:text-dark-text-secondary mb-2\">\r\n                              Social Media Links\r\n                            </div>\r\n                            <div className=\"text-sm text-text-primary dark:text-dark-text-primary break-all\">\r\n                              {checkIn.socialMediaLinks}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n\r\n                        {/* GPS Coordinates */}\r\n                        {checkIn.gpsCoords && (\r\n                          <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3\">\r\n                            <div className=\"text-xs font-semibold text-text-secondary dark:text-dark-text-secondary mb-2\">\r\n                              GPS Location\r\n                            </div>\r\n                            <div className=\"text-sm text-text-primary dark:text-dark-text-primary\">\r\n                              üìç {checkIn.gpsCoords.lat.toFixed(6)}, {checkIn.gpsCoords.lng.toFixed(6)}\r\n                            </div>\r\n                            <a\r\n                              href={`https://www.google.com/maps?q=${checkIn.gpsCoords.lat},${checkIn.gpsCoords.lng}`}\r\n                              target=\"_blank\"\r\n                              rel=\"noopener noreferrer\"\r\n                              className=\"text-xs text-primary dark:text-dark-primary hover:underline mt-1 inline-block\"\r\n                              onClick={(e) => e.stopPropagation()}\r\n                            >\r\n                              View on Google Maps ‚Üí\r\n                            </a>\r\n                          </div>\r\n                        )}\r\n\r\n                        {/* Photos */}\r\n                        {checkIn.photoURLs && checkIn.photoURLs.length > 0 && (\r\n                          <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3\">\r\n                            <div className=\"text-xs font-semibold text-text-secondary dark:text-dark-text-secondary mb-2\">\r\n                              Photos ({checkIn.photoURLs.length})\r\n                            </div>\r\n                            <div className=\"grid grid-cols-2 md:grid-cols-3 gap-2\">\r\n                              {checkIn.photoURLs.map((url, idx) => (\r\n                                <a\r\n                                  key={idx}\r\n                                  href={url}\r\n                                  target=\"_blank\"\r\n                                  rel=\"noopener noreferrer\"\r\n                                  className=\"block aspect-square rounded-lg overflow-hidden bg-gray-200 dark:bg-gray-600\"\r\n                                  onClick={(e) => e.stopPropagation()}\r\n                                >\r\n                                  <img\r\n                                    src={url}\r\n                                    alt={`Check-in ${idx + 1}`}\r\n                                    className=\"w-full h-full object-cover hover:opacity-80 transition-opacity\"\r\n                                  />\r\n                                </a>\r\n                              ))}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n\r\n            {/* Load More Button */}\r\n            {hasMore && (\r\n              <div className=\"mt-6 text-center\">\r\n                <button\r\n                  onClick={handleLoadMore}\r\n                  disabled={loadingMore}\r\n                  className=\"btn btn-secondary px-8\"\r\n                >\r\n                  {loadingMore ? (\r\n                    <>\r\n                      <span className=\"spinner-small mr-2\"></span>\r\n                      Loading...\r\n                    </>\r\n                  ) : (\r\n                    `Load More (${ITEMS_PER_PAGE} at a time)`\r\n                  )}\r\n                </button>\r\n              </div>\r\n            )}\r\n\r\n            {!hasMore && history.length > 0 && (\r\n              <div className=\"mt-6 text-center text-text-secondary dark:text-dark-text-secondary text-sm\">\r\n                You've reached the end of your check-in history\r\n              </div>\r\n            )}\r\n          </>\r\n        )}\r\n\r\n        {/* Back Button - Bottom */}\r\n        <div className=\"mt-8 text-center\">\r\n          <button\r\n            onClick={() => navigate(-1)}\r\n            className=\"inline-flex items-center gap-2 text-primary dark:text-dark-primary hover:underline font-semibold\"\r\n          >\r\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n            </svg>\r\n            Back\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CheckInHistoryPage;\r\n"],"names":["CheckInHistoryPage","_userData$stats","_userData$stats2","_userData$stats3","navigate","useNavigate","currentUser","userData","useAuth","history","setHistory","useState","loading","setLoading","loadingMore","setLoadingMore","filter","setFilter","lastDoc","setLastDoc","hasMore","setHasMore","expandedItems","setExpandedItems","Set","bestieNames","setBestieNames","useEffect","loadHistory","length","async","uniqueBestieIds","forEach","checkIn","bestieIds","id","add","prevNames","names","_objectSpread","promises","bestieId","push","getDoc","doc","db","then","bestieDoc","exists","bestieData","data","displayName","catch","error","console","Promise","all","fetchBestieNames","loadMore","arguments","undefined","q","query","collection","where","uid","orderBy","limit","startAfter","snapshot","getDocs","checkIns","prev","docs","toggleExpanded","newExpanded","has","delete","getStatusBadge","status","_jsx","className","children","formatDuration","minutes","concat","hours","Math","floor","mins","_jsxs","onClick","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","stats","totalCheckIns","completedCheckIns","alertedCheckIns","_Fragment","map","_checkIn$createdAt","_checkIn$bestieIds2","_checkIn$createdAt2","_checkIn$alertTime","_checkIn$completedAt","_checkIn$alertedAt","isExpanded","canExpand","_checkIn$photoURLs","_checkIn$bestieIds","notes","meetingWith","socialMediaLinks","gpsCoords","photoURLs","alertTime","completedAt","alertedAt","hasExpandableContent","location","createdAt","toDate","formatDistanceToNow","addSuffix","e","stopPropagation","duration","format","lat","toFixed","lng","href","target","rel","url","idx","src","alt","handleLoadMore","disabled"],"sourceRoot":""}