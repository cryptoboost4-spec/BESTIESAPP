{"version":3,"file":"static/js/392.a13f9bd6.chunk.js","mappings":"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","sources":["config/features.js","config/messenger.js","components/checkin/CheckInLoader.jsx","components/checkin/CheckInMap.jsx","components/checkin/MeetingInfoSection.jsx","components/checkin/DurationSelector.jsx","components/checkin/SharePromptButtons.jsx","components/checkin/BestieSelector.jsx","components/checkin/MessengerContactSelector.jsx","components/checkin/NotesPhotosSection.jsx","pages/CreateCheckInPage.jsx"],"sourcesContent":["// Feature flags - enable/disable features without code changes\r\nexport const FEATURES = {\r\n  // Core (always on)\r\n  core: true,\r\n  auth: true,\r\n  checkIns: true,\r\n  besties: true,\r\n  \r\n  // MVP Launch (enabled)\r\n  templates: true,\r\n  quickButtons: true,\r\n  celebrationMessages: true,\r\n  gpsLocation: true,\r\n  manualLocation: true,\r\n  extendButtons: true,\r\n  \r\n  // Gamification (enabled)\r\n  bestieCircle: true,\r\n  badges: true,\r\n  shareableCards: true,\r\n  \r\n  // Media (enabled)\r\n  mediaUpload: true,\r\n  photoCapture: true,\r\n  \r\n  // Payments (enabled)\r\n  donations: true,\r\n  smsSubscription: true,\r\n\r\n  // Messaging (enabled)\r\n  messengerAlerts: true,\r\n  telegramAlerts: true,\r\n\r\n  // Future features (disabled for now)\r\n  emergency: false,\r\n  reversePin: false,\r\n  liveTracking: false,\r\n  videoRecording: false,\r\n  facebookLogin: false, // Enable when account is unblocked\r\n  phoneAuth: false // Not needed for MVP\r\n};\r\n\r\n// Helper to check if feature is enabled\r\nexport const isEnabled = (feature) => FEATURES[feature] === true;\r\n\r\nexport default FEATURES;\r\n","// Facebook Messenger configuration\r\nexport const MESSENGER_CONFIG = {\r\n  // Facebook Page username (for m.me links)\r\n  pageUsername: 'besties.safety',\r\n\r\n  // M.me link template - replace {userId} with actual user ID\r\n  getLinkForUser: (userId) => `https://m.me/besties.safety?ref=${userId}`,\r\n\r\n  // Contact expiry time (20 hours in milliseconds)\r\n  contactExpiryHours: 20,\r\n  contactExpiryMs: 20 * 60 * 60 * 1000\r\n};\r\n\r\nexport default MESSENGER_CONFIG;\r\n","import React, { useState } from 'react';\r\n\r\n// Luxury girly skeleton loader for check-in creation\r\nconst CheckInLoader = () => {\r\n  const messages = [\r\n    \"Wrapping you in safety... Your besties will watch over you ğŸ’–\",\r\n    \"Building your protection... We've got your back, always âœ¨\",\r\n    \"Setting up your safety circle... You're never alone with us ğŸŒ¸\",\r\n    \"Preparing your safety net... Because you deserve to feel secure ğŸ’•\",\r\n  ];\r\n\r\n  // Pick one random message for this check-in\r\n  const [message] = useState(() => messages[Math.floor(Math.random() * messages.length)]);\r\n\r\n  return (\r\n    <>\r\n    <div className=\"min-h-screen bg-gradient-to-br from-rose-50 via-pink-50 via-purple-50 to-indigo-50 dark:from-purple-900/30 dark:via-pink-900/30 dark:to-indigo-900/30 flex items-center justify-center p-4 relative overflow-hidden\">\r\n      {/* Elegant floating elements */}\r\n      <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\r\n        {[...Array(20)].map((_, i) => (\r\n          <div\r\n            key={i}\r\n            className=\"absolute animate-float-elegant\"\r\n            style={{\r\n              left: `${Math.random() * 100}%`,\r\n              top: `${Math.random() * 100}%`,\r\n              animationDelay: `${Math.random() * 4}s`,\r\n              animationDuration: `${6 + Math.random() * 4}s`,\r\n              opacity: 0.3 + Math.random() * 0.3,\r\n            }}\r\n          >\r\n            <span className=\"text-2xl\">\r\n              {['âœ¨', 'ğŸ’', 'ğŸŒ¸', 'ğŸ¦‹', 'ğŸ’«', 'ğŸŒº', 'ğŸµï¸', 'ğŸ€'][Math.floor(Math.random() * 8)]}\r\n            </span>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Luxury content card */}\r\n      <div className=\"w-full max-w-lg text-center relative z-10\">\r\n        <div className=\"relative bg-white/95 dark:bg-gray-800/95 backdrop-blur-xl rounded-[2rem] p-10 shadow-[0_20px_60px_rgba(0,0,0,0.1)] border border-white/50 dark:border-gray-600/50\">\r\n        {/* Message */}\r\n        <h2 className=\"font-display text-3xl text-gradient mb-4\">\r\n          Creating your check-in!\r\n        </h2>\r\n\r\n        <p className=\"text-xl text-text-secondary font-semibold mb-8 animate-fade-in\">\r\n          {message}\r\n        </p>\r\n\r\n        {/* Cute loading animation */}\r\n        <div className=\"flex justify-center gap-2 mb-8\">\r\n          {[0, 1, 2].map((i) => (\r\n            <div\r\n              key={i}\r\n              className=\"w-4 h-4 bg-gradient-primary rounded-full animate-bounce\"\r\n              style={{ animationDelay: `${i * 0.15}s` }}\r\n            ></div>\r\n          ))}\r\n        </div>\r\n\r\n          {/* Elegant loading animation */}\r\n          <div className=\"flex justify-center items-center gap-2 mb-8\">\r\n            {[0, 1, 2, 3, 4].map((i) => (\r\n              <div\r\n                key={i}\r\n                className=\"w-2 h-2 bg-gradient-to-r from-pink-400 to-purple-400 rounded-full animate-wave\"\r\n                style={{\r\n                  animationDelay: `${i * 0.15}s`,\r\n                  animationDuration: '1.5s'\r\n                }}\r\n              ></div>\r\n            ))}\r\n          </div>\r\n\r\n          {/* Silk ribbon progress bar */}\r\n          <div className=\"relative w-full h-2 bg-gradient-to-r from-pink-100 via-purple-100 to-fuchsia-100 dark:from-pink-900/50 dark:via-purple-900/50 dark:to-fuchsia-900/50 rounded-full overflow-hidden shadow-inner\">\r\n            <div className=\"absolute inset-0 bg-gradient-to-r from-pink-400 via-purple-400 via-fuchsia-400 to-pink-400 animate-silk-shimmer bg-[length:300%_100%] opacity-80\"></div>\r\n            <div className=\"absolute inset-0 bg-white/30 dark:bg-white/10 animate-silk-shine\"></div>\r\n          </div>\r\n\r\n          {/* Gentle reminder */}\r\n          <p className=\"text-xs text-gray-400 dark:text-gray-400 mt-6 italic\">\r\n            Taking care of you, always ğŸ’•\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n      <style>{`\r\n        @keyframes float-elegant {\r\n          0%, 100% {\r\n            transform: translateY(0px) translateX(0px) rotate(0deg);\r\n            opacity: 0.3;\r\n          }\r\n          50% {\r\n            transform: translateY(-30px) translateX(10px) rotate(5deg);\r\n            opacity: 0.6;\r\n          }\r\n        }\r\n        @keyframes pulse-slow {\r\n          0%, 100% { transform: scale(1); opacity: 0.4; }\r\n          50% { transform: scale(1.2); opacity: 0.2; }\r\n        }\r\n        @keyframes pulse-gentle {\r\n          0%, 100% { transform: scale(1); }\r\n          50% { transform: scale(1.05); }\r\n        }\r\n        @keyframes wave {\r\n          0%, 100% { transform: translateY(0); }\r\n          50% { transform: translateY(-8px); }\r\n        }\r\n        @keyframes silk-shimmer {\r\n          0% { background-position: 0% center; }\r\n          100% { background-position: 300% center; }\r\n        }\r\n        @keyframes silk-shine {\r\n          0% { transform: translateX(-100%) skewX(-15deg); opacity: 0; }\r\n          50% { opacity: 0.5; }\r\n          100% { transform: translateX(200%) skewX(-15deg); opacity: 0; }\r\n        }\r\n        @keyframes draw-check {\r\n          0% { stroke-dasharray: 0, 100; }\r\n          100% { stroke-dasharray: 100, 0; }\r\n        }\r\n        .animate-float-elegant {\r\n          animation: float-elegant 8s ease-in-out infinite;\r\n        }\r\n        .animate-pulse-slow {\r\n          animation: pulse-slow 3s ease-in-out infinite;\r\n        }\r\n        .animate-pulse-gentle {\r\n          animation: pulse-gentle 2s ease-in-out infinite;\r\n        }\r\n        .animate-wave {\r\n          animation: wave 1.5s ease-in-out infinite;\r\n        }\r\n        .animate-silk-shimmer {\r\n          animation: silk-shimmer 3s linear infinite;\r\n        }\r\n        .animate-silk-shine {\r\n          animation: silk-shine 3s ease-in-out infinite;\r\n        }\r\n        .animate-draw-check {\r\n          animation: draw-check 2s ease-in-out infinite;\r\n          stroke-dasharray: 100;\r\n        }\r\n      `}</style>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CheckInLoader;\r\n","import React, { useRef, useEffect } from 'react';\r\nimport toast from 'react-hot-toast';\r\nimport { isEnabled } from '../../config/features';\r\n\r\nconst CheckInMap = ({\r\n  locationInput,\r\n  setLocationInput,\r\n  gpsCoords,\r\n  setGpsCoords,\r\n  mapInitialized,\r\n  setMapInitialized,\r\n  mapLocked,\r\n  setMapLocked,\r\n  autocompleteLoaded,\r\n  showLocationDropdown,\r\n  setShowLocationDropdown,\r\n  loading,\r\n  setLoading\r\n}) => {\r\n  const locationInputRef = useRef(null);\r\n  const autocompleteRef = useRef(null);\r\n  const mapRef = useRef(null);\r\n  const mapInstanceRef = useRef(null);\r\n\r\n  // Initialize Map when API is loaded\r\n  useEffect(() => {\r\n    if (!autocompleteLoaded || !mapRef.current || mapInitialized) return;\r\n\r\n    // Add extra validation that API is actually ready\r\n    if (!window.google || !window.google.maps || !window.google.maps.Map) {\r\n      console.warn('Google Maps API not fully ready yet, retrying...');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      console.log('Initializing Google Map...');\r\n      // Initialize Google Map - locked by default\r\n      mapInstanceRef.current = new window.google.maps.Map(mapRef.current, {\r\n        center: { lat: 37.7749, lng: -122.4194 }, // San Francisco\r\n        zoom: 12,\r\n        disableDefaultUI: true,\r\n        zoomControl: true,\r\n        mapTypeControl: false,\r\n        streetViewControl: false,\r\n        fullscreenControl: false,\r\n        draggable: false, // Start locked\r\n        gestureHandling: 'none', // Disable all gestures initially\r\n      });\r\n\r\n      // Handle double-tap to unlock/place pin\r\n      mapInstanceRef.current.addListener('dblclick', (event) => {\r\n        if (mapLocked) {\r\n          // Unlock the map\r\n          setMapLocked(false);\r\n          mapInstanceRef.current.setOptions({\r\n            draggable: true,\r\n            gestureHandling: 'greedy'\r\n          });\r\n          toast.success('ğŸ—ºï¸ Map unlocked! Drag to explore', { duration: 2000 });\r\n        } else {\r\n          // Place pin at MAP CENTER (where the fixed pin is displayed)\r\n          const mapCenter = mapInstanceRef.current.getCenter();\r\n          const coords = { lat: mapCenter.lat(), lng: mapCenter.lng() };\r\n\r\n          // Save the center coordinates\r\n          setGpsCoords(coords);\r\n\r\n          // Reverse geocode to get address from the center pin location\r\n          const geocoder = new window.google.maps.Geocoder();\r\n          geocoder.geocode({ location: coords }, (results, status) => {\r\n            if (status === 'OK' && results[0]) {\r\n              const address = results[0].formatted_address;\r\n              setLocationInput(address);\r\n              console.log('Pin placed, location updated to:', address);\r\n            } else {\r\n              // Fallback to coordinates if geocoding fails\r\n              const coordsString = `${coords.lat.toFixed(6)}, ${coords.lng.toFixed(6)}`;\r\n              setLocationInput(coordsString);\r\n              console.log('Pin placed, using coordinates:', coordsString);\r\n            }\r\n          });\r\n\r\n          // Show success feedback\r\n          toast.success('ğŸ“ Pin location saved!', { duration: 1500 });\r\n        }\r\n      });\r\n\r\n      // Handle map drag - update location instantly when map is dragged\r\n      mapInstanceRef.current.addListener('dragend', () => {\r\n        if (!mapLocked) {\r\n          // Get the center of the map (where the pin is)\r\n          const mapCenter = mapInstanceRef.current.getCenter();\r\n          const coords = { lat: mapCenter.lat(), lng: mapCenter.lng() };\r\n\r\n          // Save the center coordinates\r\n          setGpsCoords(coords);\r\n\r\n          // Reverse geocode to get address and update search bar\r\n          const geocoder = new window.google.maps.Geocoder();\r\n          geocoder.geocode({ location: coords }, (results, status) => {\r\n            if (status === 'OK' && results[0]) {\r\n              const address = results[0].formatted_address;\r\n              setLocationInput(address);\r\n              console.log('Map dragged, location updated to:', address);\r\n            } else {\r\n              // Fallback to coordinates if geocoding fails\r\n              const coordsString = `${coords.lat.toFixed(6)}, ${coords.lng.toFixed(6)}`;\r\n              setLocationInput(coordsString);\r\n              console.log('Map dragged, using coordinates:', coordsString);\r\n            }\r\n          });\r\n        }\r\n      });\r\n\r\n      // Show reminder on single click when locked\r\n      mapInstanceRef.current.addListener('click', () => {\r\n        if (mapLocked) {\r\n          toast('ğŸ’¡ Double-tap to unlock map!', {\r\n            duration: 2000,\r\n            icon: 'ğŸ”’',\r\n            style: {\r\n              background: '#fef3c7',\r\n              color: '#92400e',\r\n              fontWeight: 600,\r\n            }\r\n          });\r\n        }\r\n      });\r\n\r\n      setMapInitialized(true);\r\n      console.log('Google Map initialized successfully');\r\n    } catch (error) {\r\n      console.error('Error initializing map:', error);\r\n      toast.error('Failed to initialize map. Please refresh the page.', {\r\n        duration: 4000,\r\n        id: 'map-init-error'\r\n      });\r\n    }\r\n  }, [autocompleteLoaded, mapInitialized, mapLocked, setGpsCoords, setLocationInput, setMapInitialized, setMapLocked]);\r\n\r\n  // Initialize Autocomplete when API is loaded\r\n  useEffect(() => {\r\n    if (!autocompleteLoaded || !locationInputRef.current) return;\r\n\r\n    // Add extra validation that Places API is actually ready\r\n    if (!window.google || !window.google.maps || !window.google.maps.places || !window.google.maps.places.Autocomplete) {\r\n      console.warn('Google Places API not fully ready yet, retrying...');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      console.log('Initializing Google Places Autocomplete...');\r\n\r\n      // Initialize Google Places Autocomplete\r\n      autocompleteRef.current = new window.google.maps.places.Autocomplete(\r\n        locationInputRef.current,\r\n        {\r\n          types: ['establishment', 'geocode'], // Allow both businesses and addresses\r\n          fields: ['formatted_address', 'name', 'geometry'], // Request only needed fields\r\n        }\r\n      );\r\n\r\n      // Listen for place selection\r\n      autocompleteRef.current.addListener('place_changed', () => {\r\n        try {\r\n          const place = autocompleteRef.current.getPlace();\r\n\r\n          if (place.formatted_address) {\r\n            // Use business name if available, otherwise use formatted address\r\n            const displayLocation = place.name && place.name !== place.formatted_address\r\n              ? `${place.name}, ${place.formatted_address}`\r\n              : place.formatted_address;\r\n\r\n            setLocationInput(displayLocation);\r\n\r\n            // Center map on selected place (no marker needed - fixed pin in center)\r\n            if (place.geometry && place.geometry.location && mapInstanceRef.current) {\r\n              const location = place.geometry.location;\r\n              const coords = { lat: location.lat(), lng: location.lng() };\r\n              mapInstanceRef.current.setCenter(coords);\r\n              mapInstanceRef.current.setZoom(15);\r\n              setGpsCoords(coords); // Store coordinates\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error('Error handling place selection:', error);\r\n          toast.error('Error selecting location. Please try again.', {\r\n            duration: 3000\r\n          });\r\n        }\r\n      });\r\n\r\n      console.log('Autocomplete initialized successfully');\r\n    } catch (error) {\r\n      console.error('Error initializing autocomplete:', error);\r\n      toast.error('Could not initialize address search. Please type your location manually.', {\r\n        duration: 4000,\r\n        id: 'autocomplete-init-error'\r\n      });\r\n    }\r\n\r\n    return () => {\r\n      // Cleanup autocomplete listeners\r\n      if (autocompleteRef.current) {\r\n        window.google.maps.event.clearInstanceListeners(autocompleteRef.current);\r\n      }\r\n    };\r\n  }, [autocompleteLoaded, setGpsCoords, setLocationInput]);\r\n\r\n  // Update map when GPS coordinates are available\r\n  useEffect(() => {\r\n    if (!gpsCoords || !mapInstanceRef.current) return;\r\n\r\n    try {\r\n      // Center map on GPS location (fixed pin shows the location)\r\n      mapInstanceRef.current.setCenter(gpsCoords);\r\n      mapInstanceRef.current.setZoom(16);\r\n    } catch (error) {\r\n      console.error('Error updating map with GPS:', error);\r\n    }\r\n  }, [gpsCoords]);\r\n\r\n  const handleGetLocation = () => {\r\n    if (!isEnabled('gpsLocation')) {\r\n      toast.error('GPS location is not enabled');\r\n      return;\r\n    }\r\n\r\n    if (navigator.geolocation) {\r\n      setLoading(true);\r\n      toast.loading('Getting your location...', { id: 'gps-loading' });\r\n\r\n      // Use watchPosition for better accuracy, then stop after first good reading\r\n      const watchId = navigator.geolocation.watchPosition(\r\n        (position) => {\r\n          const lat = position.coords.latitude;\r\n          const lng = position.coords.longitude;\r\n          const accuracy = position.coords.accuracy; // in meters\r\n          \r\n          // Stop watching once we get a good reading (< 20m accuracy) or after 5 seconds\r\n          navigator.geolocation.clearWatch(watchId);\r\n          \r\n          // If accuracy is poor, try one more time with getCurrentPosition\r\n          if (accuracy > 20) {\r\n            navigator.geolocation.getCurrentPosition(\r\n              (betterPosition) => {\r\n                const betterLat = betterPosition.coords.latitude;\r\n                const betterLng = betterPosition.coords.longitude;\r\n                const betterAccuracy = betterPosition.coords.accuracy;\r\n                const gpsCoords = { lat: betterLat, lng: betterLng };\r\n\r\n                // Use reverse geocoding to get address from coordinates\r\n                const geocoder = new window.google.maps.Geocoder();\r\n                geocoder.geocode({ location: gpsCoords }, (results, status) => {\r\n                  toast.dismiss('gps-loading');\r\n                  setLoading(false);\r\n\r\n                  if (status === 'OK' && results[0]) {\r\n                    setLocationInput(results[0].formatted_address);\r\n                    toast.success(`Location captured! (Accuracy: ${Math.round(betterAccuracy)}m)`, { duration: 2000 });\r\n                  } else {\r\n                    setLocationInput(`GPS: ${betterLat.toFixed(6)}, ${betterLng.toFixed(6)}`);\r\n                    toast.success(`Location captured (Accuracy: ${Math.round(betterAccuracy)}m)`, { duration: 2000 });\r\n                  }\r\n\r\n                  setGpsCoords(gpsCoords);\r\n                });\r\n              },\r\n              (error) => {\r\n                // Fallback to first reading\r\n                const gpsCoords = { lat, lng };\r\n                const geocoder = new window.google.maps.Geocoder();\r\n                geocoder.geocode({ location: gpsCoords }, (results, status) => {\r\n                  toast.dismiss('gps-loading');\r\n                  setLoading(false);\r\n\r\n                  if (status === 'OK' && results[0]) {\r\n                    setLocationInput(results[0].formatted_address);\r\n                    toast.success(`Location captured! (Accuracy: ${Math.round(accuracy)}m)`, { duration: 2000 });\r\n                  } else {\r\n                    setLocationInput(`GPS: ${lat.toFixed(6)}, ${lng.toFixed(6)}`);\r\n                    toast.success(`Location captured (Accuracy: ${Math.round(accuracy)}m)`, { duration: 2000 });\r\n                  }\r\n\r\n                  setGpsCoords(gpsCoords);\r\n                });\r\n              },\r\n              { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }\r\n            );\r\n          } else {\r\n            // Good accuracy, use this reading\r\n            const gpsCoords = { lat, lng };\r\n            const geocoder = new window.google.maps.Geocoder();\r\n            geocoder.geocode({ location: gpsCoords }, (results, status) => {\r\n              toast.dismiss('gps-loading');\r\n              setLoading(false);\r\n\r\n              if (status === 'OK' && results[0]) {\r\n                setLocationInput(results[0].formatted_address);\r\n                toast.success(`Location captured! (Accuracy: ${Math.round(accuracy)}m)`, { duration: 2000 });\r\n              } else {\r\n                setLocationInput(`GPS: ${lat.toFixed(6)}, ${lng.toFixed(6)}`);\r\n                toast.success(`Location captured (Accuracy: ${Math.round(accuracy)}m)`, { duration: 2000 });\r\n              }\r\n\r\n              setGpsCoords(gpsCoords);\r\n            });\r\n          }\r\n        },\r\n        (error) => {\r\n          navigator.geolocation.clearWatch(watchId);\r\n          // Fallback to getCurrentPosition\r\n          navigator.geolocation.getCurrentPosition(\r\n            (position) => {\r\n              const lat = position.coords.latitude;\r\n              const lng = position.coords.longitude;\r\n              const accuracy = position.coords.accuracy;\r\n              const gpsCoords = { lat, lng };\r\n\r\n              const geocoder = new window.google.maps.Geocoder();\r\n              geocoder.geocode({ location: gpsCoords }, (results, status) => {\r\n                toast.dismiss('gps-loading');\r\n                setLoading(false);\r\n\r\n                if (status === 'OK' && results[0]) {\r\n                  setLocationInput(results[0].formatted_address);\r\n                  toast.success(`Location captured! (Accuracy: ${Math.round(accuracy)}m)`, { duration: 2000 });\r\n                } else {\r\n                  setLocationInput(`GPS: ${lat.toFixed(6)}, ${lng.toFixed(6)}`);\r\n                  toast.success(`Location captured (Accuracy: ${Math.round(accuracy)}m)`, { duration: 2000 });\r\n                }\r\n\r\n                setGpsCoords(gpsCoords);\r\n              });\r\n            },\r\n            (fallbackError) => {\r\n              toast.dismiss('gps-loading');\r\n              setLoading(false);\r\n              console.error('Geolocation error:', fallbackError);\r\n              // Show error message (handled below)\r\n            },\r\n            { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }\r\n          );\r\n        },\r\n        { enableHighAccuracy: true, timeout: 5000, maximumAge: 0 }\r\n      );\r\n      \r\n      // Stop watching after 10 seconds max\r\n      setTimeout(() => {\r\n        navigator.geolocation.clearWatch(watchId);\r\n      }, 10000);\r\n    } else {\r\n      toast.error('Geolocation not supported by your browser. Please search for your location manually.');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"card p-0 overflow-hidden\">\r\n      <label className=\"block text-lg font-display text-text-primary p-6 pb-3 text-center\">\r\n        Create Check-In\r\n      </label>\r\n\r\n      {/* Map with overlays */}\r\n      <div className=\"relative\">\r\n        {/* Map Container */}\r\n        <div\r\n          ref={mapRef}\r\n          className=\"w-full h-80\"\r\n          style={{ minHeight: '320px' }}\r\n        ></div>\r\n\r\n        {/* Search bar overlay */}\r\n        <div className=\"absolute top-3 left-3 right-3 z-10\">\r\n          <input\r\n            ref={locationInputRef}\r\n            type=\"text\"\r\n            value={locationInput}\r\n            onChange={(e) => setLocationInput(e.target.value)}\r\n            onFocus={() => setShowLocationDropdown(true)}\r\n            onBlur={() => setTimeout(() => setShowLocationDropdown(false), 200)}\r\n            className=\"input w-full shadow-lg\"\r\n            placeholder=\"Search for a place...\"\r\n            required\r\n            autoComplete=\"off\"\r\n          />\r\n          {/* Location dropdown */}\r\n          {showLocationDropdown && isEnabled('gpsLocation') && (\r\n            <div className=\"mt-2 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-600 overflow-hidden\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  handleGetLocation();\r\n                  setShowLocationDropdown(false);\r\n                }}\r\n                className=\"w-full px-4 py-3 flex items-center gap-3 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left\"\r\n              >\r\n                <svg\r\n                  className=\"w-5 h-5 text-primary\"\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <circle cx=\"12\" cy=\"12\" r=\"3\" strokeWidth={2} />\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 2v4m0 12v4M2 12h4m12 0h4\" />\r\n                </svg>\r\n                <span className=\"font-semibold text-text-primary\">Your Location</span>\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Fixed center pin - doesn't move, map moves underneath */}\r\n        <div className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-full z-10 pointer-events-none\">\r\n          <svg\r\n            className=\"w-12 h-12 text-primary drop-shadow-lg\"\r\n            fill=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\"/>\r\n          </svg>\r\n        </div>\r\n\r\n        {/* Locate me button overlay - positioned below search bar */}\r\n        {isEnabled('gpsLocation') && (\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleGetLocation}\r\n            className=\"absolute right-3 top-20 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 p-3 rounded-lg shadow-lg border border-gray-300 dark:border-gray-600 transition-all z-10\"\r\n            disabled={loading}\r\n            title=\"Use my current location\"\r\n          >\r\n            {loading ? (\r\n              <div className=\"w-5 h-5 spinner-small\"></div>\r\n            ) : (\r\n              <svg\r\n                className=\"w-5 h-5\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <circle cx=\"12\" cy=\"12\" r=\"3\" strokeWidth={2} />\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 2v4m0 12v4M2 12h4m12 0h4\" />\r\n              </svg>\r\n            )}\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      <p className=\"text-xs text-text-secondary p-3 px-6\">\r\n        ğŸ’œ <strong className=\"text-primary\">Your safety matters.</strong> Add as much location detail as you'd like to share\r\n      </p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CheckInMap;\r\n","import React from 'react';\r\n\r\nconst MeetingInfoSection = ({\r\n  meetingWith,\r\n  setMeetingWith,\r\n  socialMediaLinks,\r\n  setSocialMediaLinks,\r\n  socialMediaExpanded,\r\n  setSocialMediaExpanded\r\n}) => {\r\n  return (\r\n    <div className=\"mb-6\">\r\n      <label className=\"block text-lg font-display text-text-primary mb-3\">\r\n        Who are you meeting? ğŸ‘¥ (Optional)\r\n      </label>\r\n      <input\r\n        type=\"text\"\r\n        value={meetingWith}\r\n        onChange={(e) => setMeetingWith(e.target.value)}\r\n        className=\"input mb-3\"\r\n        placeholder=\"e.g., Alex, Sarah, John...\"\r\n      />\r\n\r\n      {/* Social Media Button/Input */}\r\n      {socialMediaExpanded ? (\r\n        <div className=\"animate-fade-in\">\r\n          <label className=\"block text-sm font-semibold text-text-secondary mb-2\">\r\n            Their Social Media\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            value={socialMediaLinks}\r\n            onChange={(e) => setSocialMediaLinks(e.target.value)}\r\n            className=\"input mb-2\"\r\n            placeholder=\"e.g., @username on Instagram, facebook.com/profile...\"\r\n            autoFocus\r\n          />\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => setSocialMediaExpanded(false)}\r\n            className=\"w-full btn btn-secondary text-sm py-2\"\r\n          >\r\n            Done\r\n          </button>\r\n        </div>\r\n      ) : (\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => setSocialMediaExpanded(true)}\r\n          className={`w-full border-2 ${\r\n            socialMediaLinks\r\n              ? 'border-primary bg-primary/10 text-primary'\r\n              : 'border-dashed border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:border-primary hover:bg-primary/5'\r\n          } rounded-xl p-3 text-sm font-semibold transition-all`}\r\n        >\r\n          {socialMediaLinks ? 'âœ“ Social Media Added' : 'ğŸ“± Add Their Social Media'}\r\n        </button>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MeetingInfoSection;\r\n","import React from 'react';\r\n\r\nconst DurationSelector = ({ duration, setDuration }) => {\r\n  return (\r\n    <div className=\"card p-6\">\r\n      <label className=\"block text-lg font-display text-text-primary mb-3\">\r\n        How long? â°\r\n      </label>\r\n\r\n      <div className=\"grid grid-cols-4 gap-3 mb-4\">\r\n        {[15, 30, 60, 120].map((mins) => (\r\n          <button\r\n            key={mins}\r\n            type=\"button\"\r\n            onClick={() => setDuration(mins)}\r\n            className={`py-3 rounded-xl font-semibold transition-all ${\r\n              duration === mins\r\n                ? 'bg-gradient-primary text-white shadow-lg'\r\n                : 'bg-gray-100 dark:bg-gray-700 text-text-primary hover:bg-gray-200 dark:hover:bg-gray-600'\r\n            }`}\r\n          >\r\n            {mins < 60 ? `${mins}m` : `${mins / 60}h`}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      <input\r\n        type=\"range\"\r\n        min=\"15\"\r\n        max=\"180\"\r\n        step=\"15\"\r\n        value={duration}\r\n        onChange={(e) => setDuration(parseInt(e.target.value))}\r\n        className=\"w-full\"\r\n      />\r\n      <div className=\"text-center mt-3\">\r\n        <div className=\"text-sm text-text-secondary\">\r\n          {duration} minutes\r\n        </div>\r\n        <div className=\"text-sm font-semibold text-primary mt-1\">\r\n          Alert at: {new Date(Date.now() + duration * 60 * 1000).toLocaleTimeString('en-US', {\r\n            hour: 'numeric',\r\n            minute: '2-digit',\r\n            hour12: true\r\n          })}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DurationSelector;\r\n","import React from 'react';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst SharePromptButtons = ({ bestieName, onClose }) => {\r\n  const handleShareToAddPhone = (platform) => {\r\n    const message = `Hey! You haven't added your phone number on Besties yet. I can't use you as my emergency contact until you do. Can you add it please? â¤ï¸\\n\\nDownload Besties: ${window.location.origin}`;\r\n    const encoded = encodeURIComponent(message);\r\n    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);\r\n\r\n    switch (platform) {\r\n      case 'whatsapp':\r\n        if (isMobile) {\r\n          window.location.href = `whatsapp://send?text=${encoded}`;\r\n        } else {\r\n          window.open(`https://wa.me/?text=${encoded}`, '_blank');\r\n        }\r\n        break;\r\n      case 'messenger':\r\n        if (isMobile) {\r\n          window.location.href = `fb-messenger://share?link=${encodeURIComponent(window.location.origin)}`;\r\n          setTimeout(() => {\r\n            window.open(`https://www.facebook.com/dialog/send?link=${encodeURIComponent(window.location.origin)}&app_id=&redirect_uri=${encodeURIComponent(window.location.origin)}`, '_blank');\r\n          }, 1500);\r\n        } else {\r\n          window.open(`https://www.facebook.com/dialog/send?link=${encodeURIComponent(window.location.origin)}&app_id=&redirect_uri=${encodeURIComponent(window.location.origin)}`, '_blank', 'width=600,height=400');\r\n        }\r\n        break;\r\n      case 'instagram':\r\n        navigator.clipboard.writeText(message).then(() => {\r\n          toast.success('Message copied! Opening Instagram DMs...');\r\n          if (isMobile) {\r\n            window.location.href = 'instagram://direct/inbox';\r\n            setTimeout(() => {\r\n              window.open('https://www.instagram.com/direct/inbox/', '_blank');\r\n            }, 1500);\r\n          } else {\r\n            window.open('https://www.instagram.com/direct/inbox/', '_blank');\r\n          }\r\n        }).catch(() => {\r\n          toast.error('Failed to copy message');\r\n        });\r\n        break;\r\n      case 'sms':\r\n        window.location.href = `sms:?body=${encoded}`;\r\n        break;\r\n      case 'facebook':\r\n        const textEncoded = encodeURIComponent('Hey! Please add your phone number on Besties â¤ï¸');\r\n        const urlEncoded = encodeURIComponent(window.location.origin);\r\n        if (isMobile) {\r\n          window.location.href = `fb://profile`;\r\n          setTimeout(() => {\r\n            window.open(`https://www.facebook.com/sharer/sharer.php?u=${urlEncoded}&quote=${textEncoded}`, '_blank');\r\n          }, 1500);\r\n        } else {\r\n          window.open(`https://www.facebook.com/sharer/sharer.php?u=${urlEncoded}&quote=${textEncoded}`, '_blank', 'width=600,height=400');\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n\r\n    toast.success(`Opening ${platform}...`);\r\n    if (onClose) onClose();\r\n  };\r\n\r\n  return (\r\n    <div className=\"mt-2 p-4 bg-purple-50 dark:bg-purple-900/30 border-2 border-purple-200 dark:border-purple-800 rounded-xl\">\r\n      <p className=\"text-sm font-semibold text-purple-900 dark:text-purple-200 mb-3\">\r\n        ğŸ“± Ask {bestieName} to add their phone number\r\n      </p>\r\n      <div className=\"grid grid-cols-3 gap-2\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => handleShareToAddPhone('whatsapp')}\r\n          className=\"flex flex-col items-center gap-1 p-3 rounded-lg bg-[#25D366] hover:bg-[#20BA5A] text-white transition-colors\"\r\n        >\r\n          <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path d=\"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z\"/>\r\n          </svg>\r\n          <span className=\"text-xs\">WhatsApp</span>\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => handleShareToAddPhone('messenger')}\r\n          className=\"flex flex-col items-center gap-1 p-3 rounded-lg bg-[#0084FF] hover:bg-[#0073E6] text-white transition-colors\"\r\n        >\r\n          <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path d=\"M12 0C5.373 0 0 4.975 0 11.111c0 3.497 1.745 6.616 4.472 8.652V24l4.086-2.242c1.09.301 2.246.464 3.442.464 6.627 0 12-4.974 12-11.111C24 4.975 18.627 0 12 0zm1.191 14.963l-3.055-3.26-5.963 3.26L10.732 8l3.131 3.259L19.752 8l-6.561 6.963z\"/>\r\n          </svg>\r\n          <span className=\"text-xs\">Messenger</span>\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => handleShareToAddPhone('instagram')}\r\n          className=\"flex flex-col items-center gap-1 p-3 rounded-lg bg-gradient-to-r from-[#833AB4] via-[#FD1D1D] to-[#F77737] hover:opacity-90 text-white transition-opacity\"\r\n        >\r\n          <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path d=\"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z\"/>\r\n          </svg>\r\n          <span className=\"text-xs\">Instagram</span>\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => handleShareToAddPhone('sms')}\r\n          className=\"flex flex-col items-center gap-1 p-3 rounded-lg bg-success hover:bg-green-600 text-white transition-colors\"\r\n        >\r\n          <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z\" />\r\n          </svg>\r\n          <span className=\"text-xs\">SMS</span>\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => handleShareToAddPhone('facebook')}\r\n          className=\"flex flex-col items-center gap-1 p-3 rounded-lg bg-[#1877F2] hover:bg-[#166FE5] text-white transition-colors\"\r\n        >\r\n          <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path d=\"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z\"/>\r\n          </svg>\r\n          <span className=\"text-xs\">Facebook</span>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SharePromptButtons;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport toast from 'react-hot-toast';\r\nimport ProfileWithBubble from '../ProfileWithBubble';\r\nimport SharePromptButtons from './SharePromptButtons';\r\nimport { MESSENGER_CONFIG } from '../../config/messenger';\r\n\r\nconst BestieSelector = ({ \r\n  besties, \r\n  selectedBesties, \r\n  setSelectedBesties,\r\n  messengerContacts = [],\r\n  selectedMessengerContacts = [],\r\n  setSelectedMessengerContacts = () => {},\r\n  userId,\r\n  showMessenger = true\r\n}) => {\r\n  const navigate = useNavigate();\r\n  const [expandedBestieShare, setExpandedBestieShare] = useState(null);\r\n  const [copied, setCopied] = useState(false);\r\n\r\n  // Filter active messenger contacts\r\n  const now = Date.now();\r\n  const activeMessengerContacts = messengerContacts.filter(\r\n    contact => contact.expiresAt?.toMillis() > now\r\n  );\r\n\r\n  // Auto-select new messenger contacts\r\n  useEffect(() => {\r\n    if (activeMessengerContacts.length > 0 && setSelectedMessengerContacts) {\r\n      const allContactIds = activeMessengerContacts.map(c => c.id);\r\n      // Auto-select all messenger contacts that aren't already selected\r\n      const newSelections = allContactIds.filter(id => !selectedMessengerContacts.includes(id));\r\n      if (newSelections.length > 0) {\r\n        setSelectedMessengerContacts([...selectedMessengerContacts, ...newSelections]);\r\n      }\r\n    }\r\n  }, [activeMessengerContacts.length]); // Only run when count changes\r\n\r\n  const toggleBestie = (bestieId) => {\r\n    if (selectedBesties.includes(bestieId)) {\r\n      setSelectedBesties(selectedBesties.filter(id => id !== bestieId));\r\n    } else {\r\n      if (selectedBesties.length >= 5) {\r\n        toast.error('Maximum 5 SMS besties per check-in');\r\n        return;\r\n      }\r\n      setSelectedBesties([...selectedBesties, bestieId]);\r\n    }\r\n  };\r\n\r\n  const toggleMessengerContact = (contactId) => {\r\n    if (selectedMessengerContacts.includes(contactId)) {\r\n      setSelectedMessengerContacts(selectedMessengerContacts.filter(id => id !== contactId));\r\n    } else {\r\n      setSelectedMessengerContacts([...selectedMessengerContacts, contactId]);\r\n    }\r\n  };\r\n\r\n  // Check if bestie has ANY contact method\r\n  const hasContactMethod = (bestie) => {\r\n    return (bestie.phone && bestie.smsEnabled) || \r\n           bestie.telegramChatId || \r\n           bestie.notificationPreferences?.telegram ||\r\n           bestie.notificationPreferences?.push;\r\n  };\r\n\r\n  const getTimeRemaining = (expiresAt) => {\r\n    const remaining = expiresAt?.toMillis() - now;\r\n    if (remaining <= 0) return null;\r\n    const hours = Math.floor(remaining / (1000 * 60 * 60));\r\n    const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));\r\n    if (hours > 0) return `${hours}h ${minutes}m left`;\r\n    return `${minutes}m left`;\r\n  };\r\n\r\n  const copyMessengerLink = () => {\r\n    const link = MESSENGER_CONFIG.getLinkForUser(userId);\r\n    navigator.clipboard.writeText(link);\r\n    setCopied(true);\r\n    setTimeout(() => setCopied(false), 2000);\r\n    toast.success('Link copied!');\r\n  };\r\n\r\n  return (\r\n    <div className=\"card p-6\">\r\n      <label className=\"block text-lg font-display text-text-primary mb-3\">\r\n        Who should we alert? ğŸ’œ\r\n      </label>\r\n\r\n      {/* Messenger Contacts Section */}\r\n      {showMessenger && (\r\n        <div className=\"mb-4\">\r\n          <div className=\"flex items-center justify-between mb-2\">\r\n            <span className=\"text-sm font-semibold text-text-secondary flex items-center gap-2\">\r\n              ğŸ’¬ Messenger Contacts\r\n              <span className=\"text-xs bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 px-2 py-0.5 rounded-full\">\r\n                Free & Unlimited\r\n              </span>\r\n            </span>\r\n          </div>\r\n\r\n          {activeMessengerContacts.length > 0 ? (\r\n            <div className=\"space-y-2 mb-3\">\r\n              {activeMessengerContacts.map((contact) => {\r\n                const isSelected = selectedMessengerContacts.includes(contact.id);\r\n                const timeRemaining = getTimeRemaining(contact.expiresAt);\r\n\r\n                return (\r\n                  <button\r\n                    key={contact.id}\r\n                    type=\"button\"\r\n                    onClick={() => toggleMessengerContact(contact.id)}\r\n                    className={`w-full p-3 rounded-xl border-2 transition-all text-left ${\r\n                      isSelected\r\n                        ? 'border-blue-500 bg-blue-50 dark:bg-blue-900/30'\r\n                        : 'border-gray-200 dark:border-gray-600 hover:border-gray-300'\r\n                    }`}\r\n                  >\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className=\"flex-shrink-0\">\r\n                        {contact.photoURL ? (\r\n                          <img src={contact.photoURL} alt={contact.name} className=\"w-10 h-10 rounded-full object-cover\" />\r\n                        ) : (\r\n                          <div className=\"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold\">\r\n                            {contact.name?.charAt(0) || '?'}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <div className=\"font-semibold text-text-primary truncate\">{contact.name}</div>\r\n                        <div className=\"text-xs text-blue-600 dark:text-blue-400\">{timeRemaining}</div>\r\n                      </div>\r\n                      <div className={`w-5 h-5 rounded border-2 flex items-center justify-center ${\r\n                        isSelected ? 'bg-blue-500 border-blue-500' : 'border-gray-300'\r\n                      }`}>\r\n                        {isSelected && (\r\n                          <svg className=\"w-3 h-3 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={3} d=\"M5 13l4 4L19 7\" />\r\n                          </svg>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </button>\r\n                );\r\n              })}\r\n            </div>\r\n          ) : (\r\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-3 mb-3 text-center\">\r\n              <p className=\"text-sm text-blue-700 dark:text-blue-300\">No messenger contacts connected yet</p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Add more messenger besties link */}\r\n          <button\r\n            type=\"button\"\r\n            onClick={copyMessengerLink}\r\n            className=\"w-full text-sm text-blue-600 dark:text-blue-400 hover:underline flex items-center justify-center gap-2\"\r\n          >\r\n            {copied ? 'âœ“ Copied!' : 'â• Add more messenger besties'}\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Divider */}\r\n      {showMessenger && besties.length > 0 && (\r\n        <div className=\"border-t border-gray-200 dark:border-gray-700 my-4\"></div>\r\n      )}\r\n\r\n      {/* Circle Besties Section */}\r\n      <div className=\"mb-2\">\r\n        <span className=\"text-sm font-semibold text-text-secondary\">ğŸ‘¥ Circle Besties (max 5)</span>\r\n      </div>\r\n\r\n      {besties.length === 0 ? (\r\n        <div className=\"text-center py-6 bg-orange-50 dark:bg-orange-900/30 border-2 border-orange-200 dark:border-orange-800 rounded-xl\">\r\n          <p className=\"font-semibold text-text-primary mb-2\">âš ï¸ No besties in your circle</p>\r\n          <p className=\"text-text-secondary text-sm mb-4\">Add besties to your bestie circle on the home page to create check-ins</p>\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => navigate('/')}\r\n            className=\"btn btn-primary\"\r\n          >\r\n            Go to Home Page\r\n          </button>\r\n        </div>\r\n      ) : (\r\n        <div className=\"space-y-2\">\r\n          {besties.map((bestie) => {\r\n            const selectionIndex = selectedBesties.indexOf(bestie.id);\r\n            const isSelected = selectionIndex !== -1;\r\n            const selectionNumber = isSelected ? selectionIndex + 1 : null;\r\n            const isShareExpanded = expandedBestieShare === bestie.id;\r\n            const canSelect = hasContactMethod(bestie);\r\n\r\n            return (\r\n              <div key={bestie.id} className=\"w-full\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => canSelect && toggleBestie(bestie.id)}\r\n                  disabled={!canSelect}\r\n                  className={`w-full p-4 rounded-xl border-2 transition-all text-left ${\r\n                    !canSelect\r\n                      ? 'border-orange-300 dark:border-orange-800 bg-orange-50 dark:bg-orange-900/30 opacity-60'\r\n                      : isSelected\r\n                      ? 'border-primary bg-primary/5'\r\n                      : 'border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500'\r\n                  }`}\r\n                >\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-3 flex-1\">\r\n                      <ProfileWithBubble\r\n                        photoURL={bestie.photoURL}\r\n                        name={bestie.name || bestie.email || 'Unknown'}\r\n                        requestAttention={bestie.requestAttention}\r\n                        size=\"md\"\r\n                        showBubble={true}\r\n                      />\r\n                      <div className=\"flex-1\">\r\n                        <div className=\"font-semibold text-text-primary\">{bestie.name || bestie.email || 'Unknown'}</div>\r\n                        <div className=\"text-sm text-text-secondary\">\r\n                          {!canSelect\r\n                            ? 'âš ï¸ No contact method available'\r\n                            : bestie.phone && bestie.smsEnabled\r\n                            ? bestie.email || bestie.phone\r\n                            : bestie.telegramChatId\r\n                            ? 'ğŸ“± Telegram enabled'\r\n                            : 'Push notifications enabled'}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    {canSelect ? (\r\n                      isSelected && (\r\n                        <div className=\"bg-primary text-white px-3 py-1 rounded-full text-sm font-bold\">\r\n                          {selectionNumber}/5\r\n                        </div>\r\n                      )\r\n                    ) : (\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          setExpandedBestieShare(isShareExpanded ? null : bestie.id);\r\n                        }}\r\n                        className=\"btn btn-sm btn-primary\"\r\n                      >\r\n                        Ask to Add\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                </button>\r\n\r\n                {/* Social Share Menu for No Contact Method */}\r\n                {!canSelect && isShareExpanded && (\r\n                  <SharePromptButtons\r\n                    bestieName={bestie.name}\r\n                    onClose={() => setExpandedBestieShare(null)}\r\n                  />\r\n                )}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"mt-3 text-sm text-primary font-semibold\">\r\n        Selected: {selectedBesties.length}/5 SMS â€¢ {selectedMessengerContacts.length} Messenger\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BestieSelector;\r\n","import React from 'react';\r\nimport { MESSENGER_CONFIG } from '../../config/messenger';\r\nimport InfoButton from '../InfoButton';\r\n\r\nconst MessengerContactSelector = ({\r\n  messengerContacts,\r\n  selectedContacts,\r\n  setSelectedContacts,\r\n  userId\r\n}) => {\r\n  const toggleContact = (contactId) => {\r\n    if (selectedContacts.includes(contactId)) {\r\n      setSelectedContacts(selectedContacts.filter(id => id !== contactId));\r\n    } else {\r\n      setSelectedContacts([...selectedContacts, contactId]);\r\n    }\r\n  };\r\n\r\n  const getTimeRemaining = (expiresAt) => {\r\n    const now = Date.now();\r\n    const expiryTime = expiresAt?.toMillis();\r\n    const remaining = expiryTime - now;\r\n\r\n    if (remaining <= 0) return null; // Expired\r\n\r\n    const hours = Math.floor(remaining / (1000 * 60 * 60));\r\n    const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));\r\n\r\n    if (hours > 0) {\r\n      return `${hours}h ${minutes}m left`;\r\n    }\r\n    return `${minutes}m left`;\r\n  };\r\n\r\n  // Filter out expired contacts\r\n  const now = Date.now();\r\n  const activeContacts = messengerContacts.filter(\r\n    contact => contact.expiresAt?.toMillis() > now\r\n  );\r\n\r\n  const copyMessengerLink = () => {\r\n    const link = MESSENGER_CONFIG.getLinkForUser(userId);\r\n    navigator.clipboard.writeText(link);\r\n  };\r\n\r\n  return (\r\n    <div className=\"card p-6\">\r\n      <div className=\"flex items-center justify-between mb-3\">\r\n        <label className=\"text-lg font-display text-text-primary flex items-center gap-2\">\r\n          Messenger Contacts (Optional)\r\n          <InfoButton message=\"Select Messenger contacts to receive emergency alerts. No limits! Contacts auto-connect for 20 hours when they message you via your Messenger link. Completely free alternative to SMS.\" />\r\n        </label>\r\n        <span className=\"text-xs bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 px-2 py-1 rounded-full font-semibold\">\r\n          Unlimited & Free\r\n        </span>\r\n      </div>\r\n\r\n      {activeContacts.length === 0 ? (\r\n        <div className=\"bg-gradient-to-br from-pink-50 to-purple-50 dark:from-pink-900/20 dark:to-purple-900/20 border-2 border-pink-200 dark:border-pink-800 rounded-xl p-6\">\r\n          <div className=\"text-center\">\r\n            <div className=\"text-4xl mb-2\">ğŸ’œ</div>\r\n            <p className=\"font-semibold text-text-primary mb-2\">Add a Messenger Bestie</p>\r\n            <p className=\"text-text-secondary text-sm mb-4\">\r\n              Free & unlimited alerts! Share your link and when they message you, they're connected for 20 hours.\r\n            </p>\r\n            \r\n            {/* Tooltip explanation */}\r\n            <div className=\"bg-pink-100 dark:bg-pink-900/30 rounded-lg p-3 mb-4 text-left\">\r\n              <p className=\"text-xs text-pink-800 dark:text-pink-200\">\r\n                <strong>ğŸ’¡ How it works:</strong> Share your link â†’ They click & send any message â†’ Instant 20hr connection for free alerts!\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"flex flex-col sm:flex-row gap-2 justify-center\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={copyMessengerLink}\r\n                className=\"btn btn-secondary inline-flex items-center justify-center gap-2\"\r\n              >\r\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\" />\r\n                </svg>\r\n                Copy Link\r\n              </button>\r\n              <a\r\n                href={`https://www.facebook.com/dialog/send?link=${encodeURIComponent(MESSENGER_CONFIG.getLinkForUser(userId))}&app_id=464891037130549&redirect_uri=${encodeURIComponent(window.location.href)}`}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n                className=\"btn btn-primary inline-flex items-center justify-center gap-2\"\r\n              >\r\n                <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path d=\"M12 2C6.477 2 2 6.145 2 11.235c0 2.894 1.447 5.48 3.71 7.155V22l3.477-1.906c.929.257 1.915.394 2.813.394 5.523 0 10-4.145 10-9.235C22 6.145 17.523 2 12 2z\"/>\r\n                </svg>\r\n                Share on Messenger\r\n              </a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          <div className=\"space-y-2 mb-4\">\r\n            {activeContacts.map((contact) => {\r\n              const isSelected = selectedContacts.includes(contact.id);\r\n              const timeRemaining = getTimeRemaining(contact.expiresAt);\r\n\r\n              if (!timeRemaining) return null; // Skip expired contacts\r\n\r\n              return (\r\n                <button\r\n                  key={contact.id}\r\n                  type=\"button\"\r\n                  onClick={() => toggleContact(contact.id)}\r\n                  className={`w-full p-4 rounded-xl border-2 transition-all text-left ${\r\n                    isSelected\r\n                      ? 'border-blue-500 bg-blue-50 dark:bg-blue-900/30'\r\n                      : 'border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500'\r\n                  }`}\r\n                >\r\n                  <div className=\"flex items-center gap-3\">\r\n                    {/* Profile Photo */}\r\n                    <div className=\"flex-shrink-0\">\r\n                      {contact.photoURL ? (\r\n                        <img\r\n                          src={contact.photoURL}\r\n                          alt={contact.name}\r\n                          className=\"w-12 h-12 rounded-full object-cover\"\r\n                        />\r\n                      ) : (\r\n                        <div className=\"w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold\">\r\n                          {contact.name?.charAt(0) || '?'}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* Contact Info */}\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"font-semibold text-text-primary truncate\">\r\n                        {contact.name}\r\n                      </div>\r\n                      <div className=\"text-sm text-text-secondary flex items-center gap-2\">\r\n                        <svg className=\"w-4 h-4 text-blue-500\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                          <path d=\"M12 2C6.477 2 2 6.145 2 11.235c0 2.894 1.447 5.48 3.71 7.155V22l3.477-1.906c.929.257 1.915.394 2.813.394 5.523 0 10-4.145 10-9.235C22 6.145 17.523 2 12 2zm.972 12.413l-2.562-2.732-5.002 2.732 5.502-5.838 2.623 2.732 4.941-2.732-5.502 5.838z\"/>\r\n                        </svg>\r\n                        <span>{timeRemaining}</span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Checkbox */}\r\n                    <div className=\"flex-shrink-0\">\r\n                      <div className={`w-6 h-6 rounded border-2 flex items-center justify-center ${\r\n                        isSelected\r\n                          ? 'bg-blue-500 border-blue-500'\r\n                          : 'border-gray-300 dark:border-gray-600'\r\n                      }`}>\r\n                        {isSelected && (\r\n                          <svg className=\"w-4 h-4 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={3} d=\"M5 13l4 4L19 7\" />\r\n                          </svg>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </button>\r\n              );\r\n            })}\r\n          </div>\r\n\r\n          {selectedContacts.length > 0 && (\r\n            <div className=\"text-sm text-center p-3 bg-green-50 dark:bg-green-900/30 rounded-lg text-text-secondary\">\r\n              âœ“ {selectedContacts.length} Messenger contact{selectedContacts.length > 1 ? 's' : ''} selected\r\n            </div>\r\n          )}\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MessengerContactSelector;\r\n","import React, { useRef } from 'react';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst NotesPhotosSection = ({\r\n  notes,\r\n  setNotes,\r\n  photoFiles,\r\n  setPhotoFiles,\r\n  photoPreviews,\r\n  setPhotoPreviews,\r\n  notesExpanded,\r\n  setNotesExpanded,\r\n  photosExpanded,\r\n  setPhotosExpanded\r\n}) => {\r\n  const fileInputRef = useRef(null);\r\n\r\n  const handlePhotoChange = (e) => {\r\n    const files = Array.from(e.target.files);\r\n    if (files.length === 0) return;\r\n\r\n    // Check if adding these files would exceed the 5 photo limit\r\n    if (photoFiles.length + files.length > 5) {\r\n      toast.error('You can only upload up to 5 photos per check-in');\r\n      return;\r\n    }\r\n\r\n    // Validate each file\r\n    for (const file of files) {\r\n      if (file.size > 5 * 1024 * 1024) {\r\n        toast.error(`${file.name} is too large. Photos must be less than 5MB`);\r\n        return;\r\n      }\r\n\r\n      if (!file.type.startsWith('image/')) {\r\n        toast.error(`${file.name} is not an image file`);\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Add files and previews\r\n    setPhotoFiles([...photoFiles, ...files]);\r\n    const newPreviews = files.map(file => URL.createObjectURL(file));\r\n    setPhotoPreviews([...photoPreviews, ...newPreviews]);\r\n\r\n    // Clear the file input\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = '';\r\n    }\r\n  };\r\n\r\n  const removePhoto = (index) => {\r\n    setPhotoFiles(photoFiles.filter((_, i) => i !== index));\r\n    setPhotoPreviews(photoPreviews.filter((_, i) => i !== index));\r\n  };\r\n\r\n  return (\r\n    <div className=\"card p-6\">\r\n      <label className=\"block text-lg font-display text-text-primary mb-3\">\r\n        Notes & Photos (Optional)\r\n      </label>\r\n\r\n      {/* Side-by-side buttons */}\r\n      <div className=\"grid grid-cols-2 gap-3 mb-4\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => {\r\n            setNotesExpanded(!notesExpanded);\r\n            if (!notesExpanded) setPhotosExpanded(false);\r\n          }}\r\n          className={`py-4 px-4 rounded-xl font-semibold transition-all border-2 ${\r\n            notesExpanded\r\n              ? 'bg-gradient-primary text-white border-primary shadow-lg scale-105'\r\n              : notes\r\n              ? 'bg-primary/10 border-primary text-primary'\r\n              : 'bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-text-primary hover:border-primary hover:bg-primary/5'\r\n          }`}\r\n        >\r\n          <div className=\"text-2xl mb-1\">ğŸ“</div>\r\n          <div className=\"text-sm\">Add Notes</div>\r\n          {notes && !notesExpanded && <div className=\"text-xs mt-1 opacity-75\">âœ“ Added</div>}\r\n        </button>\r\n\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => {\r\n            setPhotosExpanded(!photosExpanded);\r\n            if (!photosExpanded) setNotesExpanded(false);\r\n          }}\r\n          className={`py-4 px-4 rounded-xl font-semibold transition-all border-2 ${\r\n            photosExpanded\r\n              ? 'bg-gradient-primary text-white border-primary shadow-lg scale-105'\r\n              : photoFiles.length > 0\r\n              ? 'bg-primary/10 border-primary text-primary'\r\n              : 'bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-text-primary hover:border-primary hover:bg-primary/5'\r\n          }`}\r\n        >\r\n          <div className=\"text-2xl mb-1\">ğŸ“·</div>\r\n          <div className=\"text-sm\">Add Photos</div>\r\n          {photoFiles.length > 0 && !photosExpanded && (\r\n            <div className=\"text-xs mt-1 opacity-75\">âœ“ {photoFiles.length}/5</div>\r\n          )}\r\n        </button>\r\n      </div>\r\n\r\n      {/* Expandable Notes Section */}\r\n      {notesExpanded && (\r\n        <div className=\"mb-4 animate-fade-in\">\r\n          <textarea\r\n            value={notes}\r\n            onChange={(e) => setNotes(e.target.value)}\r\n            onKeyDown={(e) => {\r\n              // Mobile keyboard \"Done\" or \"Go\" button (Enter without shift)\r\n              if (e.key === 'Enter' && !e.shiftKey) {\r\n                e.preventDefault();\r\n                setNotesExpanded(false);\r\n                e.target.blur(); // Dismiss keyboard\r\n              }\r\n            }}\r\n            className=\"input min-h-[120px] resize-none\"\r\n            placeholder=\"Any additional info for your besties...\"\r\n            autoFocus\r\n          />\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => setNotesExpanded(false)}\r\n            className=\"mt-2 w-full btn btn-secondary text-sm py-2\"\r\n          >\r\n            Done\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Expandable Photos Section */}\r\n      {photosExpanded && (\r\n        <div className=\"animate-fade-in\">\r\n          <div className=\"text-sm font-semibold text-text-primary mb-2\">\r\n            Add Photos ({photoFiles.length}/5)\r\n          </div>\r\n\r\n          {/* Photo grid */}\r\n          {photoPreviews.length > 0 && (\r\n            <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3 mb-3\">\r\n              {photoPreviews.map((preview, index) => (\r\n                <div key={index} className=\"relative aspect-square\">\r\n                  <img\r\n                    src={preview}\r\n                    alt={`Preview ${index + 1}`}\r\n                    className=\"w-full h-full rounded-xl object-cover\"\r\n                  />\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => removePhoto(index)}\r\n                    className=\"absolute top-1 right-1 bg-red-500 text-white w-6 h-6 rounded-full text-sm font-bold hover:bg-red-600 flex items-center justify-center\"\r\n                  >\r\n                    âœ•\r\n                  </button>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n\r\n          {/* Add more photos button */}\r\n          {photoFiles.length < 5 && (\r\n            <div className=\"mb-3\">\r\n              <input\r\n                ref={fileInputRef}\r\n                type=\"file\"\r\n                accept=\"image/*\"\r\n                multiple\r\n                onChange={handlePhotoChange}\r\n                className=\"hidden\"\r\n                id=\"photo-input\"\r\n              />\r\n              <label\r\n                htmlFor=\"photo-input\"\r\n                className=\"block w-full p-8 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl text-center cursor-pointer hover:border-primary hover:bg-primary/5 transition-colors\"\r\n              >\r\n                <div className=\"text-4xl mb-2\">ğŸ“·</div>\r\n                <div className=\"text-sm text-text-secondary\">\r\n                  Click to add photos (up to 5, max 5MB each)\r\n                </div>\r\n              </label>\r\n            </div>\r\n          )}\r\n\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => setPhotosExpanded(false)}\r\n            className=\"w-full btn btn-secondary text-sm py-2\"\r\n          >\r\n            Done\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotesPhotosSection;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { db, storage } from '../services/firebase';\r\nimport { collection, query, where, getDocs, addDoc, getDoc, doc, Timestamp, onSnapshot } from 'firebase/firestore';\r\nimport { ref, uploadBytes, getDownloadURL } from 'firebase/storage';\r\nimport toast from 'react-hot-toast';\r\nimport errorTracker from '../services/errorTracking';\r\nimport useOptimisticUpdate from '../hooks/useOptimisticUpdate';\r\nimport CheckInLoader from '../components/checkin/CheckInLoader';\r\nimport CheckInMap from '../components/checkin/CheckInMap';\r\nimport MeetingInfoSection from '../components/checkin/MeetingInfoSection';\r\nimport DurationSelector from '../components/checkin/DurationSelector';\r\nimport BestieSelector from '../components/checkin/BestieSelector';\r\nimport MessengerContactSelector from '../components/checkin/MessengerContactSelector';\r\nimport NotesPhotosSection from '../components/checkin/NotesPhotosSection';\r\nimport { FEATURES } from '../config/features';\r\n\r\nconst CreateCheckInPage = () => {\r\n  const { currentUser, userData, loading: authLoading } = useAuth();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  const [locationInput, setLocationInput] = useState('');\r\n  const [duration, setDuration] = useState(30);\r\n  const [selectedBesties, setSelectedBesties] = useState([]);\r\n  const [notes, setNotes] = useState('');\r\n  const [meetingWith, setMeetingWith] = useState('');\r\n  const [socialMediaLinks, setSocialMediaLinks] = useState('');\r\n  const [photoFiles, setPhotoFiles] = useState([]);\r\n  const [photoPreviews, setPhotoPreviews] = useState([]);\r\n  const [besties, setBesties] = useState([]);\r\n  const [messengerContacts, setMessengerContacts] = useState([]);\r\n  const [selectedMessengerContacts, setSelectedMessengerContacts] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [showingLoader, setShowingLoader] = useState(false);\r\n  const [autocompleteLoaded, setAutocompleteLoaded] = useState(false);\r\n  const { executeOptimistic } = useOptimisticUpdate();\r\n  const [gpsCoords, setGpsCoords] = useState(null);\r\n  const [mapInitialized, setMapInitialized] = useState(false);\r\n  const [mapLocked, setMapLocked] = useState(true);\r\n  const [notesExpanded, setNotesExpanded] = useState(false);\r\n  const [photosExpanded, setPhotosExpanded] = useState(false);\r\n  const [shouldAutoSubmit, setShouldAutoSubmit] = useState(false);\r\n  const [showLocationDropdown, setShowLocationDropdown] = useState(false);\r\n  const [socialMediaExpanded, setSocialMediaExpanded] = useState(false);\r\n\r\n  // Auto-redirect to onboarding if user hasn't completed it\r\n  useEffect(() => {\r\n    if (authLoading) return;\r\n\r\n    if (userData && userData.onboardingCompleted === false) {\r\n      navigate('/onboarding');\r\n    }\r\n  }, [userData, authLoading, navigate]);\r\n\r\n  useEffect(() => {\r\n    errorTracker.trackFunnelStep('checkin', 'view_create_page');\r\n\r\n    // Load from quick button or template\r\n    if (location.state?.quickMinutes) {\r\n      errorTracker.trackFunnelStep('checkin', 'use_quick_button', { minutes: location.state.quickMinutes });\r\n      setDuration(location.state.quickMinutes);\r\n    }\r\n\r\n    // Load from new quick check-in types\r\n    if (location.state?.quickType) {\r\n      const { quickType, duration: quickDuration, rego, meetingWith: meetingWithParam, skipLocation } = location.state;\r\n\r\n      errorTracker.trackFunnelStep('checkin', `use_quick_${quickType}`, { duration: quickDuration });\r\n\r\n      if (quickDuration) {\r\n        setDuration(quickDuration);\r\n      }\r\n\r\n      // If skipLocation is true, set location and flag for auto-submit\r\n      if (skipLocation) {\r\n        setLocationInput('No location set');\r\n        setShouldAutoSubmit(true);\r\n      }\r\n\r\n      // Handle rideshare - add rego to notes\r\n      if (quickType === 'rideshare' && rego) {\r\n        setNotes(`ğŸš— Rideshare - Vehicle: ${rego}`);\r\n      }\r\n\r\n      // Handle quick meet - set meeting with\r\n      if (quickType === 'quickmeet' && meetingWithParam) {\r\n        setMeetingWith(meetingWithParam);\r\n      }\r\n\r\n      // Handle walking - add note\r\n      if (quickType === 'walking') {\r\n        setNotes('ğŸš¶â€â™€ï¸ Walking alone');\r\n      }\r\n    }\r\n\r\n    if (location.state?.template) {\r\n      errorTracker.trackFunnelStep('checkin', 'use_template');\r\n      const template = location.state.template;\r\n      setLocationInput(template.location || '');\r\n      setDuration(template.duration || 30);\r\n      setSelectedBesties(template.bestieIds || []);\r\n      setNotes(template.notes || '');\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [location.state]);\r\n\r\n  // Load besties when currentUser is available\r\n  useEffect(() => {\r\n    if (!currentUser || authLoading) return;\r\n\r\n    console.group('ğŸ” Setting up Bestie Circle Listener');\r\n\r\n    // Set up real-time listener for user's featuredCircle\r\n    const userDocRef = doc(db, 'users', currentUser.uid);\r\n    const unsubscribe = onSnapshot(userDocRef, async (userDoc) => {\r\n      try {\r\n        if (!userDoc.exists()) {\r\n          console.error('âŒ User document does not exist');\r\n          console.groupEnd();\r\n          setBesties([]);\r\n          return;\r\n        }\r\n\r\n        const userData = userDoc.data();\r\n        const featuredIds = userData.featuredCircle || [];\r\n\r\n        if (featuredIds.length === 0) {\r\n          console.warn('âš ï¸ featuredCircle is empty - no besties to load');\r\n          setBesties([]);\r\n          return;\r\n        }\r\n\r\n        // Get all accepted besties to find the ones in the circle\r\n        const [requesterQuery, recipientQuery] = await Promise.all([\r\n          getDocs(\r\n            query(\r\n              collection(db, 'besties'),\r\n              where('requesterId', '==', currentUser.uid),\r\n              where('status', '==', 'accepted')\r\n            )\r\n          ),\r\n          getDocs(\r\n            query(\r\n              collection(db, 'besties'),\r\n              where('recipientId', '==', currentUser.uid),\r\n              where('status', '==', 'accepted')\r\n            )\r\n          ),\r\n        ]);\r\n\r\n        const allBestiesList = [];\r\n\r\n        requesterQuery.forEach((doc) => {\r\n          const data = doc.data();\r\n          allBestiesList.push({\r\n            id: data.recipientId,\r\n            name: data.recipientName || 'Bestie',\r\n            phone: data.recipientPhone,\r\n            email: data.recipientEmail,\r\n          });\r\n        });\r\n\r\n        recipientQuery.forEach((doc) => {\r\n          const data = doc.data();\r\n          allBestiesList.push({\r\n            id: data.requesterId,\r\n            name: data.requesterName || 'Bestie',\r\n            phone: data.requesterPhone,\r\n            email: data.requesterEmail,\r\n          });\r\n        });\r\n\r\n        // Filter to only show besties in the featured circle\r\n        const circleBesties = allBestiesList.filter(b => featuredIds.includes(b.id));\r\n\r\n        // Fetch full user data for each bestie to get displayName, photoURL, requestAttention, and SMS settings\r\n        const bestiesWithUserData = await Promise.all(\r\n          circleBesties.map(async (bestie) => {\r\n            try {\r\n              const userDoc = await getDoc(doc(db, 'users', bestie.id));\r\n              if (userDoc.exists()) {\r\n                const userData = userDoc.data();\r\n                return {\r\n                  ...bestie,\r\n                  name: userData.displayName || bestie.name || bestie.email || 'Bestie',\r\n                  photoURL: userData.photoURL || null,\r\n                  email: userData.email || bestie.email,\r\n                  phone: userData.phoneNumber || bestie.phone,\r\n                  smsEnabled: userData.notificationPreferences?.sms || false,\r\n                  requestAttention: userData.requestAttention || null,\r\n                };\r\n              }\r\n              return bestie;\r\n            } catch (error) {\r\n              console.error(`Error fetching user data for ${bestie.id}:`, error);\r\n              return bestie;\r\n            }\r\n          })\r\n        );\r\n\r\n        setBesties(bestiesWithUserData);\r\n\r\n        // Auto-select besties who have any contact method (phone+SMS, telegram, or push)\r\n        // Allow messenger-only check-ins - no SMS requirement\r\n        if (!location.state?.template && bestiesWithUserData.length > 0) {\r\n          // Prefer besties with phone+SMS, but also include those with telegram or push\r\n          const bestiesWithContact = bestiesWithUserData.filter(b => \r\n            (b.phone && b.smsEnabled) || \r\n            b.telegramChatId || \r\n            b.notificationPreferences?.telegram ||\r\n            b.notificationPreferences?.push\r\n          );\r\n          setSelectedBesties(bestiesWithContact.map(b => b.id));\r\n\r\n          // Warn if some besties can't receive alerts\r\n          const cantReceiveAlerts = bestiesWithUserData.filter(b => !b.phone || !b.smsEnabled);\r\n          if (cantReceiveAlerts.length > 0) {\r\n            console.warn('âš ï¸ Some circle besties missing phone/SMS:', cantReceiveAlerts);\r\n            const missingPhone = cantReceiveAlerts.filter(b => !b.phone).length;\r\n            const missingSMS = cantReceiveAlerts.filter(b => b.phone && !b.smsEnabled).length;\r\n\r\n            let message = '';\r\n            if (missingPhone > 0 && missingSMS > 0) {\r\n              message = `${missingPhone} bestie(s) need to add their phone number and ${missingSMS} need to enable SMS alerts`;\r\n            } else if (missingPhone > 0) {\r\n              message = `${missingPhone} bestie(s) need to add their phone number`;\r\n            } else {\r\n              message = `${missingSMS} bestie(s) need to enable SMS alerts in Settings`;\r\n            }\r\n\r\n            toast(message, {\r\n              icon: 'â„¹ï¸',\r\n              duration: 5000\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading besties:', error);\r\n        toast.error('Failed to load besties');\r\n      }\r\n    }, (error) => {\r\n      console.error('Error in featuredCircle listener:', error);\r\n      toast.error('Failed to load besties');\r\n    });\r\n\r\n    console.groupEnd();\r\n\r\n    // Cleanup listener on unmount\r\n    return () => {\r\n      unsubscribe();\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [currentUser, authLoading]);\r\n\r\n  // Load Messenger contacts when currentUser is available\r\n  useEffect(() => {\r\n    if (!currentUser || authLoading || !FEATURES.messengerAlerts) return;\r\n\r\n    const messengerContactsRef = collection(db, 'messengerContacts');\r\n    const q = query(messengerContactsRef, where('userId', '==', currentUser.uid));\r\n\r\n    const unsubscribe = onSnapshot(q, (snapshot) => {\r\n      const contactsData = snapshot.docs.map(doc => ({\r\n        id: doc.id,\r\n        ...doc.data()\r\n      }));\r\n\r\n      // Filter out expired contacts\r\n      const now = Date.now();\r\n      const activeContacts = contactsData.filter(\r\n        contact => contact.expiresAt?.toMillis() > now\r\n      );\r\n\r\n      setMessengerContacts(activeContacts);\r\n    }, (error) => {\r\n      console.error('Error loading messenger contacts:', error);\r\n    });\r\n\r\n    return () => unsubscribe();\r\n  }, [currentUser, authLoading]);\r\n\r\n  // Auto-submit quick check-ins after besties are loaded\r\n  useEffect(() => {\r\n    if (shouldAutoSubmit && !loading) {\r\n      // Check if we have at least one contact method (regular besties OR messenger contacts)\r\n      const hasRegularBesties = selectedBesties.length > 0;\r\n      const hasMessengerContacts = selectedMessengerContacts.length > 0;\r\n      \r\n      if (hasRegularBesties || hasMessengerContacts) {\r\n        // Besties are loaded and auto-selected, now trigger submit IMMEDIATELY\r\n        console.log('Auto-submitting quick check-in with besties:', selectedBesties, 'messenger:', selectedMessengerContacts);\r\n\r\n        // Trigger submit immediately without delay\r\n        const submitBtn = document.querySelector('#create-checkin-submit-btn');\r\n        if (submitBtn && !submitBtn.disabled) {\r\n          console.log('Clicking submit button');\r\n          submitBtn.click();\r\n          setShouldAutoSubmit(false); // Reset flag\r\n        } else {\r\n          console.warn('Submit button not ready:', { submitBtn, disabled: submitBtn?.disabled });\r\n        }\r\n      } else {\r\n        // No besties or messenger contacts available - show error and stop auto-submit\r\n        console.warn('No besties or messenger contacts available for quick check-in');\r\n        toast.error('You need at least one bestie or messenger contact to create a check-in. Please add besties first.', {\r\n          duration: 6000\r\n        });\r\n        setShouldAutoSubmit(false);\r\n        // Navigate back to home\r\n        setTimeout(() => {\r\n          navigate('/');\r\n        }, 2000);\r\n      }\r\n    }\r\n  }, [shouldAutoSubmit, selectedBesties, selectedMessengerContacts, loading, navigate]);\r\n\r\n  // Load Google Places API\r\n  useEffect(() => {\r\n    const apiKey = process.env.REACT_APP_GOOGLE_MAPS_API_KEY;\r\n\r\n    if (!apiKey) {\r\n      console.warn('Google Maps API key not configured');\r\n      toast.error('Address autocomplete is not available. Please type your location manually.', {\r\n        duration: 5000,\r\n        id: 'maps-api-missing'\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Check if Google Maps is already loaded\r\n    const checkGoogleLoaded = () => {\r\n      if (window.google && window.google.maps && window.google.maps.places) {\r\n        setAutocompleteLoaded(true);\r\n        return true;\r\n      }\r\n      return false;\r\n    };\r\n\r\n    // If already loaded, set state immediately\r\n    if (checkGoogleLoaded()) {\r\n      return;\r\n    }\r\n\r\n    // Check if script is already being loaded\r\n    const existingScript = document.querySelector('script[src*=\"maps.googleapis.com\"]');\r\n    if (existingScript) {\r\n      // Script exists, wait for it to load with timeout\r\n      let attempts = 0;\r\n      const maxAttempts = 100; // 10 seconds timeout\r\n      const interval = setInterval(() => {\r\n        attempts++;\r\n        if (checkGoogleLoaded()) {\r\n          clearInterval(interval);\r\n        } else if (attempts >= maxAttempts) {\r\n          clearInterval(interval);\r\n          console.error('Google Maps API loading timeout');\r\n          toast.error('Map is taking too long to load. Please refresh the page.', {\r\n            duration: 5000,\r\n            id: 'maps-timeout'\r\n          });\r\n        }\r\n      }, 100);\r\n\r\n      return () => clearInterval(interval);\r\n    }\r\n\r\n    // Load script with loading=async\r\n    const script = document.createElement('script');\r\n    script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&libraries=places&loading=async`;\r\n    script.async = true;\r\n    script.defer = true;\r\n\r\n    // Add timeout for script loading\r\n    const loadTimeout = setTimeout(() => {\r\n      if (!checkGoogleLoaded()) {\r\n        console.error('Google Maps API script load timeout');\r\n        toast.error('Map failed to load. Please check your internet connection and refresh.', {\r\n          duration: 5000,\r\n          id: 'maps-load-timeout'\r\n        });\r\n      }\r\n    }, 15000); // 15 second timeout\r\n\r\n    let checkInterval = null;\r\n    let readyTimeout = null;\r\n\r\n    script.onload = () => {\r\n      clearTimeout(loadTimeout);\r\n      // Double check that the API is fully loaded\r\n      checkInterval = setInterval(() => {\r\n        if (checkGoogleLoaded()) {\r\n          if (checkInterval) {\r\n            clearInterval(checkInterval);\r\n            checkInterval = null;\r\n          }\r\n        }\r\n      }, 100);\r\n\r\n      // Set a short timeout to ensure API is ready\r\n      readyTimeout = setTimeout(() => {\r\n        if (checkGoogleLoaded()) {\r\n          console.log('Google Maps API loaded successfully');\r\n        }\r\n      }, 500);\r\n    };\r\n\r\n    script.onerror = (error) => {\r\n      clearTimeout(loadTimeout);\r\n      console.error('Failed to load Google Maps API:', error);\r\n      toast.error('Failed to load address autocomplete. Please refresh the page.', {\r\n        duration: 5000,\r\n        id: 'maps-error'\r\n      });\r\n    };\r\n\r\n    document.head.appendChild(script);\r\n\r\n    // Cleanup timeouts and intervals on unmount\r\n    return () => {\r\n      clearTimeout(loadTimeout);\r\n      if (checkInterval) {\r\n        clearInterval(checkInterval);\r\n      }\r\n      if (readyTimeout) {\r\n        clearTimeout(readyTimeout);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    // Check if at least one contact method is selected (either regular bestie OR messenger contact)\r\n    const hasRegularBesties = selectedBesties.length > 0;\r\n    const hasMessengerContacts = selectedMessengerContacts.length > 0;\r\n    \r\n    if (!hasRegularBesties && !hasMessengerContacts) {\r\n      errorTracker.trackFunnelStep('checkin', 'error_no_besties');\r\n      toast.error('Please select at least one bestie or messenger contact to notify', { duration: 4000 });\r\n      return;\r\n    }\r\n\r\n    // For regular besties, check if they have contact methods (phone+SMS, telegram, or push)\r\n    // But allow check-in even if they only have messenger contacts\r\n    if (hasRegularBesties) {\r\n      const bestiesWithoutContact = selectedBesties.filter(bestieId => {\r\n        const bestie = besties.find(b => b.id === bestieId);\r\n        // Check if bestie has any contact method\r\n        return !bestie?.phone && !bestie?.telegramChatId && !bestie?.notificationPreferences?.telegram && !bestie?.notificationPreferences?.push;\r\n      }).map(bestieId => {\r\n        const bestie = besties.find(b => b.id === bestieId);\r\n        return bestie?.name || 'Unknown';\r\n      });\r\n\r\n      if (bestiesWithoutContact.length > 0) {\r\n        toast.error(`These besties need to enable notifications: ${bestiesWithoutContact.join(', ')}`, {\r\n          duration: 6000\r\n        });\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Location is only required for custom check-ins (not quick check-ins)\r\n    const isQuickCheckIn = location.state?.skipLocation || location.state?.quickType;\r\n    if (!isQuickCheckIn && !locationInput.trim()) {\r\n      errorTracker.trackFunnelStep('checkin', 'error_no_location');\r\n      toast.error('Please enter a location');\r\n      return;\r\n    }\r\n\r\n    if (duration < 10 || duration > 180) {\r\n      toast.error('Duration must be between 10 and 180 minutes');\r\n      return;\r\n    }\r\n\r\n    errorTracker.trackFunnelStep('checkin', 'submit_checkin', {\r\n      besties: selectedBesties.length,\r\n      duration,\r\n      hasNotes: !!notes,\r\n    });\r\n\r\n    // Show cute loader immediately\r\n    setShowingLoader(true);\r\n\r\n    // Use optimistic update - show loader and process in background\r\n    await executeOptimistic({\r\n      optimisticUpdate: () => {\r\n        // Loader is already showing - no immediate navigation\r\n      },\r\n      serverUpdate: async () => {\r\n        setLoading(true);\r\n        try {\r\n          const now = new Date();\r\n          const alertTime = new Date(now.getTime() + duration * 60 * 1000);\r\n\r\n          // Upload photos if provided\r\n          const photoURLs = [];\r\n          if (photoFiles.length > 0) {\r\n            for (let i = 0; i < photoFiles.length; i++) {\r\n              const file = photoFiles[i];\r\n              try {\r\n                const storageRef = ref(storage, `checkin-photos/${currentUser.uid}/${Date.now()}_${i}_${file.name}`);\r\n                await uploadBytes(storageRef, file);\r\n                const downloadURL = await getDownloadURL(storageRef);\r\n\r\n                if (downloadURL) {\r\n                  photoURLs.push(downloadURL);\r\n                } else {\r\n                  console.warn(`Failed to get download URL for photo ${i}`);\r\n                }\r\n              } catch (photoError) {\r\n                console.error(`Error uploading photo ${i}:`, photoError);\r\n              }\r\n            }\r\n          }\r\n\r\n          // Filter out any undefined/null/empty values before saving\r\n          const validPhotoURLs = photoURLs.filter(url => url && url.trim() !== '');\r\n\r\n          // Get current privacy setting and circle snapshot\r\n          const privacyLevel = userData?.privacySettings?.checkInVisibility || 'all_besties';\r\n          const circleSnapshot = userData?.featuredCircle || [];\r\n\r\n          const checkInData = {\r\n            userId: currentUser.uid,\r\n            location: locationInput,\r\n            gpsCoords: gpsCoords || null,\r\n            duration: duration,\r\n            alertTime: Timestamp.fromDate(alertTime),\r\n            bestieIds: selectedBesties,\r\n            notes: notes || null,\r\n            meetingWith: meetingWith || null,\r\n            socialMediaLinks: socialMediaLinks || null,\r\n            status: 'active',\r\n            privacyLevel: privacyLevel,\r\n            circleSnapshot: circleSnapshot,\r\n            createdAt: Timestamp.now(),\r\n            lastUpdate: Timestamp.now(),\r\n          };\r\n\r\n          // Add Messenger contact IDs if any are selected\r\n          if (selectedMessengerContacts.length > 0) {\r\n            checkInData.messengerContactIds = selectedMessengerContacts;\r\n          }\r\n\r\n          // Only add photoURLs field if there are valid photos\r\n          if (validPhotoURLs.length > 0) {\r\n            checkInData.photoURLs = validPhotoURLs;\r\n          }\r\n\r\n          // Add document and get reference\r\n          const docRef = await addDoc(collection(db, 'checkins'), checkInData);\r\n\r\n          // Track analytics\r\n          const { logAnalyticsEvent } = require('../services/firebase');\r\n          logAnalyticsEvent('checkin_created', {\r\n            duration: duration,\r\n            besties_count: selectedBesties.length,\r\n            messenger_contacts_count: selectedMessengerContacts.length,\r\n            has_photos: validPhotoURLs.length > 0,\r\n            has_notes: !!notes\r\n          });\r\n\r\n          // Verify the document was created by reading it back\r\n          const docSnap = await getDoc(doc(db, 'checkins', docRef.id));\r\n\r\n          if (!docSnap.exists()) {\r\n            throw new Error('Check-in was not saved properly. Please try again.');\r\n          }\r\n\r\n          // Verify critical data\r\n          const savedData = docSnap.data();\r\n          if (savedData.userId !== currentUser.uid || savedData.status !== 'active') {\r\n            throw new Error('Check-in data verification failed. Please try again.');\r\n          }\r\n\r\n          // Verify besties were saved correctly\r\n          if (!savedData.bestieIds || savedData.bestieIds.length !== selectedBesties.length) {\r\n            throw new Error('Bestie list was not saved correctly. Please try again.');\r\n          }\r\n\r\n          // Verify all bestie IDs match exactly\r\n          const bestiesMatch = selectedBesties.every(id => savedData.bestieIds.includes(id));\r\n          if (!bestiesMatch) {\r\n            throw new Error('Bestie list verification failed. Please try again.');\r\n          }\r\n\r\n          errorTracker.trackFunnelStep('checkin', 'complete_checkin');\r\n\r\n          // Track emergency contact selections for each bestie\r\n          try {\r\n            const { incrementEmergencyContactCount } = await import('../services/interactionTracking');\r\n            selectedBesties.forEach(bestieId => {\r\n              incrementEmergencyContactCount(bestieId);\r\n            });\r\n          } catch (trackingError) {\r\n            console.error('Failed to track emergency contact selections:', trackingError);\r\n          }\r\n\r\n          // Navigate after successful creation\r\n          setTimeout(() => {\r\n            navigate('/');\r\n          }, 1000); // Small delay to show success message\r\n\r\n          return docRef;\r\n        } finally {\r\n          setLoading(false);\r\n        }\r\n      },\r\n      rollback: () => {\r\n        // Hide loader and stay on page on error\r\n        setShowingLoader(false);\r\n      },\r\n      onError: (error) => {\r\n        console.error('Error creating check-in:', error);\r\n        errorTracker.logCustomError('Failed to create check-in', { error: error.message });\r\n        setShowingLoader(false);\r\n      },\r\n      successMessage: 'Check-in created! Stay safe! ğŸ’œ',\r\n      errorMessage: 'Failed to create check-in. Please try creating it again.',\r\n      showLoadingToast: false,\r\n      loadingMessage: 'Creating your check-in...'\r\n    });\r\n  };\r\n\r\n  // Show loader while creating check-in\r\n  if (showingLoader) {\r\n    return <CheckInLoader />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-pattern\">\r\n      <div className={`max-w-2xl mx-auto p-4 pb-20 ${shouldAutoSubmit ? 'opacity-0 pointer-events-none' : ''}`}>\r\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n          {/* Location with Map */}\r\n          <CheckInMap\r\n            locationInput={locationInput}\r\n            setLocationInput={setLocationInput}\r\n            gpsCoords={gpsCoords}\r\n            setGpsCoords={setGpsCoords}\r\n            mapInitialized={mapInitialized}\r\n            setMapInitialized={setMapInitialized}\r\n            mapLocked={mapLocked}\r\n            setMapLocked={setMapLocked}\r\n            autocompleteLoaded={autocompleteLoaded}\r\n            showLocationDropdown={showLocationDropdown}\r\n            setShowLocationDropdown={setShowLocationDropdown}\r\n            loading={loading}\r\n            setLoading={setLoading}\r\n          />\r\n\r\n          {/* Who Meeting & Duration Combined */}\r\n          <div className=\"card p-6\">\r\n            <MeetingInfoSection\r\n              meetingWith={meetingWith}\r\n              setMeetingWith={setMeetingWith}\r\n              socialMediaLinks={socialMediaLinks}\r\n              setSocialMediaLinks={setSocialMediaLinks}\r\n              socialMediaExpanded={socialMediaExpanded}\r\n              setSocialMediaExpanded={setSocialMediaExpanded}\r\n            />\r\n\r\n            <DurationSelector\r\n              duration={duration}\r\n              setDuration={setDuration}\r\n            />\r\n          </div>\r\n\r\n          {/* Who Should We Alert - Combined Section */}\r\n          <BestieSelector\r\n            besties={besties}\r\n            selectedBesties={selectedBesties}\r\n            setSelectedBesties={setSelectedBesties}\r\n            messengerContacts={messengerContacts}\r\n            selectedMessengerContacts={selectedMessengerContacts}\r\n            setSelectedMessengerContacts={setSelectedMessengerContacts}\r\n            userId={currentUser?.uid}\r\n            showMessenger={FEATURES.messengerAlerts}\r\n          />\r\n\r\n          {/* Notes and Photos */}\r\n          <NotesPhotosSection\r\n            notes={notes}\r\n            setNotes={setNotes}\r\n            photoFiles={photoFiles}\r\n            setPhotoFiles={setPhotoFiles}\r\n            photoPreviews={photoPreviews}\r\n            setPhotoPreviews={setPhotoPreviews}\r\n            notesExpanded={notesExpanded}\r\n            setNotesExpanded={setNotesExpanded}\r\n            photosExpanded={photosExpanded}\r\n            setPhotosExpanded={setPhotosExpanded}\r\n          />\r\n\r\n          {/* Submit */}\r\n          <button\r\n            type=\"submit\"\r\n            id=\"create-checkin-submit-btn\"\r\n            disabled={loading || selectedBesties.length === 0}\r\n            className=\"w-full btn btn-primary text-lg py-4\"\r\n          >\r\n            {loading ? 'Creating...' : 'ğŸ›¡ï¸ Start Check-In'}\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CreateCheckInPage;\r\n"],"names":["FEATURES","core","auth","checkIns","besties","templates","quickButtons","celebrationMessages","gpsLocation","manualLocation","extendButtons","bestieCircle","badges","shareableCards","mediaUpload","photoCapture","donations","smsSubscription","messengerAlerts","telegramAlerts","emergency","reversePin","liveTracking","videoRecording","facebookLogin","phoneAuth","isEnabled","feature","MESSENGER_CONFIG","pageUsername","getLinkForUser","userId","concat","contactExpiryHours","contactExpiryMs","CheckInLoader","messages","message","useState","Math","floor","random","length","_jsxs","_Fragment","children","className","_jsx","Array","map","_","i","style","left","top","animationDelay","animationDuration","opacity","_ref","locationInput","setLocationInput","gpsCoords","setGpsCoords","mapInitialized","setMapInitialized","mapLocked","setMapLocked","autocompleteLoaded","showLocationDropdown","setShowLocationDropdown","loading","setLoading","locationInputRef","useRef","autocompleteRef","mapRef","mapInstanceRef","useEffect","current","window","google","maps","Map","console","log","center","lat","lng","zoom","disableDefaultUI","zoomControl","mapTypeControl","streetViewControl","fullscreenControl","draggable","gestureHandling","addListener","event","setOptions","toast","success","duration","mapCenter","getCenter","coords","Geocoder","geocode","location","results","status","address","formatted_address","coordsString","toFixed","icon","background","color","fontWeight","error","id","warn","places","Autocomplete","types","fields","place","getPlace","displayLocation","name","geometry","setCenter","setZoom","clearInstanceListeners","handleGetLocation","navigator","geolocation","watchId","watchPosition","position","latitude","longitude","accuracy","clearWatch","getCurrentPosition","betterPosition","betterLat","betterLng","betterAccuracy","dismiss","round","enableHighAccuracy","timeout","maximumAge","fallbackError","setTimeout","ref","minHeight","type","value","onChange","e","target","onFocus","onBlur","placeholder","required","autoComplete","onClick","fill","stroke","viewBox","cx","cy","r","strokeWidth","strokeLinecap","strokeLinejoin","d","disabled","title","meetingWith","setMeetingWith","socialMediaLinks","setSocialMediaLinks","socialMediaExpanded","setSocialMediaExpanded","autoFocus","setDuration","mins","min","max","step","parseInt","Date","now","toLocaleTimeString","hour","minute","hour12","bestieName","onClose","handleShareToAddPhone","platform","origin","encoded","encodeURIComponent","isMobile","test","userAgent","href","open","clipboard","writeText","then","catch","textEncoded","urlEncoded","selectedBesties","setSelectedBesties","messengerContacts","selectedMessengerContacts","setSelectedMessengerContacts","showMessenger","navigate","useNavigate","expandedBestieShare","setExpandedBestieShare","copied","setCopied","activeMessengerContacts","filter","contact","_contact$expiresAt","expiresAt","toMillis","newSelections","c","includes","_contact$name","isSelected","timeRemaining","remaining","hours","minutes","getTimeRemaining","toggleMessengerContact","contactId","photoURL","src","alt","charAt","copyMessengerLink","link","bestie","selectionIndex","indexOf","selectionNumber","isShareExpanded","canSelect","_bestie$notificationP","_bestie$notificationP2","phone","smsEnabled","telegramChatId","notificationPreferences","telegram","push","hasContactMethod","bestieId","toggleBestie","ProfileWithBubble","email","requestAttention","size","showBubble","stopPropagation","SharePromptButtons","notes","setNotes","photoFiles","setPhotoFiles","photoPreviews","setPhotoPreviews","notesExpanded","setNotesExpanded","photosExpanded","setPhotosExpanded","fileInputRef","onKeyDown","key","shiftKey","preventDefault","blur","preview","index","removePhoto","accept","multiple","files","from","file","startsWith","newPreviews","URL","createObjectURL","htmlFor","CreateCheckInPage","currentUser","userData","authLoading","useAuth","useLocation","setBesties","setMessengerContacts","showingLoader","setShowingLoader","setAutocompleteLoaded","executeOptimistic","useOptimisticUpdate","shouldAutoSubmit","setShouldAutoSubmit","onboardingCompleted","_location$state","_location$state2","_location$state3","errorTracker","trackFunnelStep","state","quickMinutes","quickType","quickDuration","rego","meetingWithParam","skipLocation","template","bestieIds","group","userDocRef","doc","db","uid","unsubscribe","onSnapshot","async","_location$state4","userDoc","exists","groupEnd","featuredIds","data","featuredCircle","requesterQuery","recipientQuery","Promise","all","getDocs","query","collection","where","allBestiesList","forEach","recipientId","recipientName","recipientPhone","recipientEmail","requesterId","requesterName","requesterPhone","requesterEmail","circleBesties","b","bestiesWithUserData","getDoc","_userData$notificatio","_objectSpread","displayName","phoneNumber","sms","bestiesWithContact","_b$notificationPrefer","_b$notificationPrefer2","cantReceiveAlerts","missingPhone","missingSMS","messengerContactsRef","q","snapshot","contactsData","docs","activeContacts","hasRegularBesties","hasMessengerContacts","submitBtn","document","querySelector","click","apiKey","process","checkGoogleLoaded","attempts","maxAttempts","interval","setInterval","clearInterval","script","createElement","defer","loadTimeout","checkInterval","readyTimeout","onload","clearTimeout","onerror","head","appendChild","onSubmit","_location$state5","_location$state6","bestiesWithoutContact","find","join","trim","hasNotes","optimisticUpdate","serverUpdate","_userData$privacySett","alertTime","getTime","photoURLs","storageRef","storage","uploadBytes","downloadURL","getDownloadURL","photoError","validPhotoURLs","url","privacyLevel","privacySettings","checkInVisibility","circleSnapshot","checkInData","Timestamp","fromDate","createdAt","lastUpdate","messengerContactIds","docRef","addDoc","logAnalyticsEvent","require","besties_count","messenger_contacts_count","has_photos","has_notes","docSnap","Error","savedData","every","incrementEmergencyContactCount","trackingError","rollback","onError","logCustomError","successMessage","errorMessage","showLoadingToast","loadingMessage","CheckInMap","MeetingInfoSection","DurationSelector","BestieSelector","NotesPhotosSection"],"sourceRoot":""}