"use strict";(self.webpackChunkbesties_frontend=self.webpackChunkbesties_frontend||[]).push([[619],{1619:(e,s,t)=>{t.r(s),t.d(s,{default:()=>i});var a=t(2555),r=t(5043),c=t(7400),l=t(5472),n=t(559),d=t(579);const i=()=>{const[e,s]=(0,r.useState)("24h"),[t,i]=(0,r.useState)([]),[x,m]=(0,r.useState)([]),[o,h]=(0,r.useState)([]),[p,j]=(0,r.useState)({}),[u,y]=(0,r.useState)(!0);(0,r.useEffect)(()=>{N()},[e]);const N=async()=>{y(!0);try{const s=l.Dc.fromDate((()=>{const s=new Date;switch(e){case"1h":return new Date(s.getTime()-36e5);case"24h":default:return new Date(s.getTime()-864e5);case"7d":return new Date(s.getTime()-6048e5)}})()),t=(0,l.P)((0,l.rJ)(c.db,"errors"),(0,l._M)("createdAt",">=",s),(0,l.My)("createdAt","desc"),(0,l.AB)(50)),r=await(0,l.GG)(t),n=[];r.forEach(e=>n.push((0,a.A)({id:e.id},e.data()))),i(n);const d=(0,l.P)((0,l.rJ)(c.db,"performance"),(0,l._M)("createdAt",">=",s),(0,l.My)("createdAt","desc"),(0,l.AB)(100)),x=await(0,l.GG)(d),o=[];x.forEach(e=>o.push((0,a.A)({id:e.id},e.data()))),m(o);const p=(0,l.P)((0,l.rJ)(c.db,"user_actions"),(0,l._M)("createdAt",">=",s),(0,l.My)("createdAt","desc"),(0,l.AB)(200)),u=await(0,l.GG)(p),N=[];u.forEach(e=>N.push((0,a.A)({id:e.id},e.data()))),h(N);const v=(0,l.P)((0,l.rJ)(c.db,"funnel_events"),(0,l._M)("createdAt",">=",s),(0,l.My)("createdAt","desc")),b=await(0,l.GG)(v),g={};b.forEach(e=>{const s=e.data();g[s.funnel]||(g[s.funnel]={}),g[s.funnel][s.step]||(g[s.funnel][s.step]=0),g[s.funnel][s.step]++}),j(g),y(!1)}catch(s){console.error("Error loading monitoring data:",s),y(!1)}},v=(t.length/Math.max(o.length,1)*100).toFixed(2),b=x.filter(e=>"page_load"===e.type),g=b.length>0?(b.reduce((e,s)=>{var t;return e+((null===(t=s.metrics)||void 0===t?void 0:t.total)||0)},0)/b.length).toFixed(0):0,f=t.reduce((e,s)=>(e[s.type]=(e[s.type]||0)+1,e),{}),w=o.filter(e=>"page_view"===e.action),A=w.reduce((e,s)=>{var t;const a=(null===(t=s.details)||void 0===t?void 0:t.page)||"unknown";return e[a]=(e[a]||0)+1,e},{}),k=Object.entries(A).sort((e,s)=>s[1]-e[1]).slice(0,10);return u?(0,d.jsxs)("div",{className:"min-h-screen bg-pattern",children:[(0,d.jsx)(n.A,{}),(0,d.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,d.jsx)("div",{className:"spinner"})})]}):(0,d.jsxs)("div",{className:"min-h-screen bg-pattern",children:[(0,d.jsx)(n.A,{}),(0,d.jsxs)("div",{className:"max-w-7xl mx-auto p-4 pb-20",children:[(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsx)("h1",{className:"text-3xl font-display text-text-primary mb-2",children:"\ud83d\udd0d Monitoring Dashboard"}),(0,d.jsx)("p",{className:"text-text-secondary",children:"Real-time errors, performance & user behavior"})]}),(0,d.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,d.jsx)("button",{onClick:()=>s("1h"),className:"px-4 py-2 rounded-full font-semibold ".concat("1h"===e?"bg-primary text-white":"bg-white text-text-primary"),children:"Last Hour"}),(0,d.jsx)("button",{onClick:()=>s("24h"),className:"px-4 py-2 rounded-full font-semibold ".concat("24h"===e?"bg-primary text-white":"bg-white text-text-primary"),children:"Last 24h"}),(0,d.jsx)("button",{onClick:()=>s("7d"),className:"px-4 py-2 rounded-full font-semibold ".concat("7d"===e?"bg-primary text-white":"bg-white text-text-primary"),children:"Last 7 Days"})]}),(0,d.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,d.jsxs)("div",{className:"card p-4 text-center",children:[(0,d.jsx)("div",{className:"text-3xl font-display ".concat(t.length>0?"text-danger":"text-success"),children:t.length}),(0,d.jsx)("div",{className:"text-sm text-text-secondary",children:"Total Errors"})]}),(0,d.jsxs)("div",{className:"card p-4 text-center",children:[(0,d.jsxs)("div",{className:"text-3xl font-display text-warning",children:[v,"%"]}),(0,d.jsx)("div",{className:"text-sm text-text-secondary",children:"Error Rate"})]}),(0,d.jsxs)("div",{className:"card p-4 text-center",children:[(0,d.jsxs)("div",{className:"text-3xl font-display text-primary",children:[g,"ms"]}),(0,d.jsx)("div",{className:"text-sm text-text-secondary",children:"Avg Page Load"})]}),(0,d.jsxs)("div",{className:"card p-4 text-center",children:[(0,d.jsx)("div",{className:"text-3xl font-display text-secondary",children:o.length}),(0,d.jsx)("div",{className:"text-sm text-text-secondary",children:"User Actions"})]})]}),(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsxs)("h2",{className:"text-2xl font-display text-text-primary mb-4",children:["\ud83d\udc1b Recent Errors (",t.length,")"]}),0===t.length?(0,d.jsxs)("div",{className:"card p-8 text-center",children:[(0,d.jsx)("div",{className:"text-4xl mb-2",children:"\u2705"}),(0,d.jsx)("p",{className:"text-text-secondary",children:"No errors! Everything is working perfectly!"})]}):(0,d.jsx)("div",{className:"space-y-3",children:t.slice(0,10).map(e=>(0,d.jsxs)("div",{className:"card p-4 border-l-4 border-danger",children:[(0,d.jsx)("div",{className:"flex items-start justify-between mb-2",children:(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,d.jsx)("span",{className:"badge badge-danger",children:e.type}),(0,d.jsx)("span",{className:"text-sm text-text-secondary",children:e.createdAt&&new Date(e.createdAt.toDate()).toLocaleString()})]}),(0,d.jsx)("div",{className:"font-semibold text-text-primary mb-1",children:e.message}),(0,d.jsx)("div",{className:"text-sm text-text-secondary mb-2",children:e.url}),e.userId&&(0,d.jsxs)("div",{className:"text-xs text-text-secondary",children:["User: ",e.userId]})]})}),e.stack&&(0,d.jsxs)("details",{className:"text-xs text-text-secondary mt-2",children:[(0,d.jsx)("summary",{className:"cursor-pointer",children:"Stack Trace"}),(0,d.jsx)("pre",{className:"mt-2 p-2 bg-gray-50 rounded overflow-auto max-h-40",children:e.stack})]})]},e.id))})]}),Object.keys(f).length>0&&(0,d.jsxs)("div",{className:"card p-6 mb-6",children:[(0,d.jsx)("h3",{className:"font-display text-lg text-text-primary mb-4",children:"Error Types Breakdown"}),(0,d.jsx)("div",{className:"space-y-2",children:Object.entries(f).map(e=>{let[s,a]=e;return(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-text-primary",children:s}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"h-2 bg-danger/20 rounded-full",style:{width:"".concat(a/t.length*200,"px")},children:(0,d.jsx)("div",{className:"h-full bg-danger rounded-full",style:{width:"100%"}})}),(0,d.jsx)("span",{className:"text-text-secondary text-sm w-8 text-right",children:a})]})]},s)})})]}),(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsx)("h2",{className:"text-2xl font-display text-text-primary mb-4",children:"\u26a1 Performance Issues"}),0===x.filter(e=>"slow_resource"===e.type).length?(0,d.jsxs)("div",{className:"card p-8 text-center",children:[(0,d.jsx)("div",{className:"text-4xl mb-2",children:"\ud83d\ude80"}),(0,d.jsx)("p",{className:"text-text-secondary",children:"No slow resources detected!"})]}):(0,d.jsx)("div",{className:"card p-6",children:(0,d.jsx)("div",{className:"space-y-2",children:x.filter(e=>"slow_resource"===e.type).slice(0,10).map((e,s)=>(0,d.jsxs)("div",{className:"flex items-center justify-between p-3 bg-warning/10 rounded-lg",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("div",{className:"text-sm font-semibold text-text-primary truncate",children:e.name}),(0,d.jsx)("div",{className:"text-xs text-text-secondary",children:e.createdAt&&new Date(e.createdAt.toDate()).toLocaleString()})]}),(0,d.jsxs)("div",{className:"text-warning font-semibold ml-4",children:[Math.round(e.duration),"ms"]})]},s))})})]}),b.length>0&&(0,d.jsxs)("div",{className:"card p-6 mb-6",children:[(0,d.jsx)("h3",{className:"font-display text-lg text-text-primary mb-4",children:"Page Load Breakdown (avg)"}),(0,d.jsx)("div",{className:"space-y-2",children:["dns","tcp","request","response","dom","load"].map(e=>{const s=b.reduce((s,t)=>{var a;return s+((null===(a=t.metrics)||void 0===a?void 0:a[e])||0)},0)/b.length;return(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-text-primary capitalize",children:e}),(0,d.jsxs)("span",{className:"text-text-secondary",children:[Math.round(s),"ms"]})]},e)})})]}),(0,d.jsxs)("div",{className:"card p-6 mb-6",children:[(0,d.jsx)("h3",{className:"font-display text-lg text-text-primary mb-4",children:"\ud83d\udcca Top Pages"}),(0,d.jsx)("div",{className:"space-y-2",children:k.map(e=>{let[s,t]=e;return(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-text-primary",children:s}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"h-2 bg-primary/20 rounded-full",style:{width:"".concat(t/w.length*200,"px")},children:(0,d.jsx)("div",{className:"h-full bg-primary rounded-full",style:{width:"100%"}})}),(0,d.jsxs)("span",{className:"text-text-secondary text-sm w-12 text-right",children:[t," views"]})]})]},s)})})]}),Object.keys(p).length>0&&(0,d.jsxs)("div",{className:"card p-6 mb-6",children:[(0,d.jsx)("h3",{className:"font-display text-lg text-text-primary mb-4",children:"\ud83c\udfaf Conversion Funnels"}),Object.entries(p).map(e=>{let[s,t]=e;const a=Object.entries(t).sort(),r=Math.max(...Object.values(t));return(0,d.jsxs)("div",{className:"mb-6 last:mb-0",children:[(0,d.jsxs)("div",{className:"font-semibold text-text-primary mb-3 capitalize",children:[s.replace(/_/g," ")," Funnel"]}),(0,d.jsx)("div",{className:"space-y-2",children:a.map((e,s)=>{let[t,c]=e;const l=0===s?100:(c/a[0][1]*100).toFixed(1),n=s>0?((a[s-1][1]-c)/a[s-1][1]*100).toFixed(1):0;return(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,d.jsx)("span",{className:"text-text-primary capitalize",children:t.replace(/_/g," ")}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsxs)("span",{className:"text-text-secondary text-sm",children:[c," users"]}),(0,d.jsxs)("span",{className:"text-text-secondary text-sm",children:["(",l,"%)"]}),n>0&&(0,d.jsxs)("span",{className:"text-danger text-sm",children:["-",n,"%"]})]})]}),(0,d.jsx)("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden",children:(0,d.jsx)("div",{className:"h-full ".concat(n>20?"bg-danger":"bg-primary"),style:{width:"".concat(c/r*100,"%")}})})]},t)})})]},s)})]}),(0,d.jsx)("button",{onClick:N,className:"w-full btn btn-primary",disabled:u,children:"\ud83d\udd04 Refresh Data"})]})]})}}}]);
//# sourceMappingURL=619.b66c1b81.chunk.js.map