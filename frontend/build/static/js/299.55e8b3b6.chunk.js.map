{"version":3,"file":"static/js/299.55e8b3b6.chunk.js","mappings":"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","sources":["config/features.js","pages/CreateCheckInPage.jsx"],"sourcesContent":["// Feature flags - enable/disable features without code changes\nexport const FEATURES = {\n  // Core (always on)\n  core: true,\n  auth: true,\n  checkIns: true,\n  besties: true,\n  \n  // MVP Launch (enabled)\n  templates: true,\n  quickButtons: true,\n  celebrationMessages: true,\n  gpsLocation: true,\n  manualLocation: true,\n  extendButtons: true,\n  \n  // Gamification (enabled)\n  bestieCircle: true,\n  badges: true,\n  shareableCards: true,\n  \n  // Media (enabled)\n  mediaUpload: true,\n  photoCapture: true,\n  \n  // Payments (enabled)\n  donations: true,\n  smsSubscription: true,\n  \n  // Future features (disabled for now)\n  emergency: false,\n  reversePin: false,\n  liveTracking: false,\n  videoRecording: false,\n  facebookLogin: false, // Enable when account is unblocked\n  phoneAuth: false // Not needed for MVP\n};\n\n// Helper to check if feature is enabled\nexport const isEnabled = (feature) => FEATURES[feature] === true;\n\nexport default FEATURES;\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\nimport { db, storage } from '../services/firebase';\nimport { collection, query, where, getDocs, addDoc, getDoc, doc, Timestamp, onSnapshot } from 'firebase/firestore';\nimport { ref, uploadBytes, getDownloadURL } from 'firebase/storage';\nimport toast from 'react-hot-toast';\nimport { isEnabled } from '../config/features';\nimport errorTracker from '../services/errorTracking';\nimport useOptimisticUpdate from '../hooks/useOptimisticUpdate';\nimport ProfileWithBubble from '../components/ProfileWithBubble';\n\n// Luxury girly skeleton loader for check-in creation\nconst CheckInLoader = () => {\n  const messages = [\n    \"Wrapping you in safety... Your besties will watch over you ğŸ’–\",\n    \"Building your protection... We've got your back, always âœ¨\",\n    \"Setting up your safety circle... You're never alone with us ğŸŒ¸\",\n    \"Preparing your safety net... Because you deserve to feel secure ğŸ’•\",\n  ];\n\n  // Pick one random message for this check-in\n  const [message] = useState(() => messages[Math.floor(Math.random() * messages.length)]);\n\n  return (\n    <>\n    <div className=\"min-h-screen bg-gradient-to-br from-rose-50 via-pink-50 via-purple-50 to-indigo-50 dark:from-purple-900/30 dark:via-pink-900/30 dark:to-indigo-900/30 flex items-center justify-center p-4 relative overflow-hidden\">\n      {/* Elegant floating elements */}\n      <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\n        {[...Array(20)].map((_, i) => (\n          <div\n            key={i}\n            className=\"absolute animate-float-elegant\"\n            style={{\n              left: `${Math.random() * 100}%`,\n              top: `${Math.random() * 100}%`,\n              animationDelay: `${Math.random() * 4}s`,\n              animationDuration: `${6 + Math.random() * 4}s`,\n              opacity: 0.3 + Math.random() * 0.3,\n            }}\n          >\n            <span className=\"text-2xl\">\n              {['âœ¨', 'ğŸ’', 'ğŸŒ¸', 'ğŸ¦‹', 'ğŸ’«', 'ğŸŒº', 'ğŸµï¸', 'ğŸ€'][Math.floor(Math.random() * 8)]}\n            </span>\n          </div>\n        ))}\n      </div>\n\n      {/* Luxury content card */}\n      <div className=\"w-full max-w-lg text-center relative z-10\">\n        <div className=\"relative bg-white/95 dark:bg-gray-800/95 backdrop-blur-xl rounded-[2rem] p-10 shadow-[0_20px_60px_rgba(0,0,0,0.1)] border border-white/50 dark:border-gray-600/50\">\n        {/* Message */}\n        <h2 className=\"font-display text-3xl text-gradient mb-4\">\n          Creating your check-in!\n        </h2>\n\n        <p className=\"text-xl text-text-secondary font-semibold mb-8 animate-fade-in\">\n          {message}\n        </p>\n\n        {/* Cute loading animation */}\n        <div className=\"flex justify-center gap-2 mb-8\">\n          {[0, 1, 2].map((i) => (\n            <div\n              key={i}\n              className=\"w-4 h-4 bg-gradient-primary rounded-full animate-bounce\"\n              style={{ animationDelay: `${i * 0.15}s` }}\n            ></div>\n          ))}\n        </div>\n\n          {/* Elegant loading animation */}\n          <div className=\"flex justify-center items-center gap-2 mb-8\">\n            {[0, 1, 2, 3, 4].map((i) => (\n              <div\n                key={i}\n                className=\"w-2 h-2 bg-gradient-to-r from-pink-400 to-purple-400 rounded-full animate-wave\"\n                style={{\n                  animationDelay: `${i * 0.15}s`,\n                  animationDuration: '1.5s'\n                }}\n              ></div>\n            ))}\n          </div>\n\n          {/* Silk ribbon progress bar */}\n          <div className=\"relative w-full h-2 bg-gradient-to-r from-pink-100 via-purple-100 to-fuchsia-100 dark:from-pink-900/50 dark:via-purple-900/50 dark:to-fuchsia-900/50 rounded-full overflow-hidden shadow-inner\">\n            <div className=\"absolute inset-0 bg-gradient-to-r from-pink-400 via-purple-400 via-fuchsia-400 to-pink-400 animate-silk-shimmer bg-[length:300%_100%] opacity-80\"></div>\n            <div className=\"absolute inset-0 bg-white/30 dark:bg-white/10 animate-silk-shine\"></div>\n          </div>\n\n          {/* Gentle reminder */}\n          <p className=\"text-xs text-gray-400 dark:text-gray-400 mt-6 italic\">\n            Taking care of you, always ğŸ’•\n          </p>\n        </div>\n      </div>\n    </div>\n\n      <style>{`\n        @keyframes float-elegant {\n          0%, 100% {\n            transform: translateY(0px) translateX(0px) rotate(0deg);\n            opacity: 0.3;\n          }\n          50% {\n            transform: translateY(-30px) translateX(10px) rotate(5deg);\n            opacity: 0.6;\n          }\n        }\n        @keyframes pulse-slow {\n          0%, 100% { transform: scale(1); opacity: 0.4; }\n          50% { transform: scale(1.2); opacity: 0.2; }\n        }\n        @keyframes pulse-gentle {\n          0%, 100% { transform: scale(1); }\n          50% { transform: scale(1.05); }\n        }\n        @keyframes wave {\n          0%, 100% { transform: translateY(0); }\n          50% { transform: translateY(-8px); }\n        }\n        @keyframes silk-shimmer {\n          0% { background-position: 0% center; }\n          100% { background-position: 300% center; }\n        }\n        @keyframes silk-shine {\n          0% { transform: translateX(-100%) skewX(-15deg); opacity: 0; }\n          50% { opacity: 0.5; }\n          100% { transform: translateX(200%) skewX(-15deg); opacity: 0; }\n        }\n        @keyframes draw-check {\n          0% { stroke-dasharray: 0, 100; }\n          100% { stroke-dasharray: 100, 0; }\n        }\n        .animate-float-elegant {\n          animation: float-elegant 8s ease-in-out infinite;\n        }\n        .animate-pulse-slow {\n          animation: pulse-slow 3s ease-in-out infinite;\n        }\n        .animate-pulse-gentle {\n          animation: pulse-gentle 2s ease-in-out infinite;\n        }\n        .animate-wave {\n          animation: wave 1.5s ease-in-out infinite;\n        }\n        .animate-silk-shimmer {\n          animation: silk-shimmer 3s linear infinite;\n        }\n        .animate-silk-shine {\n          animation: silk-shine 3s ease-in-out infinite;\n        }\n        .animate-draw-check {\n          animation: draw-check 2s ease-in-out infinite;\n          stroke-dasharray: 100;\n        }\n      `}</style>\n    </>\n  );\n};\n\nconst CreateCheckInPage = () => {\n  const { currentUser, userData, loading: authLoading } = useAuth();\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const [locationInput, setLocationInput] = useState('');\n  const [duration, setDuration] = useState(30);\n  const [selectedBesties, setSelectedBesties] = useState([]);\n  const [notes, setNotes] = useState('');\n  const [meetingWith, setMeetingWith] = useState('');\n  const [socialMediaLinks, setSocialMediaLinks] = useState(''); // Social media links of person meeting\n  const [photoFiles, setPhotoFiles] = useState([]);\n  const [photoPreviews, setPhotoPreviews] = useState([]);\n  const [besties, setBesties] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [showingLoader, setShowingLoader] = useState(false);\n  const [autocompleteLoaded, setAutocompleteLoaded] = useState(false);\n  const { executeOptimistic } = useOptimisticUpdate();\n  const [gpsCoords, setGpsCoords] = useState(null); // Store GPS coordinates for map display\n  const [mapInitialized, setMapInitialized] = useState(false);\n  const [mapLocked, setMapLocked] = useState(true); // Map starts locked\n  const [expandedBestieShare, setExpandedBestieShare] = useState(null); // Track which bestie's share menu is open\n  const [notesExpanded, setNotesExpanded] = useState(false); // Track if notes section is expanded\n  const [photosExpanded, setPhotosExpanded] = useState(false); // Track if photos section is expanded\n  const [shouldAutoSubmit, setShouldAutoSubmit] = useState(false); // Flag for auto-submit after besties load\n  const [showLocationDropdown, setShowLocationDropdown] = useState(false); // Track if location dropdown is visible\n  const [socialMediaExpanded, setSocialMediaExpanded] = useState(false); // Track if social media input is expanded\n\n  // Map default center (San Francisco)\n  const mapCenter = { lat: 37.7749, lng: -122.4194 };\n\n  const locationInputRef = useRef(null);\n  const autocompleteRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const mapRef = useRef(null);\n  const mapInstanceRef = useRef(null);\n\n  // Auto-redirect to onboarding if user hasn't completed it\n  useEffect(() => {\n    if (authLoading) return;\n\n    if (userData && userData.onboardingCompleted === false) {\n      navigate('/onboarding');\n    }\n  }, [userData, authLoading, navigate]);\n\n\n  useEffect(() => {\n    errorTracker.trackFunnelStep('checkin', 'view_create_page');\n\n    // Load from quick button or template\n    if (location.state?.quickMinutes) {\n      errorTracker.trackFunnelStep('checkin', 'use_quick_button', { minutes: location.state.quickMinutes });\n      setDuration(location.state.quickMinutes);\n    }\n\n    // Load from new quick check-in types\n    if (location.state?.quickType) {\n      const { quickType, duration: quickDuration, rego, meetingWith: meetingWithParam, skipLocation } = location.state;\n\n      errorTracker.trackFunnelStep('checkin', `use_quick_${quickType}`, { duration: quickDuration });\n\n      if (quickDuration) {\n        setDuration(quickDuration);\n      }\n\n      // If skipLocation is true, set location and flag for auto-submit\n      if (skipLocation) {\n        setLocationInput('No location set');\n        setShouldAutoSubmit(true); // Flag to auto-submit once besties are loaded\n      }\n\n      // Handle rideshare - add rego to notes\n      if (quickType === 'rideshare' && rego) {\n        setNotes(`ğŸš— Rideshare - Vehicle: ${rego}`);\n      }\n\n      // Handle quick meet - set meeting with\n      if (quickType === 'quickmeet' && meetingWithParam) {\n        setMeetingWith(meetingWithParam);\n      }\n\n      // Handle walking - add note\n      if (quickType === 'walking') {\n        setNotes('ğŸš¶â€â™€ï¸ Walking alone');\n      }\n    }\n\n    if (location.state?.template) {\n      errorTracker.trackFunnelStep('checkin', 'use_template');\n      const template = location.state.template;\n      setLocationInput(template.location || '');\n      setDuration(template.duration || 30);\n      setSelectedBesties(template.bestieIds || []);\n      setNotes(template.notes || '');\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [location.state]);\n\n  // Load besties when currentUser is available\n  useEffect(() => {\n    if (!currentUser || authLoading) return;\n\n    console.group('ğŸ” Setting up Bestie Circle Listener');\n\n    // Set up real-time listener for user's featuredCircle\n    const userDocRef = doc(db, 'users', currentUser.uid);\n    const unsubscribe = onSnapshot(userDocRef, async (userDoc) => {\n      try {\n        if (!userDoc.exists()) {\n          console.error('âŒ User document does not exist');\n          console.groupEnd();\n          setBesties([]);\n          return;\n        }\n\n        const userData = userDoc.data();\n        const featuredIds = userData.featuredCircle || [];\n\n        if (featuredIds.length === 0) {\n          console.warn('âš ï¸ featuredCircle is empty - no besties to load');\n          setBesties([]);\n          return;\n        }\n\n        // Get all accepted besties to find the ones in the circle\n        const [requesterQuery, recipientQuery] = await Promise.all([\n          getDocs(\n            query(\n              collection(db, 'besties'),\n              where('requesterId', '==', currentUser.uid),\n              where('status', '==', 'accepted')\n            )\n          ),\n          getDocs(\n            query(\n              collection(db, 'besties'),\n              where('recipientId', '==', currentUser.uid),\n              where('status', '==', 'accepted')\n            )\n          ),\n        ]);\n\n        const allBestiesList = [];\n\n        requesterQuery.forEach((doc) => {\n          const data = doc.data();\n          allBestiesList.push({\n            id: data.recipientId,\n            name: data.recipientName || 'Bestie',\n            phone: data.recipientPhone,\n            email: data.recipientEmail,\n          });\n        });\n\n        recipientQuery.forEach((doc) => {\n          const data = doc.data();\n          allBestiesList.push({\n            id: data.requesterId,\n            name: data.requesterName || 'Bestie',\n            phone: data.requesterPhone,\n            email: data.requesterEmail,\n          });\n        });\n\n        // Filter to only show besties in the featured circle\n        const circleBesties = allBestiesList.filter(b => featuredIds.includes(b.id));\n\n        // Fetch full user data for each bestie to get displayName, photoURL, requestAttention, and SMS settings\n        const bestiesWithUserData = await Promise.all(\n          circleBesties.map(async (bestie) => {\n            try {\n              const userDoc = await getDoc(doc(db, 'users', bestie.id));\n              if (userDoc.exists()) {\n                const userData = userDoc.data();\n                return {\n                  ...bestie,\n                  name: userData.displayName || bestie.name || bestie.email || 'Bestie',\n                  photoURL: userData.photoURL || null,\n                  email: userData.email || bestie.email,\n                  phone: userData.phoneNumber || bestie.phone,\n                  smsEnabled: userData.notificationPreferences?.sms || false,\n                  requestAttention: userData.requestAttention || null,\n                };\n              }\n              return bestie;\n            } catch (error) {\n              console.error(`Error fetching user data for ${bestie.id}:`, error);\n              return bestie;\n            }\n          })\n        );\n\n        setBesties(bestiesWithUserData);\n\n        // Auto-select only besties who have phone numbers AND SMS enabled (required for emergency alerts)\n        if (!location.state?.template && bestiesWithUserData.length > 0) {\n          const bestiesWithPhoneAndSMS = bestiesWithUserData.filter(b => b.phone && b.smsEnabled);\n          setSelectedBesties(bestiesWithPhoneAndSMS.map(b => b.id));\n\n          // Warn if some besties can't receive alerts\n          const cantReceiveAlerts = bestiesWithUserData.filter(b => !b.phone || !b.smsEnabled);\n          if (cantReceiveAlerts.length > 0) {\n            console.warn('âš ï¸ Some circle besties missing phone/SMS:', cantReceiveAlerts);\n            const missingPhone = cantReceiveAlerts.filter(b => !b.phone).length;\n            const missingSMS = cantReceiveAlerts.filter(b => b.phone && !b.smsEnabled).length;\n\n            let message = '';\n            if (missingPhone > 0 && missingSMS > 0) {\n              message = `${missingPhone} bestie(s) need to add their phone number and ${missingSMS} need to enable SMS alerts`;\n            } else if (missingPhone > 0) {\n              message = `${missingPhone} bestie(s) need to add their phone number`;\n            } else {\n              message = `${missingSMS} bestie(s) need to enable SMS alerts in Settings`;\n            }\n\n            toast(message, {\n              icon: 'â„¹ï¸',\n              duration: 5000\n            });\n          }\n        }\n      } catch (error) {\n        console.error('Error loading besties:', error);\n        toast.error('Failed to load besties');\n      }\n    }, (error) => {\n      console.error('Error in featuredCircle listener:', error);\n      toast.error('Failed to load besties');\n    });\n\n    console.groupEnd();\n\n    // Cleanup listener on unmount\n    return () => {\n      unsubscribe();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [currentUser, authLoading]);\n\n  // Auto-submit quick check-ins after besties are loaded\n  useEffect(() => {\n    if (shouldAutoSubmit && selectedBesties.length > 0 && !loading) {\n      // Besties are loaded and auto-selected, now trigger submit IMMEDIATELY\n      console.log('Auto-submitting quick check-in with besties:', selectedBesties);\n\n      // Trigger submit immediately without delay\n      const submitBtn = document.querySelector('#create-checkin-submit-btn');\n      if (submitBtn && !submitBtn.disabled) {\n        console.log('Clicking submit button');\n        submitBtn.click();\n        setShouldAutoSubmit(false); // Reset flag\n      } else {\n        console.warn('Submit button not ready:', { submitBtn, disabled: submitBtn?.disabled });\n      }\n    }\n  }, [shouldAutoSubmit, selectedBesties, loading]);\n\n  // Load Google Places API\n  useEffect(() => {\n    const apiKey = process.env.REACT_APP_GOOGLE_MAPS_API_KEY;\n\n    if (!apiKey) {\n      console.warn('Google Maps API key not configured');\n      toast.error('Address autocomplete is not available. Please type your location manually.', {\n        duration: 5000,\n        id: 'maps-api-missing'\n      });\n      return;\n    }\n\n    // Check if Google Maps is already loaded\n    const checkGoogleLoaded = () => {\n      if (window.google && window.google.maps && window.google.maps.places) {\n        setAutocompleteLoaded(true);\n        return true;\n      }\n      return false;\n    };\n\n    // If already loaded, set state immediately\n    if (checkGoogleLoaded()) {\n      return;\n    }\n\n    // Check if script is already being loaded\n    const existingScript = document.querySelector('script[src*=\"maps.googleapis.com\"]');\n    if (existingScript) {\n      // Script exists, wait for it to load with timeout\n      let attempts = 0;\n      const maxAttempts = 100; // 10 seconds timeout\n      const interval = setInterval(() => {\n        attempts++;\n        if (checkGoogleLoaded()) {\n          clearInterval(interval);\n        } else if (attempts >= maxAttempts) {\n          clearInterval(interval);\n          console.error('Google Maps API loading timeout');\n          toast.error('Map is taking too long to load. Please refresh the page.', {\n            duration: 5000,\n            id: 'maps-timeout'\n          });\n        }\n      }, 100);\n\n      return () => clearInterval(interval);\n    }\n\n    // Load script with loading=async\n    const script = document.createElement('script');\n    script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&libraries=places&loading=async`;\n    script.async = true;\n    script.defer = true;\n\n    // Add timeout for script loading\n    const loadTimeout = setTimeout(() => {\n      if (!checkGoogleLoaded()) {\n        console.error('Google Maps API script load timeout');\n        toast.error('Map failed to load. Please check your internet connection and refresh.', {\n          duration: 5000,\n          id: 'maps-load-timeout'\n        });\n      }\n    }, 15000); // 15 second timeout\n\n    script.onload = () => {\n      clearTimeout(loadTimeout);\n      // Double check that the API is fully loaded\n      const checkInterval = setInterval(() => {\n        if (checkGoogleLoaded()) {\n          clearInterval(checkInterval);\n        }\n      }, 100);\n\n      // Set a short timeout to ensure API is ready\n      setTimeout(() => {\n        if (checkGoogleLoaded()) {\n          console.log('Google Maps API loaded successfully');\n        }\n      }, 500);\n    };\n\n    script.onerror = (error) => {\n      clearTimeout(loadTimeout);\n      console.error('Failed to load Google Maps API:', error);\n      toast.error('Failed to load address autocomplete. Please refresh the page.', {\n        duration: 5000,\n        id: 'maps-error'\n      });\n    };\n\n    document.head.appendChild(script);\n\n    // Cleanup timeout on unmount\n    return () => clearTimeout(loadTimeout);\n  }, []);\n\n  // Initialize Map when API is loaded\n  useEffect(() => {\n    if (!autocompleteLoaded || !mapRef.current || mapInitialized) return;\n\n    // Add extra validation that API is actually ready\n    if (!window.google || !window.google.maps || !window.google.maps.Map) {\n      console.warn('Google Maps API not fully ready yet, retrying...');\n      // Retry after a short delay\n      const retryTimeout = setTimeout(() => {\n        setAutocompleteLoaded(false);\n        setTimeout(() => setAutocompleteLoaded(true), 100);\n      }, 500);\n      return () => clearTimeout(retryTimeout);\n    }\n\n    try {\n      console.log('Initializing Google Map...');\n      // Initialize Google Map - locked by default\n      mapInstanceRef.current = new window.google.maps.Map(mapRef.current, {\n        center: mapCenter,\n        zoom: 12,\n        disableDefaultUI: true,\n        zoomControl: true,\n        mapTypeControl: false,\n        streetViewControl: false,\n        fullscreenControl: false,\n        draggable: false, // Start locked\n        gestureHandling: 'none', // Disable all gestures initially\n      });\n\n      // Handle double-tap to unlock/place pin\n      mapInstanceRef.current.addListener('dblclick', (event) => {\n        if (mapLocked) {\n          // Unlock the map\n          setMapLocked(false);\n          mapInstanceRef.current.setOptions({\n            draggable: true,\n            gestureHandling: 'greedy'\n          });\n          toast.success('ğŸ—ºï¸ Map unlocked! Drag to explore', { duration: 2000 });\n        } else {\n          // Place pin at MAP CENTER (where the fixed pin is displayed)\n          const mapCenter = mapInstanceRef.current.getCenter();\n          const coords = { lat: mapCenter.lat(), lng: mapCenter.lng() };\n\n          // Save the center coordinates\n          setGpsCoords(coords);\n\n          // Reverse geocode to get address from the center pin location\n          const geocoder = new window.google.maps.Geocoder();\n          geocoder.geocode({ location: coords }, (results, status) => {\n            if (status === 'OK' && results[0]) {\n              const address = results[0].formatted_address;\n              setLocationInput(address); // UPDATE: This now updates the input field\n              console.log('Pin placed, location updated to:', address);\n            } else {\n              // Fallback to coordinates if geocoding fails\n              const coordsString = `${coords.lat.toFixed(6)}, ${coords.lng.toFixed(6)}`;\n              setLocationInput(coordsString);\n              console.log('Pin placed, using coordinates:', coordsString);\n            }\n          });\n\n          // Show success feedback\n          toast.success('ğŸ“ Pin location saved!', { duration: 1500 });\n        }\n      });\n\n      // Handle map drag - update location instantly when map is dragged\n      mapInstanceRef.current.addListener('dragend', () => {\n        if (!mapLocked) {\n          // Get the center of the map (where the pin is)\n          const mapCenter = mapInstanceRef.current.getCenter();\n          const coords = { lat: mapCenter.lat(), lng: mapCenter.lng() };\n\n          // Save the center coordinates\n          setGpsCoords(coords);\n\n          // Reverse geocode to get address and update search bar\n          const geocoder = new window.google.maps.Geocoder();\n          geocoder.geocode({ location: coords }, (results, status) => {\n            if (status === 'OK' && results[0]) {\n              const address = results[0].formatted_address;\n              setLocationInput(address);\n              console.log('Map dragged, location updated to:', address);\n            } else {\n              // Fallback to coordinates if geocoding fails\n              const coordsString = `${coords.lat.toFixed(6)}, ${coords.lng.toFixed(6)}`;\n              setLocationInput(coordsString);\n              console.log('Map dragged, using coordinates:', coordsString);\n            }\n          });\n        }\n      });\n\n      // Show reminder on single click when locked\n      mapInstanceRef.current.addListener('click', () => {\n        if (mapLocked) {\n          toast('ğŸ’¡ Double-tap to unlock map!', {\n            duration: 2000,\n            icon: 'ğŸ”’',\n            style: {\n              background: '#fef3c7',\n              color: '#92400e',\n              fontWeight: 600,\n            }\n          });\n        }\n      });\n\n      setMapInitialized(true);\n      console.log('Google Map initialized successfully');\n    } catch (error) {\n      console.error('Error initializing map:', error);\n      toast.error('Failed to initialize map. Please refresh the page.', {\n        duration: 4000,\n        id: 'map-init-error'\n      });\n    }\n    // mapCenter is a constant, not state\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [autocompleteLoaded, mapInitialized, mapLocked]);\n\n  // Initialize Autocomplete when API is loaded\n  useEffect(() => {\n    if (!autocompleteLoaded || !locationInputRef.current) return;\n\n    // Add extra validation that Places API is actually ready\n    if (!window.google || !window.google.maps || !window.google.maps.places || !window.google.maps.places.Autocomplete) {\n      console.warn('Google Places API not fully ready yet, retrying...');\n      // Retry after a short delay\n      const retryTimeout = setTimeout(() => {\n        setAutocompleteLoaded(false);\n        setTimeout(() => setAutocompleteLoaded(true), 100);\n      }, 500);\n      return () => clearTimeout(retryTimeout);\n    }\n\n    try {\n      console.log('Initializing Google Places Autocomplete...');\n\n      // Initialize Google Places Autocomplete\n      autocompleteRef.current = new window.google.maps.places.Autocomplete(\n        locationInputRef.current,\n        {\n          types: ['establishment', 'geocode'], // Allow both businesses and addresses\n          fields: ['formatted_address', 'name', 'geometry'], // Request only needed fields\n        }\n      );\n\n      // Listen for place selection\n      autocompleteRef.current.addListener('place_changed', () => {\n        try {\n          const place = autocompleteRef.current.getPlace();\n\n          if (place.formatted_address) {\n            // Use business name if available, otherwise use formatted address\n            const displayLocation = place.name && place.name !== place.formatted_address\n              ? `${place.name}, ${place.formatted_address}`\n              : place.formatted_address;\n\n            setLocationInput(displayLocation);\n\n            // Center map on selected place (no marker needed - fixed pin in center)\n            if (place.geometry && place.geometry.location && mapInstanceRef.current) {\n              const location = place.geometry.location;\n              const coords = { lat: location.lat(), lng: location.lng() };\n              mapInstanceRef.current.setCenter(coords);\n              mapInstanceRef.current.setZoom(15);\n              setGpsCoords(coords); // Store coordinates\n            }\n          }\n        } catch (error) {\n          console.error('Error handling place selection:', error);\n          toast.error('Error selecting location. Please try again.', {\n            duration: 3000\n          });\n        }\n      });\n\n      console.log('Autocomplete initialized successfully');\n    } catch (error) {\n      console.error('Error initializing autocomplete:', error);\n      toast.error('Could not initialize address search. Please type your location manually.', {\n        duration: 4000,\n        id: 'autocomplete-init-error'\n      });\n    }\n\n    return () => {\n      // Cleanup autocomplete listeners\n      if (autocompleteRef.current) {\n        window.google.maps.event.clearInstanceListeners(autocompleteRef.current);\n      }\n    };\n  }, [autocompleteLoaded]);\n\n  // Update map when GPS coordinates are available\n  useEffect(() => {\n    if (!gpsCoords || !mapInstanceRef.current) return;\n\n    try {\n      // Center map on GPS location (fixed pin shows the location)\n      mapInstanceRef.current.setCenter(gpsCoords);\n      mapInstanceRef.current.setZoom(16);\n    } catch (error) {\n      console.error('Error updating map with GPS:', error);\n    }\n  }, [gpsCoords]);\n\n  const handleGetLocation = () => {\n    if (!isEnabled('gpsLocation')) {\n      toast.error('GPS location is not enabled');\n      return;\n    }\n\n    if (navigator.geolocation) {\n      setLoading(true);\n      toast.loading('Getting your location...', { id: 'gps-loading' });\n\n      navigator.geolocation.getCurrentPosition(\n        (position) => {\n          const lat = position.coords.latitude;\n          const lng = position.coords.longitude;\n          const gpsCoords = { lat, lng };\n\n          // Use reverse geocoding to get address from coordinates\n          const geocoder = new window.google.maps.Geocoder();\n          geocoder.geocode({ location: gpsCoords }, (results, status) => {\n            toast.dismiss('gps-loading');\n            setLoading(false);\n\n            if (status === 'OK' && results[0]) {\n              setLocationInput(results[0].formatted_address);\n              toast.success('Location captured!', { duration: 2000 });\n            } else {\n              // Fallback to coordinates if geocoding fails\n              setLocationInput(`GPS: ${lat.toFixed(4)}, ${lng.toFixed(4)}`);\n              toast.success('Location captured (coordinates only)', { duration: 2000 });\n            }\n\n            setGpsCoords(gpsCoords); // Store coordinates for map\n          });\n        },\n        (error) => {\n          toast.dismiss('gps-loading');\n          setLoading(false);\n          console.error('Geolocation error:', error);\n\n          // Provide specific error messages based on error code\n          if (error.code === 1) {\n            toast.error('Location permission denied. Please enable location access in your browser settings.', { duration: 6000 });\n          } else if (error.code === 2) {\n            toast.error('Location unavailable. Make sure location services are enabled on your device.', { duration: 5000 });\n          } else if (error.code === 3) {\n            toast.error('Location request timed out. Please try again or search for your location.', { duration: 5000 });\n          } else {\n            toast.error('Could not get location. Please search manually.', { duration: 4000 });\n          }\n        },\n        {\n          timeout: 30000, // 30 second timeout (increased from 10s)\n          enableHighAccuracy: true, // Better accuracy\n          maximumAge: 0 // Don't use cached location\n        }\n      );\n    } else {\n      toast.error('Geolocation not supported by your browser. Please search for your location manually.');\n    }\n  };\n\n  const toggleBestie = (bestieId) => {\n    if (selectedBesties.includes(bestieId)) {\n      setSelectedBesties(selectedBesties.filter(id => id !== bestieId));\n    } else {\n      if (selectedBesties.length >= 5) {\n        toast.error('Maximum 5 besties per check-in');\n        return;\n      }\n      setSelectedBesties([...selectedBesties, bestieId]);\n    }\n  };\n\n  const handleShareToAddPhone = (platform, bestieName) => {\n    const message = `Hey! You haven't added your phone number on Besties yet. I can't use you as my emergency contact until you do. Can you add it please? â¤ï¸\\n\\nDownload Besties: ${window.location.origin}`;\n    const encoded = encodeURIComponent(message);\n    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);\n\n    switch (platform) {\n      case 'whatsapp':\n        if (isMobile) {\n          window.location.href = `whatsapp://send?text=${encoded}`;\n        } else {\n          window.open(`https://wa.me/?text=${encoded}`, '_blank');\n        }\n        break;\n      case 'messenger':\n        if (isMobile) {\n          window.location.href = `fb-messenger://share?link=${encodeURIComponent(window.location.origin)}`;\n          setTimeout(() => {\n            window.open(`https://www.facebook.com/dialog/send?link=${encodeURIComponent(window.location.origin)}&app_id=&redirect_uri=${encodeURIComponent(window.location.origin)}`, '_blank');\n          }, 1500);\n        } else {\n          window.open(`https://www.facebook.com/dialog/send?link=${encodeURIComponent(window.location.origin)}&app_id=&redirect_uri=${encodeURIComponent(window.location.origin)}`, '_blank', 'width=600,height=400');\n        }\n        break;\n      case 'instagram':\n        navigator.clipboard.writeText(message).then(() => {\n          toast.success('Message copied! Opening Instagram DMs...');\n          if (isMobile) {\n            window.location.href = 'instagram://direct/inbox';\n            setTimeout(() => {\n              window.open('https://www.instagram.com/direct/inbox/', '_blank');\n            }, 1500);\n          } else {\n            window.open('https://www.instagram.com/direct/inbox/', '_blank');\n          }\n        }).catch(() => {\n          toast.error('Failed to copy message');\n        });\n        break;\n      case 'sms':\n        window.location.href = `sms:?body=${encoded}`;\n        break;\n      case 'facebook':\n        const textEncoded = encodeURIComponent('Hey! Please add your phone number on Besties â¤ï¸');\n        const urlEncoded = encodeURIComponent(window.location.origin);\n        if (isMobile) {\n          window.location.href = `fb://profile`;\n          setTimeout(() => {\n            window.open(`https://www.facebook.com/sharer/sharer.php?u=${urlEncoded}&quote=${textEncoded}`, '_blank');\n          }, 1500);\n        } else {\n          window.open(`https://www.facebook.com/sharer/sharer.php?u=${urlEncoded}&quote=${textEncoded}`, '_blank', 'width=600,height=400');\n        }\n        break;\n      default:\n        break;\n    }\n\n    toast.success(`Opening ${platform}...`);\n    setExpandedBestieShare(null); // Close the menu\n  };\n\n  const handlePhotoChange = (e) => {\n    const files = Array.from(e.target.files);\n    if (files.length === 0) return;\n\n    // Check if adding these files would exceed the 5 photo limit\n    if (photoFiles.length + files.length > 5) {\n      toast.error('You can only upload up to 5 photos per check-in');\n      return;\n    }\n\n    // Validate each file\n    for (const file of files) {\n      if (file.size > 5 * 1024 * 1024) {\n        toast.error(`${file.name} is too large. Photos must be less than 5MB`);\n        return;\n      }\n\n      if (!file.type.startsWith('image/')) {\n        toast.error(`${file.name} is not an image file`);\n        return;\n      }\n    }\n\n    // Add files and previews\n    setPhotoFiles([...photoFiles, ...files]);\n    const newPreviews = files.map(file => URL.createObjectURL(file));\n    setPhotoPreviews([...photoPreviews, ...newPreviews]);\n\n    // Clear the file input\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const removePhoto = (index) => {\n    setPhotoFiles(photoFiles.filter((_, i) => i !== index));\n    setPhotoPreviews(photoPreviews.filter((_, i) => i !== index));\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (selectedBesties.length === 0) {\n      errorTracker.trackFunnelStep('checkin', 'error_no_besties');\n      toast.error('Please select at least one bestie from your circle to notify', { duration: 4000 });\n      return;\n    }\n\n    // Check if selected besties have phone numbers\n    const bestiesWithoutPhone = selectedBesties.filter(bestieId => {\n      const bestie = besties.find(b => b.id === bestieId);\n      return !bestie?.phone;\n    }).map(bestieId => {\n      const bestie = besties.find(b => b.id === bestieId);\n      return bestie?.name || 'Unknown';\n    });\n\n    if (bestiesWithoutPhone.length > 0) {\n      toast.error(`These besties need to add their phone number: ${bestiesWithoutPhone.join(', ')}`, {\n        duration: 6000\n      });\n      return;\n    }\n\n    if (!locationInput.trim()) {\n      errorTracker.trackFunnelStep('checkin', 'error_no_location');\n      toast.error('Please enter a location');\n      return;\n    }\n\n    if (duration < 10 || duration > 180) {\n      toast.error('Duration must be between 10 and 180 minutes');\n      return;\n    }\n\n    errorTracker.trackFunnelStep('checkin', 'submit_checkin', {\n      besties: selectedBesties.length,\n      duration,\n      hasNotes: !!notes,\n    });\n\n    // Show cute loader immediately\n    setShowingLoader(true);\n\n    // Use optimistic update - show loader and process in background\n    await executeOptimistic({\n      optimisticUpdate: () => {\n        // Loader is already showing - no immediate navigation\n      },\n      serverUpdate: async () => {\n        setLoading(true);\n        try {\n          const now = new Date();\n          const alertTime = new Date(now.getTime() + duration * 60 * 1000);\n\n          // Upload photos if provided - only if user actually selected photos\n          const photoURLs = [];\n          if (photoFiles.length > 0) {\n            for (let i = 0; i < photoFiles.length; i++) {\n              const file = photoFiles[i];\n              try {\n                const storageRef = ref(storage, `checkin-photos/${currentUser.uid}/${Date.now()}_${i}_${file.name}`);\n                await uploadBytes(storageRef, file);\n                const downloadURL = await getDownloadURL(storageRef);\n\n                // Only add to array if we got a valid URL\n                if (downloadURL) {\n                  photoURLs.push(downloadURL);\n                } else {\n                  console.warn(`Failed to get download URL for photo ${i}`);\n                }\n              } catch (photoError) {\n                console.error(`Error uploading photo ${i}:`, photoError);\n                // Continue with other photos even if one fails\n              }\n            }\n          }\n\n          // Filter out any undefined/null/empty values before saving\n          const validPhotoURLs = photoURLs.filter(url => url && url.trim() !== '');\n\n          // Get current privacy setting and circle snapshot\n          const privacyLevel = userData?.privacySettings?.checkInVisibility || 'all_besties';\n          const circleSnapshot = userData?.featuredCircle || [];\n\n          const checkInData = {\n            userId: currentUser.uid,\n            location: locationInput,\n            gpsCoords: gpsCoords || null, // Save GPS coordinates from map pin\n            duration: duration,\n            alertTime: Timestamp.fromDate(alertTime),\n            bestieIds: selectedBesties,\n            notes: notes || null,\n            meetingWith: meetingWith || null,\n            socialMediaLinks: socialMediaLinks || null, // Save social media links\n            status: 'active',\n            privacyLevel: privacyLevel,\n            circleSnapshot: circleSnapshot,\n            createdAt: Timestamp.now(),\n            lastUpdate: Timestamp.now(),\n          };\n\n          // Only add photoURLs field if there are valid photos\n          if (validPhotoURLs.length > 0) {\n            checkInData.photoURLs = validPhotoURLs;\n          }\n\n          // Add document and get reference\n          const docRef = await addDoc(collection(db, 'checkins'), checkInData);\n\n          // Verify the document was created by reading it back\n          const docSnap = await getDoc(doc(db, 'checkins', docRef.id));\n\n          if (!docSnap.exists()) {\n            throw new Error('Check-in was not saved properly. Please try again.');\n          }\n\n          // Verify critical data\n          const savedData = docSnap.data();\n          if (savedData.userId !== currentUser.uid || savedData.status !== 'active') {\n            throw new Error('Check-in data verification failed. Please try again.');\n          }\n\n          // Verify besties were saved correctly\n          if (!savedData.bestieIds || savedData.bestieIds.length !== selectedBesties.length) {\n            throw new Error('Bestie list was not saved correctly. Please try again.');\n          }\n\n          // Verify all bestie IDs match exactly\n          const bestiesMatch = selectedBesties.every(id => savedData.bestieIds.includes(id));\n          if (!bestiesMatch) {\n            throw new Error('Bestie list verification failed. Please try again.');\n          }\n\n          errorTracker.trackFunnelStep('checkin', 'complete_checkin');\n\n          // Navigate after successful creation\n          setTimeout(() => {\n            navigate('/');\n          }, 1000); // Small delay to show success message\n\n          return docRef;\n        } finally {\n          setLoading(false);\n        }\n      },\n      rollback: () => {\n        // Hide loader and stay on page on error\n        setShowingLoader(false);\n      },\n      onError: (error) => {\n        console.error('Error creating check-in:', error);\n        errorTracker.logCustomError('Failed to create check-in', { error: error.message });\n        setShowingLoader(false);\n      },\n      successMessage: 'Check-in created! Stay safe! ğŸ’œ',\n      errorMessage: 'Failed to create check-in. Please try creating it again.',\n      showLoadingToast: false, // We're showing the loader instead\n      loadingMessage: 'Creating your check-in...'\n    });\n  };\n\n  // Show loader while creating check-in\n  if (showingLoader) {\n    return <CheckInLoader />;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-pattern\">\n\n      <div className={`max-w-2xl mx-auto p-4 pb-20 ${shouldAutoSubmit ? 'opacity-0 pointer-events-none' : ''}`}>\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          {/* Location with Map */}\n          <div className=\"card p-0 overflow-hidden\">\n            <label className=\"block text-lg font-display text-text-primary p-6 pb-3 text-center\">\n              Create Check-In\n            </label>\n\n            {/* Map with overlays */}\n            <div className=\"relative\">\n              {/* Map Container */}\n              <div\n                ref={mapRef}\n                className=\"w-full h-80\"\n                style={{ minHeight: '320px' }}\n              ></div>\n\n              {/* Search bar overlay */}\n              <div className=\"absolute top-3 left-3 right-3 z-10\">\n                <input\n                  ref={locationInputRef}\n                  type=\"text\"\n                  value={locationInput}\n                  onChange={(e) => setLocationInput(e.target.value)}\n                  onFocus={() => setShowLocationDropdown(true)}\n                  onBlur={() => setTimeout(() => setShowLocationDropdown(false), 200)}\n                  className=\"input w-full shadow-lg\"\n                  placeholder=\"Search for a place...\"\n                  required\n                  autoComplete=\"off\"\n                />\n                {/* Location dropdown */}\n                {showLocationDropdown && isEnabled('gpsLocation') && (\n                  <div className=\"mt-2 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-600 overflow-hidden\">\n                    <button\n                      type=\"button\"\n                      onClick={() => {\n                        handleGetLocation();\n                        setShowLocationDropdown(false);\n                      }}\n                      className=\"w-full px-4 py-3 flex items-center gap-3 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left\"\n                    >\n                      <svg\n                        className=\"w-5 h-5 text-primary\"\n                        fill=\"none\"\n                        stroke=\"currentColor\"\n                        viewBox=\"0 0 24 24\"\n                      >\n                        <circle cx=\"12\" cy=\"12\" r=\"3\" strokeWidth={2} />\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 2v4m0 12v4M2 12h4m12 0h4\" />\n                      </svg>\n                      <span className=\"font-semibold text-text-primary\">Your Location</span>\n                    </button>\n                  </div>\n                )}\n              </div>\n\n              {/* Fixed center pin - doesn't move, map moves underneath */}\n              <div className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-full z-10 pointer-events-none\">\n                <svg\n                  className=\"w-12 h-12 text-primary drop-shadow-lg\"\n                  fill=\"currentColor\"\n                  viewBox=\"0 0 24 24\"\n                >\n                  <path d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\"/>\n                </svg>\n              </div>\n\n              {/* Locate me button overlay - positioned below search bar */}\n              {isEnabled('gpsLocation') && (\n                <button\n                  type=\"button\"\n                  onClick={handleGetLocation}\n                  className=\"absolute right-3 top-20 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 p-3 rounded-lg shadow-lg border border-gray-300 dark:border-gray-600 transition-all z-10\"\n                  disabled={loading}\n                  title=\"Use my current location\"\n                >\n                  {loading ? (\n                    <div className=\"w-5 h-5 spinner-small\"></div>\n                  ) : (\n                    <svg\n                      className=\"w-5 h-5\"\n                      fill=\"none\"\n                      stroke=\"currentColor\"\n                      viewBox=\"0 0 24 24\"\n                    >\n                      <circle cx=\"12\" cy=\"12\" r=\"3\" strokeWidth={2} />\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 2v4m0 12v4M2 12h4m12 0h4\" />\n                    </svg>\n                  )}\n                </button>\n              )}\n            </div>\n\n            <p className=\"text-xs text-text-secondary p-3 px-6\">\n              ğŸ’¡ <strong className=\"text-primary\">Double-tap to unlock the map,</strong> then drag to move it and double-tap again to save\n            </p>\n          </div>\n\n          {/* Who Meeting & Duration Combined */}\n          <div className=\"card p-6\">\n            {/* Who You're Meeting */}\n            <div className=\"mb-6\">\n              <label className=\"block text-lg font-display text-text-primary mb-3\">\n                Who are you meeting? ğŸ‘¥ (Optional)\n              </label>\n              <input\n                type=\"text\"\n                value={meetingWith}\n                onChange={(e) => setMeetingWith(e.target.value)}\n                className=\"input mb-3\"\n                placeholder=\"e.g., Alex, Sarah, John...\"\n              />\n\n              {/* Social Media Button/Input */}\n              {socialMediaExpanded ? (\n                <div className=\"animate-fade-in\">\n                  <label className=\"block text-sm font-semibold text-text-secondary mb-2\">\n                    Their Social Media\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={socialMediaLinks}\n                    onChange={(e) => setSocialMediaLinks(e.target.value)}\n                    className=\"input mb-2\"\n                    placeholder=\"e.g., @username on Instagram, facebook.com/profile...\"\n                    autoFocus\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setSocialMediaExpanded(false)}\n                    className=\"w-full btn btn-secondary text-sm py-2\"\n                  >\n                    Done\n                  </button>\n                </div>\n              ) : (\n                <button\n                  type=\"button\"\n                  onClick={() => setSocialMediaExpanded(true)}\n                  className={`w-full border-2 ${\n                    socialMediaLinks\n                      ? 'border-primary bg-primary/10 text-primary'\n                      : 'border-dashed border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:border-primary hover:bg-primary/5'\n                  } rounded-xl p-3 text-sm font-semibold transition-all`}\n                >\n                  {socialMediaLinks ? 'âœ“ Social Media Added' : 'ğŸ“± Add Their Social Media'}\n                </button>\n              )}\n            </div>\n\n            {/* Duration */}\n            <div>\n              <label className=\"block text-lg font-display text-text-primary mb-3\">\n                How long? â°\n              </label>\n\n              <div className=\"grid grid-cols-4 gap-3 mb-4\">\n                {[15, 30, 60, 120].map((mins) => (\n                  <button\n                    key={mins}\n                    type=\"button\"\n                    onClick={() => setDuration(mins)}\n                    className={`py-3 rounded-xl font-semibold transition-all ${\n                      duration === mins\n                        ? 'bg-gradient-primary text-white shadow-lg'\n                        : 'bg-gray-100 dark:bg-gray-700 text-text-primary hover:bg-gray-200 dark:hover:bg-gray-600'\n                    }`}\n                  >\n                    {mins < 60 ? `${mins}m` : `${mins / 60}h`}\n                  </button>\n                ))}\n              </div>\n\n              <input\n                type=\"range\"\n                min=\"15\"\n                max=\"180\"\n                step=\"15\"\n                value={duration}\n                onChange={(e) => setDuration(parseInt(e.target.value))}\n                className=\"w-full\"\n              />\n              <div className=\"text-center mt-3\">\n                <div className=\"text-sm text-text-secondary\">\n                  {duration} minutes\n                </div>\n                <div className=\"text-sm font-semibold text-primary mt-1\">\n                  Alert at: {new Date(Date.now() + duration * 60 * 1000).toLocaleTimeString('en-US', {\n                    hour: 'numeric',\n                    minute: '2-digit',\n                    hour12: true\n                  })}\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Select Besties */}\n          <div className=\"card p-6\">\n            <label className=\"block text-lg font-display text-text-primary mb-3\">\n              Who should we alert? ğŸ’œ\n            </label>\n\n            {besties.length === 0 ? (\n              <div className=\"text-center py-8 bg-orange-50 dark:bg-orange-900/30 border-2 border-orange-200 dark:border-orange-800 rounded-xl\">\n                <p className=\"font-semibold text-text-primary mb-2\">âš ï¸ No besties in your circle</p>\n                <p className=\"text-text-secondary text-sm mb-4\">Add besties to your bestie circle on the home page to create check-ins</p>\n                <button\n                  type=\"button\"\n                  onClick={() => navigate('/')}\n                  className=\"btn btn-primary\"\n                >\n                  Go to Home Page\n                </button>\n              </div>\n            ) : (\n              <div className=\"space-y-2\">\n                {besties.map((bestie) => {\n                  const selectionIndex = selectedBesties.indexOf(bestie.id);\n                  const isSelected = selectionIndex !== -1;\n                  const selectionNumber = isSelected ? selectionIndex + 1 : null;\n                  const isShareExpanded = expandedBestieShare === bestie.id;\n\n                  return (\n                    <div key={bestie.id} className=\"w-full\">\n                      <button\n                        type=\"button\"\n                        onClick={() => (bestie.phone && bestie.smsEnabled) && toggleBestie(bestie.id)}\n                        disabled={!bestie.phone || !bestie.smsEnabled}\n                        className={`w-full p-4 rounded-xl border-2 transition-all text-left ${\n                          !bestie.phone || !bestie.smsEnabled\n                            ? 'border-orange-300 dark:border-orange-800 bg-orange-50 dark:bg-orange-900/30 opacity-60'\n                            : isSelected\n                            ? 'border-primary bg-primary/5'\n                            : 'border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500'\n                        }`}\n                      >\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center gap-3 flex-1\">\n                            <ProfileWithBubble\n                              photoURL={bestie.photoURL}\n                              name={bestie.name || bestie.email || 'Unknown'}\n                              requestAttention={bestie.requestAttention}\n                              size=\"md\"\n                              showBubble={true}\n                            />\n                            <div className=\"flex-1\">\n                              <div className=\"font-semibold text-text-primary\">{bestie.name || bestie.email || 'Unknown'}</div>\n                              <div className=\"text-sm text-text-secondary\">\n                                {!bestie.phone\n                                  ? 'âš ï¸ No phone number'\n                                  : !bestie.smsEnabled\n                                  ? 'âš ï¸ SMS alerts not enabled'\n                                  : bestie.email || bestie.phone}\n                              </div>\n                            </div>\n                          </div>\n                          {bestie.phone ? (\n                            isSelected && (\n                              <div className=\"bg-primary text-white px-3 py-1 rounded-full text-sm font-bold\">\n                                {selectionNumber}/5\n                              </div>\n                            )\n                          ) : (\n                            <button\n                              type=\"button\"\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                setExpandedBestieShare(isShareExpanded ? null : bestie.id);\n                              }}\n                              className=\"btn btn-sm btn-primary\"\n                            >\n                              Ask to Add\n                            </button>\n                          )}\n                        </div>\n                      </button>\n\n                      {/* Social Share Menu for No Phone */}\n                      {!bestie.phone && isShareExpanded && (\n                        <div className=\"mt-2 p-4 bg-purple-50 dark:bg-purple-900/30 border-2 border-purple-200 dark:border-purple-800 rounded-xl\">\n                          <p className=\"text-sm font-semibold text-purple-900 dark:text-purple-200 mb-3\">\n                            ğŸ“± Ask {bestie.name} to add their phone number\n                          </p>\n                          <div className=\"grid grid-cols-3 gap-2\">\n                            <button\n                              type=\"button\"\n                              onClick={() => handleShareToAddPhone('whatsapp', bestie.name)}\n                              className=\"flex flex-col items-center gap-1 p-3 rounded-lg bg-[#25D366] hover:bg-[#20BA5A] text-white transition-colors\"\n                            >\n                              <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                                <path d=\"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z\"/>\n                              </svg>\n                              <span className=\"text-xs\">WhatsApp</span>\n                            </button>\n                            <button\n                              type=\"button\"\n                              onClick={() => handleShareToAddPhone('messenger', bestie.name)}\n                              className=\"flex flex-col items-center gap-1 p-3 rounded-lg bg-[#0084FF] hover:bg-[#0073E6] text-white transition-colors\"\n                            >\n                              <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                                <path d=\"M12 0C5.373 0 0 4.975 0 11.111c0 3.497 1.745 6.616 4.472 8.652V24l4.086-2.242c1.09.301 2.246.464 3.442.464 6.627 0 12-4.974 12-11.111C24 4.975 18.627 0 12 0zm1.191 14.963l-3.055-3.26-5.963 3.26L10.732 8l3.131 3.259L19.752 8l-6.561 6.963z\"/>\n                              </svg>\n                              <span className=\"text-xs\">Messenger</span>\n                            </button>\n                            <button\n                              type=\"button\"\n                              onClick={() => handleShareToAddPhone('instagram', bestie.name)}\n                              className=\"flex flex-col items-center gap-1 p-3 rounded-lg bg-gradient-to-r from-[#833AB4] via-[#FD1D1D] to-[#F77737] hover:opacity-90 text-white transition-opacity\"\n                            >\n                              <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                                <path d=\"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z\"/>\n                              </svg>\n                              <span className=\"text-xs\">Instagram</span>\n                            </button>\n                            <button\n                              type=\"button\"\n                              onClick={() => handleShareToAddPhone('sms', bestie.name)}\n                              className=\"flex flex-col items-center gap-1 p-3 rounded-lg bg-success hover:bg-green-600 text-white transition-colors\"\n                            >\n                              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z\" />\n                              </svg>\n                              <span className=\"text-xs\">SMS</span>\n                            </button>\n                            <button\n                              type=\"button\"\n                              onClick={() => handleShareToAddPhone('facebook', bestie.name)}\n                              className=\"flex flex-col items-center gap-1 p-3 rounded-lg bg-[#1877F2] hover:bg-[#166FE5] text-white transition-colors\"\n                            >\n                              <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                                <path d=\"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z\"/>\n                              </svg>\n                              <span className=\"text-xs\">Facebook</span>\n                            </button>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n\n            <div className=\"mt-3 text-sm text-primary font-semibold\">\n              Selected: {selectedBesties.length}/5\n            </div>\n          </div>\n\n          {/* Notes and Photos - Side by side expandable buttons */}\n          <div className=\"card p-6\">\n            <label className=\"block text-lg font-display text-text-primary mb-3\">\n              Notes & Photos (Optional)\n            </label>\n\n            {/* Side-by-side buttons */}\n            <div className=\"grid grid-cols-2 gap-3 mb-4\">\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setNotesExpanded(!notesExpanded);\n                  if (!notesExpanded) setPhotosExpanded(false);\n                }}\n                className={`py-4 px-4 rounded-xl font-semibold transition-all border-2 ${\n                  notesExpanded\n                    ? 'bg-gradient-primary text-white border-primary shadow-lg scale-105'\n                    : notes\n                    ? 'bg-primary/10 border-primary text-primary'\n                    : 'bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-text-primary hover:border-primary hover:bg-primary/5'\n                }`}\n              >\n                <div className=\"text-2xl mb-1\">ğŸ“</div>\n                <div className=\"text-sm\">Add Notes</div>\n                {notes && !notesExpanded && <div className=\"text-xs mt-1 opacity-75\">âœ“ Added</div>}\n              </button>\n\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setPhotosExpanded(!photosExpanded);\n                  if (!photosExpanded) setNotesExpanded(false);\n                }}\n                className={`py-4 px-4 rounded-xl font-semibold transition-all border-2 ${\n                  photosExpanded\n                    ? 'bg-gradient-primary text-white border-primary shadow-lg scale-105'\n                    : photoFiles.length > 0\n                    ? 'bg-primary/10 border-primary text-primary'\n                    : 'bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-text-primary hover:border-primary hover:bg-primary/5'\n                }`}\n              >\n                <div className=\"text-2xl mb-1\">ğŸ“·</div>\n                <div className=\"text-sm\">Add Photos</div>\n                {photoFiles.length > 0 && !photosExpanded && (\n                  <div className=\"text-xs mt-1 opacity-75\">âœ“ {photoFiles.length}/5</div>\n                )}\n              </button>\n            </div>\n\n            {/* Expandable Notes Section */}\n            {notesExpanded && (\n              <div className=\"mb-4 animate-fade-in\">\n                <textarea\n                  value={notes}\n                  onChange={(e) => setNotes(e.target.value)}\n                  onKeyDown={(e) => {\n                    // Mobile keyboard \"Done\" or \"Go\" button (Enter without shift)\n                    if (e.key === 'Enter' && !e.shiftKey) {\n                      e.preventDefault();\n                      setNotesExpanded(false);\n                      e.target.blur(); // Dismiss keyboard\n                    }\n                  }}\n                  className=\"input min-h-[120px] resize-none\"\n                  placeholder=\"Any additional info for your besties...\"\n                  autoFocus\n                />\n                <button\n                  type=\"button\"\n                  onClick={() => setNotesExpanded(false)}\n                  className=\"mt-2 w-full btn btn-secondary text-sm py-2\"\n                >\n                  Done\n                </button>\n              </div>\n            )}\n\n            {/* Expandable Photos Section */}\n            {photosExpanded && (\n              <div className=\"animate-fade-in\">\n                <div className=\"text-sm font-semibold text-text-primary mb-2\">\n                  Add Photos ({photoFiles.length}/5)\n                </div>\n\n                {/* Photo grid */}\n                {photoPreviews.length > 0 && (\n                  <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3 mb-3\">\n                    {photoPreviews.map((preview, index) => (\n                      <div key={index} className=\"relative aspect-square\">\n                        <img\n                          src={preview}\n                          alt={`Preview ${index + 1}`}\n                          className=\"w-full h-full rounded-xl object-cover\"\n                        />\n                        <button\n                          type=\"button\"\n                          onClick={() => removePhoto(index)}\n                          className=\"absolute top-1 right-1 bg-red-500 text-white w-6 h-6 rounded-full text-sm font-bold hover:bg-red-600 flex items-center justify-center\"\n                        >\n                          âœ•\n                        </button>\n                      </div>\n                    ))}\n                  </div>\n                )}\n\n                {/* Add more photos button */}\n                {photoFiles.length < 5 && (\n                  <div className=\"mb-3\">\n                    <input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      accept=\"image/*\"\n                      multiple\n                      onChange={handlePhotoChange}\n                      className=\"hidden\"\n                      id=\"photo-input\"\n                    />\n                    <label\n                      htmlFor=\"photo-input\"\n                      className=\"block w-full p-8 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl text-center cursor-pointer hover:border-primary hover:bg-primary/5 transition-colors\"\n                    >\n                      <div className=\"text-4xl mb-2\">ğŸ“·</div>\n                      <div className=\"text-sm text-text-secondary\">\n                        Click to add photos (up to 5, max 5MB each)\n                      </div>\n                    </label>\n                  </div>\n                )}\n\n                <button\n                  type=\"button\"\n                  onClick={() => setPhotosExpanded(false)}\n                  className=\"w-full btn btn-secondary text-sm py-2\"\n                >\n                  Done\n                </button>\n              </div>\n            )}\n          </div>\n\n          {/* Submit */}\n          <button\n            type=\"submit\"\n            id=\"create-checkin-submit-btn\"\n            disabled={loading || selectedBesties.length === 0}\n            className=\"w-full btn btn-primary text-lg py-4\"\n          >\n            {loading ? 'Creating...' : 'ğŸ›¡ï¸ Start Check-In'}\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default CreateCheckInPage;\n"],"names":["FEATURES","core","auth","checkIns","besties","templates","quickButtons","celebrationMessages","gpsLocation","manualLocation","extendButtons","bestieCircle","badges","shareableCards","mediaUpload","photoCapture","donations","smsSubscription","emergency","reversePin","liveTracking","videoRecording","facebookLogin","phoneAuth","isEnabled","feature","CheckInLoader","messages","message","useState","Math","floor","random","length","_jsxs","_Fragment","children","className","_jsx","Array","map","_","i","style","left","concat","top","animationDelay","animationDuration","opacity","CreateCheckInPage","currentUser","userData","loading","authLoading","useAuth","navigate","useNavigate","location","useLocation","locationInput","setLocationInput","duration","setDuration","selectedBesties","setSelectedBesties","notes","setNotes","meetingWith","setMeetingWith","socialMediaLinks","setSocialMediaLinks","photoFiles","setPhotoFiles","photoPreviews","setPhotoPreviews","setBesties","setLoading","showingLoader","setShowingLoader","autocompleteLoaded","setAutocompleteLoaded","executeOptimistic","useOptimisticUpdate","gpsCoords","setGpsCoords","mapInitialized","setMapInitialized","mapLocked","setMapLocked","expandedBestieShare","setExpandedBestieShare","notesExpanded","setNotesExpanded","photosExpanded","setPhotosExpanded","shouldAutoSubmit","setShouldAutoSubmit","showLocationDropdown","setShowLocationDropdown","socialMediaExpanded","setSocialMediaExpanded","mapCenter","lat","lng","locationInputRef","useRef","autocompleteRef","fileInputRef","mapRef","mapInstanceRef","useEffect","onboardingCompleted","_location$state","_location$state2","_location$state3","errorTracker","trackFunnelStep","state","quickMinutes","minutes","quickType","quickDuration","rego","meetingWithParam","skipLocation","template","bestieIds","console","group","userDocRef","doc","db","uid","unsubscribe","onSnapshot","async","_location$state4","userDoc","exists","error","groupEnd","featuredIds","data","featuredCircle","warn","requesterQuery","recipientQuery","Promise","all","getDocs","query","collection","where","allBestiesList","forEach","push","id","recipientId","name","recipientName","phone","recipientPhone","email","recipientEmail","requesterId","requesterName","requesterPhone","requesterEmail","circleBesties","filter","b","includes","bestiesWithUserData","getDoc","bestie","_userData$notificatio","_objectSpread","displayName","photoURL","phoneNumber","smsEnabled","notificationPreferences","sms","requestAttention","bestiesWithPhoneAndSMS","cantReceiveAlerts","missingPhone","missingSMS","toast","icon","log","submitBtn","document","querySelector","disabled","click","apiKey","process","REACT_APP_GOOGLE_MAPS_API_KEY","checkGoogleLoaded","window","google","maps","places","attempts","maxAttempts","interval","setInterval","clearInterval","script","createElement","src","defer","loadTimeout","setTimeout","onload","clearTimeout","checkInterval","onerror","head","appendChild","current","Map","retryTimeout","center","zoom","disableDefaultUI","zoomControl","mapTypeControl","streetViewControl","fullscreenControl","draggable","gestureHandling","addListener","event","setOptions","success","getCenter","coords","Geocoder","geocode","results","status","address","formatted_address","coordsString","toFixed","background","color","fontWeight","Autocomplete","types","fields","place","getPlace","displayLocation","geometry","setCenter","setZoom","clearInstanceListeners","handleGetLocation","navigator","geolocation","getCurrentPosition","position","latitude","longitude","dismiss","code","timeout","enableHighAccuracy","maximumAge","handleShareToAddPhone","platform","bestieName","origin","encoded","encodeURIComponent","isMobile","test","userAgent","href","open","clipboard","writeText","then","catch","textEncoded","urlEncoded","onSubmit","e","preventDefault","bestiesWithoutPhone","bestieId","find","trim","hasNotes","optimisticUpdate","serverUpdate","_userData$privacySett","now","Date","alertTime","getTime","photoURLs","file","storageRef","ref","storage","uploadBytes","downloadURL","getDownloadURL","photoError","validPhotoURLs","url","privacyLevel","privacySettings","checkInVisibility","circleSnapshot","checkInData","userId","Timestamp","fromDate","createdAt","lastUpdate","docRef","addDoc","docSnap","Error","savedData","every","rollback","onError","logCustomError","successMessage","errorMessage","showLoadingToast","loadingMessage","join","minHeight","type","value","onChange","target","onFocus","onBlur","placeholder","required","autoComplete","onClick","fill","stroke","viewBox","cx","cy","r","strokeWidth","strokeLinecap","strokeLinejoin","d","title","autoFocus","mins","min","max","step","parseInt","toLocaleTimeString","hour","minute","hour12","selectionIndex","indexOf","isSelected","selectionNumber","isShareExpanded","toggleBestie","ProfileWithBubble","size","showBubble","stopPropagation","onKeyDown","key","shiftKey","blur","preview","index","alt","removePhoto","accept","multiple","files","from","startsWith","newPreviews","URL","createObjectURL","htmlFor"],"sourceRoot":""}