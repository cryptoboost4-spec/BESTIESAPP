"use strict";(self.webpackChunkbesties_frontend=self.webpackChunkbesties_frontend||[]).push([[683],{6683:(e,t,s)=>{s.r(t),s.d(t,{default:()=>m});var r=s(5043),a=s(3216),i=s(4528),l=s(7400),n=s(5472),c=s(8147),o=s(2339),d=s(579);const m=()=>{const{currentUser:e,userData:t}=(0,i.As)(),s=(0,a.Zp)(),[m,x]=(0,r.useState)("welcome"),[h,y]=(0,r.useState)(0),[u,b]=(0,r.useState)(""),[p,g]=(0,r.useState)(!1),[f,j]=(0,r.useState)(!1),[N,w]=(0,r.useState)(!1),[k,v]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=sessionStorage.getItem("inviter_info")||localStorage.getItem("inviter_info");if(e)try{v(JSON.parse(e))}catch(t){console.error("Failed to parse inviter info:",t)}},[]),(0,r.useEffect)(()=>{null!==t&&void 0!==t&&t.displayName&&!u?b(t.displayName):null!==e&&void 0!==e&&e.displayName&&!u&&b(e.displayName)},[t,e,u]);const S=[{emoji:"\ud83d\udc4b",title:"Welcome to Besties!",description:"Your personal safety check-in app that keeps your loved ones informed."},{emoji:"\u23f0",title:"How It Works",description:"Create a check-in with a time limit. If you don't mark yourself safe before time runs out, your besties get alerted."},{emoji:"\ud83d\udc9c",title:"Your Safety Network",description:"Add up to 5 besties to your circle. They'll be notified if you miss a check-in, so they can make sure you're okay."},{emoji:"\ud83d\udcf1",title:"Stay Connected",description:"Your besties get SMS alerts when you miss a check-in. They can also see your location and notes from your last check-in."},{emoji:"\u2728",title:"Let's Get Started!",description:"We'll help you set up your profile and add your first bestie. Then you'll be ready to create your first check-in!"}],C=S[h];(0,r.useEffect)(()=>{"bestie-circle"===m&&e&&I()},[m,e]);const I=async()=>{w(!0);try{if(sessionStorage.getItem("pending_invite")||localStorage.getItem("pending_invite"))for(let e=0;e<6;e++){await new Promise(e=>setTimeout(e,500));if(!(sessionStorage.getItem("pending_invite")||localStorage.getItem("pending_invite")))break}const[t,s]=await Promise.all([(0,n.GG)((0,n.P)((0,n.rJ)(l.db,"besties"),(0,n._M)("requesterId","==",e.uid),(0,n._M)("status","==","accepted"))),(0,n.GG)((0,n.P)((0,n.rJ)(l.db,"besties"),(0,n._M)("recipientId","==",e.uid),(0,n._M)("status","==","accepted")))]);j(!t.empty||!s.empty)}catch(t){console.error("Error checking besties:",t)}finally{w(!1)}},_=async()=>{if(u.trim())try{await(0,n.mZ)((0,n.H9)(l.db,"users",e.uid),{displayName:u.trim()}),x("photo")}catch(t){console.error("Error updating name:",t),o.Ay.error("Failed to update name")}else o.Ay.error("Please enter a name")},Y=async t=>{const s=t.target.files[0];if(!s)return;if(s.size>5242880)return void o.Ay.error("Photo must be less than 5MB");g(!0);const r=o.Ay.loading("Uploading photo...");try{const t=(0,c.KR)(l.IG,"profile-pictures/".concat(e.uid,"/").concat(Date.now(),"_").concat(s.name));await(0,c.D)(t,s);const a=await(0,c.qk)(t);await(0,n.mZ)((0,n.H9)(l.db,"users",e.uid),{photoURL:a}),o.Ay.success("Photo uploaded!",{id:r}),x(k?"invite-welcome":"bestie-circle")}catch(a){console.error("Error uploading photo:",a),o.Ay.error("Failed to upload photo",{id:r})}finally{g(!1)}},A=()=>{x(k?"invite-welcome":"bestie-circle")},P=async()=>{try{await(0,n.mZ)((0,n.H9)(l.db,"users",e.uid),{onboardingCompleted:!0}),s(f?"/create":"/profile")}catch(t){console.error("Error completing onboarding:",t),o.Ay.error("Failed to complete onboarding")}};return"welcome"===m?(0,d.jsx)("div",{className:"min-h-screen bg-gradient-primary flex items-center justify-center p-4",children:(0,d.jsxs)("div",{className:"max-w-md w-full text-center",children:[(0,d.jsx)("div",{className:"text-8xl mb-6 animate-bounce",children:"\ud83d\udc9c"}),(0,d.jsx)("h1",{className:"text-4xl font-display text-white mb-4",children:"Welcome to Besties!"}),(0,d.jsx)("p",{className:"text-xl text-white/90 mb-8",children:"Your personal safety network in your pocket"}),(0,d.jsx)("button",{onClick:()=>x("slides"),className:"btn bg-white dark:bg-gray-800 text-primary hover:bg-white/90 dark:hover:bg-gray-700 text-lg px-8 py-4",children:"Get Started \u2192"})]})}):"slides"===m?(0,d.jsx)("div",{className:"min-h-screen bg-white dark:bg-gray-800 flex flex-col items-center justify-center p-4",children:(0,d.jsxs)("div",{className:"max-w-md w-full text-center",children:[(0,d.jsx)("div",{className:"text-7xl mb-6",children:C.emoji}),(0,d.jsx)("h2",{className:"text-3xl font-display text-gray-800 dark:text-gray-200 mb-4",children:C.title}),(0,d.jsx)("p",{className:"text-lg text-gray-600 dark:text-gray-400 mb-8",children:C.description}),(0,d.jsx)("div",{className:"flex justify-center gap-2 mb-8",children:S.map((e,t)=>(0,d.jsx)("div",{className:"w-2 h-2 rounded-full transition-all ".concat(t===h?"bg-primary w-6":"bg-gray-300 dark:bg-gray-600")},t))}),(0,d.jsx)("div",{className:"flex gap-3",children:h<S.length-1?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{onClick:()=>x("name"),className:"flex-1 btn btn-secondary",children:"Skip"}),(0,d.jsx)("button",{onClick:()=>y(h+1),className:"flex-1 btn btn-primary",children:"Next \u2192"})]}):(0,d.jsx)("button",{onClick:()=>x("name"),className:"w-full btn btn-primary text-lg py-4",children:"Let's check your details! \u2192"})})]})}):"name"===m?(0,d.jsx)("div",{className:"min-h-screen bg-white dark:bg-gray-800 flex items-center justify-center p-4",children:(0,d.jsxs)("div",{className:"max-w-md w-full",children:[(0,d.jsxs)("div",{className:"text-center mb-8",children:[(0,d.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udc64"}),(0,d.jsx)("h2",{className:"text-3xl font-display text-gray-800 dark:text-gray-200 mb-2",children:"Is this name correct?"}),(0,d.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"This is how your besties will see you"})]}),(0,d.jsx)("input",{type:"text",value:u,onChange:e=>b(e.target.value),className:"w-full p-4 border-2 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200 rounded-xl focus:border-primary focus:outline-none text-lg mb-6",placeholder:"Your name"}),(0,d.jsx)("button",{onClick:_,className:"w-full btn btn-primary text-lg py-4",children:"Looks Good! \u2713"})]})}):"photo"===m?(0,d.jsx)("div",{className:"min-h-screen bg-white dark:bg-gray-800 flex items-center justify-center p-4",children:(0,d.jsxs)("div",{className:"max-w-md w-full",children:[(0,d.jsxs)("div",{className:"text-center mb-8",children:[(0,d.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udcf7"}),(0,d.jsx)("h2",{className:"text-3xl font-display text-gray-800 dark:text-gray-200 mb-2",children:"Add a Profile Picture?"}),(0,d.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Help your besties recognize you (optional)"})]}),(null===t||void 0===t?void 0:t.photoURL)&&(0,d.jsx)("div",{className:"mb-6 flex justify-center",children:(0,d.jsx)("img",{src:t.photoURL,alt:"Profile",className:"w-32 h-32 rounded-full object-cover border-4 border-primary"})}),(0,d.jsxs)("label",{className:"block w-full mb-4",children:[(0,d.jsx)("div",{className:"btn btn-primary text-lg py-4 text-center cursor-pointer",children:p?"Uploading...":"\ud83d\udce4 Upload Photo"}),(0,d.jsx)("input",{type:"file",accept:"image/*",onChange:Y,className:"hidden",disabled:p})]}),(0,d.jsx)("button",{onClick:A,className:"w-full btn btn-secondary text-lg py-4",disabled:p,children:"Skip for Now \u2192"})]})}):"invite-welcome"===m&&k?(0,d.jsx)("div",{className:"min-h-screen bg-gradient-secondary flex items-center justify-center p-4",children:(0,d.jsxs)("div",{className:"max-w-md w-full text-center",children:[(0,d.jsx)("div",{className:"text-8xl mb-6 animate-bounce",children:"\ud83d\udc9c"}),k.photoURL?(0,d.jsx)("div",{className:"mb-6 flex justify-center",children:(0,d.jsx)("img",{src:k.photoURL,alt:k.displayName,className:"w-32 h-32 rounded-full object-cover border-4 border-white shadow-xl"})}):(0,d.jsx)("div",{className:"mb-6 flex justify-center",children:(0,d.jsx)("div",{className:"w-32 h-32 rounded-full bg-gradient-primary flex items-center justify-center text-white text-5xl font-display border-4 border-white shadow-xl",children:(null===(G=k.displayName)||void 0===G?void 0:G[0])||"?"})}),(0,d.jsx)("h1",{className:"text-4xl font-display text-white mb-4",children:"Welcome to Besties!"}),(0,d.jsxs)("p",{className:"text-2xl text-white/90 mb-2",children:["You accepted ",(0,d.jsxs)("span",{className:"font-bold",children:[k.displayName,"'s"]})," request"]}),(0,d.jsx)("p",{className:"text-xl text-white/90 mb-8",children:"You are now besties! \ud83c\udf89"}),(0,d.jsx)("button",{onClick:()=>{sessionStorage.removeItem("inviter_info"),localStorage.removeItem("inviter_info"),v(null),x("bestie-circle")},className:"btn bg-white dark:bg-gray-800 text-primary hover:bg-white/90 dark:hover:bg-gray-700 text-lg px-8 py-4",children:"Continue \u2192"})]})}):"bestie-circle"===m?N?(0,d.jsx)("div",{className:"min-h-screen bg-white dark:bg-gray-800 flex items-center justify-center",children:(0,d.jsx)("div",{className:"spinner"})}):(0,d.jsx)("div",{className:"min-h-screen bg-white dark:bg-gray-800 flex items-center justify-center p-4 overflow-y-auto",children:(0,d.jsxs)("div",{className:"max-w-2xl w-full py-8",children:[(0,d.jsxs)("div",{className:"text-center mb-8",children:[(0,d.jsx)("div",{className:"text-6xl mb-4",children:"\u2b50"}),(0,d.jsx)("h2",{className:"text-3xl font-display text-gray-800 dark:text-gray-200 mb-2",children:"Your Bestie Circle"}),(0,d.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"These are the 5 besties who get notified if you miss a check-in."}),!f&&(0,d.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 border-2 border-yellow-300 dark:border-yellow-600 rounded-xl p-4 mb-6",children:(0,d.jsx)("p",{className:"text-sm font-semibold text-yellow-800 dark:text-yellow-200",children:"\u26a0\ufe0f You need at least one bestie to create a check-in"})}),f&&(0,d.jsx)("div",{className:"bg-green-50 dark:bg-green-900/30 border-2 border-green-300 dark:border-green-600 rounded-xl p-4 mb-6",children:(0,d.jsx)("p",{className:"text-sm font-semibold text-green-800 dark:text-green-200",children:"\u2705 Great! You already have a bestie in your circle"})})]}),(0,d.jsxs)("div",{className:"card p-6 mb-6",children:[(0,d.jsx)("h3",{className:"font-display text-lg mb-4 text-center text-gray-800 dark:text-gray-200",children:"How It Works:"}),(0,d.jsxs)("ul",{className:"space-y-3 text-sm text-gray-600 dark:text-gray-400",children:[(0,d.jsxs)("li",{className:"flex gap-3",children:[(0,d.jsx)("span",{className:"text-2xl",children:"1\ufe0f\u20e3"}),(0,d.jsx)("span",{children:"Choose up to 5 besties for your safety circle"})]}),(0,d.jsxs)("li",{className:"flex gap-3",children:[(0,d.jsx)("span",{className:"text-2xl",children:"2\ufe0f\u20e3"}),(0,d.jsx)("span",{children:"They'll get SMS alerts if you miss a check-in"})]}),(0,d.jsxs)("li",{className:"flex gap-3",children:[(0,d.jsx)("span",{className:"text-2xl",children:"3\ufe0f\u20e3"}),(0,d.jsx)("span",{children:"You can change who's in your circle anytime"})]})]})]}),f?(0,d.jsx)("button",{onClick:P,className:"w-full btn btn-primary text-lg py-4",children:"Start Creating Check-Ins! \u2192"}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{onClick:P,className:"w-full btn btn-primary text-lg py-4 mb-3",children:"\u2795 Add Your First Bestie"}),(0,d.jsx)("p",{className:"text-xs text-center text-gray-600 dark:text-gray-400",children:"You'll be taken to your profile. Click on a + button in your bestie circle to continue"})]})]})}):null;var G}}}]);
//# sourceMappingURL=683.5487e4de.chunk.js.map