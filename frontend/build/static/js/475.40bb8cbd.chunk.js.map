{"version":3,"file":"static/js/475.40bb8cbd.chunk.js","mappings":"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","sources":["pages/AdminBackfillPage.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { functions } from '../services/firebase';\r\nimport { httpsCallable } from 'firebase/functions';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst AdminBackfillPage = () => {\r\n  const { userData } = useAuth();\r\n  const [running, setRunning] = useState(false);\r\n  const [result, setResult] = useState(null);\r\n\r\n  const runBackfill = async () => {\r\n    if (!window.confirm('Are you sure you want to run the bestieUserIds backfill? This will update all existing bestie relationships.')) {\r\n      return;\r\n    }\r\n\r\n    setRunning(true);\r\n    setResult(null);\r\n\r\n    try {\r\n      console.log('üöÄ Calling backfill function...');\r\n      const backfillFunc = httpsCallable(functions, 'backfillBestieUserIds');\r\n      const response = await backfillFunc();\r\n\r\n      console.log('‚úÖ Backfill completed:', response.data);\r\n      setResult(response.data);\r\n      toast.success('Backfill completed successfully!');\r\n    } catch (error) {\r\n      console.error('‚ùå Backfill failed:', error);\r\n      toast.error(`Backfill failed: ${error.message}`);\r\n      setResult({\r\n        success: false,\r\n        error: error.message\r\n      });\r\n    } finally {\r\n      setRunning(false);\r\n    }\r\n  };\r\n\r\n  // Check if user is admin\r\n  if (!userData?.isAdmin) {\r\n    return (\r\n      <div className=\"min-h-screen bg-pattern\">\r\n        <div className=\"max-w-4xl mx-auto p-4 pb-20\">\r\n          <div className=\"card p-12 text-center\">\r\n            <div className=\"text-6xl mb-4\">üîí</div>\r\n            <h2 className=\"text-2xl font-display text-text-primary mb-2\">Admin Only</h2>\r\n            <p className=\"text-text-secondary\">\r\n              You must be an admin to access this page\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-pattern\">\r\n\r\n      <div className=\"max-w-4xl mx-auto p-4 pb-20\">\r\n        <div className=\"card p-8\">\r\n          <h1 className=\"text-3xl font-display text-gradient mb-6\">\r\n            üîß Admin Backfill Tools\r\n          </h1>\r\n\r\n          <div className=\"bg-yellow-50 border-2 border-yellow-200 rounded-xl p-6 mb-6\">\r\n            <h2 className=\"text-xl font-display text-yellow-900 mb-3\">\r\n              ‚ö†Ô∏è Backfill bestieUserIds\r\n            </h2>\r\n            <p className=\"text-gray-700 mb-4\">\r\n              This will populate the <code className=\"bg-yellow-100 px-2 py-1 rounded\">bestieUserIds</code> array\r\n              for all existing accepted bestie relationships.\r\n            </p>\r\n            <div className=\"bg-white rounded-lg p-4 mb-4\">\r\n              <h3 className=\"font-semibold mb-2\">What this does:</h3>\r\n              <ul className=\"list-disc list-inside space-y-1 text-sm text-gray-700\">\r\n                <li>Queries all accepted besties in the database</li>\r\n                <li>For each bestie pair, adds both users to each other's bestieUserIds array</li>\r\n                <li>Enables besties to view each other's profiles (required by Firebase rules)</li>\r\n                <li>Safe to run multiple times (won't create duplicates)</li>\r\n              </ul>\r\n            </div>\r\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4\">\r\n              <h3 className=\"font-semibold text-blue-900 mb-2\">üí° When to use this:</h3>\r\n              <p className=\"text-sm text-blue-800\">\r\n                Run this if besties can't view each other's profiles or see bestie data.\r\n                This typically happens if the onCreate Cloud Function wasn't deployed when\r\n                bestie relationships were created.\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <button\r\n            onClick={runBackfill}\r\n            disabled={running}\r\n            className={`w-full py-4 px-6 rounded-xl font-semibold text-lg transition-all ${\r\n              running\r\n                ? 'bg-gray-400 cursor-not-allowed'\r\n                : 'bg-gradient-primary hover:scale-105 shadow-lg'\r\n            } text-white`}\r\n          >\r\n            {running ? (\r\n              <span className=\"flex items-center justify-center gap-3\">\r\n                <div className=\"spinner\"></div>\r\n                Running backfill...\r\n              </span>\r\n            ) : (\r\n              '‚ñ∂Ô∏è Run Backfill Now'\r\n            )}\r\n          </button>\r\n\r\n          {result && (\r\n            <div className={`mt-6 p-6 rounded-xl ${\r\n              result.success ? 'bg-green-50 border-2 border-green-200' : 'bg-red-50 border-2 border-red-200'\r\n            }`}>\r\n              <h3 className={`text-xl font-display mb-4 ${\r\n                result.success ? 'text-green-900' : 'text-red-900'\r\n              }`}>\r\n                {result.success ? '‚úÖ Success!' : '‚ùå Failed'}\r\n              </h3>\r\n\r\n              {result.success && (\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div className=\"bg-white rounded-lg p-4\">\r\n                      <div className=\"text-3xl font-bold text-green-700\">{result.processed || 0}</div>\r\n                      <div className=\"text-sm text-gray-600\">Besties Processed</div>\r\n                    </div>\r\n                    <div className=\"bg-white rounded-lg p-4\">\r\n                      <div className=\"text-3xl font-bold text-blue-700\">{result.updated || 0}</div>\r\n                      <div className=\"text-sm text-gray-600\">Successfully Updated</div>\r\n                    </div>\r\n                    <div className=\"bg-white rounded-lg p-4\">\r\n                      <div className=\"text-3xl font-bold text-yellow-700\">{result.skipped || 0}</div>\r\n                      <div className=\"text-sm text-gray-600\">Skipped</div>\r\n                    </div>\r\n                    <div className=\"bg-white rounded-lg p-4\">\r\n                      <div className=\"text-3xl font-bold text-red-700\">{result.errors?.length || 0}</div>\r\n                      <div className=\"text-sm text-gray-600\">Errors</div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {result.errors && result.errors.length > 0 && (\r\n                    <div className=\"bg-white rounded-lg p-4\">\r\n                      <h4 className=\"font-semibold text-red-900 mb-2\">Errors:</h4>\r\n                      <ul className=\"text-sm text-gray-700 space-y-1\">\r\n                        {result.errors.map((err, idx) => (\r\n                          <li key={idx}>\r\n                            Bestie {err.bestieId}: {err.error}\r\n                          </li>\r\n                        ))}\r\n                      </ul>\r\n                    </div>\r\n                  )}\r\n\r\n                  <p className=\"text-green-800 font-semibold mt-4\">\r\n                    üéâ All besties should now be able to view each other's profiles!\r\n                  </p>\r\n                </div>\r\n              )}\r\n\r\n              {!result.success && (\r\n                <div className=\"text-red-800\">\r\n                  <p className=\"font-semibold mb-2\">Error:</p>\r\n                  <pre className=\"bg-white p-4 rounded overflow-auto text-sm\">\r\n                    {result.error || JSON.stringify(result, null, 2)}\r\n                  </pre>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminBackfillPage;\r\n"],"names":["AdminBackfillPage","_result$errors","userData","useAuth","running","setRunning","useState","result","setResult","isAdmin","_jsx","className","children","_jsxs","onClick","async","window","confirm","console","log","backfillFunc","httpsCallable","functions","response","data","toast","success","error","concat","message","disabled","processed","updated","skipped","errors","length","map","err","idx","bestieId","JSON","stringify"],"sourceRoot":""}