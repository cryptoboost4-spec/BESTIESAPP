"use strict";(self.webpackChunkbesties_frontend=self.webpackChunkbesties_frontend||[]).push([[211],{4211:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var r=a(2555),s=a(5043),d=a(3216),c=a(4528),n=a(7400),i=a(5472),l=a(9202),x=a(559),o=a(579);const m=()=>{var e,t,a;const m=(0,d.Zp)(),{currentUser:h,userData:k}=(0,c.As)(),[p,u]=(0,s.useState)([]),[v,y]=(0,s.useState)(!0),[b,j]=(0,s.useState)(!1),[g,N]=(0,s.useState)("all"),[f,w]=(0,s.useState)(null),[A,C]=(0,s.useState)(!0);(0,s.useEffect)(()=>{M()},[h,g]);const M=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(h){e?j(!0):(y(!0),u([]),w(null),C(!0));try{let t=(0,i.P)((0,i.rJ)(n.db,"checkins"),(0,i._M)("userId","==",h.uid),(0,i.My)("createdAt","desc"),(0,i.AB)(20));"completed"===g?t=(0,i.P)((0,i.rJ)(n.db,"checkins"),(0,i._M)("userId","==",h.uid),(0,i._M)("status","==","completed"),(0,i.My)("createdAt","desc"),(0,i.AB)(20)):"alerted"===g&&(t=(0,i.P)((0,i.rJ)(n.db,"checkins"),(0,i._M)("userId","==",h.uid),(0,i._M)("status","==","alerted"),(0,i.My)("createdAt","desc"),(0,i.AB)(20))),e&&f&&(t=(0,i.P)(t,(0,i.HM)(f)));const a=await(0,i.GG)(t),s=[];a.forEach(e=>{s.push((0,r.A)({id:e.id},e.data()))}),u(e?e=>[...e,...s]:s),w(a.docs[a.docs.length-1]||null),C(20===s.length),y(!1),j(!1)}catch(t){console.error("Error loading history:",t),e||u([]),y(!1),j(!1)}}},S=e=>{switch(e){case"completed":return(0,o.jsx)("span",{className:"badge badge-success",children:"\u2705 Safe"});case"alerted":return(0,o.jsx)("span",{className:"badge badge-warning",children:"\ud83d\udea8 Alerted"});case"active":return(0,o.jsx)("span",{className:"badge badge-primary",children:"\u23f0 Active"});default:return(0,o.jsx)("span",{className:"badge",children:"Unknown"})}},B=e=>{if(e<60)return"".concat(e,"m");const t=Math.floor(e/60),a=e%60;return a>0?"".concat(t,"h ").concat(a,"m"):"".concat(t,"h")};return v?(0,o.jsxs)("div",{className:"min-h-screen bg-pattern dark:bg-dark-pattern",children:[(0,o.jsx)(x.A,{}),(0,o.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,o.jsx)("div",{className:"spinner"})})]}):(0,o.jsxs)("div",{className:"min-h-screen bg-pattern dark:bg-dark-pattern",children:[(0,o.jsx)(x.A,{}),(0,o.jsxs)("div",{className:"max-w-4xl mx-auto p-4 pb-20",children:[(0,o.jsxs)("button",{onClick:()=>m(-1),className:"flex items-center gap-2 text-primary dark:text-dark-primary hover:underline mb-4 font-semibold",children:[(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]}),(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("h1",{className:"text-3xl font-display text-text-primary dark:text-dark-text-primary mb-2",children:"Check-in History"}),(0,o.jsx)("p",{className:"text-text-secondary dark:text-dark-text-secondary",children:"View all your past check-ins"})]}),(0,o.jsxs)("div",{className:"flex gap-2 mb-6 overflow-x-auto pb-2",children:[(0,o.jsx)("button",{onClick:()=>N("all"),className:"px-4 py-2 rounded-full font-semibold whitespace-nowrap transition-all ".concat("all"===g?"bg-primary text-white":"bg-white dark:bg-dark-card text-text-primary dark:text-dark-text-primary hover:bg-gray-50 dark:hover:bg-dark-hover"),children:"All"}),(0,o.jsx)("button",{onClick:()=>N("completed"),className:"px-4 py-2 rounded-full font-semibold whitespace-nowrap transition-all ".concat("completed"===g?"bg-success text-white":"bg-white dark:bg-dark-card text-text-primary dark:text-dark-text-primary hover:bg-gray-50 dark:hover:bg-dark-hover"),children:"\u2705 Safe"}),(0,o.jsx)("button",{onClick:()=>N("alerted"),className:"px-4 py-2 rounded-full font-semibold whitespace-nowrap transition-all ".concat("alerted"===g?"bg-warning text-white":"bg-white dark:bg-dark-card text-text-primary dark:text-dark-text-primary hover:bg-gray-50 dark:hover:bg-dark-hover"),children:"\ud83d\udea8 Alerted"})]}),(0,o.jsx)("div",{className:"card dark:bg-dark-card p-6 mb-6",children:(0,o.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"text-2xl font-display text-primary dark:text-dark-primary",children:(null===k||void 0===k||null===(e=k.stats)||void 0===e?void 0:e.totalCheckIns)||0}),(0,o.jsx)("div",{className:"text-sm text-text-secondary dark:text-dark-text-secondary",children:"Total"})]}),(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"text-2xl font-display text-success dark:text-dark-success",children:(null===k||void 0===k||null===(t=k.stats)||void 0===t?void 0:t.completedCheckIns)||0}),(0,o.jsx)("div",{className:"text-sm text-text-secondary dark:text-dark-text-secondary",children:"Completed"})]}),(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"text-2xl font-display text-warning dark:text-dark-warning",children:(null===k||void 0===k||null===(a=k.stats)||void 0===a?void 0:a.alertedCheckIns)||0}),(0,o.jsx)("div",{className:"text-sm text-text-secondary dark:text-dark-text-secondary",children:"Alerted"})]})]})}),0===p.length?(0,o.jsxs)("div",{className:"card dark:bg-dark-card p-12 text-center",children:[(0,o.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udccb"}),(0,o.jsx)("h2",{className:"text-2xl font-display text-text-primary dark:text-dark-text-primary mb-2",children:"No check-ins yet"}),(0,o.jsx)("p",{className:"text-text-secondary dark:text-dark-text-secondary",children:"Your check-in history will appear here"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"space-y-4",children:p.map(e=>{var t;return(0,o.jsxs)("div",{className:"card dark:bg-dark-card p-6",children:[(0,o.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,o.jsxs)("div",{className:"flex-1",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,o.jsx)("h3",{className:"font-display text-lg text-text-primary dark:text-dark-text-primary",children:e.location}),S(e.status)]}),(0,o.jsx)("div",{className:"text-sm text-text-secondary dark:text-dark-text-secondary",children:e.createdAt&&(0,l.m)(e.createdAt.toDate(),{addSuffix:!0})})]})}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"text-text-secondary dark:text-dark-text-secondary",children:"Duration"}),(0,o.jsx)("div",{className:"font-semibold text-text-primary dark:text-dark-text-primary",children:B(e.duration)})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"text-text-secondary dark:text-dark-text-secondary",children:"Besties Notified"}),(0,o.jsx)("div",{className:"font-semibold text-text-primary dark:text-dark-text-primary",children:(null===(t=e.bestieIds)||void 0===t?void 0:t.length)||0})]})]}),e.notes&&(0,o.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-dark-border",children:(0,o.jsxs)("div",{className:"text-sm text-text-secondary dark:text-dark-text-secondary italic",children:['"',e.notes,'"']})}),e.completedAt&&(0,o.jsxs)("div",{className:"mt-3 text-xs text-success dark:text-dark-success",children:["\u2705 Completed ",(0,l.m)(e.completedAt.toDate(),{addSuffix:!0})]}),e.alertedAt&&(0,o.jsxs)("div",{className:"mt-3 text-xs text-warning dark:text-dark-warning",children:["\ud83d\udea8 Alert sent ",(0,l.m)(e.alertedAt.toDate(),{addSuffix:!0})]})]},e.id)})}),A&&(0,o.jsx)("div",{className:"mt-6 text-center",children:(0,o.jsx)("button",{onClick:()=>{M(!0)},disabled:b,className:"btn btn-secondary px-8",children:b?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"spinner-small mr-2"}),"Loading..."]}):"Load More (".concat(20," at a time)")})}),!A&&p.length>0&&(0,o.jsx)("div",{className:"mt-6 text-center text-text-secondary dark:text-dark-text-secondary text-sm",children:"You've reached the end of your check-in history"})]}),(0,o.jsx)("div",{className:"mt-8 text-center",children:(0,o.jsxs)("button",{onClick:()=>m(-1),className:"inline-flex items-center gap-2 text-primary dark:text-dark-primary hover:underline font-semibold",children:[(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]})})]})]})}}}]);
//# sourceMappingURL=211.3b433308.chunk.js.map