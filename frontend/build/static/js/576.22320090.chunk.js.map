{"version":3,"file":"static/js/576.22320090.chunk.js","mappings":"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","sources":["utils/phoneUtils.js","services/notificationService.js","services/profileCompletionService.js","components/ProfileCompletionModal.jsx","pages/EditProfilePage.jsx","components/ConfettiCelebration.jsx"],"sourcesContent":["/**\r\n * Phone number utility functions for E.164 formatting\r\n * E.164 format: +[country code][phone number]\r\n * Example: +61412345678\r\n */\r\n\r\n/**\r\n * Format a phone number to E.164 standard\r\n * @param {string} phoneNumber - The phone number to format\r\n * @param {string} countryCode - The country code (e.g., '+61', '+1')\r\n * @returns {string} - Formatted phone number in E.164 format\r\n */\r\nexport const formatToE164 = (phoneNumber, countryCode = '+1') => {\r\n  if (!phoneNumber) return '';\r\n\r\n  // If already in E.164 format (starts with +), return as is\r\n  if (phoneNumber.startsWith('+')) {\r\n    return phoneNumber.replace(/\\s/g, '');\r\n  }\r\n\r\n  // Remove all non-digit characters\r\n  const digitsOnly = phoneNumber.replace(/\\D/g, '');\r\n\r\n  // If empty after cleaning, return empty string\r\n  if (!digitsOnly) return '';\r\n\r\n  // Add country code if not present\r\n  return `${countryCode}${digitsOnly}`;\r\n};\r\n\r\n/**\r\n * Detect country code from phone number\r\n * @param {string} phoneNumber - The phone number\r\n * @returns {string} - Detected country code or default '+1'\r\n */\r\nexport const detectCountryCode = (phoneNumber) => {\r\n  if (!phoneNumber) return '+1';\r\n\r\n  if (phoneNumber.startsWith('+1')) return '+1';\r\n  if (phoneNumber.startsWith('+44')) return '+44';\r\n  if (phoneNumber.startsWith('+61')) return '+61';\r\n  if (phoneNumber.startsWith('+91')) return '+91';\r\n\r\n  // Default to US/Canada\r\n  return '+1';\r\n};\r\n\r\n/**\r\n * Parse E.164 phone number to separate country code and number\r\n * @param {string} e164Number - Phone number in E.164 format\r\n * @returns {object} - { countryCode, phoneNumber }\r\n */\r\nexport const parseE164 = (e164Number) => {\r\n  if (!e164Number || !e164Number.startsWith('+')) {\r\n    return { countryCode: '+1', phoneNumber: e164Number || '' };\r\n  }\r\n\r\n  // Try to match known country codes\r\n  if (e164Number.startsWith('+1')) {\r\n    return { countryCode: '+1', phoneNumber: e164Number.slice(2) };\r\n  }\r\n  if (e164Number.startsWith('+44')) {\r\n    return { countryCode: '+44', phoneNumber: e164Number.slice(3) };\r\n  }\r\n  if (e164Number.startsWith('+61')) {\r\n    return { countryCode: '+61', phoneNumber: e164Number.slice(3) };\r\n  }\r\n  if (e164Number.startsWith('+91')) {\r\n    return { countryCode: '+91', phoneNumber: e164Number.slice(3) };\r\n  }\r\n\r\n  // Fallback: assume first 1-3 digits are country code\r\n  const match = e164Number.match(/^\\+(\\d{1,3})(.*)$/);\r\n  if (match) {\r\n    return { countryCode: `+${match[1]}`, phoneNumber: match[2] };\r\n  }\r\n\r\n  return { countryCode: '+1', phoneNumber: e164Number };\r\n};\r\n\r\n/**\r\n * Display phone number in a user-friendly format\r\n * @param {string} e164Number - Phone number in E.164 format\r\n * @returns {string} - Formatted display string\r\n */\r\nexport const formatForDisplay = (e164Number) => {\r\n  if (!e164Number) return '';\r\n\r\n  const { countryCode, phoneNumber } = parseE164(e164Number);\r\n\r\n  // Format based on country\r\n  if (countryCode === '+1') {\r\n    // US/Canada: +1 (555) 123-4567\r\n    if (phoneNumber.length === 10) {\r\n      return `${countryCode} (${phoneNumber.slice(0, 3)}) ${phoneNumber.slice(3, 6)}-${phoneNumber.slice(6)}`;\r\n    }\r\n  } else if (countryCode === '+61') {\r\n    // Australia: +61 412 345 678\r\n    if (phoneNumber.length === 9) {\r\n      return `${countryCode} ${phoneNumber.slice(0, 3)} ${phoneNumber.slice(3, 6)} ${phoneNumber.slice(6)}`;\r\n    }\r\n  } else if (countryCode === '+44') {\r\n    // UK: +44 7911 123456\r\n    if (phoneNumber.length === 10) {\r\n      return `${countryCode} ${phoneNumber.slice(0, 4)} ${phoneNumber.slice(4)}`;\r\n    }\r\n  } else if (countryCode === '+91') {\r\n    // India: +91 98765 43210\r\n    if (phoneNumber.length === 10) {\r\n      return `${countryCode} ${phoneNumber.slice(0, 5)} ${phoneNumber.slice(5)}`;\r\n    }\r\n  }\r\n\r\n  // Fallback: just add space after country code\r\n  return `${countryCode} ${phoneNumber}`;\r\n};\r\n\r\n/**\r\n * Validate E.164 phone number\r\n * @param {string} phoneNumber - Phone number to validate\r\n * @returns {boolean} - True if valid E.164 format\r\n */\r\nexport const isValidE164 = (phoneNumber) => {\r\n  if (!phoneNumber) return false;\r\n\r\n  // E.164 format: + followed by 1-15 digits\r\n  const e164Regex = /^\\+[1-9]\\d{1,14}$/;\r\n  return e164Regex.test(phoneNumber);\r\n};\r\n\r\n/**\r\n * Normalize phone number from various formats to E.164\r\n * Handles common Australian formats:\r\n * - 0412 345 678 -> +61412345678\r\n * - 04 1234 5678 -> +61412345678\r\n * - 412345678 -> +61412345678\r\n */\r\nexport const normalizeAustralianPhone = (phoneNumber) => {\r\n  if (!phoneNumber) return '';\r\n\r\n  // Already in E.164\r\n  if (phoneNumber.startsWith('+61')) {\r\n    return phoneNumber.replace(/\\s/g, '');\r\n  }\r\n\r\n  // Remove all non-digits\r\n  const digitsOnly = phoneNumber.replace(/\\D/g, '');\r\n\r\n  // If starts with 0, remove it (Australian mobile numbers)\r\n  const withoutLeadingZero = digitsOnly.startsWith('0') ? digitsOnly.slice(1) : digitsOnly;\r\n\r\n  // Add +61\r\n  return `+61${withoutLeadingZero}`;\r\n};\r\n\r\nconst phoneUtils = {\r\n  formatToE164,\r\n  detectCountryCode,\r\n  parseE164,\r\n  formatForDisplay,\r\n  isValidE164,\r\n  normalizeAustralianPhone,\r\n};\r\n\r\nexport default phoneUtils;\r\n","import { db } from './firebase';\r\nimport { collection, addDoc, serverTimestamp } from 'firebase/firestore';\r\n\r\n/**\r\n * Notification Types:\r\n * - bestie_request: Someone sent you a bestie request\r\n * - check_in_alert: A bestie missed their check-in\r\n * - missed_check_in: You missed a check-in\r\n * - request_attention: A bestie is requesting attention\r\n * - badge_earned: You earned a new badge\r\n * - system: System messages and announcements\r\n */\r\n\r\nclass NotificationService {\r\n  /**\r\n   * Create a notification for a user\r\n   * @param {string} userId - The user ID to send notification to\r\n   * @param {string} type - Type of notification (bestie_request, check_in_alert, etc.)\r\n   * @param {string} title - Notification title\r\n   * @param {string} message - Notification message\r\n   * @param {object} metadata - Optional metadata (bestieId, checkInId, etc.)\r\n   */\r\n  async createNotification(userId, type, title, message, metadata = {}) {\r\n    try {\r\n      await addDoc(collection(db, 'notifications'), {\r\n        userId,\r\n        type,\r\n        title,\r\n        message,\r\n        read: false,\r\n        createdAt: serverTimestamp(),\r\n        ...metadata,\r\n      });\r\n    } catch (error) {\r\n      console.error('Error creating notification:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send a bestie request notification\r\n   */\r\n  async notifyBestieRequest(userId, requesterName) {\r\n    return this.createNotification(\r\n      userId,\r\n      'bestie_request',\r\n      'New Bestie Request',\r\n      `${requesterName} wants to be your bestie!`,\r\n      { requesterName }\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Send a check-in alert notification\r\n   */\r\n  async notifyCheckInAlert(userId, bestieName, checkInId) {\r\n    return this.createNotification(\r\n      userId,\r\n      'check_in_alert',\r\n      'Check-in Alert',\r\n      `${bestieName} hasn't checked in yet. They might need help.`,\r\n      { bestieName, checkInId }\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Send a missed check-in notification\r\n   */\r\n  async notifyMissedCheckIn(userId, checkInId) {\r\n    return this.createNotification(\r\n      userId,\r\n      'missed_check_in',\r\n      'Missed Check-in',\r\n      'You missed your check-in. Your besties were notified.',\r\n      { checkInId }\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Send a request attention notification\r\n   * Note: Notifications can only be created by Cloud Functions per security rules\r\n   * This will fail silently - notifications should be created server-side\r\n   */\r\n  async notifyRequestAttention(userId, bestieName, bestieId) {\r\n    try {\r\n      // Security rules prevent direct creation - this will fail\r\n      // TODO: Create a Cloud Function for this or update security rules\r\n      return this.createNotification(\r\n        userId,\r\n        'request_attention',\r\n        'Someone Needs You',\r\n        `${bestieName} is requesting your attention`,\r\n        { bestieName, bestieId }\r\n      );\r\n    } catch (error) {\r\n      // Silently fail - notifications should be created via Cloud Function\r\n      console.warn('Notification creation failed (expected - should use Cloud Function):', error.message);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send a badge earned notification\r\n   */\r\n  async notifyBadgeEarned(userId, badgeName, badgeDescription) {\r\n    return this.createNotification(\r\n      userId,\r\n      'badge_earned',\r\n      'New Badge Unlocked!',\r\n      `You earned the \"${badgeName}\" badge! ${badgeDescription}`,\r\n      { badgeName, badgeDescription }\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Send a system notification\r\n   */\r\n  async notifySystem(userId, title, message) {\r\n    return this.createNotification(\r\n      userId,\r\n      'system',\r\n      title,\r\n      message\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Send welcome notification to new users\r\n   */\r\n  async notifyWelcome(userId, displayName) {\r\n    return this.createNotification(\r\n      userId,\r\n      'system',\r\n      `Welcome to Besties, ${displayName}!`,\r\n      'Start by adding your first bestie and creating a check-in. We\\'ve got your back!'\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Send notification when a bestie accepts your request\r\n   */\r\n  async notifyBestieAccepted(userId, bestieName) {\r\n    return this.createNotification(\r\n      userId,\r\n      'bestie_request',\r\n      'Bestie Request Accepted!',\r\n      `${bestieName} accepted your bestie request. Stay safe together!`,\r\n      { bestieName }\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Send notification when a check-in is completed successfully\r\n   */\r\n  async notifyCheckInComplete(userId, checkInName) {\r\n    return this.createNotification(\r\n      userId,\r\n      'check_in_alert',\r\n      'Check-in Complete',\r\n      `Great job! You completed \"${checkInName}\" safely.`,\r\n      { checkInName }\r\n    );\r\n  }\r\n}\r\n\r\nexport const notificationService = new NotificationService();\r\nexport default notificationService;\r\n","import { db } from './firebase';\r\nimport { doc, getDoc, setDoc, updateDoc, arrayUnion } from 'firebase/firestore';\r\nimport { notificationService } from './notificationService';\r\n\r\n/**\r\n * Check if user's profile is 100% complete\r\n * @param {object} userData - User data from Firestore\r\n * @param {object} currentUser - Firebase auth user\r\n * @param {number} bestiesCount - Number of accepted besties\r\n * @returns {boolean} - True if profile is 100% complete\r\n */\r\nexport const isProfileComplete = (userData, currentUser, bestiesCount) => {\r\n  const hasEmail = !!currentUser?.email;\r\n  const hasPhone = !!userData?.phoneNumber;\r\n  const hasPhoto = !!userData?.photoURL;\r\n  const hasBio = !!userData?.profile?.bio;\r\n  const hasBesties = bestiesCount >= 5;\r\n\r\n  return hasEmail && hasPhone && hasPhoto && hasBio && hasBesties;\r\n};\r\n\r\n/**\r\n * Award the Profile Perfectionist badge when profile is 100% complete\r\n * @param {string} userId - User ID\r\n * @returns {Promise<boolean>} - True if badge was awarded (first time), false if already had it\r\n */\r\nexport const awardProfileCompletionBadge = async (userId) => {\r\n  try {\r\n    const BADGE_ID = 'profile_perfectionist';\r\n    const badgeDoc = await getDoc(doc(db, 'badges', userId));\r\n\r\n    // Check if user already has this badge\r\n    if (badgeDoc.exists()) {\r\n      const existingBadges = badgeDoc.data().badges || [];\r\n      const alreadyHasBadge = existingBadges.some(b => b.id === BADGE_ID);\r\n\r\n      if (alreadyHasBadge) {\r\n        return false; // Already has the badge, don't celebrate again\r\n      }\r\n\r\n      // Add the badge\r\n      await updateDoc(doc(db, 'badges', userId), {\r\n        badges: arrayUnion({\r\n          id: BADGE_ID,\r\n          name: 'Profile Perfectionist',\r\n          description: 'Completed your full profile - ready to connect!',\r\n          icon: '‚≠ê',\r\n          earnedAt: new Date(),\r\n          category: 'profile'\r\n        })\r\n      });\r\n    } else {\r\n      // Create badges document with the profile completion badge\r\n      await setDoc(doc(db, 'badges', userId), {\r\n        badges: [{\r\n          id: BADGE_ID,\r\n          name: 'Profile Perfectionist',\r\n          description: 'Completed your full profile - ready to connect!',\r\n          icon: '‚≠ê',\r\n          earnedAt: new Date(),\r\n          category: 'profile'\r\n        }]\r\n      });\r\n    }\r\n\r\n    // Send notification\r\n    await notificationService.notifyBadgeEarned(\r\n      userId,\r\n      'Profile Perfectionist',\r\n      'You completed your entire profile! You\\'re all set to stay safe with your besties.'\r\n    );\r\n\r\n    return true; // Badge was awarded for the first time\r\n  } catch (error) {\r\n    console.error('Error awarding profile completion badge:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Check and award badge if profile becomes complete\r\n * This should be called after profile updates\r\n * @param {string} userId - User ID\r\n * @param {object} userData - Updated user data\r\n * @param {object} currentUser - Firebase auth user\r\n * @param {number} bestiesCount - Number of accepted besties\r\n * @returns {Promise<boolean>} - True if badge was awarded (trigger celebration!)\r\n */\r\nexport const checkAndAwardProfileCompletion = async (userId, userData, currentUser, bestiesCount) => {\r\n  const profileComplete = isProfileComplete(userData, currentUser, bestiesCount);\r\n\r\n  if (profileComplete) {\r\n    const wasAwarded = await awardProfileCompletionBadge(userId);\r\n    return wasAwarded; // Return true only if it's the first time\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\nconst profileCompletionService = {\r\n  isProfileComplete,\r\n  awardProfileCompletionBadge,\r\n  checkAndAwardProfileCompletion\r\n};\r\n\r\nexport default profileCompletionService;\r\n","import React, { useEffect, useState } from 'react';\r\nimport ConfettiCelebration from './ConfettiCelebration';\r\n\r\nconst ProfileCompletionModal = ({ isOpen, onClose }) => {\r\n  const [showConfetti, setShowConfetti] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setShowConfetti(true);\r\n      // Auto-close confetti after 5 seconds\r\n      const timer = setTimeout(() => {\r\n        setShowConfetti(false);\r\n      }, 5000);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <>\r\n      {/* Confetti */}\r\n      {showConfetti && <ConfettiCelebration />}\r\n\r\n      {/* Modal Overlay */}\r\n      <div className=\"fixed inset-0 bg-black/60 dark:bg-black/75 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in\">\r\n        {/* Modal Card */}\r\n        <div className=\"card max-w-lg w-full p-8 animate-scale-up relative overflow-hidden bg-white dark:bg-gray-800\">\r\n          {/* Floating decorative elements */}\r\n          <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\r\n            <div className=\"absolute top-6 left-6 text-3xl animate-float opacity-60\">‚≠ê</div>\r\n            <div className=\"absolute top-10 right-8 text-2xl animate-float delay-1s opacity-50\">üí´</div>\r\n            <div className=\"absolute bottom-10 left-10 text-2xl animate-float delay-2s opacity-60\">‚ú®</div>\r\n            <div className=\"absolute bottom-6 right-6 text-3xl animate-float delay-3s opacity-50\">üéâ</div>\r\n          </div>\r\n\r\n          <div className=\"relative z-10 text-center\">\r\n            {/* Badge Icon */}\r\n            <div className=\"inline-flex items-center justify-center w-24 h-24 bg-gradient-to-br from-yellow-200 to-yellow-400 rounded-full mb-6 shadow-2xl animate-bounce-slow\">\r\n              <span className=\"text-5xl\">‚≠ê</span>\r\n            </div>\r\n\r\n            {/* Congratulations Text */}\r\n            <h2 className=\"text-4xl font-display bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent mb-3\">\r\n              Congratulations!\r\n            </h2>\r\n\r\n            <h3 className=\"text-2xl font-display text-text-primary dark:text-white mb-4\">\r\n              Profile Perfectionist Unlocked!\r\n            </h3>\r\n\r\n            <p className=\"text-lg text-text-secondary dark:text-gray-300 mb-6 max-w-md mx-auto\">\r\n              You've completed your entire profile! Your besties can now see all your info, and you're all set to stay safe together.\r\n            </p>\r\n\r\n            {/* Badge Display */}\r\n            <div className=\"inline-block bg-gradient-to-br from-pink-50 to-purple-50 dark:from-pink-900/30 dark:to-purple-900/30 rounded-2xl p-6 mb-6 border-2 border-pink-200 dark:border-pink-700 shadow-xl\">\r\n              <div className=\"text-5xl mb-2\">‚≠ê</div>\r\n              <div className=\"text-xl font-display text-text-primary dark:text-white mb-1\">Profile Perfectionist</div>\r\n              <div className=\"text-sm text-text-secondary dark:text-gray-300\">\r\n                Completed your full profile\r\n              </div>\r\n            </div>\r\n\r\n            {/* Fun Stats */}\r\n            <div className=\"bg-gradient-to-r from-pink-100 to-purple-100 dark:from-pink-900/40 dark:to-purple-900/40 rounded-xl p-4 mb-6 border border-pink-200 dark:border-pink-800\">\r\n              <div className=\"text-sm font-semibold text-text-primary dark:text-white mb-2\">\r\n                üéØ Profile Complete! Here's what you unlocked:\r\n              </div>\r\n              <div className=\"space-y-1 text-xs text-text-secondary dark:text-gray-300\">\r\n                <div>‚úÖ Full profile visibility to your besties</div>\r\n                <div>‚úÖ Profile Perfectionist badge</div>\r\n                <div>‚úÖ Priority support access</div>\r\n                <div>‚úÖ Shareable profile cards</div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Action Button */}\r\n            <button\r\n              onClick={onClose}\r\n              className=\"btn btn-primary w-full max-w-xs mx-auto shadow-lg hover:shadow-xl transition-all\"\r\n            >\r\n              Awesome! Let's Go! üéâ\r\n            </button>\r\n\r\n            <p className=\"text-xs text-text-secondary dark:text-gray-400 mt-4\">\r\n              Check your Notifications to see your new badge\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ProfileCompletionModal;\r\n","/* =================================================================\r\n   ‚ö†Ô∏è  AI PROTECTION: DO NOT EDIT THIS FILE ‚ö†Ô∏è\r\n   Profile Editor - Do not modify unless explicitly told by the user\r\n   ================================================================= */\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { db, storage, authService } from '../services/firebase';\r\nimport { doc, updateDoc, collection, query, where, getDocs } from 'firebase/firestore';\r\nimport { ref, uploadBytes, getDownloadURL } from 'firebase/storage';\r\nimport toast from 'react-hot-toast';\r\nimport { isValidE164 } from '../utils/phoneUtils';\r\nimport { checkAndAwardProfileCompletion } from '../services/profileCompletionService';\r\nimport ProfileCompletionModal from '../components/ProfileCompletionModal';\r\n\r\nconst EditProfilePage = () => {\r\n  const { currentUser, userData } = useAuth();\r\n  const navigate = useNavigate();\r\n\r\n  const [displayName, setDisplayName] = useState(userData?.displayName || '');\r\n  const [bio, setBio] = useState(userData?.profile?.bio || '');\r\n  const [birthdate, setBirthdate] = useState(userData?.profile?.birthdate || '');\r\n  const [phoneNumber, setPhoneNumber] = useState(userData?.phoneNumber || '');\r\n  const [profilePicture, setProfilePicture] = useState(null);\r\n  const [previewUrl, setPreviewUrl] = useState(userData?.photoURL || null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Auto-scroll to section based on hash\r\n  useEffect(() => {\r\n    const hash = window.location.hash.slice(1); // Remove #\r\n    if (hash) {\r\n      // Wait for content to render\r\n      setTimeout(() => {\r\n        const element = document.getElementById(hash);\r\n        if (element) {\r\n          element.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n          // Optional: highlight the section briefly\r\n          element.style.transition = 'background-color 0.3s';\r\n          element.style.backgroundColor = 'rgba(168, 85, 247, 0.1)';\r\n          setTimeout(() => {\r\n            element.style.backgroundColor = '';\r\n          }, 2000);\r\n        }\r\n      }, 100);\r\n    }\r\n  }, []);\r\n\r\n  // Phone verification states\r\n  const [showPhoneVerification, setShowPhoneVerification] = useState(false);\r\n  const [verificationCode, setVerificationCode] = useState('');\r\n  const [phoneConfirmationResult, setPhoneConfirmationResult] = useState(null);\r\n  const [pendingPhoneNumber, setPendingPhoneNumber] = useState('');\r\n\r\n  // Profile completion celebration\r\n  const [showCompletionModal, setShowCompletionModal] = useState(false);\r\n\r\n  const handleFileChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      if (file.size > 5 * 1024 * 1024) {\r\n        toast.error('File size must be less than 5MB');\r\n        return;\r\n      }\r\n      setProfilePicture(file);\r\n      setPreviewUrl(URL.createObjectURL(file));\r\n    }\r\n  };\r\n\r\n  const uploadProfilePicture = async () => {\r\n    if (!profilePicture) return userData?.photoURL || null;\r\n\r\n    try {\r\n      const storageRef = ref(storage, `profile-pictures/${currentUser.uid}/${Date.now()}_${profilePicture.name}`);\r\n      await uploadBytes(storageRef, profilePicture);\r\n      const url = await getDownloadURL(storageRef);\r\n      return url;\r\n    } catch (error) {\r\n      console.error('Error uploading profile picture:', error);\r\n      toast.error('Failed to upload profile picture');\r\n      return userData?.photoURL || null;\r\n    }\r\n  };\r\n\r\n  const handleSendPhoneVerification = async () => {\r\n    if (!phoneNumber || phoneNumber === userData?.phoneNumber) {\r\n      toast.error('Please enter a new phone number');\r\n      return;\r\n    }\r\n\r\n    // Validate phone number format\r\n    const trimmed = phoneNumber.trim();\r\n\r\n    // Check for empty after trim\r\n    if (!trimmed) {\r\n      toast.error('Please enter a phone number');\r\n      return;\r\n    }\r\n\r\n    // Check for invalid characters (only allow digits, +, spaces, hyphens, parentheses)\r\n    if (!/^[0-9+\\s\\-()]+$/.test(trimmed)) {\r\n      toast.error('Phone number can only contain digits, +, spaces, hyphens, and parentheses');\r\n      return;\r\n    }\r\n\r\n    // Format phone number - ensure it starts with +\r\n    let formattedPhone = trimmed.replace(/[\\s\\-()]/g, ''); // Remove formatting characters\r\n\r\n    if (!formattedPhone.startsWith('+')) {\r\n      // If it doesn't start with +, assume Australia +61 and remove leading 0\r\n      if (formattedPhone.startsWith('0')) {\r\n        formattedPhone = '+61' + formattedPhone.slice(1);\r\n      } else {\r\n        // If no country code and doesn't start with 0, assume it's missing +\r\n        formattedPhone = '+' + formattedPhone;\r\n      }\r\n    }\r\n\r\n    // Validate E.164 format (+ followed by 1-15 digits)\r\n    if (!isValidE164(formattedPhone)) {\r\n      toast.error('Invalid phone number format. Please enter a valid international number (e.g., +61412345678 or 0412345678)', { duration: 5000 });\r\n      return;\r\n    }\r\n\r\n    // Check length (must be between 8-15 digits after country code)\r\n    const digitsOnly = formattedPhone.slice(1); // Remove the +\r\n    if (digitsOnly.length < 8) {\r\n      toast.error('Phone number is too short. Please enter a complete phone number');\r\n      return;\r\n    }\r\n    if (digitsOnly.length > 15) {\r\n      toast.error('Phone number is too long. Please check and try again');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    // Setup reCAPTCHA\r\n    const recaptchaResult = authService.setupRecaptcha('phone-recaptcha-container');\r\n    if (!recaptchaResult.success) {\r\n      toast.error('Failed to set up verification. Please refresh the page.');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    // Send verification code\r\n    const result = await authService.sendPhoneVerification(formattedPhone, recaptchaResult.verifier);\r\n    setLoading(false);\r\n\r\n    if (result.success) {\r\n      setPhoneConfirmationResult(result.confirmationResult);\r\n      setPendingPhoneNumber(formattedPhone);\r\n      setShowPhoneVerification(true);\r\n      toast.success('Verification code sent to your phone!');\r\n    } else {\r\n      toast.error(result.error || 'Failed to send verification code');\r\n    }\r\n  };\r\n\r\n  const handleVerifyPhoneCode = async () => {\r\n    if (!verificationCode || !phoneConfirmationResult) {\r\n      toast.error('Please enter the verification code');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    const result = await authService.verifyPhoneCode(phoneConfirmationResult, verificationCode);\r\n\r\n    if (result.success) {\r\n      toast.success('Phone number verified!');\r\n      setShowPhoneVerification(false);\r\n      setPhoneNumber(pendingPhoneNumber);\r\n\r\n      // CRITICAL: Force auth token refresh after phone verification\r\n      // This ensures Firestore security rules have the updated auth info\r\n      try {\r\n        await currentUser.getIdToken(true); // Force refresh\r\n        // Small delay to ensure token propagates to Firestore\r\n        await new Promise(resolve => setTimeout(resolve, 500));\r\n      } catch (error) {\r\n        console.error('Token refresh error:', error);\r\n      }\r\n\r\n      // Check if SMS is not enabled and prompt user\r\n      if (!userData?.notificationPreferences?.sms) {\r\n        toast(\r\n          (t) => (\r\n            <div className=\"flex flex-col gap-2\">\r\n              <div className=\"font-semibold\">üì± Enable SMS Alerts?</div>\r\n              <div className=\"text-sm\">Would you like to receive emergency alerts via SMS?</div>\r\n              <div className=\"flex gap-2\">\r\n                <button\r\n                  onClick={async () => {\r\n                    try {\r\n                      await updateDoc(doc(db, 'users', currentUser.uid), {\r\n                        'notificationPreferences.sms': true\r\n                      });\r\n                      toast.success('SMS alerts enabled!');\r\n                      toast.dismiss(t.id);\r\n                    } catch (error) {\r\n                      console.error('Error enabling SMS:', error);\r\n                      toast.error('Failed to enable SMS');\r\n                    }\r\n                  }}\r\n                  className=\"btn btn-primary btn-sm\"\r\n                >\r\n                  Enable SMS\r\n                </button>\r\n                <button\r\n                  onClick={() => toast.dismiss(t.id)}\r\n                  className=\"btn btn-secondary btn-sm\"\r\n                >\r\n                  Not Now\r\n                </button>\r\n              </div>\r\n              <div className=\"text-xs text-gray-500\">You can change this later in Settings</div>\r\n            </div>\r\n          ),\r\n          { duration: 10000 }\r\n        );\r\n      }\r\n\r\n      // Now save the profile with the verified phone number\r\n      saveProfileChanges(pendingPhoneNumber);\r\n    } else {\r\n      setLoading(false);\r\n      toast.error(result.error || 'Invalid verification code');\r\n    }\r\n  };\r\n\r\n  const saveProfileChanges = async (verifiedPhoneNumber = null) => {\r\n    try {\r\n      // Upload profile picture if changed\r\n      let photoURL = userData?.photoURL || null;\r\n\r\n      if (profilePicture) {\r\n        const uploadedPhotoURL = await uploadProfilePicture();\r\n        if (uploadedPhotoURL) {\r\n          photoURL = uploadedPhotoURL;\r\n        }\r\n      }\r\n\r\n      // Update Firestore\r\n      await updateDoc(doc(db, 'users', currentUser.uid), {\r\n        displayName,\r\n        phoneNumber: verifiedPhoneNumber || phoneNumber,\r\n        photoURL,\r\n        'profile.bio': bio,\r\n        'profile.birthdate': birthdate,\r\n        updatedAt: new Date(),\r\n      });\r\n\r\n      // Track analytics\r\n      const { logAnalyticsEvent } = require('../services/firebase');\r\n      logAnalyticsEvent('profile_updated', {\r\n        has_photo: !!photoURL,\r\n        has_bio: !!bio,\r\n        has_birthdate: !!birthdate\r\n      });\r\n\r\n      toast.success('Profile updated successfully!');\r\n\r\n      // Check if profile is now complete and award badge\r\n      // Get besties count\r\n      const bestiesQuery1 = query(\r\n        collection(db, 'besties'),\r\n        where('requesterId', '==', currentUser.uid),\r\n        where('status', '==', 'accepted')\r\n      );\r\n      const bestiesQuery2 = query(\r\n        collection(db, 'besties'),\r\n        where('recipientId', '==', currentUser.uid),\r\n        where('status', '==', 'accepted')\r\n      );\r\n      const [snapshot1, snapshot2] = await Promise.all([\r\n        getDocs(bestiesQuery1),\r\n        getDocs(bestiesQuery2)\r\n      ]);\r\n      const bestiesCount = snapshot1.size + snapshot2.size;\r\n\r\n      // Create updated userData object\r\n      const updatedUserData = {\r\n        ...userData,\r\n        displayName,\r\n        phoneNumber: verifiedPhoneNumber || phoneNumber,\r\n        photoURL,\r\n        profile: {\r\n          ...userData?.profile,\r\n          bio,\r\n          birthdate\r\n        }\r\n      };\r\n\r\n      // Check and award profile completion badge\r\n      const wasAwarded = await checkAndAwardProfileCompletion(\r\n        currentUser.uid,\r\n        updatedUserData,\r\n        currentUser,\r\n        bestiesCount\r\n      );\r\n\r\n      if (wasAwarded) {\r\n        // Show celebration modal\r\n        setShowCompletionModal(true);\r\n        // Don't navigate yet, let user close the modal first\r\n      } else {\r\n        // Navigate after a short delay\r\n        setTimeout(() => {\r\n          navigate('/profile');\r\n        }, 500);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error updating profile:', error);\r\n      toast.error(error.message || 'Failed to update profile');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSave = async (e) => {\r\n    e.preventDefault();\r\n\r\n    // Check if phone number has changed\r\n    const phoneChanged = phoneNumber && phoneNumber !== userData?.phoneNumber;\r\n\r\n    if (phoneChanged) {\r\n      // Phone number changed, require verification\r\n      handleSendPhoneVerification();\r\n      return; // Don't save yet, wait for verification\r\n    }\r\n\r\n    // If phone number hasn't changed, save normally\r\n    setLoading(true);\r\n    await saveProfileChanges();\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-pattern\">\r\n\r\n      <div className=\"max-w-2xl mx-auto p-4 pb-32 md:pb-20\">\r\n        <div className=\"mb-6\">\r\n          <h1 className=\"text-3xl font-display text-text-primary mb-2\">Edit Profile</h1>\r\n          <p className=\"text-text-secondary\">Update your personal information</p>\r\n        </div>\r\n\r\n        <form onSubmit={handleSave} className=\"space-y-6\">\r\n          {/* Profile Picture */}\r\n          <div id=\"profile-picture\" className=\"card p-6\">\r\n            <label className=\"block text-lg font-display text-text-primary mb-4\">\r\n              Profile Picture\r\n            </label>\r\n            \r\n            <div className=\"flex items-center gap-6\">\r\n              <div className=\"w-24 h-24 bg-gradient-primary rounded-full flex items-center justify-center text-white text-3xl font-display overflow-hidden\">\r\n                {previewUrl ? (\r\n                  <img src={previewUrl} alt=\"Profile\" className=\"w-full h-full object-cover\" />\r\n                ) : (\r\n                  displayName?.[0] || 'U'\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"flex-1\">\r\n                <input\r\n                  type=\"file\"\r\n                  accept=\"image/*\"\r\n                  onChange={handleFileChange}\r\n                  className=\"hidden\"\r\n                  id=\"profile-picture\"\r\n                />\r\n                <label\r\n                  htmlFor=\"profile-picture\"\r\n                  className=\"btn btn-secondary cursor-pointer inline-block\"\r\n                >\r\n                  Choose Photo\r\n                </label>\r\n                <div className=\"text-sm text-text-secondary mt-2\">\r\n                  JPG, PNG or GIF. Max size 5MB\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Basic Info */}\r\n          <div id=\"basic-info\" className=\"card p-6\">\r\n            <h3 className=\"text-lg font-display text-text-primary mb-4\">Basic Information</h3>\r\n\r\n            <div className=\"space-y-4\">\r\n              <div id=\"display-name\">\r\n                <label className=\"block text-sm font-semibold text-text-primary mb-2\">\r\n                  Display Name\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={displayName}\r\n                  onChange={(e) => setDisplayName(e.target.value)}\r\n                  className=\"input\"\r\n                  placeholder=\"Your name\"\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              <div id=\"bio\">\r\n                <label className=\"block text-sm font-semibold text-text-primary mb-2\">\r\n                  Bio\r\n                </label>\r\n                <textarea\r\n                  value={bio}\r\n                  onChange={(e) => setBio(e.target.value)}\r\n                  className=\"input min-h-[80px] resize-none\"\r\n                  placeholder=\"Tell people about yourself...\"\r\n                  maxLength={150}\r\n                />\r\n                <div className=\"text-xs text-text-secondary mt-1\">\r\n                  {bio.length}/150 characters\r\n                </div>\r\n              </div>\r\n\r\n              <div id=\"birthday\">\r\n                <label className=\"block text-sm font-semibold text-text-primary mb-2\">\r\n                  Birthday üéÇ\r\n                </label>\r\n                <input\r\n                  type=\"date\"\r\n                  value={birthdate}\r\n                  onChange={(e) => setBirthdate(e.target.value)}\r\n                  className=\"input\"\r\n                  max={new Date().toISOString().split('T')[0]}\r\n                />\r\n                <div className=\"text-xs text-text-secondary mt-1\">\r\n                  Your besties will be notified on your birthday! (Optional)\r\n                </div>\r\n              </div>\r\n\r\n              <div id=\"phone\">\r\n                <label className=\"block text-sm font-semibold text-text-primary mb-2\">\r\n                  Phone Number\r\n                </label>\r\n                <div className=\"flex gap-2\">\r\n                  <input\r\n                    type=\"tel\"\r\n                    value={phoneNumber}\r\n                    onChange={(e) => setPhoneNumber(e.target.value)}\r\n                    className=\"input flex-1\"\r\n                    placeholder=\"+61 400 000 000 or 0400 000 000\"\r\n                  />\r\n                  {phoneNumber !== userData?.phoneNumber && phoneNumber && (\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={handleSendPhoneVerification}\r\n                      disabled={loading}\r\n                      className=\"btn btn-primary whitespace-nowrap\"\r\n                    >\r\n                      {loading ? 'Sending...' : 'Verify Now'}\r\n                    </button>\r\n                  )}\r\n                </div>\r\n                {phoneNumber !== userData?.phoneNumber && phoneNumber && (\r\n                  <div className=\"text-xs text-orange-600 dark:text-orange-400 mt-1\">\r\n                    ‚ö†Ô∏è Click \"Verify Now\" to verify this number via SMS\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Account Info */}\r\n          <div className=\"card p-6\">\r\n            <h3 className=\"text-lg font-display text-text-primary mb-4\">Account Info</h3>\r\n\r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <div className=\"text-sm text-text-secondary mb-1\">Email</div>\r\n                <div className=\"font-semibold text-text-primary\">{currentUser?.email}</div>\r\n                <div className=\"text-xs text-text-secondary mt-1\">\r\n                  To change your email, use Google authentication\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <div className=\"text-sm text-text-secondary mb-1\">Member Since</div>\r\n                <div className=\"font-semibold text-text-primary\">\r\n                  {userData?.stats?.joinedAt?.toDate().toLocaleDateString() || 'Recently'}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Actions */}\r\n          <div className=\"flex gap-3\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => navigate('/profile')}\r\n              className=\"flex-1 btn btn-secondary\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              disabled={loading}\r\n              className=\"flex-1 btn btn-primary flex items-center justify-center gap-2\"\r\n            >\r\n              {loading && (\r\n                <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\"></div>\r\n              )}\r\n              {loading ? 'Sending verification...' : 'Save Changes'}\r\n            </button>\r\n          </div>\r\n        </form>\r\n\r\n        {/* Phone Verification Modal */}\r\n        {showPhoneVerification && (\r\n          <div className=\"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50 p-4\">\r\n            <div className=\"card dark:bg-gray-800 p-6 max-w-md w-full animate-scale-up\">\r\n              <h2 className=\"text-2xl font-display text-text-primary mb-2\">Verify Phone Number</h2>\r\n              <p className=\"text-text-secondary mb-4\">\r\n                We sent a 6-digit code to <strong>{pendingPhoneNumber}</strong>\r\n              </p>\r\n\r\n              <div className=\"mb-4\">\r\n                <label className=\"block text-sm font-semibold text-text-primary mb-2\">\r\n                  Verification Code\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={verificationCode}\r\n                  onChange={(e) => setVerificationCode(e.target.value)}\r\n                  className=\"input\"\r\n                  placeholder=\"123456\"\r\n                  maxLength={6}\r\n                  autoFocus\r\n                />\r\n              </div>\r\n\r\n              <div className=\"flex gap-3\">\r\n                <button\r\n                  onClick={() => {\r\n                    setShowPhoneVerification(false);\r\n                    setVerificationCode('');\r\n                    setPhoneConfirmationResult(null);\r\n                  }}\r\n                  className=\"flex-1 btn btn-secondary\"\r\n                  disabled={loading}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  onClick={handleVerifyPhoneCode}\r\n                  className=\"flex-1 btn btn-primary flex items-center justify-center gap-2\"\r\n                  disabled={loading || verificationCode.length !== 6}\r\n                >\r\n                  {loading && (\r\n                    <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\"></div>\r\n                  )}\r\n                  {loading ? 'Verifying & Saving...' : 'Verify & Save'}\r\n                </button>\r\n              </div>\r\n\r\n              <p className=\"text-xs text-text-secondary mt-4 text-center\">\r\n                Didn't receive the code?{' '}\r\n                <button\r\n                  onClick={handleSendPhoneVerification}\r\n                  className=\"text-primary underline\"\r\n                  disabled={loading}\r\n                >\r\n                  Resend\r\n                </button>\r\n              </p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Invisible reCAPTCHA container */}\r\n        <div id=\"phone-recaptcha-container\"></div>\r\n\r\n        {/* Profile Completion Celebration Modal */}\r\n        <ProfileCompletionModal\r\n          isOpen={showCompletionModal}\r\n          onClose={() => {\r\n            setShowCompletionModal(false);\r\n            navigate('/profile');\r\n          }}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditProfilePage;\r\n","import { useEffect } from 'react';\r\n// canvas-confetti will be lazy-loaded when needed\r\n\r\nconst ConfettiCelebration = ({ trigger = false, type = 'default' }) => {\r\n  useEffect(() => {\r\n    if (!trigger) return;\r\n\r\n    const fireConfetti = async () => {\r\n      // Lazy load canvas-confetti\r\n      const confetti = (await import('canvas-confetti')).default;\r\n      if (type === 'badge') {\r\n        // Badge celebration - stars and hearts\r\n        const count = 200;\r\n        const defaults = {\r\n          origin: { y: 0.7 },\r\n          shapes: ['circle', 'square'],\r\n          colors: ['#FF69B4', '#DDA0DD', '#FFB6C1', '#FFC0CB', '#FF1493']\r\n        };\r\n\r\n        function fire(particleRatio, opts) {\r\n          confetti({\r\n            ...defaults,\r\n            ...opts,\r\n            particleCount: Math.floor(count * particleRatio)\r\n          });\r\n        }\r\n\r\n        fire(0.25, {\r\n          spread: 26,\r\n          startVelocity: 55,\r\n        });\r\n\r\n        fire(0.2, {\r\n          spread: 60,\r\n        });\r\n\r\n        fire(0.35, {\r\n          spread: 100,\r\n          decay: 0.91,\r\n          scalar: 0.8\r\n        });\r\n\r\n        fire(0.1, {\r\n          spread: 120,\r\n          startVelocity: 25,\r\n          decay: 0.92,\r\n          scalar: 1.2\r\n        });\r\n\r\n        fire(0.1, {\r\n          spread: 120,\r\n          startVelocity: 45,\r\n        });\r\n      } else if (type === 'milestone') {\r\n        // Milestone - explosion from center\r\n        confetti({\r\n          particleCount: 150,\r\n          spread: 70,\r\n          origin: { y: 0.6 },\r\n          colors: ['#FF69B4', '#DDA0DD', '#FFB6C1', '#87CEEB', '#98FB98']\r\n        });\r\n\r\n        // Second burst\r\n        setTimeout(() => {\r\n          confetti({\r\n            particleCount: 100,\r\n            angle: 60,\r\n            spread: 55,\r\n            origin: { x: 0 },\r\n            colors: ['#FF69B4', '#DDA0DD', '#FFB6C1']\r\n          });\r\n        }, 200);\r\n\r\n        setTimeout(() => {\r\n          confetti({\r\n            particleCount: 100,\r\n            angle: 120,\r\n            spread: 55,\r\n            origin: { x: 1 },\r\n            colors: ['#87CEEB', '#98FB98', '#FFB6C1']\r\n          });\r\n        }, 400);\r\n      } else {\r\n        // Default celebration\r\n        confetti({\r\n          particleCount: 100,\r\n          spread: 70,\r\n          origin: { y: 0.6 },\r\n          colors: ['#FF69B4', '#DDA0DD', '#FFB6C1', '#FFC0CB', '#FF1493']\r\n        });\r\n      }\r\n    };\r\n\r\n    fireConfetti().catch(console.error);\r\n  }, [trigger, type]);\r\n\r\n  return null; // This component doesn't render anything\r\n};\r\n\r\nexport default ConfettiCelebration;\r\n"],"names":["isValidE164","phoneNumber","test","notificationService","createNotification","userId","type","title","message","metadata","arguments","length","undefined","addDoc","collection","db","_objectSpread","read","createdAt","serverTimestamp","error","console","notifyBestieRequest","requesterName","this","concat","notifyCheckInAlert","bestieName","checkInId","notifyMissedCheckIn","notifyRequestAttention","bestieId","warn","notifyBadgeEarned","badgeName","badgeDescription","notifySystem","notifyWelcome","displayName","notifyBestieAccepted","notifyCheckInComplete","checkInName","isProfileComplete","userData","currentUser","bestiesCount","_userData$profile","hasEmail","email","hasPhone","hasPhoto","photoURL","hasBio","profile","bio","awardProfileCompletionBadge","async","BADGE_ID","badgeDoc","getDoc","doc","exists","existingBadges","data","badges","some","b","id","updateDoc","arrayUnion","name","description","icon","earnedAt","Date","category","setDoc","checkAndAwardProfileCompletion","_ref","isOpen","onClose","showConfetti","setShowConfetti","useState","useEffect","timer","setTimeout","clearTimeout","_jsxs","_Fragment","children","_jsx","ConfettiCelebration","className","onClick","EditProfilePage","_userData$profile2","_userData$stats","_userData$stats$joine","useAuth","navigate","useNavigate","setDisplayName","setBio","birthdate","setBirthdate","setPhoneNumber","profilePicture","setProfilePicture","previewUrl","setPreviewUrl","loading","setLoading","hash","window","location","slice","element","document","getElementById","scrollIntoView","behavior","block","style","transition","backgroundColor","showPhoneVerification","setShowPhoneVerification","verificationCode","setVerificationCode","phoneConfirmationResult","setPhoneConfirmationResult","pendingPhoneNumber","setPendingPhoneNumber","showCompletionModal","setShowCompletionModal","handleSendPhoneVerification","toast","trimmed","trim","formattedPhone","replace","startsWith","duration","digitsOnly","recaptchaResult","authService","setupRecaptcha","success","result","sendPhoneVerification","verifier","confirmationResult","saveProfileChanges","verifiedPhoneNumber","uploadedPhotoURL","storageRef","ref","storage","uid","now","uploadBytes","getDownloadURL","uploadProfilePicture","updatedAt","logAnalyticsEvent","require","has_photo","has_bio","has_birthdate","bestiesQuery1","query","where","bestiesQuery2","snapshot1","snapshot2","Promise","all","getDocs","size","updatedUserData","onSubmit","e","preventDefault","src","alt","accept","onChange","file","target","files","URL","createObjectURL","htmlFor","value","placeholder","required","maxLength","max","toISOString","split","disabled","stats","joinedAt","toDate","toLocaleDateString","autoFocus","verifyPhoneCode","_userData$notificatio","getIdToken","resolve","notificationPreferences","sms","t","dismiss","ProfileCompletionModal","trigger","confetti","default","count","defaults","origin","y","shapes","colors","fire","particleRatio","opts","particleCount","Math","floor","spread","startVelocity","decay","scalar","angle","x","fireConfetti","catch"],"sourceRoot":""}