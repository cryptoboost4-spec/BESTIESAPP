"use strict";(self.webpackChunkbesties_frontend=self.webpackChunkbesties_frontend||[]).push([[475],{475:(e,s,l)=>{l.r(s),l.d(s,{default:()=>o});var t=l(5043),a=l(4528),i=l(7400),r=l(626),d=l(559),c=l(2339),n=l(579);const o=()=>{var e;const{userData:s}=(0,a.As)(),[l,o]=(0,t.useState)(!1),[x,h]=(0,t.useState)(null);return null!==s&&void 0!==s&&s.isAdmin?(0,n.jsxs)("div",{className:"min-h-screen bg-pattern",children:[(0,n.jsx)(d.A,{}),(0,n.jsx)("div",{className:"max-w-4xl mx-auto p-4 pb-20",children:(0,n.jsxs)("div",{className:"card p-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-display text-gradient mb-6",children:"\ud83d\udd27 Admin Backfill Tools"}),(0,n.jsxs)("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-xl p-6 mb-6",children:[(0,n.jsx)("h2",{className:"text-xl font-display text-yellow-900 mb-3",children:"\u26a0\ufe0f Backfill bestieUserIds"}),(0,n.jsxs)("p",{className:"text-gray-700 mb-4",children:["This will populate the ",(0,n.jsx)("code",{className:"bg-yellow-100 px-2 py-1 rounded",children:"bestieUserIds"})," array for all existing accepted bestie relationships."]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg p-4 mb-4",children:[(0,n.jsx)("h3",{className:"font-semibold mb-2",children:"What this does:"}),(0,n.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-700",children:[(0,n.jsx)("li",{children:"Queries all accepted besties in the database"}),(0,n.jsx)("li",{children:"For each bestie pair, adds both users to each other's bestieUserIds array"}),(0,n.jsx)("li",{children:"Enables besties to view each other's profiles (required by Firebase rules)"}),(0,n.jsx)("li",{children:"Safe to run multiple times (won't create duplicates)"})]})]}),(0,n.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[(0,n.jsx)("h3",{className:"font-semibold text-blue-900 mb-2",children:"\ud83d\udca1 When to use this:"}),(0,n.jsx)("p",{className:"text-sm text-blue-800",children:"Run this if besties can't view each other's profiles or see bestie data. This typically happens if the onCreate Cloud Function wasn't deployed when bestie relationships were created."})]})]}),(0,n.jsx)("button",{onClick:async()=>{if(window.confirm("Are you sure you want to run the bestieUserIds backfill? This will update all existing bestie relationships.")){o(!0),h(null);try{console.log("\ud83d\ude80 Calling backfill function...");const e=(0,r.Qg)(i.Cn,"backfillBestieUserIds"),s=await e();console.log("\u2705 Backfill completed:",s.data),h(s.data),c.Ay.success("Backfill completed successfully!")}catch(e){console.error("\u274c Backfill failed:",e),c.Ay.error("Backfill failed: ".concat(e.message)),h({success:!1,error:e.message})}finally{o(!1)}}},disabled:l,className:"w-full py-4 px-6 rounded-xl font-semibold text-lg transition-all ".concat(l?"bg-gray-400 cursor-not-allowed":"bg-gradient-primary hover:scale-105 shadow-lg"," text-white"),children:l?(0,n.jsxs)("span",{className:"flex items-center justify-center gap-3",children:[(0,n.jsx)("div",{className:"spinner"}),"Running backfill..."]}):"\u25b6\ufe0f Run Backfill Now"}),x&&(0,n.jsxs)("div",{className:"mt-6 p-6 rounded-xl ".concat(x.success?"bg-green-50 border-2 border-green-200":"bg-red-50 border-2 border-red-200"),children:[(0,n.jsx)("h3",{className:"text-xl font-display mb-4 ".concat(x.success?"text-green-900":"text-red-900"),children:x.success?"\u2705 Success!":"\u274c Failed"}),x.success&&(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-3xl font-bold text-green-700",children:x.processed||0}),(0,n.jsx)("div",{className:"text-sm text-gray-600",children:"Besties Processed"})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-3xl font-bold text-blue-700",children:x.updated||0}),(0,n.jsx)("div",{className:"text-sm text-gray-600",children:"Successfully Updated"})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-3xl font-bold text-yellow-700",children:x.skipped||0}),(0,n.jsx)("div",{className:"text-sm text-gray-600",children:"Skipped"})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-3xl font-bold text-red-700",children:(null===(e=x.errors)||void 0===e?void 0:e.length)||0}),(0,n.jsx)("div",{className:"text-sm text-gray-600",children:"Errors"})]})]}),x.errors&&x.errors.length>0&&(0,n.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,n.jsx)("h4",{className:"font-semibold text-red-900 mb-2",children:"Errors:"}),(0,n.jsx)("ul",{className:"text-sm text-gray-700 space-y-1",children:x.errors.map((e,s)=>(0,n.jsxs)("li",{children:["Bestie ",e.bestieId,": ",e.error]},s))})]}),(0,n.jsx)("p",{className:"text-green-800 font-semibold mt-4",children:"\ud83c\udf89 All besties should now be able to view each other's profiles!"})]}),!x.success&&(0,n.jsxs)("div",{className:"text-red-800",children:[(0,n.jsx)("p",{className:"font-semibold mb-2",children:"Error:"}),(0,n.jsx)("pre",{className:"bg-white p-4 rounded overflow-auto text-sm",children:x.error||JSON.stringify(x,null,2)})]})]})]})})]}):(0,n.jsxs)("div",{className:"min-h-screen bg-pattern",children:[(0,n.jsx)(d.A,{}),(0,n.jsx)("div",{className:"max-w-4xl mx-auto p-4 pb-20",children:(0,n.jsxs)("div",{className:"card p-12 text-center",children:[(0,n.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udd12"}),(0,n.jsx)("h2",{className:"text-2xl font-display text-text-primary mb-2",children:"Admin Only"}),(0,n.jsx)("p",{className:"text-text-secondary",children:"You must be an admin to access this page"})]})})]})}}}]);
//# sourceMappingURL=475.db488b31.chunk.js.map