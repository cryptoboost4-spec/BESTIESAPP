/*! For license information please see main.5d848948.js.LICENSE.txt */
(()=>{"use strict";var e={52:(e,t,n)=>{n.d(t,{KO:()=>$,MF:()=>Y,Sx:()=>X,Wp:()=>J,j6:()=>K,om:()=>q,xZ:()=>H});var r=n(8812),i=n(443),s=n(7700),a=n(2799);class o{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const l="@firebase/app",c="0.10.13",u=new i.Vy("@firebase/app"),d="@firebase/app-compat",h="@firebase/analytics-compat",f="@firebase/analytics",p="@firebase/app-check-compat",m="@firebase/app-check",g="@firebase/auth",y="@firebase/auth-compat",v="@firebase/database",b="@firebase/data-connect",w="@firebase/database-compat",x="@firebase/functions",k="@firebase/functions-compat",_="@firebase/installations",I="@firebase/installations-compat",E="@firebase/messaging",S="@firebase/messaging-compat",N="@firebase/performance",T="@firebase/performance-compat",C="@firebase/remote-config",A="@firebase/remote-config-compat",j="@firebase/storage",P="@firebase/storage-compat",D="@firebase/firestore",R="@firebase/vertexai-preview",O="@firebase/firestore-compat",M="firebase",L="[DEFAULT]",F={[l]:"fire-core",[d]:"fire-core-compat",[f]:"fire-analytics",[h]:"fire-analytics-compat",[m]:"fire-app-check",[p]:"fire-app-check-compat",[g]:"fire-auth",[y]:"fire-auth-compat",[v]:"fire-rtdb",[b]:"fire-data-connect",[w]:"fire-rtdb-compat",[x]:"fire-fn",[k]:"fire-fn-compat",[_]:"fire-iid",[I]:"fire-iid-compat",[E]:"fire-fcm",[S]:"fire-fcm-compat",[N]:"fire-perf",[T]:"fire-perf-compat",[C]:"fire-rc",[A]:"fire-rc-compat",[j]:"fire-gcs",[P]:"fire-gcs-compat",[D]:"fire-fst",[O]:"fire-fst-compat",[R]:"fire-vertex","fire-js":"fire-js",[M]:"fire-js-all"},U=new Map,V=new Map,B=new Map;function z(e,t){try{e.container.addComponent(t)}catch(n){u.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function q(e){const t=e.name;if(B.has(t))return u.debug("There were multiple attempts to register component ".concat(t,".")),!1;B.set(t,e);for(const n of U.values())z(n,e);for(const n of V.values())z(n,e);return!0}function K(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function H(e){return void 0!==e.settings}const W={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},G=new s.FA("app","Firebase",W);class Q{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw G.create("app-deleted",{appName:this._name})}}const Y="10.14.1";function J(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const i=Object.assign({name:L,automaticDataCollectionEnabled:!1},t),a=i.name;if("string"!==typeof a||!a)throw G.create("bad-app-name",{appName:String(a)});if(n||(n=(0,s.T9)()),!n)throw G.create("no-options");const o=U.get(a);if(o){if((0,s.bD)(n,o.options)&&(0,s.bD)(i,o.config))return o;throw G.create("duplicate-app",{appName:a})}const l=new r.h1(a);for(const r of B.values())l.addComponent(r);const c=new Q(n,i,l);return U.set(a,c),c}function X(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L;const t=U.get(e);if(!t&&e===L&&(0,s.T9)())return J();if(!t)throw G.create("no-app",{appName:e});return t}function $(e,t,n){var i;let s=null!==(i=F[e])&&void 0!==i?i:e;n&&(s+="-".concat(n));const a=s.match(/\s|\//),o=t.match(/\s|\//);if(a||o){const e=['Unable to register library "'.concat(s,'" with version "').concat(t,'":')];return a&&e.push('library name "'.concat(s,'" contains illegal characters (whitespace or "/")')),a&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void u.warn(e.join(" "))}q(new r.uA("".concat(s,"-version"),()=>({library:s,version:t}),"VERSION"))}const Z="firebase-heartbeat-store";let ee=null;function te(){return ee||(ee=(0,a.P2)("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Z)}catch(n){console.warn(n)}}}).catch(e=>{throw G.create("idb-open",{originalErrorMessage:e.message})})),ee}async function ne(e,t){try{const n=(await te()).transaction(Z,"readwrite"),r=n.objectStore(Z);await r.put(t,re(e)),await n.done}catch(n){if(n instanceof s.g)u.warn(n.message);else{const e=G.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});u.warn(e.message)}}}function re(e){return"".concat(e.name,"!").concat(e.options.appId)}class ie{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ae(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=se();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}catch(n){u.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=se(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),oe(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),oe(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=(0,s.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return u.warn(t),""}}}function se(){return(new Date).toISOString().substring(0,10)}class ae{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,s.zW)()&&(0,s.eX)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await te()).transaction(Z),n=await t.objectStore(Z).get(re(e));return await t.done,n}catch(t){if(t instanceof s.g)u.warn(t.message);else{const e=G.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});u.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ne(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ne(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function oe(e){return(0,s.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var le;le="",q(new r.uA("platform-logger",e=>new o(e),"PRIVATE")),q(new r.uA("heartbeat",e=>new ie(e),"PRIVATE")),$(l,c,le),$(l,c,"esm2017"),$("fire-js","")},443:(e,t,n)=>{n.d(t,{$b:()=>i,Vy:()=>c});const r=[];var i;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(i||(i={}));const s={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},a=i.INFO,o={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},l=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=o[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];console[r]("[".concat(n,"]  ").concat(e.name,":"),...s)};class c{constructor(e){this.name=e,this._logLevel=a,this._logHandler=l,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in i))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?s[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...t),this._logHandler(this,i.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...t),this._logHandler(this,i.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.INFO,...t),this._logHandler(this,i.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.WARN,...t),this._logHandler(this,i.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.ERROR,...t),this._logHandler(this,i.ERROR,...t)}}},579:(e,t,n)=>{e.exports=n(1153)},626:(e,t,n)=>{n.d(t,{Uz:()=>k,Qg:()=>_});var r=n(52),i=n(7700),s=n(8812);const a="type.googleapis.com/google.protobuf.Int64Value",o="type.googleapis.com/google.protobuf.UInt64Value";function l(e,t){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function c(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"===typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(e=>c(e));if("function"===typeof e||"object"===typeof e)return l(e,e=>c(e));throw new Error("Data cannot be encoded in JSON: "+e)}function u(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case a:case o:{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(e=>u(e)):"function"===typeof e||"object"===typeof e?l(e,e=>u(e)):e}const d="functions",h={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class f extends i.g{constructor(e,t,n){super("".concat(d,"/").concat(e),t||""),this.details=n}}class p{constructor(e,t,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(e=>this.auth=e,()=>{}),this.messaging||t.get().then(e=>this.messaging=e,()=>{}),this.appCheck||n.get().then(e=>this.appCheck=e,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null===e||void 0===e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(e){if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}}const m="us-central1";class g{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:m,s=arguments.length>5?arguments[5]:void 0;this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new p(t,n,r),this.cancelAllRequests=new Promise(e=>{this.deleteService=()=>Promise.resolve(e())});try{const e=new URL(i);this.customDomain=e.origin+("/"===e.pathname?"":e.pathname),this.region=m}catch(a){this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;if(null!==this.emulatorOrigin){const n=this.emulatorOrigin;return"".concat(n,"/").concat(t,"/").concat(this.region,"/").concat(e)}return null!==this.customDomain?"".concat(this.customDomain,"/").concat(e):"https://".concat(this.region,"-").concat(t,".cloudfunctions.net/").concat(e)}}function y(e,t,n){return r=>function(e,t,n,r){const i=e._url(t);return b(e,i,n,r)}(e,t,r,n||{})}async function v(e,t,n,r){let i;n["Content-Type"]="application/json";try{i=await r(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(a){return{status:0,json:null}}let s=null;try{s=await i.json()}catch(a){}return{status:i.status,json:s}}async function b(e,t,n,r){const i={data:n=c(n)},s={},a=await e.contextProvider.getContext(r.limitedUseAppCheckTokens);a.authToken&&(s.Authorization="Bearer "+a.authToken),a.messagingToken&&(s["Firebase-Instance-ID-Token"]=a.messagingToken),null!==a.appCheckToken&&(s["X-Firebase-AppCheck"]=a.appCheckToken);const o=function(e){let t=null;return{promise:new Promise((n,r)=>{t=setTimeout(()=>{r(new f("deadline-exceeded","deadline-exceeded"))},e)}),cancel:()=>{t&&clearTimeout(t)}}}(r.timeout||7e4),l=await Promise.race([v(t,i,s,e.fetchImpl),o.promise,e.cancelAllRequests]);if(o.cancel(),!l)throw new f("cancelled","Firebase Functions instance was deleted.");const d=function(e,t){let n,r=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),i=r;try{const e=t&&t.error;if(e){const t=e.status;if("string"===typeof t){if(!h[t])return new f("internal","internal");r=h[t],i=t}const s=e.message;"string"===typeof s&&(i=s),n=e.details,void 0!==n&&(n=u(n))}}catch(s){}return"ok"===r?null:new f(r,i,n)}(l.status,l.json);if(d)throw d;if(!l.json)throw new f("internal","Response is not valid JSON object.");let p=l.json.data;if("undefined"===typeof p&&(p=l.json.result),"undefined"===typeof p)throw new f("internal","Response is missing data field.");return{data:u(p)}}const w="@firebase/functions",x="0.11.8";function k(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.Sx)(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m;const n=(0,r.j6)((0,i.Ku)(e),d).getImmediate({identifier:t}),s=(0,i.yU)("functions");return s&&function(e,t,n){!function(e,t,n){e.emulatorOrigin="http://".concat(t,":").concat(n)}((0,i.Ku)(e),t,n)}(n,...s),n}function _(e,t,n){return y((0,i.Ku)(e),t,n)}var I,E;I=fetch.bind(self),(0,r.om)(new s.uA(d,(e,t)=>{let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("messaging-internal"),a=e.getProvider("app-check-internal");return new g(r,i,s,a,n,I)},"PUBLIC").setMultipleInstances(!0)),(0,r.KO)(w,x,E),(0,r.KO)(w,x,"esm2017")},711:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(2555),i=n(5043),s=n(3216),a=n(3984),o=n(5472),l=n(4528),c=n(3889),u=n(579);const d=()=>{const e=(0,s.Zp)(),{currentUser:t}=(0,l.As)(),{isDark:d}=(0,c.D)(),[h,f]=(0,i.useState)(!1),[p,m]=(0,i.useState)([]),[g,y]=(0,i.useState)(0),v=(0,i.useRef)(null);(0,i.useEffect)(()=>{const e=e=>{v.current&&!v.current.contains(e.target)&&f(!1)};if(h)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[h]),(0,i.useEffect)(()=>{if(null===t||void 0===t||!t.uid)return;const e=(0,o.P)((0,o.rJ)(a.db,"notifications"),(0,o._M)("userId","==",t.uid),(0,o.My)("createdAt","desc")),n=(0,o.aQ)(e,e=>{const t=e.docs.map(e=>(0,r.A)({id:e.id},e.data()));m(t),y(t.filter(e=>!e.read).length)});return()=>n()},[null===t||void 0===t?void 0:t.uid]);const b=async e=>{try{await(0,o.mZ)((0,o.H9)(a.db,"notifications",e),{read:!0})}catch(t){console.error("Error marking notification as read:",t)}},w=e=>{switch(e){case"bestie_request":case"checkin_reaction":return"\ud83d\udc9c";case"bestie_accepted":return"\ud83c\udf89";case"check_in_alert":case"checkin_urgent":return"\ud83d\udea8";case"checkin_reminder":return"\u23f0";case"missed_check_in":return"\u26a0\ufe0f";case"request_attention":return"\ud83d\udc4b";case"badge_earned":return"\ud83c\udfc6";case"post_comment":return"\ud83d\udcac";case"attention_response":return"\ud83e\udd17";case"system":return"\ud83d\udce2";default:return"\ud83d\udd14"}},x=e=>{if(!e)return"";const t=e.toDate?e.toDate():new Date(e),n=new Date-t,r=Math.floor(n/6e4),i=Math.floor(n/36e5),s=Math.floor(n/864e5);return r<1?"Just now":r<60?"".concat(r,"m ago"):i<24?"".concat(i,"h ago"):s<7?"".concat(s,"d ago"):t.toLocaleDateString()};return 0===p.length?null:(0,u.jsxs)("div",{className:"relative",ref:v,children:[(0,u.jsxs)("button",{onClick:()=>f(!h),className:"relative p-2.5 rounded-full bg-gradient-to-br from-pink-100 to-purple-100 dark:from-pink-900/40 dark:to-purple-900/40 hover:from-pink-200 hover:to-purple-200 dark:hover:from-pink-800/50 dark:hover:to-purple-800/50 transition-all shadow-md hover:shadow-lg border border-pink-200/50 dark:border-pink-700/30",children:[(0,u.jsxs)("svg",{viewBox:"0 0 24 24",className:"w-6 h-6",children:[(0,u.jsx)("defs",{children:(0,u.jsxs)("linearGradient",{id:"bellGradientInline",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,u.jsx)("stop",{offset:"0%",stopColor:"#ec4899"}),(0,u.jsx)("stop",{offset:"50%",stopColor:"#a855f7"}),(0,u.jsx)("stop",{offset:"100%",stopColor:"#d946ef"})]})}),(0,u.jsx)("path",{d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9",fill:"none",stroke:"url(#bellGradientInline)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),g>0&&(0,u.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center",children:g>9?"9+":g})]}),h&&(0,u.jsxs)("div",{className:"absolute top-full right-0 mt-2 w-80 ".concat(d?"bg-gray-800 border-gray-700":"bg-white border-gray-200"," rounded-xl shadow-2xl border-2 z-50 max-h-96 overflow-hidden flex flex-col transition-colors"),children:[(0,u.jsx)("div",{className:"p-4 border-b-2 ".concat(d?"border-gray-700 bg-gray-900":"border-gray-100 bg-gradient-to-r from-pink-50 to-purple-50"),children:(0,u.jsxs)("h3",{className:"font-display text-lg ".concat(d?"text-gray-100":"text-text-primary"," flex items-center justify-between"),children:[(0,u.jsx)("span",{children:"Notifications"}),g>0&&(0,u.jsxs)("span",{className:"text-xs bg-primary text-white px-2 py-1 rounded-full",children:[g," new"]})]})}),(0,u.jsx)("div",{className:"overflow-y-auto flex-1",children:0===p.length?(0,u.jsxs)("div",{className:"p-8 text-center",children:[(0,u.jsx)("div",{className:"text-4xl mb-2",children:"\ud83d\udd14"}),(0,u.jsx)("p",{className:"text-sm ".concat(d?"text-gray-400":"text-text-secondary"),children:"No notifications yet"}),(0,u.jsx)("p",{className:"text-xs mt-1 ".concat(d?"text-gray-500":"text-text-secondary"),children:"We'll notify you about check-ins, bestie requests, and more"})]}):(0,u.jsx)("div",{className:"divide-y ".concat(d?"divide-gray-700":"divide-gray-100"),children:p.map(t=>(0,u.jsx)("button",{onClick:()=>(t=>{switch(t.read||b(t.id),t.type){case"bestie_request":case"bestie_accepted":t.requesterId||t.senderId?e("/profile/".concat(t.requesterId||t.senderId)):e("/besties");break;case"check_in_alert":t.userId||t.checkInUserId?e("/profile/".concat(t.userId||t.checkInUserId)):(t.checkInId,e("/"));break;case"checkin_reminder":case"checkin_urgent":case"checkInCreated":case"checkInExtended":case"checkInCompleted":e("/");break;case"missed_check_in":case"request_attention":case"checkin_reaction":case"attention_response":e("/besties");break;case"badge_earned":const{logAnalyticsEvent:r}=n(3984);r("badge_earned_viewed",{badge_id:t.badgeId}),e("/profile"),setTimeout(()=>{const e=document.querySelector(".badges-section");e&&e.scrollIntoView({behavior:"smooth",block:"center"})},300);break;case"post_comment":t.postId?e("/besties",{state:{openPostId:t.postId}}):e("/besties");break;case"emergency_sos":t.userId?e("/profile/".concat(t.userId)):e("/")}f(!1)})(t),className:"w-full p-4 text-left transition-colors ".concat(d?"hover:bg-gray-700 ".concat(t.read?"":"bg-gray-900/50"):"hover:bg-gradient-to-r hover:from-pink-50 hover:to-purple-50 ".concat(t.read?"":"bg-purple-50/30")),children:(0,u.jsxs)("div",{className:"flex gap-3",children:[(0,u.jsx)("div",{className:"flex-shrink-0 text-2xl",children:w(t.type)}),(0,u.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,u.jsx)("p",{className:"text-sm ".concat(t.read?d?"text-gray-300":"text-gray-700":d?"font-semibold text-gray-100":"font-semibold text-gray-900"),children:t.title}),(0,u.jsx)("p",{className:"text-xs mt-1 ".concat(d?"text-gray-400":"text-gray-600"),children:t.message}),(0,u.jsx)("p",{className:"text-xs mt-1 ".concat("text-gray-500"),children:x(t.createdAt)})]}),!t.read&&(0,u.jsx)("div",{className:"flex-shrink-0",children:(0,u.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full"})})]})},t.id))})}),g>0&&(0,u.jsx)("div",{className:"p-3 border-t-2 ".concat(d?"border-gray-700 bg-gray-900":"border-gray-100 bg-gray-50"),children:(0,u.jsx)("button",{onClick:async()=>{const e=p.filter(e=>!e.read);for(const t of e)await b(t.id)},className:"w-full text-center text-sm font-semibold text-primary hover:text-primary-dark transition-colors",children:"Mark all as read"})})]})]})}},1019:(e,t,n)=>{function r(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}n.d(t,{w:()=>r})},1153:(e,t,n)=>{var r=n(5043),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:s,_owner:o.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},1387:(e,t,n)=>{function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}var i;n.d(t,{AO:()=>d,Gh:()=>L,HS:()=>F,Oi:()=>o,Rr:()=>h,pX:()=>q,pb:()=>A,rc:()=>i,tH:()=>z,ue:()=>m,yD:()=>M,zR:()=>a}),function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(i||(i={}));const s="popstate";function a(e){return void 0===e&&(e={}),f(function(e,t){let{pathname:n,search:r,hash:i}=e.location;return u("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:d(t)},null,e)}function o(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function l(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function c(e,t){return{usr:e.state,key:e.key,idx:t}}function u(e,t,n,i){return void 0===n&&(n=null),r({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?h(t):t,{state:n,key:t&&t.key||i||Math.random().toString(36).substr(2,8)})}function d(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function h(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function f(e,t,n,a){void 0===a&&(a={});let{window:l=document.defaultView,v5Compat:h=!1}=a,f=l.history,p=i.Pop,m=null,g=y();function y(){return(f.state||{idx:null}).idx}function v(){p=i.Pop;let e=y(),t=null==e?null:e-g;g=e,m&&m({action:p,location:w.location,delta:t})}function b(e){let t="null"!==l.location.origin?l.location.origin:l.location.href,n="string"===typeof e?e:d(e);return n=n.replace(/ $/,"%20"),o(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,f.replaceState(r({},f.state,{idx:g}),""));let w={get action(){return p},get location(){return e(l,f)},listen(e){if(m)throw new Error("A history only accepts one active listener");return l.addEventListener(s,v),m=e,()=>{l.removeEventListener(s,v),m=null}},createHref:e=>t(l,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){p=i.Push;let r=u(w.location,e,t);n&&n(r,e),g=y()+1;let s=c(r,g),a=w.createHref(r);try{f.pushState(s,"",a)}catch(o){if(o instanceof DOMException&&"DataCloneError"===o.name)throw o;l.location.assign(a)}h&&m&&m({action:p,location:w.location,delta:1})},replace:function(e,t){p=i.Replace;let r=u(w.location,e,t);n&&n(r,e),g=y();let s=c(r,g),a=w.createHref(r);f.replaceState(s,"",a),h&&m&&m({action:p,location:w.location,delta:0})},go:e=>f.go(e)};return w}var p;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(p||(p={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function m(e,t,n){return void 0===n&&(n="/"),g(e,t,n,!1)}function g(e,t,n,r){let i=A(("string"===typeof t?h(t):t).pathname||"/",n);if(null==i)return null;let s=y(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let a=null;for(let o=0;null==a&&o<s.length;++o){let e=C(i);a=N(s[o],e,r)}return a}function y(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(e,i,s)=>{let a={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};a.relativePath.startsWith("/")&&(o(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(r.length));let l=F([r,a.relativePath]),c=n.concat(a);e.children&&e.children.length>0&&(o(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+l+'".'),y(e.children,t,c,l)),(null!=e.path||e.index)&&t.push({path:l,score:S(l,e.index),routesMeta:c})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of v(e.path))i(e,t,r);else i(e,t)}),t}function v(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===r.length)return i?[s,""]:[s];let a=v(r.join("/")),o=[];return o.push(...a.map(e=>""===e?s:[s,e].join("/"))),i&&o.push(...a),o.map(t=>e.startsWith("/")&&""===t?"/":t)}const b=/^:[\w-]+$/,w=3,x=2,k=1,_=10,I=-2,E=e=>"*"===e;function S(e,t){let n=e.split("/"),r=n.length;return n.some(E)&&(r+=I),t&&(r+=x),n.filter(e=>!E(e)).reduce((e,t)=>e+(b.test(t)?w:""===t?k:_),r)}function N(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,i={},s="/",a=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===s?t:t.slice(s.length)||"/",u=T({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=T({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(i,u.params),a.push({params:i,pathname:F([s,u.pathname]),pathnameBase:U(F([s,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(s=F([s,u.pathnameBase]))}return a}function T(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);l("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let s=new RegExp(i,t?void 0:"i");return[s,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=o[n]||"";a=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:s,pathnameBase:a,pattern:e}}function C(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return l(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function A(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}const j=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,P=e=>j.test(e);function D(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}function R(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function O(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function M(e,t){let n=O(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function L(e,t,n,i){let s;void 0===i&&(i=!1),"string"===typeof e?s=h(e):(s=r({},e),o(!s.pathname||!s.pathname.includes("?"),R("?","pathname","search",s)),o(!s.pathname||!s.pathname.includes("#"),R("#","pathname","hash",s)),o(!s.search||!s.search.includes("#"),R("#","search","hash",s)));let a,c=""===e||""===s.pathname,u=c?"/":s.pathname;if(null==u)a=n;else{let e=t.length-1;if(!i&&u.startsWith("..")){let t=u.split("/");for(;".."===t[0];)t.shift(),e-=1;s.pathname=t.join("/")}a=e>=0?t[e]:"/"}let d=function(e,t){void 0===t&&(t="/");let n,{pathname:r,search:i="",hash:s=""}="string"===typeof e?h(e):e;if(r)if(P(r))n=r;else{if(r.includes("//")){let e=r;r=r.replace(/\/\/+/g,"/"),l(!1,"Pathnames cannot have embedded double slashes - normalizing "+e+" -> "+r)}n=r.startsWith("/")?D(r.substring(1),"/"):D(r,t)}else n=t;return{pathname:n,search:V(i),hash:B(s)}}(s,a),f=u&&"/"!==u&&u.endsWith("/"),p=(c||"."===u)&&n.endsWith("/");return d.pathname.endsWith("/")||!f&&!p||(d.pathname+="/"),d}const F=e=>e.join("/").replace(/\/\/+/g,"/"),U=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),V=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",B=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";class z extends Error{}function q(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const K=["post","put","patch","delete"],H=(new Set(K),["get",...K]);new Set(H),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred")},1479:(e,t,n)=>{n.d(t,{c:()=>u});const r={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function i(e){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const s={date:i({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:i({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:i({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},a={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function o(e){return(t,n)=>{let r;if("formatting"===(null!==n&&void 0!==n&&n.context?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,i=null!==n&&void 0!==n&&n.width?String(n.width):t;r=e.formattingValues[i]||e.formattingValues[t]}else{const t=e.defaultWidth,i=null!==n&&void 0!==n&&n.width?String(n.width):e.defaultWidth;r=e.values[i]||e.values[t]}return r[e.argumentCallback?e.argumentCallback(t):t]}}function l(e){return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=n.width,i=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],s=t.match(i);if(!s)return null;const a=s[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n;return}(o,e=>e.test(a)):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n;return}(o,e=>e.test(a));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;return{value:c,rest:t.slice(a.length)}}}var c;const u={code:"en-US",formatDistance:(e,t,n)=>{let i;const s=r[e];return i="string"===typeof s?s:1===t?s.one:s.other.replace("{{count}}",t.toString()),null!==n&&void 0!==n&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i},formatLong:s,formatRelative:(e,t,n,r)=>a[e],localize:{ordinalNumber:(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:o({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:o({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:o({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:o({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:o({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(c={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.match(c.matchPattern);if(!n)return null;const r=n[0],i=e.match(c.parsePattern);if(!i)return null;let s=c.valueCallback?c.valueCallback(i[0]):i[0];return s=t.valueCallback?t.valueCallback(s):s,{value:s,rest:e.slice(r.length)}}),era:l({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:l({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:l({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:l({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:l({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}}},1655:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(5043),i=n(3216),s=n(4505),a=n(2339),o=n(579);const l=()=>{const[e,t]=(0,r.useState)(!1),n=(0,i.Zp)(),l=async e=>{t(!0);try{const t=await s.Ay.createCheckoutSession({amount:e,type:"donation"});t.data&&t.data.url?window.location.href=t.data.url:a.Ay.error("Failed to start donation")}catch(n){console.error("Donation error:",n),a.Ay.error("Failed to start donation")}finally{t(!1)}};return(0,o.jsxs)("div",{className:"card p-8 mb-6 bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/30 dark:to-pink-900/30 border-2 border-purple-100 dark:border-purple-700",children:[(0,o.jsx)("h2",{className:"text-2xl font-display text-text-primary mb-4 text-center",children:"Keep Besties Free \ud83d\udc9c"}),(0,o.jsx)("p",{className:"text-text-secondary text-center mb-6",children:"Choose an amount that works for you - every bit helps keep Besties free for everyone"}),(0,o.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,o.jsxs)("button",{onClick:()=>l(1),disabled:e,className:"btn btn-secondary p-6 flex flex-col items-center gap-2 hover:scale-105 transition-transform",children:[(0,o.jsx)("span",{className:"text-2xl",children:"\ud83d\udc9c"}),(0,o.jsx)("span",{className:"font-display text-xl",children:"$1"}),(0,o.jsx)("span",{className:"text-xs text-text-secondary",children:"Support"})]}),(0,o.jsxs)("button",{onClick:()=>l(5),disabled:e,className:"btn btn-primary p-6 flex flex-col items-center gap-2 transform scale-105 shadow-lg hover:scale-110 transition-transform",children:[(0,o.jsx)("span",{className:"text-2xl",children:"\u2615"}),(0,o.jsx)("span",{className:"font-display text-xl",children:"$5"}),(0,o.jsx)("span",{className:"text-xs",children:"Coffee"})]}),(0,o.jsxs)("button",{onClick:()=>l(10),disabled:e,className:"btn btn-secondary p-6 flex flex-col items-center gap-2 hover:scale-105 transition-transform",children:[(0,o.jsx)("span",{className:"text-2xl",children:"\ud83c\udfac"}),(0,o.jsx)("span",{className:"font-display text-xl",children:"$10"}),(0,o.jsx)("span",{className:"text-xs text-text-secondary",children:"Movie Night"})]})]}),(0,o.jsx)("p",{className:"text-xs text-center text-text-secondary italic mb-4",children:"Monthly contribution - cancel anytime, no questions asked"}),(0,o.jsx)("button",{onClick:()=>n("/about"),className:"w-full font-semibold text-sm underline transition-colors text-primary hover:text-primary-dark dark:hover:text-primary-light",children:"Learn more about Besties \u2192"})]})}},2339:(e,t,n)=>{function r(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}n.d(t,{l$:()=>be,Ay:()=>we});var i=n(2555),s=n(5043);let a={data:""},o=e=>{if("object"==typeof window){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||a},l=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,c=/\/\*[^]*?\*\/|  +/g,u=/\n+/g,d=(e,t)=>{let n="",r="",i="";for(let s in e){let a=e[s];"@"==s[0]?"i"==s[1]?n=s+" "+a+";":r+="f"==s[1]?d(a,s):s+"{"+d(a,"k"==s[1]?"":t)+"}":"object"==typeof a?r+=d(a,t?t.replace(/([^,])+/g,e=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)):s):null!=a&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=d.p?d.p(s,a):s+":"+a+";")}return n+(t&&i?t+"{"+i+"}":i)+r},h={},f=e=>{if("object"==typeof e){let t="";for(let n in e)t+=n+f(e[n]);return t}return e},p=(e,t,n,r,i)=>{let s=f(e),a=h[s]||(h[s]=(e=>{let t=0,n=11;for(;t<e.length;)n=101*n+e.charCodeAt(t++)>>>0;return"go"+n})(s));if(!h[a]){let t=s!==e?e:(e=>{let t,n,r=[{}];for(;t=l.exec(e.replace(c,""));)t[4]?r.shift():t[3]?(n=t[3].replace(u," ").trim(),r.unshift(r[0][n]=r[0][n]||{})):r[0][t[1]]=t[2].replace(u," ").trim();return r[0]})(e);h[a]=d(i?{["@keyframes "+a]:t}:t,n?"":"."+a)}let o=n&&h.g?h.g:null;return n&&(h.g=h[a]),((e,t,n,r)=>{r?t.data=t.data.replace(r,e):-1===t.data.indexOf(e)&&(t.data=n?e+t.data:t.data+e)})(h[a],t,r,o),a};function m(e){let t=this||{},n=e.call?e(t.p):e;return p(n.unshift?n.raw?((e,t,n)=>e.reduce((e,r,i)=>{let s=t[i];if(s&&s.call){let e=s(n),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;s=t?"."+t:e&&"object"==typeof e?e.props?"":d(e,""):!1===e?"":e}return e+r+(null==s?"":s)},""))(n,[].slice.call(arguments,1),t.p):n.reduce((e,n)=>Object.assign(e,n&&n.call?n(t.p):n),{}):n,o(t.target),t.g,t.o,t.k)}m.bind({g:1});let g,y,v,b=m.bind({k:1});function w(e,t){let n=this||{};return function(){let r=arguments;function i(s,a){let o=Object.assign({},s),l=o.className||i.className;n.p=Object.assign({theme:y&&y()},o),n.o=/ *go\d+/.test(l),o.className=m.apply(n,r)+(l?" "+l:""),t&&(o.ref=a);let c=e;return e[0]&&(c=o.as||e,delete o.as),v&&c[0]&&v(o),g(c,o)}return t?t(i):i}}var x,k,_,I,E,S,N,T,C,A,j,P,D,R,O,M,L=(e,t)=>(e=>"function"==typeof e)(e)?e(t):e,F=(()=>{let e=0;return()=>(++e).toString()})(),U=(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),V="default",B=(e,t)=>{let{toastLimit:n}=e.settings;switch(t.type){case 0:return(0,i.A)((0,i.A)({},e),{},{toasts:[t.toast,...e.toasts].slice(0,n)});case 1:return(0,i.A)((0,i.A)({},e),{},{toasts:e.toasts.map(e=>e.id===t.toast.id?(0,i.A)((0,i.A)({},e),t.toast):e)});case 2:let{toast:r}=t;return B(e,{type:e.toasts.find(e=>e.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=t;return(0,i.A)((0,i.A)({},e),{},{toasts:e.toasts.map(e=>e.id===s||void 0===s?(0,i.A)((0,i.A)({},e),{},{dismissed:!0,visible:!1}):e)});case 4:return void 0===t.toastId?(0,i.A)((0,i.A)({},e),{},{toasts:[]}):(0,i.A)((0,i.A)({},e),{},{toasts:e.toasts.filter(e=>e.id!==t.toastId)});case 5:return(0,i.A)((0,i.A)({},e),{},{pausedAt:t.time});case 6:let a=t.time-(e.pausedAt||0);return(0,i.A)((0,i.A)({},e),{},{pausedAt:void 0,toasts:e.toasts.map(e=>(0,i.A)((0,i.A)({},e),{},{pauseDuration:e.pauseDuration+a}))})}},z=[],q={toasts:[],pausedAt:void 0,settings:{toastLimit:20}},K={},H=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:V;K[t]=B(K[t]||q,e),z.forEach(e=>{let[n,r]=e;n===t&&r(K[t])})},W=e=>Object.keys(K).forEach(t=>H(e,t)),G=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V;return t=>{H(t,e)}},Q={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Y=e=>(t,n)=>{let r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blank",n=arguments.length>2?arguments[2]:void 0;return(0,i.A)((0,i.A)({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0},n),{},{id:(null==n?void 0:n.id)||F()})}(t,e,n);return G(r.toasterId||(e=>Object.keys(K).find(t=>K[t].toasts.some(t=>t.id===e)))(r.id))({type:2,toast:r}),r.id},J=(e,t)=>Y("blank")(e,t);J.error=Y("error"),J.success=Y("success"),J.loading=Y("loading"),J.custom=Y("custom"),J.dismiss=(e,t)=>{let n={type:3,toastId:e};t?G(t)(n):W(n)},J.dismissAll=e=>J.dismiss(void 0,e),J.remove=(e,t)=>{let n={type:4,toastId:e};t?G(t)(n):W(n)},J.removeAll=e=>J.remove(void 0,e),J.promise=(e,t,n)=>{let r=J.loading(t.loading,(0,i.A)((0,i.A)({},n),null==n?void 0:n.loading));return"function"==typeof e&&(e=e()),e.then(e=>{let s=t.success?L(t.success,e):void 0;return s?J.success(s,(0,i.A)((0,i.A)({id:r},n),null==n?void 0:n.success)):J.dismiss(r),e}).catch(e=>{let s=t.error?L(t.error,e):void 0;s?J.error(s,(0,i.A)((0,i.A)({id:r},n),null==n?void 0:n.error)):J.dismiss(r)}),e};var X=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",{toasts:n,pausedAt:r}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:V,[n,r]=(0,s.useState)(K[t]||q),a=(0,s.useRef)(K[t]);(0,s.useEffect)(()=>(a.current!==K[t]&&r(K[t]),z.push([t,r]),()=>{let e=z.findIndex(e=>{let[n]=e;return n===t});e>-1&&z.splice(e,1)}),[t]);let o=n.toasts.map(t=>{var n,r,s;return(0,i.A)((0,i.A)((0,i.A)((0,i.A)({},e),e[t.type]),t),{},{removeDelay:t.removeDelay||(null==(n=e[t.type])?void 0:n.removeDelay)||(null==e?void 0:e.removeDelay),duration:t.duration||(null==(r=e[t.type])?void 0:r.duration)||(null==e?void 0:e.duration)||Q[t.type],style:(0,i.A)((0,i.A)((0,i.A)({},e.style),null==(s=e[t.type])?void 0:s.style),t.style)})});return(0,i.A)((0,i.A)({},n),{},{toasts:o})}(e,t),a=(0,s.useRef)(new Map).current,o=(0,s.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(a.has(e))return;let n=setTimeout(()=>{a.delete(e),l({type:4,toastId:e})},t);a.set(e,n)},[]);(0,s.useEffect)(()=>{if(r)return;let e=Date.now(),i=n.map(n=>{if(n.duration===1/0)return;let r=(n.duration||0)+n.pauseDuration-(e-n.createdAt);if(!(r<0))return setTimeout(()=>J.dismiss(n.id,t),r);n.visible&&J.dismiss(n.id)});return()=>{i.forEach(e=>e&&clearTimeout(e))}},[n,r,t]);let l=(0,s.useCallback)(G(t),[t]),c=(0,s.useCallback)(()=>{l({type:5,time:Date.now()})},[l]),u=(0,s.useCallback)((e,t)=>{l({type:1,toast:{id:e,height:t}})},[l]),d=(0,s.useCallback)(()=>{r&&l({type:6,time:Date.now()})},[r,l]),h=(0,s.useCallback)((e,t)=>{let{reverseOrder:r=!1,gutter:i=8,defaultPosition:s}=t||{},a=n.filter(t=>(t.position||s)===(e.position||s)&&t.height),o=a.findIndex(t=>t.id===e.id),l=a.filter((e,t)=>t<o&&e.visible).length;return a.filter(e=>e.visible).slice(...r?[l+1]:[0,l]).reduce((e,t)=>e+(t.height||0)+i,0)},[n]);return(0,s.useEffect)(()=>{n.forEach(e=>{if(e.dismissed)o(e.id,e.removeDelay);else{let t=a.get(e.id);t&&(clearTimeout(t),a.delete(e.id))}})},[n,o]),{toasts:n,handlers:{updateHeight:u,startPause:c,endPause:d,calculateOffset:h}}},$=b(x||(x=r(["\nfrom {\n  transform: scale(0) rotate(45deg);\n\topacity: 0;\n}\nto {\n transform: scale(1) rotate(45deg);\n  opacity: 1;\n}"]))),Z=b(k||(k=r(["\nfrom {\n  transform: scale(0);\n  opacity: 0;\n}\nto {\n  transform: scale(1);\n  opacity: 1;\n}"]))),ee=b(_||(_=r(["\nfrom {\n  transform: scale(0) rotate(90deg);\n\topacity: 0;\n}\nto {\n  transform: scale(1) rotate(90deg);\n\topacity: 1;\n}"]))),te=w("div")(I||(I=r(["\n  width: 20px;\n  opacity: 0;\n  height: 20px;\n  border-radius: 10px;\n  background: ",";\n  position: relative;\n  transform: rotate(45deg);\n\n  animation: "," 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n  animation-delay: 100ms;\n\n  &:after,\n  &:before {\n    content: '';\n    animation: "," 0.15s ease-out forwards;\n    animation-delay: 150ms;\n    position: absolute;\n    border-radius: 3px;\n    opacity: 0;\n    background: ",";\n    bottom: 9px;\n    left: 4px;\n    height: 2px;\n    width: 12px;\n  }\n\n  &:before {\n    animation: "," 0.15s ease-out forwards;\n    animation-delay: 180ms;\n    transform: rotate(90deg);\n  }\n"])),e=>e.primary||"#ff4b4b",$,Z,e=>e.secondary||"#fff",ee),ne=b(E||(E=r(["\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n"]))),re=w("div")(S||(S=r(["\n  width: 12px;\n  height: 12px;\n  box-sizing: border-box;\n  border: 2px solid;\n  border-radius: 100%;\n  border-color: ",";\n  border-right-color: ",";\n  animation: "," 1s linear infinite;\n"])),e=>e.secondary||"#e0e0e0",e=>e.primary||"#616161",ne),ie=b(N||(N=r(["\nfrom {\n  transform: scale(0) rotate(45deg);\n\topacity: 0;\n}\nto {\n  transform: scale(1) rotate(45deg);\n\topacity: 1;\n}"]))),se=b(T||(T=r(["\n0% {\n\theight: 0;\n\twidth: 0;\n\topacity: 0;\n}\n40% {\n  height: 0;\n\twidth: 6px;\n\topacity: 1;\n}\n100% {\n  opacity: 1;\n  height: 10px;\n}"]))),ae=w("div")(C||(C=r(["\n  width: 20px;\n  opacity: 0;\n  height: 20px;\n  border-radius: 10px;\n  background: ",";\n  position: relative;\n  transform: rotate(45deg);\n\n  animation: "," 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n  animation-delay: 100ms;\n  &:after {\n    content: '';\n    box-sizing: border-box;\n    animation: "," 0.2s ease-out forwards;\n    opacity: 0;\n    animation-delay: 200ms;\n    position: absolute;\n    border-right: 2px solid;\n    border-bottom: 2px solid;\n    border-color: ",";\n    bottom: 6px;\n    left: 6px;\n    height: 10px;\n    width: 6px;\n  }\n"])),e=>e.primary||"#61d345",ie,se,e=>e.secondary||"#fff"),oe=w("div")(A||(A=r(["\n  position: absolute;\n"]))),le=w("div")(j||(j=r(["\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-width: 20px;\n  min-height: 20px;\n"]))),ce=b(P||(P=r(["\nfrom {\n  transform: scale(0.6);\n  opacity: 0.4;\n}\nto {\n  transform: scale(1);\n  opacity: 1;\n}"]))),ue=w("div")(D||(D=r(["\n  position: relative;\n  transform: scale(0.6);\n  opacity: 0.4;\n  min-width: 20px;\n  animation: "," 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n"])),ce),de=e=>{let{toast:t}=e,{icon:n,type:r,iconTheme:a}=t;return void 0!==n?"string"==typeof n?s.createElement(ue,null,n):n:"blank"===r?null:s.createElement(le,null,s.createElement(re,(0,i.A)({},a)),"loading"!==r&&s.createElement(oe,null,"error"===r?s.createElement(te,(0,i.A)({},a)):s.createElement(ae,(0,i.A)({},a))))},he=e=>"\n0% {transform: translate3d(0,".concat(-200*e,"%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n"),fe=e=>"\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,".concat(-150*e,"%,-1px) scale(.6); opacity:0;}\n"),pe=w("div")(R||(R=r(["\n  display: flex;\n  align-items: center;\n  background: #fff;\n  color: #363636;\n  line-height: 1.3;\n  will-change: transform;\n  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);\n  max-width: 350px;\n  pointer-events: auto;\n  padding: 8px 10px;\n  border-radius: 8px;\n"]))),me=w("div")(O||(O=r(["\n  display: flex;\n  justify-content: center;\n  margin: 4px 10px;\n  color: inherit;\n  flex: 1 1 auto;\n  white-space: pre-line;\n"]))),ge=s.memo(e=>{let{toast:t,position:n,style:r,children:a}=e,o=t.height?((e,t)=>{let n=e.includes("top")?1:-1,[r,i]=U()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[he(n),fe(n)];return{animation:t?"".concat(b(r)," 0.35s cubic-bezier(.21,1.02,.73,1) forwards"):"".concat(b(i)," 0.4s forwards cubic-bezier(.06,.71,.55,1)")}})(t.position||n||"top-center",t.visible):{opacity:0},l=s.createElement(de,{toast:t}),c=s.createElement(me,(0,i.A)({},t.ariaProps),L(t.message,t));return s.createElement(pe,{className:t.className,style:(0,i.A)((0,i.A)((0,i.A)({},o),r),t.style)},"function"==typeof a?a({icon:l,message:c}):s.createElement(s.Fragment,null,l,c))});!function(e,t,n,r){d.p=t,g=e,y=n,v=r}(s.createElement);var ye=e=>{let{id:t,className:n,style:r,onHeightUpdate:i,children:a}=e,o=s.useCallback(e=>{if(e){let n=()=>{let n=e.getBoundingClientRect().height;i(t,n)};n(),new MutationObserver(n).observe(e,{subtree:!0,childList:!0,characterData:!0})}},[t,i]);return s.createElement("div",{ref:o,className:n,style:r},a)},ve=m(M||(M=r(["\n  z-index: 9999;\n  > * {\n    pointer-events: auto;\n  }\n"]))),be=e=>{let{reverseOrder:t,position:n="top-center",toastOptions:r,gutter:a,children:o,toasterId:l,containerStyle:c,containerClassName:u}=e,{toasts:d,handlers:h}=X(r,l);return s.createElement("div",{"data-rht-toaster":l||"",style:(0,i.A)({position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none"},c),className:u,onMouseEnter:h.startPause,onMouseLeave:h.endPause},d.map(e=>{let r=e.position||n,l=((e,t)=>{let n=e.includes("top"),r=n?{top:0}:{bottom:0},s=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return(0,i.A)((0,i.A)({left:0,right:0,display:"flex",position:"absolute",transition:U()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:"translateY(".concat(t*(n?1:-1),"px)")},r),s)})(r,h.calculateOffset(e,{reverseOrder:t,gutter:a,defaultPosition:n}));return s.createElement(ye,{id:e.id,key:e.id,onHeightUpdate:h.updateHeight,className:e.visible?ve:"",style:l},"custom"===e.type?L(e.message,e):o?o(e):s.createElement(ge,{toast:e,position:r}))}))},we=J},2555:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function s(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n.d(t,{A:()=>o})},2730:(e,t,n)=>{var r=n(5043),i=n(8853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,s,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),k=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),N=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var M,L=Object.assign;function F(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var U=!1;function V(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),s=r.stack.split("\n"),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||i[a]!==s[o]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function B(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case _:return"Fragment";case k:return"Portal";case E:return"Profiler";case I:return"StrictMode";case C:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case N:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case j:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return z(e(t))}catch(n){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function K(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=K(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function $(e,t){X(e,t);var n=K(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,K(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+K(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:K(n)}}function se(e,t){var n=K(t.value),r=K(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ye=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,_e=null,Ie=null;function Ee(e){if(e=bi(e)){if("function"!==typeof ke)throw Error(s(280));var t=e.stateNode;t&&(t=xi(t),ke(e.stateNode,e.type,t))}}function Se(e){_e?Ie?Ie.push(e):Ie=[e]:_e=e}function Ne(){if(_e){var e=_e,t=Ie;if(Ie=_e=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Te(e,t){return e(t)}function Ce(){}var Ae=!1;function je(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Te(e,t,n)}finally{Ae=!1,(null!==_e||null!==Ie)&&(Ce(),Ne())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=xi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var De=!1;if(u)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){De=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(ue){De=!1}function Oe(e,t,n,r,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Me=!1,Le=null,Fe=!1,Ue=null,Ve={onError:function(e){Me=!0,Le=e}};function Be(e,t,n,r,i,s,a,o,l){Me=!1,Le=null,Oe.apply(Ve,arguments)}function ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ke(e){if(ze(e)!==e)throw Error(s(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return Ke(i),e;if(a===r)return Ke(i),t;a=a.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Ge=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Je=i.unstable_requestPaint,Xe=i.unstable_now,$e=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~i;0!==o?r=dt(o):0!==(s&=a)&&(r=dt(s))}else 0!==(a=n&~i)?r=dt(a):0!==s&&(r=dt(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,kt,_t,It,Et,St=!1,Nt=[],Tt=null,Ct=null,At=null,jt=new Map,Pt=new Map,Dt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":jt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Mt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Lt(e){var t=vi(e.target);if(null!==t){var n=ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void Et(e.priority,function(){_t(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Ut(e,t,n){Ft(e)&&n.delete(t)}function Vt(){St=!1,null!==Tt&&Ft(Tt)&&(Tt=null),null!==Ct&&Ft(Ct)&&(Ct=null),null!==At&&Ft(At)&&(At=null),jt.forEach(Ut),Pt.forEach(Ut)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Vt)))}function zt(e){function t(t){return Bt(t,e)}if(0<Nt.length){Bt(Nt[0],e);for(var n=1;n<Nt.length;n++){var r=Nt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Tt&&Bt(Tt,e),null!==Ct&&Bt(Ct,e),null!==At&&Bt(At,e),jt.forEach(t),Pt.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Dt.shift()}var qt=w.ReactCurrentBatchConfig,Kt=!0;function Ht(e,t,n,r){var i=bt,s=qt.transition;qt.transition=null;try{bt=1,Gt(e,t,n,r)}finally{bt=i,qt.transition=s}}function Wt(e,t,n,r){var i=bt,s=qt.transition;qt.transition=null;try{bt=4,Gt(e,t,n,r)}finally{bt=i,qt.transition=s}}function Gt(e,t,n,r){if(Kt){var i=Yt(e,t,n,r);if(null===i)Kr(e,t,r,Qt,n),Ot(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Tt=Mt(Tt,e,t,n,r,i),!0;case"dragenter":return Ct=Mt(Ct,e,t,n,r,i),!0;case"mouseover":return At=Mt(At,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return jt.set(s,Mt(jt.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Pt.set(s,Mt(Pt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Ot(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==i;){var s=bi(i);if(null!==s&&xt(s),null===(s=Yt(e,t,n,r))&&Kr(e,t,r,Qt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else Kr(e,t,r,null,n)}}var Qt=null;function Yt(e,t,n,r){if(Qt=null,null!==(e=vi(e=xe(r))))if(null===(t=ze(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Xt=null,$t=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=$t,r=n.length,i="value"in Xt?Xt.value:Xt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[s-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),dn=L({},cn,{view:0,detail:0}),hn=sn(dn),fn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=sn(fn),mn=sn(L({},fn,{dataTransfer:0})),gn=sn(L({},dn,{relatedTarget:0})),yn=sn(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(vn),wn=sn(L({},cn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function In(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_n[e])&&!!t[e]}function En(){return In}var Sn=L({},dn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Nn=sn(Sn),Tn=sn(L({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=sn(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),An=sn(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),jn=L({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=sn(jn),Dn=[9,13,27,32],Rn=u&&"CompositionEvent"in window,On=null;u&&"documentMode"in document&&(On=document.documentMode);var Mn=u&&"TextEvent"in window&&!On,Ln=u&&(!Rn||On&&8<On&&11>=On),Fn=String.fromCharCode(32),Un=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zn=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Hn(e,t,n,r){Se(r),0<(t=Wr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Wn=null,Gn=null;function Qn(e){Fr(e,0)}function Yn(e){if(G(wi(e)))return e}function Jn(e,t){if("change"===e)return t}var Xn=!1;if(u){var $n;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}$n=Zn}else $n=!1;Xn=$n&&(!document.documentMode||9<document.documentMode)}function tr(){Wn&&(Wn.detachEvent("onpropertychange",nr),Gn=Wn=null)}function nr(e){if("value"===e.propertyName&&Yn(Gn)){var t=[];Hn(t,Gn,e,xe(e)),je(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Gn=n,(Wn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Gn)}function sr(e,t){if("click"===e)return Yn(t)}function ar(e,t){if("input"===e||"change"===e)return Yn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!or(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=ur(n,s);var a=ur(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==Q(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Wr(yr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function xr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},_r={},Ir={};function Er(e){if(_r[e])return _r[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ir)return _r[e]=n[t];return e}u&&(Ir=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Sr=Er("animationend"),Nr=Er("animationiteration"),Tr=Er("animationstart"),Cr=Er("transitionend"),Ar=new Map,jr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Ar.set(e,t),l(t,[e])}for(var Dr=0;Dr<jr.length;Dr++){var Rr=jr[Dr];Pr(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Pr(Sr,"onAnimationEnd"),Pr(Nr,"onAnimationIteration"),Pr(Tr,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Cr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Or="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Or));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,o,l,c){if(Be.apply(this,arguments),Me){if(!Me)throw Error(s(198));var u=Le;Me=!1,Le=null,Fe||(Fe=!0,Ue=u)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Lr(i,o,c),s=l}else for(a=0;a<r.length;a++){if(l=(o=r[a]).instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Lr(i,o,c),s=l}}}if(Fe)throw e=Ue,Fe=!1,Ue=null,e}function Ur(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(qr(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),qr(n,e,r,t)}var Br="_reactListening"+Math.random().toString(36).slice(2);function zr(e){if(!e[Br]){e[Br]=!0,a.forEach(function(t){"selectionchange"!==t&&(Mr.has(t)||Vr(t,!1,e),Vr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Br]||(t[Br]=!0,Vr("selectionchange",!1,t))}}function qr(e,t,n,r){switch(Jt(t)){case 1:var i=Ht;break;case 4:i=Wt;break;default:i=Gt}n=i.bind(null,t,n,e),i=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Kr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var o=r.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==o;){if(null===(a=vi(o)))return;if(5===(l=a.tag)||6===l){r=s=a;continue e}o=o.parentNode}}r=r.return}je(function(){var r=s,i=xe(n),a=[];e:{var o=Ar.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Nn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Cn;break;case Sr:case Nr:case Tr:l=yn;break;case Cr:l=An;break;case"scroll":l=hn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==h&&(null!=(m=Pe(p,h))&&u.push(Hr(p,m,f)))),d)break;p=p.return}0<u.length&&(o=new l(o,c,null,n,i),a.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!vi(c)&&!c[pi])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?vi(c):null)&&(c!==(d=ze(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,m="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Tn,m="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?o:wi(l),f=null==c?o:wi(c),(o=new u(m,p+"leave",l,n,i)).target=d,o.relatedTarget=f,m=null,vi(i)===r&&((u=new u(h,p+"enter",c,n,i)).target=f,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,p=0,f=u=l;f;f=Gr(f))p++;for(f=0,m=h;m;m=Gr(m))f++;for(;0<p-f;)u=Gr(u),p--;for(;0<f-p;)h=Gr(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Gr(u),h=Gr(h)}u=null}else u=null;null!==l&&Qr(a,o,l,u,!1),null!==c&&null!==d&&Qr(a,d,c,u,!0)}if("select"===(l=(o=r?wi(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Jn;else if(Kn(o))if(Xn)g=ar;else{g=ir;var y=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=sr);switch(g&&(g=g(e,r))?Hn(a,g,n,i):(y&&y(e,o,r),"focusout"===e&&(y=o._wrapperState)&&y.controlled&&"number"===o.type&&ee(o,"number",o.value)),y=r?wi(r):window,e){case"focusin":(Kn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(a,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(a,n,i)}var v;if(Rn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else zn?Vn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(zn||"onCompositionStart"!==b?"onCompositionEnd"===b&&zn&&(v=en()):($t="value"in(Xt=i)?Xt.value:Xt.textContent,zn=!0)),0<(y=Wr(r,b)).length&&(b=new wn(b,e,null,n,i),a.push({event:b,listeners:y}),v?b.data=v:null!==(v=Bn(n))&&(b.data=v))),(v=Mn?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Un=!0,Fn);case"textInput":return(e=t.data)===Fn&&Un?null:e;default:return null}}(e,n):function(e,t){if(zn)return"compositionend"===e||!Rn&&Vn(e,t)?(e=en(),Zt=$t=Xt=null,zn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Wr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=v))}Fr(a,t)})}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Pe(e,n))&&r.unshift(Hr(e,s,i)),null!=(s=Pe(e,t))&&r.push(Hr(e,s,i))),e=e.return}return r}function Gr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var s=t._reactName,a=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,i?null!=(l=Pe(n,s))&&a.unshift(Hr(n,l,o)):i||null!=(l=Pe(n,s))&&a.push(Hr(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Yr=/\r\n?/g,Jr=/\u0000|\uFFFD/g;function Xr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Jr,"")}function $r(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(s(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(oi)}:ri;function oi(e){setTimeout(function(){throw e})}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void zt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);zt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,fi="__reactProps$"+di,pi="__reactContainer$"+di,mi="__reactEvents$"+di,gi="__reactListeners$"+di,yi="__reactHandles$"+di;function vi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[hi])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[hi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function xi(e){return e[fi]||null}var ki=[],_i=-1;function Ii(e){return{current:e}}function Ei(e){0>_i||(e.current=ki[_i],ki[_i]=null,_i--)}function Si(e,t){_i++,ki[_i]=e.current,e.current=t}var Ni={},Ti=Ii(Ni),Ci=Ii(!1),Ai=Ni;function ji(e,t){var n=e.type.contextTypes;if(!n)return Ni;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Pi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Di(){Ei(Ci),Ei(Ti)}function Ri(e,t,n){if(Ti.current!==Ni)throw Error(s(168));Si(Ti,t),Si(Ci,n)}function Oi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,q(e)||"Unknown",i));return L({},n,r)}function Mi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ni,Ai=Ti.current,Si(Ti,e),Si(Ci,Ci.current),!0}function Li(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Oi(e,t,Ai),r.__reactInternalMemoizedMergedChildContext=e,Ei(Ci),Ei(Ti),Si(Ti,e)):Ei(Ci),Si(Ci,n)}var Fi=null,Ui=!1,Vi=!1;function Bi(e){null===Fi?Fi=[e]:Fi.push(e)}function zi(){if(!Vi&&null!==Fi){Vi=!0;var e=0,t=bt;try{var n=Fi;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fi=null,Ui=!1}catch(i){throw null!==Fi&&(Fi=Fi.slice(e+1)),Ge(Ze,zi),i}finally{bt=t,Vi=!1}}return null}var qi=[],Ki=0,Hi=null,Wi=0,Gi=[],Qi=0,Yi=null,Ji=1,Xi="";function $i(e,t){qi[Ki++]=Wi,qi[Ki++]=Hi,Hi=e,Wi=t}function Zi(e,t,n){Gi[Qi++]=Ji,Gi[Qi++]=Xi,Gi[Qi++]=Yi,Yi=e;var r=Ji;e=Xi;var i=32-at(r)-1;r&=~(1<<i),n+=1;var s=32-at(t)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Ji=1<<32-at(t)+i|n<<i|r,Xi=s+e}else Ji=1<<s|n<<i|r,Xi=e}function es(e){null!==e.return&&($i(e,1),Zi(e,1,0))}function ts(e){for(;e===Hi;)Hi=qi[--Ki],qi[Ki]=null,Wi=qi[--Ki],qi[Ki]=null;for(;e===Yi;)Yi=Gi[--Qi],Gi[Qi]=null,Xi=Gi[--Qi],Gi[Qi]=null,Ji=Gi[--Qi],Gi[Qi]=null}var ns=null,rs=null,is=!1,ss=null;function as(e,t){var n=jc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function os(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:Ji,overflow:Xi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=jc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(is){var t=rs;if(t){var n=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=ci(n.nextSibling);var r=ns;t&&os(e,t)?as(r,n):(e.flags=-4097&e.flags|2,is=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,is=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function ds(e){if(e!==ns)return!1;if(!is)return us(e),is=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw hs(),Error(s(418));for(;t;)as(e,t),t=ci(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ci(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=rs;e;)e=ci(e.nextSibling)}function fs(){rs=ns=null,is=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var ms=w.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function ys(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vs(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Lc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===_?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===P&&vs(s)===t.type)?((r=i(t,n.props)).ref=gs(e,t,n),r.return=e,r):((r=Rc(n.type,n.key,n.props,null,e.mode,r)).ref=gs(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,s){return null===t||7!==t.tag?((t=Oc(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=Rc(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case k:return(t=Fc(t,e.mode,n)).return=e,t;case P:return h(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Oc(t,e.mode,n,null)).return=e,t;ys(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===i?c(e,t,n,r):null;case k:return n.key===i?u(e,t,n,r):null;case P:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||O(n))return null!==i?null:d(e,t,n,r,null);ys(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case k:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case P:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||O(r))return d(t,e=e.get(n)||null,r,i,null);ys(t,r)}return null}function m(i,s,o,l){for(var c=null,u=null,d=s,m=s=0,g=null;null!==d&&m<o.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var y=f(i,d,o[m],l);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(i,d),s=a(y,s,m),null===u?c=y:u.sibling=y,u=y,d=g}if(m===o.length)return n(i,d),is&&$i(i,m),c;if(null===d){for(;m<o.length;m++)null!==(d=h(i,o[m],l))&&(s=a(d,s,m),null===u?c=d:u.sibling=d,u=d);return is&&$i(i,m),c}for(d=r(i,d);m<o.length;m++)null!==(g=p(d,i,m,o[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),s=a(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(i,e)}),is&&$i(i,m),c}function g(i,o,l,c){var u=O(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var d=u=null,m=o,g=o=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var b=f(i,m,v.value,c);if(null===b){null===m&&(m=y);break}e&&m&&null===b.alternate&&t(i,m),o=a(b,o,g),null===d?u=b:d.sibling=b,d=b,m=y}if(v.done)return n(i,m),is&&$i(i,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=h(i,v.value,c))&&(o=a(v,o,g),null===d?u=v:d.sibling=v,d=v);return is&&$i(i,g),u}for(m=r(i,m);!v.done;g++,v=l.next())null!==(v=p(m,i,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),o=a(v,o,g),null===d?u=v:d.sibling=v,d=v);return e&&m.forEach(function(e){return t(i,e)}),is&&$i(i,g),u}return function e(r,s,a,l){if("object"===typeof a&&null!==a&&a.type===_&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case x:e:{for(var c=a.key,u=s;null!==u;){if(u.key===c){if((c=a.type)===_){if(7===u.tag){n(r,u.sibling),(s=i(u,a.props.children)).return=r,r=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&vs(c)===u.type){n(r,u.sibling),(s=i(u,a.props)).ref=gs(r,u,a),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}a.type===_?((s=Oc(a.props.children,r.mode,l,a.key)).return=r,r=s):((l=Rc(a.type,a.key,a.props,null,r.mode,l)).ref=gs(r,s,a),l.return=r,r=l)}return o(r);case k:e:{for(u=a.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(r,s.sibling),(s=i(s,a.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Fc(a,r.mode,l)).return=r,r=s}return o(r);case P:return e(r,s,(u=a._init)(a._payload),l)}if(te(a))return m(r,s,a,l);if(O(a))return g(r,s,a,l);ys(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,a)).return=r,r=s):(n(r,s),(s=Lc(a,r.mode,l)).return=r,r=s),o(r)):n(r,s)}}var ws=bs(!0),xs=bs(!1),ks=Ii(null),_s=null,Is=null,Es=null;function Ss(){Es=Is=_s=null}function Ns(e){var t=ks.current;Ei(ks),e._currentValue=t}function Ts(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Cs(e,t){_s=e,Es=Is=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function As(e){var t=e._currentValue;if(Es!==e)if(e={context:e,memoizedValue:t,next:null},null===Is){if(null===_s)throw Error(s(308));Is=e,_s.dependencies={lanes:0,firstContext:e}}else Is=Is.next=e;return t}var js=null;function Ps(e){null===js?js=[e]:js.push(e)}function Ds(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Ps(t)):(n.next=i.next,i.next=n),t.interleaved=n,Rs(e,r)}function Rs(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Os=!1;function Ms(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Tl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Rs(e,n)}return null===(i=r.interleaved)?(t.next=t,Ps(r)):(t.next=i.next,i.next=t),r.interleaved=t,Rs(e,n)}function Vs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Bs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function zs(e,t,n,r){var i=e.updateQueue;Os=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?s=c:a.next=c,a=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=i.baseState;for(a=0,u=c=l=null,o=s;;){var h=o.lane,f=o.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(h=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=m.payload)?p.call(f,d,h):p)||void 0===h)break e;d=L({},d,h);break e;case 2:Os=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,a|=h;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(h=o).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);Ml|=a,e.lanes=a,e.memoizedState=d}}function qs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var Ks={},Hs=Ii(Ks),Ws=Ii(Ks),Gs=Ii(Ks);function Qs(e){if(e===Ks)throw Error(s(174));return e}function Ys(e,t){switch(Si(Gs,t),Si(Ws,e),Si(Hs,Ks),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ei(Hs),Si(Hs,t)}function Js(){Ei(Hs),Ei(Ws),Ei(Gs)}function Xs(e){Qs(Gs.current);var t=Qs(Hs.current),n=le(t,e.type);t!==n&&(Si(Ws,e),Si(Hs,n))}function $s(e){Ws.current===e&&(Ei(Hs),Ei(Ws))}var Zs=Ii(0);function ea(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ta=[];function na(){for(var e=0;e<ta.length;e++)ta[e]._workInProgressVersionPrimary=null;ta.length=0}var ra=w.ReactCurrentDispatcher,ia=w.ReactCurrentBatchConfig,sa=0,aa=null,oa=null,la=null,ca=!1,ua=!1,da=0,ha=0;function fa(){throw Error(s(321))}function pa(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function ma(e,t,n,r,i,a){if(sa=a,aa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ra.current=null===e||null===e.memoizedState?$a:Za,e=n(r,i),ua){a=0;do{if(ua=!1,da=0,25<=a)throw Error(s(301));a+=1,la=oa=null,t.updateQueue=null,ra.current=eo,e=n(r,i)}while(ua)}if(ra.current=Xa,t=null!==oa&&null!==oa.next,sa=0,la=oa=aa=null,ca=!1,t)throw Error(s(300));return e}function ga(){var e=0!==da;return da=0,e}function ya(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?aa.memoizedState=la=e:la=la.next=e,la}function va(){if(null===oa){var e=aa.alternate;e=null!==e?e.memoizedState:null}else e=oa.next;var t=null===la?aa.memoizedState:la.next;if(null!==t)la=t,oa=e;else{if(null===e)throw Error(s(310));e={memoizedState:(oa=e).memoizedState,baseState:oa.baseState,baseQueue:oa.baseQueue,queue:oa.queue,next:null},null===la?aa.memoizedState=la=e:la=la.next=e}return la}function ba(e,t){return"function"===typeof t?t(e):t}function wa(e){var t=va(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=oa,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((sa&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,aa.lanes|=d,Ml|=d}u=u.next}while(null!==u&&u!==a);null===c?o=r:c.next=l,or(r,t.memoizedState)||(bo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,aa.lanes|=a,Ml|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function xa(e){var t=va(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{a=e(a,o.action),o=o.next}while(o!==i);or(a,t.memoizedState)||(bo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function ka(){}function _a(e,t){var n=aa,r=va(),i=t(),a=!or(r.memoizedState,i);if(a&&(r.memoizedState=i,bo=!0),r=r.queue,Oa(Sa.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,Aa(9,Ea.bind(null,n,r,i,t),void 0,null),null===Cl)throw Error(s(349));0!==(30&sa)||Ia(n,t,i)}return i}function Ia(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ea(e,t,n,r){t.value=n,t.getSnapshot=r,Na(t)&&Ta(e)}function Sa(e,t,n){return n(function(){Na(t)&&Ta(e)})}function Na(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function Ta(e){var t=Rs(e,1);null!==t&&nc(t,e,1,-1)}function Ca(e){var t=ya();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:e},t.queue=e,e=e.dispatch=Ga.bind(null,aa,e),[t.memoizedState,e]}function Aa(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ja(){return va().memoizedState}function Pa(e,t,n,r){var i=ya();aa.flags|=e,i.memoizedState=Aa(1|t,n,void 0,void 0===r?null:r)}function Da(e,t,n,r){var i=va();r=void 0===r?null:r;var s=void 0;if(null!==oa){var a=oa.memoizedState;if(s=a.destroy,null!==r&&pa(r,a.deps))return void(i.memoizedState=Aa(t,n,s,r))}aa.flags|=e,i.memoizedState=Aa(1|t,n,s,r)}function Ra(e,t){return Pa(8390656,8,e,t)}function Oa(e,t){return Da(2048,8,e,t)}function Ma(e,t){return Da(4,2,e,t)}function La(e,t){return Da(4,4,e,t)}function Fa(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ua(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Da(4,4,Fa.bind(null,t,e),n)}function Va(){}function Ba(e,t){var n=va();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&pa(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function za(e,t){var n=va();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&pa(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function qa(e,t,n){return 0===(21&sa)?(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=n):(or(n,t)||(n=mt(),aa.lanes|=n,Ml|=n,e.baseState=!0),t)}function Ka(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ia.transition;ia.transition={};try{e(!1),t()}finally{bt=n,ia.transition=r}}function Ha(){return va().memoizedState}function Wa(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qa(e))Ya(t,n);else if(null!==(n=Ds(e,t,n,r))){nc(n,e,r,ec()),Ja(n,t,r)}}function Ga(e,t,n){var r=tc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qa(e))Ya(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(i.hasEagerState=!0,i.eagerState=o,or(o,a)){var l=t.interleaved;return null===l?(i.next=i,Ps(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Ds(e,t,i,r))&&(nc(n,e,r,i=ec()),Ja(n,t,r))}}function Qa(e){var t=e.alternate;return e===aa||null!==t&&t===aa}function Ya(e,t){ua=ca=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ja(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Xa={readContext:As,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},$a={readContext:As,useCallback:function(e,t){return ya().memoizedState=[e,void 0===t?null:t],e},useContext:As,useEffect:Ra,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pa(4194308,4,Fa.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Pa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pa(4,2,e,t)},useMemo:function(e,t){var n=ya();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ya();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Wa.bind(null,aa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ya().memoizedState=e},useState:Ca,useDebugValue:Va,useDeferredValue:function(e){return ya().memoizedState=e},useTransition:function(){var e=Ca(!1),t=e[0];return e=Ka.bind(null,e[1]),ya().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=aa,i=ya();if(is){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Cl)throw Error(s(349));0!==(30&sa)||Ia(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Ra(Sa.bind(null,r,a,e),[e]),r.flags|=2048,Aa(9,Ea.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=ya(),t=Cl.identifierPrefix;if(is){var n=Xi;t=":"+t+"R"+(n=(Ji&~(1<<32-at(Ji)-1)).toString(32)+n),0<(n=da++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ha++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Za={readContext:As,useCallback:Ba,useContext:As,useEffect:Oa,useImperativeHandle:Ua,useInsertionEffect:Ma,useLayoutEffect:La,useMemo:za,useReducer:wa,useRef:ja,useState:function(){return wa(ba)},useDebugValue:Va,useDeferredValue:function(e){return qa(va(),oa.memoizedState,e)},useTransition:function(){return[wa(ba)[0],va().memoizedState]},useMutableSource:ka,useSyncExternalStore:_a,useId:Ha,unstable_isNewReconciler:!1},eo={readContext:As,useCallback:Ba,useContext:As,useEffect:Oa,useImperativeHandle:Ua,useInsertionEffect:Ma,useLayoutEffect:La,useMemo:za,useReducer:xa,useRef:ja,useState:function(){return xa(ba)},useDebugValue:Va,useDeferredValue:function(e){var t=va();return null===oa?t.memoizedState=e:qa(t,oa.memoizedState,e)},useTransition:function(){return[xa(ba)[0],va().memoizedState]},useMutableSource:ka,useSyncExternalStore:_a,useId:Ha,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ro={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=Fs(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,i))&&(nc(t,e,i,r),Vs(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=Fs(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,i))&&(nc(t,e,i,r),Vs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),i=Fs(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Us(e,i,r))&&(nc(t,e,r,n),Vs(t,e,r))}};function io(e,t,n,r,i,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,s))}function so(e,t,n){var r=!1,i=Ni,s=t.contextType;return"object"===typeof s&&null!==s?s=As(s):(i=Pi(t)?Ai:Ti.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?ji(e,i):Ni),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ro,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function ao(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ro.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Ms(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=As(s):(s=Pi(t)?Ai:Ti.current,i.context=ji(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(no(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ro.enqueueReplaceState(i,i.state,null),zs(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",r=t;do{n+=B(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ho="function"===typeof WeakMap?WeakMap:Map;function fo(e,t,n){(n=Fs(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Kl||(Kl=!0,Hl=r),uo(0,t)},n}function po(e,t,n){(n=Fs(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){uo(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!==typeof r&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function mo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ho;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Ec.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yo(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fs(-1,1)).tag=2,Us(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var vo=w.ReactCurrentOwner,bo=!1;function wo(e,t,n,r){t.child=null===e?xs(t,null,n,r):ws(t,e.child,n,r)}function xo(e,t,n,r,i){n=n.render;var s=t.ref;return Cs(t,i),r=ma(e,t,n,r,s,i),n=ga(),null===e||bo?(is&&n&&es(t),t.flags|=1,wo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ko(e,t,i))}function ko(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Pc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,_o(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return Ko(e,t,i)}return t.flags|=1,(e=Dc(s,r)).ref=t.ref,e.return=t,t.child=e}function _o(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(bo=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,Ko(e,t,i);0!==(131072&e.flags)&&(bo=!0)}}return So(e,t,n,r,i)}function Io(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Si(Dl,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Si(Dl,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Si(Dl,Pl),Pl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Si(Dl,Pl),Pl|=r;return wo(e,t,i,n),t.child}function Eo(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function So(e,t,n,r,i){var s=Pi(n)?Ai:Ti.current;return s=ji(t,s),Cs(t,i),n=ma(e,t,n,r,s,i),r=ga(),null===e||bo?(is&&r&&es(t),t.flags|=1,wo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ko(e,t,i))}function No(e,t,n,r,i){if(Pi(n)){var s=!0;Mi(t)}else s=!1;if(Cs(t,i),null===t.stateNode)qo(e,t),so(t,n,r),oo(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=As(c):c=ji(t,c=Pi(n)?Ai:Ti.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==r||l!==c)&&ao(t,a,r,c),Os=!1;var h=t.memoizedState;a.state=h,zs(t,r,a,i),l=t.memoizedState,o!==r||h!==l||Ci.current||Os?("function"===typeof u&&(no(t,n,u,r),l=t.memoizedState),(o=Os||io(t,n,o,r,h,l,c))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Ls(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),a.props=c,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=As(l):l=ji(t,l=Pi(n)?Ai:Ti.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==d||h!==l)&&ao(t,a,r,l),Os=!1,h=t.memoizedState,a.state=h,zs(t,r,a,i);var p=t.memoizedState;o!==d||h!==p||Ci.current||Os?("function"===typeof f&&(no(t,n,f,r),p=t.memoizedState),(c=Os||io(t,n,c,r,h,p,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return To(e,t,n,r,s,i)}function To(e,t,n,r,i,s){Eo(e,t);var a=0!==(128&t.flags);if(!r&&!a)return i&&Li(t,n,!1),Ko(e,t,s);r=t.stateNode,vo.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=ws(t,e.child,null,s),t.child=ws(t,null,o,s)):wo(e,t,o,s),t.memoizedState=r.state,i&&Li(t,n,!0),t.child}function Co(e){var t=e.stateNode;t.pendingContext?Ri(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ri(0,t.context,!1),Ys(e,t.containerInfo)}function Ao(e,t,n,r,i){return fs(),ps(i),t.flags|=256,wo(e,t,n,r),t.child}var jo,Po,Do,Ro,Oo={dehydrated:null,treeContext:null,retryLane:0};function Mo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lo(e,t,n){var r,i=t.pendingProps,a=Zs.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Si(Zs,1&a),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,o?(i=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Mc(l,i,0,null),e=Oc(e,i,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Mo(n),t.memoizedState=Oo,e):Fo(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,o){if(n)return 256&t.flags?(t.flags&=-257,Uo(e,t,o,r=co(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Mc({mode:"visible",children:r.children},i,0,null),(a=Oc(a,i,o,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&ws(t,e.child,null,o),t.child.memoizedState=Mo(o),t.memoizedState=Oo,a);if(0===(1&t.mode))return Uo(e,t,o,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Uo(e,t,o,r=co(a=Error(s(419)),r,void 0))}if(l=0!==(o&e.childLanes),bo||l){if(null!==(r=Cl)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|o))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Rs(e,i),nc(r,e,i,-1))}return mc(),Uo(e,t,o,r=co(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Nc.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,rs=ci(i.nextSibling),ns=t,is=!0,ss=null,null!==e&&(Gi[Qi++]=Ji,Gi[Qi++]=Xi,Gi[Qi++]=Yi,Ji=e.id,Xi=e.overflow,Yi=t),t=Fo(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,a,n);if(o){o=i.fallback,l=t.mode,r=(a=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Dc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==r?o=Dc(r,o):(o=Oc(o,l,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,l=null===(l=e.child.memoizedState)?Mo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Oo,i}return e=(o=e.child).sibling,i=Dc(o,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Fo(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uo(e,t,n,r){return null!==r&&ps(r),ws(t,e.child,null,n),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Vo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ts(e.return,t,n)}function Bo(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function zo(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(wo(e,t,r.children,n),0!==(2&(r=Zs.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Vo(e,n,t);else if(19===e.tag)Vo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Si(Zs,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ea(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Bo(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ea(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Bo(t,!0,n,null,s);break;case"together":Bo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ko(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Dc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ho(e,t){if(!is)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Wo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Go(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wo(t),null;case 1:case 17:return Pi(t.type)&&Di(),Wo(t),null;case 3:return r=t.stateNode,Js(),Ei(Ci),Ei(Ti),na(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ac(ss),ss=null))),Po(e,t),Wo(t),null;case 5:$s(t);var i=Qs(Gs.current);if(n=t.type,null!==e&&null!=t.stateNode)Do(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Wo(t),null}if(e=Qs(Hs.current),ds(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[hi]=t,r[fi]=a,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(i=0;i<Or.length;i++)Ur(Or[i],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":J(r,a),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ur("invalid",r);break;case"textarea":ie(r,a),Ur("invalid",r)}for(var l in ve(n,a),i=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&$r(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&$r(r.textContent,c,e),i=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":W(r),Z(r,a,!0);break;case"textarea":W(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hi]=t,e[fi]=r,jo(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),i=r;break;case"iframe":case"object":case"embed":Ur("load",e),i=r;break;case"video":case"audio":for(i=0;i<Or.length;i++)Ur(Or[i],e);i=r;break;case"source":Ur("error",e),i=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),i=r;break;case"details":Ur("toggle",e),i=r;break;case"input":J(e,r),i=Y(e,r),Ur("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=L({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Ur("invalid",e)}for(a in ve(n,i),c=i)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?ge(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Ur("scroll",e):null!=u&&b(e,a,u,l))}switch(n){case"input":W(e),Z(e,r,!1);break;case"textarea":W(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+K(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Wo(t),null;case 6:if(e&&null!=t.stateNode)Ro(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Qs(Gs.current),Qs(Hs.current),ds(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(a=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:$r(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$r(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Wo(t),null;case 13:if(Ei(Zs),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(is&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))hs(),fs(),t.flags|=98560,a=!1;else if(a=ds(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[hi]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Wo(t),a=!1}else null!==ss&&(ac(ss),ss=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===Rl&&(Rl=3):mc())),null!==t.updateQueue&&(t.flags|=4),Wo(t),null);case 4:return Js(),Po(e,t),null===e&&zr(t.stateNode.containerInfo),Wo(t),null;case 10:return Ns(t.type._context),Wo(t),null;case 19:if(Ei(Zs),null===(a=t.memoizedState))return Wo(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Ho(a,!1);else{if(0!==Rl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ea(e))){for(t.flags|=128,Ho(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Si(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==a.tail&&Xe()>zl&&(t.flags|=128,r=!0,Ho(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ea(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ho(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!is)return Wo(t),null}else 2*Xe()-a.renderingStartTime>zl&&1073741824!==n&&(t.flags|=128,r=!0,Ho(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Xe(),t.sibling=null,n=Zs.current,Si(Zs,r?1&n|2:1&n),t):(Wo(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(Wo(t),6&t.subtreeFlags&&(t.flags|=8192)):Wo(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Qo(e,t){switch(ts(t),t.tag){case 1:return Pi(t.type)&&Di(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Js(),Ei(Ci),Ei(Ti),na(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return $s(t),null;case 13:if(Ei(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ei(Zs),null;case 4:return Js(),null;case 10:return Ns(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}jo=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Po=function(){},Do=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Qs(Hs.current);var s,a=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),a=[];break;case"select":i=L({},i,{value:void 0}),r=L({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ve(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ur("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Ro=function(e,t,n,r){n!==r&&(t.flags|=4)};var Yo=!1,Jo=!1,Xo="function"===typeof WeakSet?WeakSet:Set,$o=null;function Zo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ic(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Ic(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&el(t,n,s)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[fi],delete t[mi],delete t[gi],delete t[yi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(o){}switch(n.tag){case 5:Jo||Zo(n,t);case 6:var r=ul,i=dl;ul=null,hl(e,t,n),dl=i,null!==(ul=r)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),zt(e)):li(ul,n.stateNode));break;case 4:r=ul,i=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=r,dl=i;break;case 0:case 11:case 14:case 15:if(!Jo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,void 0!==a&&(0!==(2&s)||0!==(4&s))&&el(n,t,a),i=i.next}while(i!==r)}hl(e,t,n);break;case 1:if(!Jo&&(Zo(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Ic(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Jo=(r=Jo)||null!==n.memoizedState,hl(e,t,n),Jo=r):hl(e,t,n);break;default:hl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xo),t.forEach(function(t){var r=Tc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));fl(a,o,i),ul=null,dl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Ic(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Ic(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Ic(e,e.return,g)}}break;case 1:ml(t,e),yl(e),512&r&&null!==n&&Zo(n,n.return);break;case 5:if(ml(t,e),yl(e),512&r&&null!==n&&Zo(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(g){Ic(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&X(i,a),be(l,o);var u=be(l,a);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];"style"===d?ge(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):b(i,d,h,u)}switch(l){case"input":$(i,a);break;case"textarea":se(i,a);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?ne(i,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[fi]=a}catch(g){Ic(e,e.return,g)}}break;case 6:if(ml(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){Ic(e,e.return,g)}}break;case 3:if(ml(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(g){Ic(e,e.return,g)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(Bl=Xe())),4&r&&pl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Jo=(u=Jo)||d,ml(t,e),Jo=u):ml(t,e),yl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for($o=e,d=e.child;null!==d;){for(h=$o=d;null!==$o;){switch(p=(f=$o).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Zo(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Ic(r,n,g)}}break;case 5:Zo(f,f.return);break;case 22:if(null!==f.memoizedState){xl(h);continue}}null!==p?(p.return=f,$o=p):xl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,u?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){Ic(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Ic(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),yl(e),4&r&&pl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),cl(e,ol(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;ll(e,ol(e),a);break;default:throw Error(s(161))}}catch(o){Ic(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){$o=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==$o;){var i=$o,s=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Yo;if(!a){var o=i.alternate,l=null!==o&&null!==o.memoizedState||Jo;o=Yo;var c=Jo;if(Yo=a,(Jo=l)&&!c)for($o=i;null!==$o;)l=(a=$o).child,22===a.tag&&null!==a.memoizedState?kl(i):null!==l?(l.return=a,$o=l):kl(i);for(;null!==s;)$o=s,bl(s,t,n),s=s.sibling;$o=i,Yo=o,Jo=c}wl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,$o=s):wl(e)}}function wl(e){for(;null!==$o;){var t=$o;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Jo||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Jo)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&qs(t,a,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}qs(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&zt(h)}}}break;default:throw Error(s(163))}Jo||512&t.flags&&il(t)}catch(f){Ic(t,t.return,f)}}if(t===e){$o=null;break}if(null!==(n=t.sibling)){n.return=t.return,$o=n;break}$o=t.return}}function xl(e){for(;null!==$o;){var t=$o;if(t===e){$o=null;break}var n=t.sibling;if(null!==n){n.return=t.return,$o=n;break}$o=t.return}}function kl(e){for(;null!==$o;){var t=$o;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Ic(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Ic(t,i,l)}}var s=t.return;try{il(t)}catch(l){Ic(t,s,l)}break;case 5:var a=t.return;try{il(t)}catch(l){Ic(t,a,l)}}}catch(l){Ic(t,t.return,l)}if(t===e){$o=null;break}var o=t.sibling;if(null!==o){o.return=t.return,$o=o;break}$o=t.return}}var _l,Il=Math.ceil,El=w.ReactCurrentDispatcher,Sl=w.ReactCurrentOwner,Nl=w.ReactCurrentBatchConfig,Tl=0,Cl=null,Al=null,jl=0,Pl=0,Dl=Ii(0),Rl=0,Ol=null,Ml=0,Ll=0,Fl=0,Ul=null,Vl=null,Bl=0,zl=1/0,ql=null,Kl=!1,Hl=null,Wl=null,Gl=!1,Ql=null,Yl=0,Jl=0,Xl=null,$l=-1,Zl=0;function ec(){return 0!==(6&Tl)?Xe():-1!==$l?$l:$l=Xe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Tl)&&0!==jl?jl&-jl:null!==ms.transition?(0===Zl&&(Zl=mt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function nc(e,t,n,r){if(50<Jl)throw Jl=0,Xl=null,Error(s(185));yt(e,n,r),0!==(2&Tl)&&e===Cl||(e===Cl&&(0===(2&Tl)&&(Ll|=n),4===Rl&&oc(e,jl)),rc(e,r),1===n&&0===Tl&&0===(1&t.mode)&&(zl=Xe()+500,Ui&&zi()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-at(s),o=1<<a,l=i[a];-1===l?0!==(o&n)&&0===(o&r)||(i[a]=ft(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var r=ht(e,e===Cl?jl:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Ui=!0,Bi(e)}(lc.bind(null,e)):Bi(lc.bind(null,e)),ai(function(){0===(6&Tl)&&zi()}),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Cc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if($l=-1,Zl=0,0!==(6&Tl))throw Error(s(327));var n=e.callbackNode;if(kc()&&e.callbackNode!==n)return null;var r=ht(e,e===Cl?jl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var i=Tl;Tl|=2;var a=pc();for(Cl===e&&jl===t||(ql=null,zl=Xe()+500,hc(e,t));;)try{vc();break}catch(l){fc(e,l)}Ss(),El.current=a,Tl=i,null!==Al?t=0:(Cl=null,jl=0,t=Rl)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=sc(e,i))),1===t)throw n=Ol,hc(e,0),oc(e,r),rc(e,Xe()),n;if(6===t)oc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!or(s(),i))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gc(e,r))&&(0!==(a=pt(e))&&(r=a,t=sc(e,a))),1===t))throw n=Ol,hc(e,0),oc(e,r),rc(e,Xe()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:xc(e,Vl,ql);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=Bl+500-Xe())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(xc.bind(null,e,Vl,ql),t);break}xc(e,Vl,ql);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-at(r);a=1<<o,(o=t[o])>i&&(i=o),r&=~a}if(r=i,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Il(r/1960))-r)){e.timeoutHandle=ri(xc.bind(null,e,Vl,ql),r);break}xc(e,Vl,ql);break;default:throw Error(s(329))}}}return rc(e,Xe()),e.callbackNode===n?ic.bind(null,e):null}function sc(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Vl,Vl=n,null!==t&&ac(t)),e}function ac(e){null===Vl?Vl=e:Vl.push.apply(Vl,e)}function oc(e,t){for(t&=~Fl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Tl))throw Error(s(327));kc();var t=ht(e,0);if(0===(1&t))return rc(e,Xe()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=sc(e,r))}if(1===n)throw n=Ol,hc(e,0),oc(e,t),rc(e,Xe()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,Vl,ql),rc(e,Xe()),null}function cc(e,t){var n=Tl;Tl|=1;try{return e(t)}finally{0===(Tl=n)&&(zl=Xe()+500,Ui&&zi())}}function uc(e){null!==Ql&&0===Ql.tag&&0===(6&Tl)&&kc();var t=Tl;Tl|=1;var n=Nl.transition,r=bt;try{if(Nl.transition=null,bt=1,e)return e()}finally{bt=r,Nl.transition=n,0===(6&(Tl=t))&&zi()}}function dc(){Pl=Dl.current,Ei(Dl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Al)for(n=Al.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Di();break;case 3:Js(),Ei(Ci),Ei(Ti),na();break;case 5:$s(r);break;case 4:Js();break;case 13:case 19:Ei(Zs);break;case 10:Ns(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Cl=e,Al=e=Dc(e.current,null),jl=Pl=t,Rl=0,Ol=null,Fl=Ll=Ml=0,Vl=Ul=null,null!==js){for(t=0;t<js.length;t++)if(null!==(r=(n=js[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var a=s.next;s.next=i,r.next=a}n.pending=r}js=null}return e}function fc(e,t){for(;;){var n=Al;try{if(Ss(),ra.current=Xa,ca){for(var r=aa.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ca=!1}if(sa=0,la=oa=aa=null,ua=!1,da=0,Sl.current=null,null===n||null===n.return){Rl=1,Ol=t,Al=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=jl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=go(o);if(null!==p){p.flags&=-257,yo(p,o,l,0,t),1&p.mode&&mo(a,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){mo(a,u,t),mc();break e}c=Error(s(426))}else if(is&&1&l.mode){var y=go(o);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),yo(y,o,l,0,t),ps(lo(c,l));break e}}a=c=lo(c,l),4!==Rl&&(Rl=2),null===Ul?Ul=[a]:Ul.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Bs(a,fo(0,c,t));break e;case 1:l=c;var v=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Wl||!Wl.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,Bs(a,po(a,l,t));break e}}a=a.return}while(null!==a)}wc(n)}catch(w){t=w,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function pc(){var e=El.current;return El.current=Xa,null===e?Xa:e}function mc(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Cl||0===(268435455&Ml)&&0===(268435455&Ll)||oc(Cl,jl)}function gc(e,t){var n=Tl;Tl|=2;var r=pc();for(Cl===e&&jl===t||(ql=null,hc(e,t));;)try{yc();break}catch(i){fc(e,i)}if(Ss(),Tl=n,El.current=r,null!==Al)throw Error(s(261));return Cl=null,jl=0,Rl}function yc(){for(;null!==Al;)bc(Al)}function vc(){for(;null!==Al&&!Ye();)bc(Al)}function bc(e){var t=_l(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?wc(e):Al=t,Sl.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Go(n,t,Pl)))return void(Al=n)}else{if(null!==(n=Qo(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Rl=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Rl&&(Rl=5)}function xc(e,t,n){var r=bt,i=Nl.transition;try{Nl.transition=null,bt=1,function(e,t,n,r){do{kc()}while(null!==Ql);if(0!==(6&Tl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,a),e===Cl&&(Al=Cl=null,jl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gl||(Gl=!0,Cc(tt,function(){return kc(),null})),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Nl.transition,Nl.transition=null;var o=bt;bt=1;var l=Tl;Tl|=4,Sl.current=null,function(e,t){if(ei=Kt,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(x){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(l=o+i),h!==a||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===i&&(l=o),f===a&&++d===r&&(c=o),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Kt=!1,$o=t;null!==$o;)if(e=(t=$o).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$o=e;else for(;null!==$o;){t=$o;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(x){Ic(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,$o=e;break}$o=t.return}m=tl,tl=!1}(e,n),gl(n,e),pr(ti),Kt=!!ei,ti=ei=null,e.current=n,vl(n,e,i),Je(),Tl=l,bt=o,Nl.transition=a}else e.current=n;if(Gl&&(Gl=!1,Ql=e,Yl=i),a=e.pendingLanes,0===a&&(Wl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Kl)throw Kl=!1,e=Hl,Hl=null,e;0!==(1&Yl)&&0!==e.tag&&kc(),a=e.pendingLanes,0!==(1&a)?e===Xl?Jl++:(Jl=0,Xl=e):Jl=0,zi()}(e,t,n,r)}finally{Nl.transition=i,bt=r}return null}function kc(){if(null!==Ql){var e=wt(Yl),t=Nl.transition,n=bt;try{if(Nl.transition=null,bt=16>e?16:e,null===Ql)var r=!1;else{if(e=Ql,Ql=null,Yl=0,0!==(6&Tl))throw Error(s(331));var i=Tl;for(Tl|=4,$o=e.current;null!==$o;){var a=$o,o=a.child;if(0!==(16&$o.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for($o=u;null!==$o;){var d=$o;switch(d.tag){case 0:case 11:case 15:nl(8,d,a)}var h=d.child;if(null!==h)h.return=d,$o=h;else for(;null!==$o;){var f=(d=$o).sibling,p=d.return;if(sl(d),d===u){$o=null;break}if(null!==f){f.return=p,$o=f;break}$o=p}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}$o=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,$o=o;else e:for(;null!==$o;){if(0!==(2048&(a=$o).flags))switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,$o=v;break e}$o=a.return}}var b=e.current;for($o=b;null!==$o;){var w=(o=$o).child;if(0!==(2064&o.subtreeFlags)&&null!==w)w.return=o,$o=w;else e:for(o=b;null!==$o;){if(0!==(2048&(l=$o).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(k){Ic(l,l.return,k)}if(l===o){$o=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,$o=x;break e}$o=l.return}}if(Tl=i,zi(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(k){}r=!0}return r}finally{bt=n,Nl.transition=t}}return!1}function _c(e,t,n){e=Us(e,t=fo(0,t=lo(n,t),1),1),t=ec(),null!==e&&(yt(e,1,t),rc(e,t))}function Ic(e,t,n){if(3===e.tag)_c(e,e,n);else for(;null!==t;){if(3===t.tag){_c(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Wl||!Wl.has(r))){t=Us(t,e=po(t,e=lo(n,e),1),1),e=ec(),null!==t&&(yt(t,1,e),rc(t,e));break}}t=t.return}}function Ec(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Cl===e&&(jl&n)===n&&(4===Rl||3===Rl&&(130023424&jl)===jl&&500>Xe()-Bl?hc(e,0):Fl|=n),rc(e,t)}function Sc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Rs(e,t))&&(yt(e,t,n),rc(e,n))}function Nc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Sc(e,n)}function Tc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Sc(e,n)}function Cc(e,t){return Ge(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jc(e,t,n,r){return new Ac(e,t,n,r)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var n=e.alternate;return null===n?((n=jc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rc(e,t,n,r,i,a){var o=2;if(r=e,"function"===typeof e)Pc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case _:return Oc(n.children,i,a,t);case I:o=8,i|=8;break;case E:return(e=jc(12,n,t,2|i)).elementType=E,e.lanes=a,e;case C:return(e=jc(13,n,t,i)).elementType=C,e.lanes=a,e;case A:return(e=jc(19,n,t,i)).elementType=A,e.lanes=a,e;case D:return Mc(n,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:o=10;break e;case N:o=9;break e;case T:o=11;break e;case j:o=14;break e;case P:o=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=jc(o,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Oc(e,t,n,r){return(e=jc(7,e,r,t)).lanes=n,e}function Mc(e,t,n,r){return(e=jc(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=jc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=jc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Vc(e,t,n,r,i,s,a,o,l){return e=new Uc(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=jc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ms(s),e}function Bc(e){if(!e)return Ni;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Pi(n))return Oi(e,n,t)}return t}function zc(e,t,n,r,i,s,a,o,l){return(e=Vc(n,r,!0,e,0,s,0,o,l)).context=Bc(null),n=e.current,(s=Fs(r=ec(),i=tc(n))).callback=void 0!==t&&null!==t?t:null,Us(n,s,i),e.current.lanes=i,yt(e,i,r),rc(e,r),e}function qc(e,t,n,r){var i=t.current,s=ec(),a=tc(i);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fs(s,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Us(i,t,a))&&(nc(e,i,a,s),Vs(e,i,a)),a}function Kc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}_l=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ci.current)bo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bo=!1,function(e,t,n){switch(t.tag){case 3:Co(t),fs();break;case 5:Xs(t);break;case 1:Pi(t.type)&&Mi(t);break;case 4:Ys(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Si(ks,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Si(Zs,1&Zs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Lo(e,t,n):(Si(Zs,1&Zs.current),null!==(e=Ko(e,t,n))?e.sibling:null);Si(Zs,1&Zs.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return zo(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Si(Zs,Zs.current),r)break;return null;case 22:case 23:return t.lanes=0,Io(e,t,n)}return Ko(e,t,n)}(e,t,n);bo=0!==(131072&e.flags)}else bo=!1,is&&0!==(1048576&t.flags)&&Zi(t,Wi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;qo(e,t),e=t.pendingProps;var i=ji(t,Ti.current);Cs(t,n),i=ma(null,t,r,e,i,n);var a=ga();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pi(r)?(a=!0,Mi(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ms(t),i.updater=ro,t.stateNode=i,i._reactInternals=t,oo(t,r,e,n),t=To(null,t,r,!0,a,n)):(t.tag=0,is&&a&&es(t),wo(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(qo(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===j)return 14}return 2}(r),e=to(r,e),i){case 0:t=So(null,t,r,e,n);break e;case 1:t=No(null,t,r,e,n);break e;case 11:t=xo(null,t,r,e,n);break e;case 14:t=ko(null,t,r,to(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,So(e,t,r,i=t.elementType===r?i:to(r,i),n);case 1:return r=t.type,i=t.pendingProps,No(e,t,r,i=t.elementType===r?i:to(r,i),n);case 3:e:{if(Co(t),null===e)throw Error(s(387));r=t.pendingProps,i=(a=t.memoizedState).element,Ls(e,t),zs(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Ao(e,t,r,n,i=lo(Error(s(423)),t));break e}if(r!==i){t=Ao(e,t,r,n,i=lo(Error(s(424)),t));break e}for(rs=ci(t.stateNode.containerInfo.firstChild),ns=t,is=!0,ss=null,n=xs(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),r===i){t=Ko(e,t,n);break e}wo(e,t,r,n)}t=t.child}return t;case 5:return Xs(t),null===e&&cs(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,o=i.children,ni(r,i)?o=null:null!==a&&ni(r,a)&&(t.flags|=32),Eo(e,t),wo(e,t,o,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Lo(e,t,n);case 4:return Ys(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ws(t,null,r,n):wo(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,xo(e,t,r,i=t.elementType===r?i:to(r,i),n);case 7:return wo(e,t,t.pendingProps,n),t.child;case 8:case 12:return wo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,Si(ks,r._currentValue),r._currentValue=o,null!==a)if(or(a.value,o)){if(a.children===i.children&&!Ci.current){t=Ko(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===a.tag){(c=Fs(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Ts(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ts(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}wo(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Cs(t,n),r=r(i=As(i)),t.flags|=1,wo(e,t,r,n),t.child;case 14:return i=to(r=t.type,t.pendingProps),ko(e,t,r,i=to(r.type,i),n);case 15:return _o(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:to(r,i),qo(e,t),t.tag=1,Pi(r)?(e=!0,Mi(t)):e=!1,Cs(t,n),so(t,r,i),oo(t,r,i,n),To(null,t,r,!0,e,n);case 19:return zo(e,t,n);case 22:return Io(e,t,n)}throw Error(s(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $c(){}function Zc(e,t,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if("function"===typeof i){var o=i;i=function(){var e=Kc(a);o.call(e)}}qc(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=Kc(a);s.call(e)}}var a=zc(t,r,e,0,null,!1,0,"",$c);return e._reactRootContainer=a,e[pi]=a.current,zr(8===e.nodeType?e.parentNode:e),uc(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var o=r;r=function(){var e=Kc(l);o.call(e)}}var l=Vc(e,0,!1,null,0,!1,0,"",$c);return e._reactRootContainer=l,e[pi]=l.current,zr(8===e.nodeType?e.parentNode:e),uc(function(){qc(t,l,n,r)}),l}(n,t,e,i,r);return Kc(a)}Yc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));qc(e,t,null,null)},Yc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){qc(null,e,null,null)}),t[pi]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=It();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Lt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),rc(t,Xe()),0===(6&Tl)&&(zl=Xe()+500,zi()))}break;case 13:uc(function(){var t=Rs(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),Wc(e,1)}},kt=function(e){if(13===e.tag){var t=Rs(e,134217728);if(null!==t)nc(t,e,134217728,ec());Wc(e,134217728)}},_t=function(e){if(13===e.tag){var t=tc(e),n=Rs(e,t);if(null!==n)nc(n,e,t,ec());Wc(e,t)}},It=function(){return bt},Et=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},ke=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=xi(r);if(!i)throw Error(s(90));G(r),$(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=cc,Ce=uc;var eu={usingClientEntryPoint:!1,Events:[bi,wi,xi,Se,Ne,cc]},tu={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{it=ru.inject(nu),st=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(s(299));var n=!1,r="",i=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Vc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,zr(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(s(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",o=Gc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=zc(t,null,e,1,null!=n?n:null,i,0,a,o),e[pi]=t.current,zr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Yc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(s(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(s(40));return!!e._reactRootContainer&&(uc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[pi]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},2799:(e,t,n)=>{n.d(t,{MR:()=>v,P2:()=>y});var r=n(2555);const i=(e,t)=>t.some(t=>e instanceof t);let s,a;const o=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap;let h={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return l.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return m(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function f(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(a||(a=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(g(this),n),m(o.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return m(e.apply(g(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(g(this),t,...r);return c.set(s,t.sort?t.sort():[t]),m(s)}}function p(e){return"function"===typeof e?f(e):(e instanceof IDBTransaction&&function(e){if(l.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});l.set(e,t)}(e),i(e,s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,h):e)}function m(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(m(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&o.set(t,e)}).catch(()=>{}),d.set(t,e),t}(e);if(u.has(e))return u.get(e);const t=p(e);return t!==e&&(u.set(e,t),d.set(t,e)),t}const g=e=>d.get(e);function y(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(e,t),o=m(a);return r&&a.addEventListener("upgradeneeded",e=>{r(m(a.result),e.oldVersion,e.newVersion,m(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}function v(e){let{blocked:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",e=>t(e.oldVersion,e)),m(n).then(()=>{})}const b=["get","getKey","getAll","getAllKeys","count"],w=["put","add","delete","clear"],x=new Map;function k(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(x.get(t))return x.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=w.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!b.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return r&&(s=s.index(o.shift())),(await Promise.all([s[n](...o),i&&t.done]))[0]};return x.set(t,s),s}h=(e=>(0,r.A)((0,r.A)({},e),{},{get:(t,n,r)=>k(t,n)||e.get(t,n,r),has:(t,n)=>!!k(t,n)||e.has(t,n)}))(h)},3007:(e,t,n)=>{n.d(t,{m:()=>b});var r=n(1019);function i(e){return(0,r.w)(e,Date.now())}var s=n(9119);function a(e,t){const n=(0,s.a)(e),r=(0,s.a)(t),i=n.getTime()-r.getTime();return i<0?-1:i>0?1:i}var o=n(6815);function l(e,t){const n=(0,s.a)(e),r=(0,s.a)(t);return 12*(n.getFullYear()-r.getFullYear())+(n.getMonth()-r.getMonth())}function c(e){const t=(0,s.a)(e);return t.setHours(23,59,59,999),t}function u(e){const t=(0,s.a)(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function d(e){const t=(0,s.a)(e);return+c(t)===+u(t)}function h(e,t){const n=(0,s.a)(e),r=(0,s.a)(t),i=a(n,r),o=Math.abs(l(n,r));let c;if(o<1)c=0;else{1===n.getMonth()&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-i*o);let t=a(n,r)===-i;d((0,s.a)(e))&&1===o&&1===a(e,r)&&(t=!1),c=i*(o-Number(t))}return 0===c?0:c}function f(e,t){return+(0,s.a)(e)-+(0,s.a)(t)}function p(e,t,n){const r=f(e,t)/1e3;return(i=null===n||void 0===n?void 0:n.roundingMethod,e=>{const t=(i?Math[i]:Math.trunc)(e);return 0===t?0:t})(r);var i}var m=n(1479),g=n(8176),y=n(4774);function v(e,t,n){var r,i;const l=(0,g.q)(),c=null!==(r=null!==(i=null===n||void 0===n?void 0:n.locale)&&void 0!==i?i:l.locale)&&void 0!==r?r:m.c,u=a(e,t);if(isNaN(u))throw new RangeError("Invalid time value");const d=Object.assign({},n,{addSuffix:null===n||void 0===n?void 0:n.addSuffix,comparison:u});let f,v;u>0?(f=(0,s.a)(t),v=(0,s.a)(e)):(f=(0,s.a)(e),v=(0,s.a)(t));const b=p(v,f),w=((0,y.G)(v)-(0,y.G)(f))/1e3,x=Math.round((b-w)/60);let k;if(x<2)return null!==n&&void 0!==n&&n.includeSeconds?b<5?c.formatDistance("lessThanXSeconds",5,d):b<10?c.formatDistance("lessThanXSeconds",10,d):b<20?c.formatDistance("lessThanXSeconds",20,d):b<40?c.formatDistance("halfAMinute",0,d):b<60?c.formatDistance("lessThanXMinutes",1,d):c.formatDistance("xMinutes",1,d):0===x?c.formatDistance("lessThanXMinutes",1,d):c.formatDistance("xMinutes",x,d);if(x<45)return c.formatDistance("xMinutes",x,d);if(x<90)return c.formatDistance("aboutXHours",1,d);if(x<o.F6){const e=Math.round(x/60);return c.formatDistance("aboutXHours",e,d)}if(x<2520)return c.formatDistance("xDays",1,d);if(x<o.Nw){const e=Math.round(x/o.F6);return c.formatDistance("xDays",e,d)}if(x<2*o.Nw)return k=Math.round(x/o.Nw),c.formatDistance("aboutXMonths",k,d);if(k=h(v,f),k<12){const e=Math.round(x/o.Nw);return c.formatDistance("xMonths",e,d)}{const e=k%12,t=Math.trunc(k/12);return e<3?c.formatDistance("aboutXYears",t,d):e<9?c.formatDistance("overXYears",t,d):c.formatDistance("almostXYears",t+1,d)}}function b(e,t){return v(e,i(e),t)}},3063:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(2555),i=n(3984),s=n(5472);const a=!1,o={log:function(){a},error:function(){console.error(...arguments)},warn:function(){a},info:function(){a},debug:function(){a},group:function(){a},groupEnd:()=>{a}};const l=new class{constructor(){this.sessionId=this.generateSessionId(),this.userId=null,this.userAgent=navigator.userAgent,this.startTime=Date.now(),this.errors=[],this.performance=[],this.setupErrorHandlers()}generateSessionId(){return"session_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}setUser(e){this.userId=e}setupErrorHandlers(){window.addEventListener("error",e=>{var t;this.logError({type:"uncaught_error",message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,stack:null===(t=e.error)||void 0===t?void 0:t.stack})}),window.addEventListener("unhandledrejection",e=>{var t,n;this.logError({type:"unhandled_promise",message:(null===(t=e.reason)||void 0===t?void 0:t.message)||String(e.reason),stack:null===(n=e.reason)||void 0===n?void 0:n.stack})}),this.trackPerformance()}logError(e){const t=(0,r.A)((0,r.A)({},e),{},{stack:e.stack||null,sessionId:this.sessionId,userId:this.userId,timestamp:Date.now(),url:window.location.href,userAgent:this.userAgent});this.errors.push(t),this.sendToFirestore("errors",t),o.error("Error tracked:",t)}logCustomError(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.logError({type:"custom_error",message:e,details:t,stack:(new Error).stack})}trackPerformance(){window.addEventListener("load",()=>{setTimeout(()=>{const e=performance.getEntriesByType("navigation")[0];e&&this.logPerformance({type:"page_load",metrics:{dns:e.domainLookupEnd-e.domainLookupStart,tcp:e.connectEnd-e.connectStart,request:e.responseStart-e.requestStart,response:e.responseEnd-e.responseStart,dom:e.domContentLoadedEventEnd-e.domContentLoadedEventStart,load:e.loadEventEnd-e.loadEventStart,total:e.loadEventEnd-e.fetchStart}})},0)});new PerformanceObserver(e=>{for(const t of e.getEntries())t.duration>1e3&&this.logPerformance({type:"slow_resource",name:t.name,duration:t.duration,size:t.transferSize})}).observe({entryTypes:["resource","measure"]})}logPerformance(e){const t=(0,r.A)((0,r.A)({},e),{},{sessionId:this.sessionId,userId:this.userId,timestamp:Date.now(),url:window.location.href});this.performance.push(t),this.sendToFirestore("performance",t)}trackAction(e){const t={action:e,details:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},sessionId:this.sessionId,userId:this.userId,timestamp:Date.now(),url:window.location.href};this.sendToFirestore("user_actions",t)}trackPageView(e){this.trackAction("page_view",{page:e})}trackFunnelStep(e,t){const n={funnel:e,step:t,metadata:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},sessionId:this.sessionId,userId:this.userId,timestamp:Date.now(),url:window.location.href};this.sendToFirestore("funnel_events",n)}async sendToFirestore(e,t){try{await(0,s.gS)((0,s.rJ)(i.db,e),(0,r.A)((0,r.A)({},t),{},{createdAt:s.Dc.now()}))}catch(n){o.error("Failed to send to Firestore:",n),this.storeLocally(e,t)}}storeLocally(e,t){try{const n="besties_".concat(e),r=JSON.parse(localStorage.getItem(n)||"[]");r.push(t),r.length>100&&r.shift(),localStorage.setItem(n,JSON.stringify(r))}catch(n){o.error("Failed to store locally:",n)}}getSessionSummary(){return{sessionId:this.sessionId,userId:this.userId,duration:Date.now()-this.startTime,errors:this.errors.length,url:window.location.href,userAgent:this.userAgent}}}},3216:(e,t,n)=>{var r;n.d(t,{$P:()=>f,BV:()=>L,C5:()=>R,Ix:()=>M,V8:()=>D,Zp:()=>y,g:()=>v,jb:()=>c,qh:()=>O,x$:()=>b,zy:()=>m});var i=n(5043),s=n(1387);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}const o=i.createContext(null);const l=i.createContext(null);const c=i.createContext(null);const u=i.createContext(null);const d=i.createContext({outlet:null,matches:[],isDataRoute:!1});const h=i.createContext(null);function f(e,t){let{relative:n}=void 0===t?{}:t;p()||(0,s.Oi)(!1);let{basename:r,navigator:a}=i.useContext(c),{hash:o,pathname:l,search:u}=b(e,{relative:n}),d=l;return"/"!==r&&(d="/"===l?r:(0,s.HS)([r,l])),a.createHref({pathname:d,search:u,hash:o})}function p(){return null!=i.useContext(u)}function m(){return p()||(0,s.Oi)(!1),i.useContext(u).location}function g(e){i.useContext(c).static||i.useLayoutEffect(e)}function y(){let{isDataRoute:e}=i.useContext(d);return e?function(){let{router:e}=T(S.UseNavigateStable),t=A(N.UseNavigateStable),n=i.useRef(!1);g(()=>{n.current=!0});let r=i.useCallback(function(r,i){void 0===i&&(i={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,a({fromRouteId:t},i)))},[e,t]);return r}():function(){p()||(0,s.Oi)(!1);let e=i.useContext(o),{basename:t,future:n,navigator:r}=i.useContext(c),{matches:a}=i.useContext(d),{pathname:l}=m(),u=JSON.stringify((0,s.yD)(a,n.v7_relativeSplatPath)),h=i.useRef(!1);return g(()=>{h.current=!0}),i.useCallback(function(n,i){if(void 0===i&&(i={}),!h.current)return;if("number"===typeof n)return void r.go(n);let a=(0,s.Gh)(n,JSON.parse(u),l,"path"===i.relative);null==e&&"/"!==t&&(a.pathname="/"===a.pathname?t:(0,s.HS)([t,a.pathname])),(i.replace?r.replace:r.push)(a,i.state,i)},[t,r,u,l,e])}()}function v(){let{matches:e}=i.useContext(d),t=e[e.length-1];return t?t.params:{}}function b(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=i.useContext(c),{matches:a}=i.useContext(d),{pathname:o}=m(),l=JSON.stringify((0,s.yD)(a,r.v7_relativeSplatPath));return i.useMemo(()=>(0,s.Gh)(e,JSON.parse(l),o,"path"===n),[e,l,o,n])}function w(e,t,n,r){p()||(0,s.Oi)(!1);let{navigator:o}=i.useContext(c),{matches:l}=i.useContext(d),h=l[l.length-1],f=h?h.params:{},g=(h&&h.pathname,h?h.pathnameBase:"/");h&&h.route;let y,v=m();if(t){var b;let e="string"===typeof t?(0,s.Rr)(t):t;"/"===g||(null==(b=e.pathname)?void 0:b.startsWith(g))||(0,s.Oi)(!1),y=e}else y=v;let w=y.pathname||"/",x=w;if("/"!==g){let e=g.replace(/^\//,"").split("/");x="/"+w.replace(/^\//,"").split("/").slice(e.length).join("/")}let k=(0,s.ue)(e,{pathname:x});let _=E(k&&k.map(e=>Object.assign({},e,{params:Object.assign({},f,e.params),pathname:(0,s.HS)([g,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?g:(0,s.HS)([g,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),l,n,r);return t&&_?i.createElement(u.Provider,{value:{location:a({pathname:"/",search:"",hash:"",state:null,key:"default"},y),navigationType:s.rc.Pop}},_):_}function x(){let e=function(){var e;let t=i.useContext(h),n=C(N.UseRouteError),r=A(N.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=(0,s.pX)(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r};return i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},t),n?i.createElement("pre",{style:a},n):null,null)}const k=i.createElement(x,null);class _ extends i.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?i.createElement(d.Provider,{value:this.props.routeContext},i.createElement(h.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function I(e){let{routeContext:t,match:n,children:r}=e,s=i.useContext(o);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),i.createElement(d.Provider,{value:t},r)}function E(e,t,n,r){var a;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var o;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(o=r)&&o.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let l=e,c=null==(a=n)?void 0:a.errors;if(null!=c){let e=l.findIndex(e=>e.route.id&&void 0!==(null==c?void 0:c[e.route.id]));e>=0||(0,s.Oi)(!1),l=l.slice(0,Math.min(l.length,e+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let i=0;i<l.length;i++){let e=l[i];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=i),e.route.id){let{loaderData:t,errors:r}=n,i=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){u=!0,l=d>=0?l.slice(0,d+1):[l[0]];break}}}return l.reduceRight((e,r,s)=>{let a,o=!1,h=null,f=null;var p;n&&(a=c&&r.route.id?c[r.route.id]:void 0,h=r.route.errorElement||k,u&&(d<0&&0===s?(p="route-fallback",!1||j[p]||(j[p]=!0),o=!0,f=null):d===s&&(o=!0,f=r.route.hydrateFallbackElement||null)));let m=t.concat(l.slice(0,s+1)),g=()=>{let t;return t=a?h:o?f:r.route.Component?i.createElement(r.route.Component,null):r.route.element?r.route.element:e,i.createElement(I,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===s)?i.createElement(_,{location:n.location,revalidation:n.revalidation,component:h,error:a,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()},null)}var S=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(S||{}),N=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(N||{});function T(e){let t=i.useContext(o);return t||(0,s.Oi)(!1),t}function C(e){let t=i.useContext(l);return t||(0,s.Oi)(!1),t}function A(e){let t=function(){let e=i.useContext(d);return e||(0,s.Oi)(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||(0,s.Oi)(!1),n.route.id}const j={};const P=(e,t,n)=>{};function D(e,t){void 0===(null==e?void 0:e.v7_startTransition)&&P("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),void 0!==(null==e?void 0:e.v7_relativeSplatPath)||t&&void 0!==t.v7_relativeSplatPath||P("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath"),t&&(void 0===t.v7_fetcherPersist&&P("v7_fetcherPersist","The persistence behavior of fetchers is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_fetcherpersist"),void 0===t.v7_normalizeFormMethod&&P("v7_normalizeFormMethod","Casing of `formMethod` fields is being normalized to uppercase in v7","https://reactrouter.com/v6/upgrading/future#v7_normalizeformmethod"),void 0===t.v7_partialHydration&&P("v7_partialHydration","`RouterProvider` hydration behavior is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_partialhydration"),void 0===t.v7_skipActionErrorRevalidation&&P("v7_skipActionErrorRevalidation","The revalidation behavior after 4xx/5xx `action` responses is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_skipactionerrorrevalidation"))}(r||(r=n.t(i,2))).startTransition;function R(e){let{to:t,replace:n,state:r,relative:a}=e;p()||(0,s.Oi)(!1);let{future:o,static:l}=i.useContext(c),{matches:u}=i.useContext(d),{pathname:h}=m(),f=y(),g=(0,s.Gh)(t,(0,s.yD)(u,o.v7_relativeSplatPath),h,"path"===a),v=JSON.stringify(g);return i.useEffect(()=>f(JSON.parse(v),{replace:n,state:r,relative:a}),[f,v,a,n,r]),null}function O(e){(0,s.Oi)(!1)}function M(e){let{basename:t="/",children:n=null,location:r,navigationType:o=s.rc.Pop,navigator:l,static:d=!1,future:h}=e;p()&&(0,s.Oi)(!1);let f=t.replace(/^\/*/,"/"),m=i.useMemo(()=>({basename:f,navigator:l,static:d,future:a({v7_relativeSplatPath:!1},h)}),[f,h,l,d]);"string"===typeof r&&(r=(0,s.Rr)(r));let{pathname:g="/",search:y="",hash:v="",state:b=null,key:w="default"}=r,x=i.useMemo(()=>{let e=(0,s.pb)(g,f);return null==e?null:{location:{pathname:e,search:y,hash:v,state:b,key:w},navigationType:o}},[f,g,y,v,b,w,o]);return null==x?null:i.createElement(c.Provider,{value:m},i.createElement(u.Provider,{children:n,value:x}))}function L(e){let{children:t,location:n}=e;return w(F(t),n)}new Promise(()=>{});i.Component;function F(e,t){void 0===t&&(t=[]);let n=[];return i.Children.forEach(e,(e,r)=>{if(!i.isValidElement(e))return;let a=[...t,r];if(e.type===i.Fragment)return void n.push.apply(n,F(e.props.children,a));e.type!==O&&(0,s.Oi)(!1),e.props.index&&e.props.children&&(0,s.Oi)(!1);let o={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=F(e.props.children,a)),n.push(o)}),n}},3889:(e,t,n)=>{n.d(t,{D:()=>a,L:()=>o});var r=n(5043),i=n(579);const s=(0,r.createContext)(),a=()=>{const e=(0,r.useContext)(s);if(!e)throw new Error("useDarkMode must be used within DarkModeProvider");return e},o=e=>{let{children:t}=e;const[n,a]=(0,r.useState)(()=>{const e=localStorage.getItem("darkMode");return!!e&&JSON.parse(e)});(0,r.useEffect)(()=>{localStorage.setItem("darkMode",JSON.stringify(n)),n?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[n]);return(0,i.jsx)(s.Provider,{value:{isDark:n,toggle:()=>a(!n)},children:t})}},3984:(e,t,n)=>{n.r(t),n.d(t,{auth:()=>Yi,authService:()=>is,db:()=>Ji,default:()=>ls,firestoreService:()=>ss,functions:()=>$i,getToken:()=>hi,googleProvider:()=>ns,logAnalyticsEvent:()=>ts,messaging:()=>Zi,onMessage:()=>fi,storage:()=>Xi,storageService:()=>as,timestampUtils:()=>os});var r=n(2555),i=n(52);(0,i.KO)("firebase","10.14.1","app");var s=n(7700),a=n(443);function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;var l=n(8812);function c(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const u=c,d=new s.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),h=new a.Vy("@firebase/auth");function f(e){if(h.logLevel<=a.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];h.error("Auth (".concat(i.MF,"): ").concat(e),...n)}}function p(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw b(e,...n)}function m(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return b(e,...n)}function g(e,t,n){const r=Object.assign(Object.assign({},u()),{[t]:n});return new s.FA("auth","Firebase",r).create(t,{appName:e.name})}function y(e){return g(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function v(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&p(e,"argument-error"),g(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function b(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return d.create(e,...n)}function w(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw b(t,...r)}}function x(e){const t="INTERNAL ASSERTION FAILED: "+e;throw f(t),new Error(t)}function k(e,t){e||x(t)}function _(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function I(){return"http:"===E()||"https:"===E()}function E(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class S{constructor(e,t){this.shortDelay=e,this.longDelay=t,k(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,s.jZ)()||(0,s.lV)()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(I()||(0,s.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function N(e,t){k(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class T{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void x("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void x("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void x("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const C={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},A=new S(3e4,6e4);function j(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function P(e,t,n,r){return D(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let i={},a={};r&&("GET"===t?a=r:i={body:JSON.stringify(r)});const o=(0,s.Am)(Object.assign({key:e.config.apiKey},a)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:l},i);return(0,s.c1)()||(c.referrerPolicy="no-referrer"),T.fetch()(O(e,e.config.apiHost,n,o),c)})}async function D(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},C),t);try{const t=new L(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw F(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw F(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw F(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw F(e,"user-disabled",s);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw g(e,o,a);p(e,o)}}catch(i){if(i instanceof s.g)throw i;p(e,"network-request-failed",{message:String(i)})}}async function R(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await P(e,t,n,r,i);return"mfaPendingCredential"in s&&p(e,"multi-factor-auth-required",{_serverResponse:s}),s}function O(e,t,n,r){const i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?N(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}function M(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class L{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(m(this.auth,"network-request-failed")),A.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function F(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=m(e,t,r);return i.customData._tokenResponse=n,i}function U(e){return void 0!==e&&void 0!==e.getResponse}function V(e){return void 0!==e&&void 0!==e.enterprise}class B{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return M(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function z(e,t){return P(e,"GET","/v2/recaptchaConfig",j(e,t))}async function q(e,t){return P(e,"POST","/v1/accounts:lookup",t)}function K(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function H(e){return 1e3*Number(e)}function W(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return f("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,s.u)(n);return e?JSON.parse(e):(f("Failed to decode base64 JWT payload"),null)}catch(i){return f("Caught error parsing JWT payload as JSON",null===i||void 0===i?void 0:i.toString()),null}}function G(e){const t=W(e);return w(t,"internal-error"),w("undefined"!==typeof t.exp,"internal-error"),w("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Q(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof s.g&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class Y{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class J{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=K(this.lastLoginAt),this.creationTime=K(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function X(e){var t;const n=e.auth,r=await e.getIdToken(),i=await Q(e,q(n,{idToken:r}));w(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const a=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?$(s.providerUserInfo):[],o=(l=e.providerData,c=a,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&s.passwordHash)&&!(null===o||void 0===o?void 0:o.length),h=!!u&&d,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new J(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function $(e){return e.map(e=>{var{providerId:t}=e,n=o(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class Z{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){w(e.idToken,"internal-error"),w("undefined"!==typeof e.idToken,"internal-error"),w("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):G(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){w(0!==e.length,"internal-error");const t=G(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(w(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await D(e,{},async()=>{const n=(0,s.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,a=O(e,r,"/v1/token","key=".concat(i)),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",T.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Z;return n&&(w("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(w("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(w("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Z,this.toJSON())}_performRefresh(){return x("not implemented")}}function ee(e,t){w("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class te{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=o(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Y(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new J(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Q(this,this.stsTokenManager.getToken(this.auth,e));return w(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(0,s.Ku)(e),r=await n.getIdToken(t),i=W(r);w(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const a="object"===typeof i.firebase?i.firebase:void 0,o=null===a||void 0===a?void 0:a.sign_in_provider;return{claims:i,token:r,authTime:K(H(i.auth_time)),issuedAtTime:K(H(i.iat)),expirationTime:K(H(i.exp)),signInProvider:o||null,signInSecondFactor:(null===a||void 0===a?void 0:a.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=(0,s.Ku)(e);await X(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(w(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new te(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){w(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await X(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,i.xZ)(this.auth.app))return Promise.reject(y(this.auth));const e=await this.getIdToken();return await Q(this,async function(e,t){return P(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,a,o,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(a=t.tenantId)&&void 0!==a?a:void 0,m=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:b,isAnonymous:x,providerData:k,stsTokenManager:_}=t;w(v&&_,e,"internal-error");const I=Z.fromJSON(this.name,_);w("string"===typeof v,e,"internal-error"),ee(u,e.name),ee(d,e.name),w("boolean"===typeof b,e,"internal-error"),w("boolean"===typeof x,e,"internal-error"),ee(h,e.name),ee(f,e.name),ee(p,e.name),ee(m,e.name),ee(g,e.name),ee(y,e.name);const E=new te({uid:v,auth:e,email:d,emailVerified:b,displayName:u,isAnonymous:x,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:I,createdAt:g,lastLoginAt:y});return k&&Array.isArray(k)&&(E.providerData=k.map(e=>Object.assign({},e))),m&&(E._redirectEventId=m),E}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new Z;r.updateFromServerResponse(t);const i=new te({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await X(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];w(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?$(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),a=new Z;a.updateFromIdToken(n);const o=new te({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new J(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(o,l),o}}const ne=new Map;function re(e){k(e instanceof Function,"Expected a class definition");let t=ne.get(e);return t?(k(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ne.set(e,t),t)}class ie{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ie.type="NONE";const se=ie;function ae(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class oe{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=ae(this.userKey,r.apiKey,i),this.fullPersistenceKey=ae("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?te._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new oe(re(se),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||re(se);const s=ae(n,e.config.apiKey,e.name);let a=null;for(const c of t)try{const t=await c._get(s);if(t){const n=te._fromJSON(e,t);c!==i&&(a=n),i=c;break}}catch(l){}const o=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&o.length?(i=o[0],a&&await i._set(s,a.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(l){}})),new oe(i,e,n)):new oe(i,e,n)}}function le(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(he(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ce(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(pe(t))return"Blackberry";if(me(t))return"Webos";if(ue(t))return"Safari";if((t.includes("chrome/")||de(t))&&!t.includes("edge/"))return"Chrome";if(fe(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function ce(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/firefox\//i.test(e)}function ue(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function de(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/crios\//i.test(e)}function he(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/iemobile/i.test(e)}function fe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/android/i.test(e)}function pe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/blackberry/i.test(e)}function me(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/webos/i.test(e)}function ge(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function ye(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return ge(e)||fe(e)||me(e)||pe(e)||/windows phone/i.test(e)||he(e)}function ve(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=le((0,s.ZQ)());break;case"Worker":t="".concat(le((0,s.ZQ)()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(i.MF,"/").concat(r)}class be{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(i){r(i)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class we{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,a;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(i=o.containsUppercaseLetter)||void 0===i||i),o.isValid&&(o.isValid=null===(s=o.containsNumericCharacter)||void 0===s||s),o.isValid&&(o.isValid=null===(a=o.containsNonAlphanumericCharacter)||void 0===a||a),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class xe{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _e(this),this.idTokenSubscription=new _e(this),this.beforeStateQueue=new be(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=d,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=re(t)),this._initializationPromise=this.queue(async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await oe.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await q(this,{idToken:e}),n=await te._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if((0,i.xZ)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null===r||void 0===r?void 0:r._redirectEventId,a=await this.tryRedirectSignIn(e);n&&n!==i||!(null===a||void 0===a?void 0:a.user)||(r=a.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return w(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await X(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,i.xZ)(this.app))return Promise.reject(y(this));const t=e?(0,s.Ku)(e):null;return t&&w(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&w(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(0,i.xZ)(this.app)?Promise.reject(y(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,i.xZ)(this.app)?Promise.reject(y(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(re(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return P(e,"GET","/v2/passwordPolicy",j(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new we(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new s.FA("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return P(e,"POST","/v2/accounts:revokeToken",j(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&re(e)||this._popupRedirectResolver;w(t,this,"argument-error"),this.redirectPersistenceManager=await oe.create(this,[re(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(w(a,this,"internal-error"),a.then(()=>{s||i(this.currentUser)}),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return w(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ve(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(h.logLevel<=a.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];h.warn("Auth (".concat(i.MF,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function ke(e){return(0,s.Ku)(e)}class _e{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,s.tD)(e=>this.observer=e)}get next(){return w(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ie={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ee(e){return Ie.loadJS(e)}function Se(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class Ne{constructor(e){this.type="recaptcha-enterprise",this.auth=ke(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;V(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n("NO_RECAPTCHA")})}):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{z(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new B(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&V(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Ie.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Ee(t).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function Te(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new Ne(e);let s;try{s=await i.verify(n)}catch(o){s=await i.verify(n,!0)}const a=Object.assign({},t);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Ce(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Te(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch(async i=>{if(i.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const i=await Te(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)})}function Ae(e,t,n){const r=ke(e);w(r._canInitEmulator,r,"emulator-config-failed"),w(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=je(t),{host:a,port:o}=function(e){const t=je(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Pe(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Pe(t)}}}(t),l=null===o?"":":".concat(o);r.config.emulator={url:"".concat(s,"//").concat(a).concat(l,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function je(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Pe(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class De{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return x("not implemented")}_getIdTokenResponse(e){return x("not implemented")}_linkToIdToken(e,t){return x("not implemented")}_getReauthenticationResolver(e){return x("not implemented")}}async function Re(e,t){return P(e,"POST","/v1/accounts:signUp",t)}async function Oe(e,t){return R(e,"POST","/v1/accounts:signInWithPassword",j(e,t))}class Me extends De{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Me(e,t,"password")}static _fromEmailAndCode(e,t){return new Me(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Ce(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Oe);case"emailLink":return async function(e,t){return R(e,"POST","/v1/accounts:signInWithEmailLink",j(e,t))}(e,{email:this._email,oobCode:this._password});default:p(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Ce(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Re);case"emailLink":return async function(e,t){return R(e,"POST","/v1/accounts:signInWithEmailLink",j(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:p(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Le(e,t){return R(e,"POST","/v1/accounts:signInWithIdp",j(e,t))}class Fe extends De{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Fe(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):p("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=o(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new Fe(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Le(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Le(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Le(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,s.Am)(t)}return e}}const Ue={USER_NOT_FOUND:"user-not-found"};class Ve extends De{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ve({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ve({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return R(e,"POST","/v1/accounts:signInWithPhoneNumber",j(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await R(e,"POST","/v1/accounts:signInWithPhoneNumber",j(e,t));if(n.temporaryProof)throw F(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return R(e,"POST","/v1/accounts:signInWithPhoneNumber",j(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Ue)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Ve({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Be{constructor(e){var t,n,r,i,a,o;const l=(0,s.I9)((0,s.hp)(e)),c=null!==(t=l.apiKey)&&void 0!==t?t:null,u=null!==(n=l.oobCode)&&void 0!==n?n:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=l.mode)&&void 0!==r?r:null);w(c&&u&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=u,this.continueUrl=null!==(i=l.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(a=l.languageCode)&&void 0!==a?a:null,this.tenantId=null!==(o=l.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=(0,s.I9)((0,s.hp)(e)).link,n=t?(0,s.I9)((0,s.hp)(t)).deep_link_id:null,r=(0,s.I9)((0,s.hp)(e)).deep_link_id;return(r?(0,s.I9)((0,s.hp)(r)).link:null)||r||n||t||e}(e);try{return new Be(t)}catch(n){return null}}}class ze{constructor(){this.providerId=ze.PROVIDER_ID}static credential(e,t){return Me._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Be.parseLink(t);return w(n,"argument-error"),Me._fromEmailAndCode(e,n.code,n.tenantId)}}ze.PROVIDER_ID="password",ze.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ze.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class qe{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ke extends qe{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class He extends Ke{constructor(){super("facebook.com")}static credential(e){return Fe._fromParams({providerId:He.PROVIDER_ID,signInMethod:He.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return He.credentialFromTaggedObject(e)}static credentialFromError(e){return He.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return He.credential(t.oauthAccessToken)}catch(n){return null}}}He.FACEBOOK_SIGN_IN_METHOD="facebook.com",He.PROVIDER_ID="facebook.com";class We extends Ke{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Fe._fromParams({providerId:We.PROVIDER_ID,signInMethod:We.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return We.credentialFromTaggedObject(e)}static credentialFromError(e){return We.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return We.credential(n,r)}catch(i){return null}}}We.GOOGLE_SIGN_IN_METHOD="google.com",We.PROVIDER_ID="google.com";class Ge extends Ke{constructor(){super("github.com")}static credential(e){return Fe._fromParams({providerId:Ge.PROVIDER_ID,signInMethod:Ge.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ge.credentialFromTaggedObject(e)}static credentialFromError(e){return Ge.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ge.credential(t.oauthAccessToken)}catch(n){return null}}}Ge.GITHUB_SIGN_IN_METHOD="github.com",Ge.PROVIDER_ID="github.com";class Qe extends Ke{constructor(){super("twitter.com")}static credential(e,t){return Fe._fromParams({providerId:Qe.PROVIDER_ID,signInMethod:Qe.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Qe.credentialFromTaggedObject(e)}static credentialFromError(e){return Qe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return Qe.credential(n,r)}catch(i){return null}}}async function Ye(e,t){return R(e,"POST","/v1/accounts:signUp",j(e,t))}Qe.TWITTER_SIGN_IN_METHOD="twitter.com",Qe.PROVIDER_ID="twitter.com";class Je{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await te._fromIdTokenResponse(e,n,r),s=Xe(n);return new Je({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Xe(n);return new Je({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Xe(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class $e extends s.g{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,$e.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new $e(e,t,n,r)}}function Ze(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw $e._fromErrorAndOperation(e,n,t,r);throw n})}async function et(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Q(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Je._forOperation(e,"link",r)}async function tt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if((0,i.xZ)(r.app))return Promise.reject(y(r));const s="reauthenticate";try{const i=await Q(e,Ze(r,s,t,e),n);w(i.idToken,r,"internal-error");const a=W(i.idToken);w(a,r,"internal-error");const{sub:o}=a;return w(e.uid===o,r,"user-mismatch"),Je._forOperation(e,s,i)}catch(a){throw(null===a||void 0===a?void 0:a.code)==="auth/".concat("user-not-found")&&p(r,"user-mismatch"),a}}async function nt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,i.xZ)(e.app))return Promise.reject(y(e));const r="signIn",s=await Ze(e,r,t),a=await Je._fromIdTokenResponse(e,r,s);return n||await e._updateCurrentUser(a.user),a}async function rt(e,t){return nt(ke(e),t)}async function it(e){const t=ke(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function st(e,t){let{displayName:n,photoURL:r}=t;if(void 0===n&&void 0===r)return;const i=(0,s.Ku)(e),a={idToken:await i.getIdToken(),displayName:n,photoUrl:r,returnSecureToken:!0},o=await Q(i,async function(e,t){return P(e,"POST","/v1/accounts:update",t)}(i.auth,a));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const l=i.providerData.find(e=>{let{providerId:t}=e;return"password"===t});l&&(l.displayName=i.displayName,l.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}new WeakMap;const at="__sak";class ot{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(at,"1"),this.storage.removeItem(at),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class lt extends ot{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ye(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);(0,s.lT)()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}lt.type="LOCAL";const ct=lt;class ut extends ot{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ut.type="SESSION";const dt=ut;class ht{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new ht(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const a=Array.from(s).map(async e=>e(t.origin,i)),o=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ft(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}ht.receivers=[];class pt{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((a,o)=>{const l=ft("",20);r.port1.start();const c=setTimeout(()=>{o(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(t.data.response);break;default:clearTimeout(c),clearTimeout(i),o(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function mt(){return window}function gt(){return"undefined"!==typeof mt().WorkerGlobalScope&&"function"===typeof mt().importScripts}const yt="firebaseLocalStorageDb",vt="firebaseLocalStorage",bt="fbase_key";class wt{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function xt(e,t){return e.transaction([vt],t?"readwrite":"readonly").objectStore(vt)}function kt(){const e=indexedDB.open(yt,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(vt,{keyPath:bt})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(vt)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(yt);return new wt(e).toPromise()}(),t(await kt()))})})}async function _t(e,t,n){const r=xt(e,!0).put({[bt]:t,value:n});return new wt(r).toPromise()}function It(e,t){const n=xt(e,!0).delete(t);return new wt(n).toPromise()}class Et{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await kt()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return gt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ht._getInstance(gt()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new pt(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await kt();return await _t(e,at,"1"),await It(e,at),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>_t(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=xt(e,!1).get(t),r=await new wt(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>It(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=xt(e,!1).getAll();return new wt(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Et.type="LOCAL";const St=Et;const Nt=1e12;class Tt{constructor(e){this.auth=e,this.counter=Nt,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new Ct(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||Nt;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||Nt;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||Nt;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class Ct{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"===typeof e?document.getElementById(e):e;w(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout(()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(n){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(n){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const At=Se("rcb"),jt=new S(3e4,6e4);class Pt{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=mt().grecaptcha)||void 0===e?void 0:e.render)}load(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return w(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)&&U(mt().grecaptcha)?Promise.resolve(mt().grecaptcha):new Promise((n,r)=>{const i=mt().setTimeout(()=>{r(m(e,"network-request-failed"))},jt.get());mt()[At]=()=>{mt().clearTimeout(i),delete mt()[At];const s=mt().grecaptcha;if(!s||!U(s))return void r(m(e,"internal-error"));const a=s.render;s.render=(e,t)=>{const n=a(e,t);return this.counter++,n},this.hostLanguage=t,n(s)};Ee("".concat(Ie.recaptchaV2Script,"?").concat((0,s.Am)({onload:At,render:"explicit",hl:t}))).catch(()=>{clearTimeout(i),r(m(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=mt().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Dt{async load(e){return new Tt(e)}clearedOneInstance(){}}const Rt="recaptcha",Ot={theme:"light",type:"image"};class Mt{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.assign({},Ot);this.parameters=n,this.type=Rt,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=ke(e),this.isInvisible="invisible"===this.parameters.size,w("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"===typeof t?document.getElementById(t):t;w(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Dt:new Pt,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){w(!this.parameters.sitekey,this.auth,"argument-error"),w(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),w("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(e=>e(t)),"function"===typeof e)e(t);else if("string"===typeof e){const n=mt()[e];"function"===typeof n&&n(t)}}}assertNotDestroyed(){w(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){w(I()&&!gt(),this.auth,"internal-error"),await function(){let e=null;return new Promise(t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()}).catch(t=>{throw e&&window.removeEventListener("load",e),t})}(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await async function(e){return(await P(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);w(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return w(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Lt{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Ve._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function Ft(e,t,n){var r;const i=await n.verify();try{let s;if(w("string"===typeof i,e,"argument-error"),w(n.type===Rt,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){w("enroll"===t.type,e,"internal-error");const n=await function(e,t){return P(e,"POST","/v2/accounts/mfaEnrollment:start",j(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{w("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;w(n,e,"missing-multi-factor-info");const a=await function(e,t){return P(e,"POST","/v2/accounts/mfaSignIn:start",j(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return a.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return P(e,"POST","/v1/accounts:sendVerificationCode",j(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class Ut{constructor(e){this.providerId=Ut.PROVIDER_ID,this.auth=ke(e)}verifyPhoneNumber(e,t){return Ft(this.auth,e,(0,s.Ku)(t))}static credential(e,t){return Ve._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Ut.credentialFromTaggedObject(t)}static credentialFromError(e){return Ut.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Ve._fromTokenResponse(n,r):null}}function Vt(e,t){return t?re(t):(w(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Ut.PROVIDER_ID="phone",Ut.PHONE_SIGN_IN_METHOD="phone";class Bt extends De{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Le(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Le(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Le(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function zt(e){return nt(e.auth,new Bt(e),e.bypassAuthState)}function qt(e){const{auth:t,user:n}=e;return w(n,t,"internal-error"),tt(n,new Bt(e),e.bypassAuthState)}async function Kt(e){const{auth:t,user:n}=e;return w(n,t,"internal-error"),et(n,new Bt(e),e.bypassAuthState)}class Ht{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:a}=e;if(s)return void this.reject(s);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zt;case"linkViaPopup":case"linkViaRedirect":return Kt;case"reauthViaPopup":case"reauthViaRedirect":return qt;default:p(this.auth,"internal-error")}}resolve(e){k(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){k(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Wt=new S(2e3,1e4);class Gt extends Ht{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Gt.currentPopupAction&&Gt.currentPopupAction.cancel(),Gt.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return w(e,this.auth,"internal-error"),e}async onExecution(){k(1===this.filter.length,"Popup operations only handle one event");const e=ft();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(m(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(m(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Gt.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(m(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Wt.get())};e()}}Gt.currentPopupAction=null;const Qt=new Map;class Yt extends Ht{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Qt.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=$t(t),r=Xt(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Qt.set(this.auth._key(),e)}return this.bypassAuthState||Qt.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Jt(e,t){Qt.set(e._key(),t)}function Xt(e){return re(e._redirectPersistence)}function $t(e){return ae("pendingRedirect",e.config.apiKey,e.name)}async function Zt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,i.xZ)(e.app))return Promise.reject(y(e));const r=ke(e),s=Vt(r,t),a=new Yt(r,s,n),o=await a.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class en{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nn(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!nn(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(m(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(tn(e))}saveEventToCache(e){this.cachedEventUids.add(tn(e)),this.lastProcessedEventTime=Date.now()}}function tn(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function nn(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const rn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,sn=/^https?/;async function an(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return P(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(on(r))return}catch(n){}p(e,"unauthorized-domain")}function on(e){const t=_(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!sn.test(n))return!1;if(rn.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const ln=new S(3e4,6e4);function cn(){const e=mt().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function un(e){return new Promise((t,n)=>{var r,i,s;function a(){cn(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{cn(),n(m(e,"network-request-failed"))},timeout:ln.get()})}if(null===(i=null===(r=mt().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=mt().gapi)||void 0===s?void 0:s.load)){const t=Se("iframefcb");return mt()[t]=()=>{gapi.load?a():n(m(e,"network-request-failed"))},Ee("".concat(Ie.gapiScript,"?onload=").concat(t)).catch(e=>n(e))}a()}}).catch(e=>{throw dn=null,e})}let dn=null;const hn=new S(5e3,15e3),fn={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},pn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mn(e){const t=e.config;w(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?N(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:i.MF},a=pn.get(e.config.apiHost);a&&(r.eid=a);const o=e._getFrameworks();return o.length&&(r.fw=o.join(",")),"".concat(n,"?").concat((0,s.Am)(r).slice(1))}async function gn(e){const t=await function(e){return dn=dn||un(e),dn}(e),n=mt().gapi;return w(n,e,"internal-error"),t.open({where:document.body,url:mn(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:fn,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=m(e,"network-request-failed"),s=mt().setTimeout(()=>{r(i)},hn.get());function a(){mt().clearTimeout(s),n(t)}t.ping(a).then(a,()=>{r(i)})}))}const yn={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class vn{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function bn(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},yn),{width:r.toString(),height:i.toString(),top:a,left:o}),u=(0,s.ZQ)().toLowerCase();n&&(l=de(u)?"_blank":n),ce(u)&&(t=t||"http://localhost",c.scrollbars="yes");const d=Object.entries(c).reduce((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")},"");if(function(){var e;return ge(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(u)&&"_self"!==l)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",l),new vn(null);const h=window.open(t||"",l,d);w(h,e,"popup-blocked");try{h.focus()}catch(f){}return new vn(h)}const wn="__/auth/handler",xn="emulator/auth/handler",kn=encodeURIComponent("fac");async function _n(e,t,n,r,a,o){w(e.config.authDomain,e,"auth-domain-config-required"),w(e.config.apiKey,e,"invalid-api-key");const l={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:i.MF,eventId:a};if(t instanceof qe){t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",(0,s.Im)(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(o||{}))l[e]=t}if(t instanceof Ke){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(l.scopes=e.join(","))}e.tenantId&&(l.tid=e.tenantId);const c=l;for(const i of Object.keys(c))void 0===c[i]&&delete c[i];const u=await e._getAppCheckToken(),d=u?"#".concat(kn,"=").concat(encodeURIComponent(u)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(wn);return N(t,xn)}(e),"?").concat((0,s.Am)(c).slice(1)).concat(d)}const In="webStorageSupport";const En=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dt,this._completeRedirectFn=Zt,this._overrideRedirectResult=Jt}async _openPopup(e,t,n,r){var i;k(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return bn(e,await _n(e,t,n,_(),r),ft())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){mt().location.href=e}(await _n(e,t,n,_(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(k(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await gn(e),n=new en(e);return t.register("authEvent",t=>{w(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(In,{type:In},n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[In];void 0!==i&&t(!!i),p(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=an(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ye()||ue()||ge()}};var Sn="@firebase/auth",Nn="1.7.9";class Tn{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){w(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Cn=(0,s.XA)("authIdTokenMaxAge")||300;let An=null;var jn;Ie={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=m("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},jn="Browser",(0,i.om)(new l.uA("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;w(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:jn,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ve(jn)},c=new xe(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(re);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),(0,i.om)(new l.uA("auth-internal",e=>(e=>new Tn(e))(ke(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,i.KO)(Sn,Nn,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(jn)),(0,i.KO)(Sn,Nn,"esm2017");var Pn=n(5472),Dn=n(8147),Rn=n(626),On=n(2799);const Mn="@firebase/installations",Ln="0.6.9",Fn=1e4,Un="w:".concat(Ln),Vn="FIS_v2",Bn=36e5,zn={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},qn=new s.FA("installations","Installations",zn);function Kn(e){return e instanceof s.g&&e.code.includes("request-failed")}function Hn(e){let{projectId:t}=e;return"".concat("https://firebaseinstallations.googleapis.com/v1","/projects/").concat(t,"/installations")}function Wn(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function Gn(e,t){const n=(await t.json()).error;return qn.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Qn(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function Yn(e,t){let{refreshToken:n}=t;const r=Qn(e);return r.append("Authorization",function(e){return"".concat(Vn," ").concat(e)}(n)),r}async function Jn(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Xn(e){return new Promise(t=>{setTimeout(t,e)})}const $n=/^[cdef][\w-]{21}$/;function Zn(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return $n.test(t)?t:""}catch(e){return""}}function er(e){return"".concat(e.appName,"!").concat(e.appId)}const tr=new Map;function nr(e,t){const n=er(e);rr(n,t),function(e,t){const n=sr();n&&n.postMessage({key:e,fid:t});ar()}(n,t)}function rr(e,t){const n=tr.get(e);if(n)for(const r of n)r(t)}let ir=null;function sr(){return!ir&&"BroadcastChannel"in self&&(ir=new BroadcastChannel("[Firebase] FID Change"),ir.onmessage=e=>{rr(e.data.key,e.data.fid)}),ir}function ar(){0===tr.size&&ir&&(ir.close(),ir=null)}const or="firebase-installations-store";let lr=null;function cr(){return lr||(lr=(0,On.P2)("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(or)}})),lr}async function ur(e,t){const n=er(e),r=(await cr()).transaction(or,"readwrite"),i=r.objectStore(or),s=await i.get(n);return await i.put(t,n),await r.done,s&&s.fid===t.fid||nr(e,t.fid),t}async function dr(e){const t=er(e),n=(await cr()).transaction(or,"readwrite");await n.objectStore(or).delete(t),await n.done}async function hr(e,t){const n=er(e),r=(await cr()).transaction(or,"readwrite"),i=r.objectStore(or),s=await i.get(n),a=t(s);return void 0===a?await i.delete(n):await i.put(a,n),await r.done,!a||s&&s.fid===a.fid||nr(e,a.fid),a}async function fr(e){let t;const n=await hr(e.appConfig,n=>{const r=function(e){const t=e||{fid:Zn(),registrationStatus:0};return gr(t)}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(qn.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:i}=t;const s=Hn(n),a=Qn(n),o=r.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&a.append("x-firebase-client",e)}const l={fid:i,authVersion:Vn,appId:n.appId,sdkVersion:Un},c={method:"POST",headers:a,body:JSON.stringify(l)},u=await Jn(()=>fetch(s,c));if(u.ok){const e=await u.json();return{fid:e.fid||i,registrationStatus:2,refreshToken:e.refreshToken,authToken:Wn(e.authToken)}}throw await Gn("Create Installation",u)}(e,t);return ur(e.appConfig,n)}catch(n){throw Kn(n)&&409===n.customData.serverCode?await dr(e.appConfig):await ur(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:pr(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry});return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function pr(e){let t=await mr(e.appConfig);for(;1===t.registrationStatus;)await Xn(100),t=await mr(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await fr(e);return n||t}return t}function mr(e){return hr(e,e=>{if(!e)throw qn.create("installation-not-found");return gr(e)})}function gr(e){return 1===(t=e).registrationStatus&&t.registrationTime+Fn<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function yr(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const i=function(e,t){let{fid:n}=t;return"".concat(Hn(e),"/").concat(n,"/authTokens:generate")}(n,t),s=Yn(n,t),a=r.getImmediate({optional:!0});if(a){const e=await a.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const o={installation:{sdkVersion:Un,appId:n.appId}},l={method:"POST",headers:s,body:JSON.stringify(o)},c=await Jn(()=>fetch(i,l));if(c.ok){return Wn(await c.json())}throw await Gn("Generate Auth Token",c)}async function vr(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await hr(e.appConfig,r=>{if(!wr(r))throw qn.create("not-registered");const i=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Bn}(e)}(i))return r;if(1===i.requestStatus)return t=async function(e,t){let n=await br(e.appConfig);for(;1===n.authToken.requestStatus;)await Xn(100),n=await br(e.appConfig);const r=n.authToken;return 0===r.requestStatus?vr(e,t):r}(e,n),r;{if(!navigator.onLine)throw qn.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return t=async function(e,t){try{const n=await yr(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await ur(e.appConfig,r),n}catch(n){if(!Kn(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await ur(e.appConfig,n)}else await dr(e.appConfig);throw n}}(e,n),n}});return t?await t:r.authToken}function br(e){return hr(e,e=>{if(!wr(e))throw qn.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+Fn<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n})}function wr(e){return void 0!==e&&2===e.registrationStatus}async function xr(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await fr(e);t&&await t}(n);return(await vr(n,t)).token}function kr(e){return qn.create("missing-app-config-values",{valueName:e})}const _r="installations",Ir=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw kr("App Configuration");if(!e.name)throw kr("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw kr(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:(0,i.j6)(t,"heartbeat"),_delete:()=>Promise.resolve()}},Er=e=>{const t=e.getProvider("app").getImmediate(),n=(0,i.j6)(t,_r).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await fr(t);return r?r.catch(console.error):vr(t).catch(console.error),n.fid}(n),getToken:e=>xr(n,e)}};(0,i.om)(new l.uA(_r,Ir,"PUBLIC")),(0,i.om)(new l.uA("installations-internal",Er,"PRIVATE")),(0,i.KO)(Mn,Ln),(0,i.KO)(Mn,Ln,"esm2017");const Sr="/firebase-messaging-sw.js",Nr="/firebase-cloud-messaging-push-scope",Tr="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Cr="https://fcmregistrations.googleapis.com/v1",Ar="google.c.a.c_id";var jr,Pr;function Dr(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Rr(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}!function(e){e[e.DATA_MESSAGE=1]="DATA_MESSAGE",e[e.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"}(jr||(jr={})),function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(Pr||(Pr={}));const Or="fcm_token_details_db",Mr=5,Lr="fcm_token_object_Store";const Fr="firebase-messaging-database",Ur=1,Vr="firebase-messaging-store";let Br=null;function zr(){return Br||(Br=(0,On.P2)(Fr,Ur,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Vr)}})),Br}async function qr(e){const t=Hr(e),n=await zr(),r=await n.transaction(Vr).objectStore(Vr).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB){const e=(await indexedDB.databases()).map(e=>e.name);if(!e.includes(Or))return null}let t=null;return(await(0,On.P2)(Or,Mr,{upgrade:async(n,r,i,s)=>{var a;if(r<2)return;if(!n.objectStoreNames.contains(Lr))return;const o=s.objectStore(Lr),l=await o.index("fcmSenderId").get(e);if(await o.clear(),l)if(2===r){const e=l;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(a=e.createTime)&&void 0!==a?a:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"===typeof e.vapidKey?e.vapidKey:Dr(e.vapidKey)}}}else if(3===r){const e=l;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:Dr(e.auth),p256dh:Dr(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:Dr(e.vapidKey)}}}else if(4===r){const e=l;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:Dr(e.auth),p256dh:Dr(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:Dr(e.vapidKey)}}}}})).close(),await(0,On.MR)(Or),await(0,On.MR)("fcm_vapid_details_db"),await(0,On.MR)("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"===typeof e.createTime&&e.createTime>0&&"string"===typeof e.token&&e.token.length>0&&"string"===typeof t.auth&&t.auth.length>0&&"string"===typeof t.p256dh&&t.p256dh.length>0&&"string"===typeof t.endpoint&&t.endpoint.length>0&&"string"===typeof t.swScope&&t.swScope.length>0&&"string"===typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await Kr(e,t),t}}async function Kr(e,t){const n=Hr(e),r=(await zr()).transaction(Vr,"readwrite");return await r.objectStore(Vr).put(t,n),await r.done,t}function Hr(e){let{appConfig:t}=e;return t.appId}const Wr={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Gr=new s.FA("messaging","Messaging",Wr);async function Qr(e,t){const n={method:"DELETE",headers:await Jr(e)};try{const r=await fetch("".concat(Yr(e.appConfig),"/").concat(t),n),i=await r.json();if(i.error){const e=i.error.message;throw Gr.create("token-unsubscribe-failed",{errorInfo:e})}}catch(r){throw Gr.create("token-unsubscribe-failed",{errorInfo:null===r||void 0===r?void 0:r.toString()})}}function Yr(e){let{projectId:t}=e;return"".concat(Cr,"/projects/").concat(t,"/registrations")}async function Jr(e){let{appConfig:t,installations:n}=e;const r=await n.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(r)})}function Xr(e){let{p256dh:t,auth:n,endpoint:r,vapidKey:i}=e;const s={web:{endpoint:r,auth:n,p256dh:t}};return i!==Tr&&(s.web.applicationPubKey=i),s}const $r=6048e5;async function Zr(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Rr(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:Dr(t.getKey("auth")),p256dh:Dr(t.getKey("p256dh"))},r=await qr(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,s=t.p256dh===e.p256dh;return n&&r&&i&&s}(r.subscriptionOptions,n))return Date.now()>=r.createTime+$r?async function(e,t){try{const n=await async function(e,t){const n=await Jr(e),r=Xr(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let s;try{const n=await fetch("".concat(Yr(e.appConfig),"/").concat(t.token),i);s=await n.json()}catch(a){throw Gr.create("token-update-failed",{errorInfo:null===a||void 0===a?void 0:a.toString()})}if(s.error){const e=s.error.message;throw Gr.create("token-update-failed",{errorInfo:e})}if(!s.token)throw Gr.create("token-update-no-token");return s.token}(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return await Kr(e.firebaseDependencies,r),n}catch(n){throw n}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await Qr(e.firebaseDependencies,r.token)}catch(i){console.warn(i)}return ei(e.firebaseDependencies,n)}return ei(e.firebaseDependencies,n)}async function ei(e,t){const n=await async function(e,t){const n=await Jr(e),r=Xr(t),i={method:"POST",headers:n,body:JSON.stringify(r)};let s;try{const t=await fetch(Yr(e.appConfig),i);s=await t.json()}catch(a){throw Gr.create("token-subscribe-failed",{errorInfo:null===a||void 0===a?void 0:a.toString()})}if(s.error){const e=s.error.message;throw Gr.create("token-subscribe-failed",{errorInfo:e})}if(!s.token)throw Gr.create("token-subscribe-no-token");return s.token}(e,t),r={token:n,createTime:Date.now(),subscriptionOptions:t};return await Kr(e,r),r.token}function ti(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i);const s=t.notification.icon;s&&(e.notification.icon=s)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){var n,r,i,s,a;if(!t.fcmOptions&&!(null===(n=t.notification)||void 0===n?void 0:n.click_action))return;e.fcmOptions={};const o=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(s=t.notification)||void 0===s?void 0:s.click_action;o&&(e.fcmOptions.link=o);const l=null===(a=t.fcmOptions)||void 0===a?void 0:a.analytics_label;l&&(e.fcmOptions.analyticsLabel=l)}(t,e),t}function ni(e){return Gr.create("missing-app-config-values",{valueName:e})}!function(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));n.join("")}("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class ri{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function(e){if(!e||!e.options)throw ni("App Configuration Object");if(!e.name)throw ni("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const r of t)if(!n[r])throw ni(r);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}async function ii(e){try{e.swRegistration=await navigator.serviceWorker.register(Sr,{scope:Nr}),e.swRegistration.update().catch(()=>{})}catch(t){throw Gr.create("failed-service-worker-registration",{browserErrorMessage:null===t||void 0===t?void 0:t.message})}}async function si(e,t){if(!navigator)throw Gr.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw Gr.create("permission-blocked");return await async function(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=Tr)}(e,null===t||void 0===t?void 0:t.vapidKey),await async function(e,t){if(t||e.swRegistration||await ii(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw Gr.create("invalid-sw-registration");e.swRegistration=t}}(e,null===t||void 0===t?void 0:t.serviceWorkerRegistration),Zr(e)}async function ai(e,t,n){const r=function(e){switch(e){case Pr.NOTIFICATION_CLICKED:return"notification_open";case Pr.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t);(await e.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[Ar],message_name:n["google.c.a.c_l"],message_time:n["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)})}async function oi(e,t){const n=t.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===Pr.PUSH_RECEIVED&&("function"===typeof e.onMessageHandler?e.onMessageHandler(ti(n)):e.onMessageHandler.next(ti(n)));const r=n.data;var i;"object"===typeof(i=r)&&i&&Ar in i&&"1"===r["google.c.a.e"]&&await ai(e,n.messageType,r)}const li="@firebase/messaging",ci="0.12.12",ui=e=>{const t=new ri(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>oi(t,e)),t},di=e=>{const t=e.getProvider("messaging").getImmediate();return{getToken:e=>si(t,e)}};async function hi(e,t){return si(e=(0,s.Ku)(e),t)}function fi(e,t){return function(e,t){if(!navigator)throw Gr.create("only-available-in-window");return e.onMessageHandler=t,()=>{e.onMessageHandler=null}}(e=(0,s.Ku)(e),t)}(0,i.om)(new l.uA("messaging",ui,"PUBLIC")),(0,i.om)(new l.uA("messaging-internal",di,"PRIVATE")),(0,i.KO)(li,ci),(0,i.KO)(li,ci,"esm2017");const pi="analytics",mi="https://www.googletagmanager.com/gtag/js",gi=new a.Vy("@firebase/analytics"),yi={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},vi=new s.FA("analytics","Analytics",yi);function bi(e){if(!e.startsWith(mi)){const t=vi.create("invalid-gtag-resource",{gtagURL:e});return gi.warn(t.message),""}return e}function wi(e){return Promise.all(e.map(e=>e.catch(e=>e)))}function xi(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:bi}),r=document.createElement("script"),i="".concat(mi,"?l=").concat(e,"&id=").concat(t);r.src=n?null===n||void 0===n?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function ki(e,t,n,r){return async function(i){try{for(var s=arguments.length,a=new Array(s>1?s-1:0),o=1;o<s;o++)a[o-1]=arguments[o];if("event"===i){const[r,i]=a;await async function(e,t,n,r,i){try{let s=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await wi(n);for(const n of e){const e=r.find(e=>e.measurementId===n),i=e&&t[e.appId];if(!i){s=[];break}s.push(i)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",r,i||{})}catch(s){gi.error(s)}}(e,t,n,r,i)}else if("config"===i){const[i,s]=a;await async function(e,t,n,r,i,s){const a=r[i];try{if(a)await t[a];else{const e=(await wi(n)).find(e=>e.measurementId===i);e&&await t[e.appId]}}catch(o){gi.error(o)}e("config",i,s)}(e,t,n,r,i,s)}else if("consent"===i){const[t,n]=a;e("consent",t,n)}else if("get"===i){const[t,n,r]=a;e("get",t,n,r)}else if("set"===i){const[t]=a;e("set",t)}else e(i,...a)}catch(l){gi.error(l)}}}const _i=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Ii(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Ei(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_i,n=arguments.length>2?arguments[2]:void 0;const{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw vi.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw vi.create("no-api-key")}const a=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new Ni;return setTimeout(async()=>{o.abort()},void 0!==n?n:6e4),Si({appId:r,apiKey:i,measurementId:s},a,o,t)}async function Si(e,t,n){let{throttleEndTimeMillis:r,backoffCount:i}=t,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_i;var o;const{appId:l,measurementId:c}=e;try{await function(e,t){return new Promise((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener(()=>{clearTimeout(s),r(vi.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(n,r)}catch(u){if(c)return gi.warn("Timed out fetching this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(c)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===u||void 0===u?void 0:u.message,"]")),{appId:l,measurementId:c};throw u}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:Ii(r)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),a=await fetch(s,i);if(200!==a.status&&304!==a.status){let e="";try{const n=await a.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(o){}throw vi.create("config-fetch-failed",{httpStatus:a.status,responseMessage:e})}return a.json()}(e);return a.deleteThrottleMetadata(l),t}catch(u){const t=u;if(!function(e){if(!(e instanceof s.g)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(a.deleteThrottleMetadata(l),c)return gi.warn("Failed to fetch this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(c)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===t||void 0===t?void 0:t.message,"]")),{appId:l,measurementId:c};throw u}const r=503===Number(null===(o=null===t||void 0===t?void 0:t.customData)||void 0===o?void 0:o.httpStatus)?(0,s.p9)(i,a.intervalMillis,30):(0,s.p9)(i,a.intervalMillis),d={throttleEndTimeMillis:Date.now()+r,backoffCount:i+1};return a.setThrottleMetadata(l,d),gi.debug("Calling attemptFetch again in ".concat(r," millis")),Si(e,d,n,a)}}class Ni{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let Ti,Ci;function Ai(e){Ci=e}function ji(e){Ti=e}async function Pi(e,t,n,r,i,a,o){var l;const c=Ei(e);c.then(t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&gi.warn("The measurement ID in the local Firebase config (".concat(e.options.measurementId,")")+" does not match the measurement ID fetched from the server (".concat(t.measurementId,").")+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(e=>gi.error(e)),t.push(c);const u=async function(){if(!(0,s.zW)())return gi.warn(vi.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await(0,s.eX)()}catch(e){return gi.warn(vi.create("indexeddb-unavailable",{errorInfo:null===e||void 0===e?void 0:e.toString()}).message),!1}return!0}().then(e=>e?r.getId():void 0),[d,h]=await Promise.all([c,u]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(mi)&&n.src.includes(e))return n;return null})(a)||xi(a,d.measurementId),Ci&&(i("consent","default",Ci),Ai(void 0)),i("js",new Date);const f=null!==(l=null===o||void 0===o?void 0:o.config)&&void 0!==l?l:{};return f.origin="firebase",f.update=!0,null!=h&&(f.firebase_id=h),i("config",d.measurementId,f),Ti&&(i("set",Ti),ji(void 0)),d.measurementId}class Di{constructor(e){this.app=e}_delete(){return delete Ri[this.app.options.appId],Promise.resolve()}}let Ri={},Oi=[];const Mi={};let Li,Fi,Ui="dataLayer",Vi="gtag",Bi=!1;function zi(e,t,n){!function(){const e=[];if((0,s.sr)()&&e.push("This is a browser extension environment."),(0,s.dM)()||e.push("Cookies are not available."),e.length>0){const t=e.map((e,t)=>"(".concat(t+1,") ").concat(e)).join(" "),n=vi.create("invalid-analytics-context",{errorInfo:t});gi.warn(n.message)}}();const r=e.options.appId;if(!r)throw vi.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw vi.create("no-api-key");gi.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+" measurement ID for this Firebase app. Falling back to the measurement ID ".concat(e.options.measurementId)+' provided in the "measurementId" field in the local Firebase config.')}if(null!=Ri[r])throw vi.create("already-exists",{id:r});if(!Bi){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(Ui);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"===typeof window[i]&&(s=window[i]),window[i]=ki(s,e,t,n),{gtagCore:s,wrappedGtag:window[i]}}(Ri,Oi,Mi,Ui,Vi);Fi=e,Li=t,Bi=!0}Ri[r]=Pi(e,Oi,Mi,t,Li,Ui,n);return new Di(e)}function qi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.Sx)();e=(0,s.Ku)(e);const t=(0,i.j6)(e,pi);return t.isInitialized()?t.getImmediate():function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,i.j6)(e,pi);if(n.isInitialized()){const e=n.getImmediate();if((0,s.bD)(t,n.getOptions()))return e;throw vi.create("already-initialized")}const r=n.initialize({options:t});return r}(e)}function Ki(e,t,n,r){e=(0,s.Ku)(e),async function(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(Fi,Ri[e.app.options.appId],t,n,r).catch(e=>gi.error(e))}const Hi="@firebase/analytics",Wi="0.10.8";(0,i.om)(new l.uA(pi,(e,t)=>{let{options:n}=t;return zi(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),(0,i.om)(new l.uA("analytics-internal",function(e){try{const t=e.getProvider(pi).getImmediate();return{logEvent:(e,n,r)=>Ki(t,e,n,r)}}catch(t){throw vi.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),(0,i.KO)(Hi,Wi),(0,i.KO)(Hi,Wi,"esm2017"),function(){const e=["REACT_APP_FIREBASE_API_KEY","REACT_APP_FIREBASE_AUTH_DOMAIN","REACT_APP_FIREBASE_PROJECT_ID","REACT_APP_FIREBASE_STORAGE_BUCKET","REACT_APP_FIREBASE_MESSAGING_SENDER_ID","REACT_APP_FIREBASE_APP_ID"].filter(e=>!{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyBcyjovZATPYqCN4yQNM99DTQ2K0dWcVyo",REACT_APP_FIREBASE_APP_ID:"1:816425843858:web:60eaaa2ddd094b6e797a4b",REACT_APP_FIREBASE_AUTH_DOMAIN:"bestiesapp.firebaseapp.com",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-6E24DQXPHX",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"816425843858",REACT_APP_FIREBASE_PROJECT_ID:"bestiesapp",REACT_APP_FIREBASE_STORAGE_BUCKET:"bestiesapp.firebasestorage.app",REACT_APP_FIREBASE_VAPID_KEY:"BPXtVOACRBaCM1AtO7sUvFGfc7_nzwvZPVh4BRDCth2-c8a_FI7_l-jszYjgtSnw_f2pJ5OAo9CgnBIUClpPm3s",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyBIotp3fl0_9y7xbyPUI79hsZR9Cw3g4l4",REACT_APP_STRIPE_PUBLISHABLE_KEY:"pk_live_51SR1CfEelNu8QcRAALMompJfse2B7tXODHYIpbcRcawyAN3fMi75mMAXpTyP66c444ydSE0Y01yczaw64TgyKW85005IvwbRX2"}[e]);if(e.length>0){const t="Missing required environment variables: ".concat(e.join(", "),"\n\n")+"Please check your .env file and ensure all Firebase configuration variables are set.";throw console.error(t),new Error(t)}const t=["REACT_APP_FIREBASE_VAPID_KEY","REACT_APP_GOOGLE_MAPS_API_KEY"].filter(e=>!{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyBcyjovZATPYqCN4yQNM99DTQ2K0dWcVyo",REACT_APP_FIREBASE_APP_ID:"1:816425843858:web:60eaaa2ddd094b6e797a4b",REACT_APP_FIREBASE_AUTH_DOMAIN:"bestiesapp.firebaseapp.com",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-6E24DQXPHX",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"816425843858",REACT_APP_FIREBASE_PROJECT_ID:"bestiesapp",REACT_APP_FIREBASE_STORAGE_BUCKET:"bestiesapp.firebasestorage.app",REACT_APP_FIREBASE_VAPID_KEY:"BPXtVOACRBaCM1AtO7sUvFGfc7_nzwvZPVh4BRDCth2-c8a_FI7_l-jszYjgtSnw_f2pJ5OAo9CgnBIUClpPm3s",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyBIotp3fl0_9y7xbyPUI79hsZR9Cw3g4l4",REACT_APP_STRIPE_PUBLISHABLE_KEY:"pk_live_51SR1CfEelNu8QcRAALMompJfse2B7tXODHYIpbcRcawyAN3fMi75mMAXpTyP66c444ydSE0Y01yczaw64TgyKW85005IvwbRX2"}[e]);t.length>0&&console.warn("Optional environment variables not set: ".concat(t.join(", "),"\n")+"Some features may not work without these.")}();const Gi={apiKey:"AIzaSyBcyjovZATPYqCN4yQNM99DTQ2K0dWcVyo",authDomain:"bestiesapp.firebaseapp.com",projectId:"bestiesapp",storageBucket:"bestiesapp.firebasestorage.app",messagingSenderId:"816425843858",appId:"1:816425843858:web:60eaaa2ddd094b6e797a4b"},Qi=(0,i.Wp)(Gi),Yi=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.Sx)();const t=(0,i.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=(0,i.j6)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),r=n.getOptions();if((0,s.bD)(r,null!==t&&void 0!==t?t:{}))return e;p(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:En,persistence:[St,ct,dt]}),r=(0,s.XA)("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(a=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Cn)return;const r=null===t||void 0===t?void 0:t.token;An!==r&&(An=r,await fetch(a,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(e,t,n){(0,s.Ku)(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){(0,s.Ku)(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var a;const o=(0,s.Tj)("auth");return o&&Ae(n,"http://".concat(o)),n}(Qi),Ji=(0,Pn.aU)(Qi),Xi=(0,Dn.c7)(Qi),$i=(0,Rn.Uz)(Qi),Zi=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.Sx)();return async function(){try{await(0,s.eX)()}catch(e){return!1}return"undefined"!==typeof window&&(0,s.zW)()&&(0,s.dM)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}().then(e=>{if(!e)throw Gr.create("unsupported-browser")},e=>{throw Gr.create("indexed-db-unsupported")}),(0,i.j6)((0,s.Ku)(e),"messaging").getImmediate()}(Qi);let es=null;"undefined"!==typeof window&&async function(){if((0,s.sr)())return!1;if(!(0,s.dM)())return!1;if(!(0,s.zW)())return!1;try{return await(0,s.eX)()}catch(e){return!1}}().then(e=>{e&&(es=qi(Qi))});const ts=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(es)try{Ki(es,e,t)}catch(n){console.error("Analytics error:",n)}};(0,Pn.ol)(Ji).catch(e=>{"failed-precondition"===e.code?console.warn("Firestore persistence failed: Multiple tabs open"):"unimplemented"===e.code&&console.warn("Firestore persistence not supported in this browser")});const ns=new We,rs=e=>{switch(e.code){case"auth/wrong-password":return"Incorrect password. Please try again.";case"auth/user-not-found":return"No account found with this email.";case"auth/email-already-in-use":return"This email is already registered.";case"auth/weak-password":return"Password should be at least 6 characters.";case"auth/invalid-email":return"Invalid email address.";case"auth/user-disabled":return"This account has been disabled.";case"auth/too-many-requests":return"Too many failed attempts. Please try again later.";case"auth/network-request-failed":return"Network error. Please check your connection.";case"auth/popup-closed-by-user":return"Sign-in popup was closed.";case"auth/cancelled-popup-request":return"Sign-in was cancelled.";case"auth/invalid-credential":return"Invalid credentials. Please check your email and password.";default:return e.message.replace("Firebase: ","").replace(/\(auth\/[\w-]+\)\.?/,"").trim()}},is={signInWithGoogle:async()=>{try{const e=await async function(e,t,n){if((0,i.xZ)(e.app))return Promise.reject(m(e,"operation-not-supported-in-this-environment"));const r=ke(e);v(e,t,qe);const s=Vt(r,n);return new Gt(r,"signInViaPopup",t,s).executeNotNull()}(Yi,ns);return{success:!0,user:e.user}}catch(e){return console.error("Google sign in error:",e),{success:!1,error:rs(e)}}},signInWithEmail:async(e,t)=>{try{const n=await function(e,t,n){return(0,i.xZ)(e.app)?Promise.reject(y(e)):rt((0,s.Ku)(e),ze.credential(t,n)).catch(async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&it(e),t})}(Yi,e,t);return{success:!0,user:n.user}}catch(n){return console.error("Email sign in error:",n),{success:!1,error:rs(n)}}},signUpWithEmail:async(e,t,n)=>{try{const r=await async function(e,t,n){if((0,i.xZ)(e.app))return Promise.reject(y(e));const r=ke(e),s=Ce(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ye),a=await s.catch(t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&it(e),t}),o=await Je._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(o.user),o}(Yi,e,t);return await st(r.user,{displayName:n||"New User"}),{success:!0,user:r.user}}catch(r){return console.error("Email sign up error:",r),{success:!1,error:rs(r)}}},setupRecaptcha:e=>{try{return window.recaptchaVerifier||(window.recaptchaVerifier=new Mt(Yi,e,{size:"invisible",callback:()=>{}})),{success:!0,verifier:window.recaptchaVerifier}}catch(t){return console.error("reCAPTCHA setup error:",t),{success:!1,error:t.message}}},sendPhoneVerification:async(e,t)=>{try{const n=await async function(e,t,n){if((0,i.xZ)(e.app))return Promise.reject(y(e));const r=ke(e),a=await Ft(r,t,(0,s.Ku)(n));return new Lt(a,e=>rt(r,e))}(Yi,e,t);return{success:!0,confirmationResult:n}}catch(n){return console.error("Phone verification error:",n),window.recaptchaVerifier&&(window.recaptchaVerifier.clear(),window.recaptchaVerifier=null),{success:!1,error:n.message}}},verifyPhoneCode:async(e,t)=>{try{return{success:!0,user:(await e.confirm(t)).user}}catch(n){return console.error("Code verification error:",n),{success:!1,error:n.message}}},signOut:async()=>{try{return await function(e){return(0,s.Ku)(e).signOut()}(Yi),{success:!0}}catch(e){return console.error("Sign out error:",e),{success:!1,error:e.message}}},getCurrentUser:()=>Yi.currentUser,getToken:async()=>{const e=Yi.currentUser;return e?await e.getIdToken():null}},ss={getDocument:async(e,t)=>{try{const n=(0,Pn.H9)(Ji,e,t),i=await(0,Pn.x7)(n);return i.exists()?{success:!0,data:(0,r.A)({id:i.id},i.data())}:{success:!1,error:"Document not found"}}catch(n){return console.error("Get document error:",n),{success:!1,error:n.message}}},setDocument:async(e,t,n)=>{try{return await(0,Pn.BN)((0,Pn.H9)(Ji,e,t),(0,r.A)((0,r.A)({},n),{},{updatedAt:(0,Pn.O5)()}),{merge:!0}),{success:!0}}catch(i){return console.error("Set document error:",i),{success:!1,error:i.message}}},addDocument:async(e,t)=>{try{return{success:!0,id:(await(0,Pn.gS)((0,Pn.rJ)(Ji,e),(0,r.A)((0,r.A)({},t),{},{createdAt:(0,Pn.O5)(),updatedAt:(0,Pn.O5)()}))).id}}catch(n){return console.error("Add document error:",n),{success:!1,error:n.message}}},updateDocument:async(e,t,n)=>{try{return await(0,Pn.mZ)((0,Pn.H9)(Ji,e,t),(0,r.A)((0,r.A)({},n),{},{updatedAt:(0,Pn.O5)()})),{success:!0}}catch(i){return console.error("Update document error:",i),{success:!1,error:i.message}}},deleteDocument:async(e,t)=>{try{return await(0,Pn.kd)((0,Pn.H9)(Ji,e,t)),{success:!0}}catch(n){return console.error("Delete document error:",n),{success:!1,error:n.message}}},queryDocuments:async(e,t)=>{try{let n=(0,Pn.rJ)(Ji,e);if(t&&t.length>0){const e=t.map(e=>{let{field:t,operator:n,value:r}=e;return(0,Pn._M)(t,n,r)});n=(0,Pn.P)(n,...e)}const i=await(0,Pn.GG)(n),s=[];return i.forEach(e=>{s.push((0,r.A)({id:e.id},e.data()))}),{success:!0,data:s}}catch(n){return console.error("Query documents error:",n),{success:!1,error:n.message}}}},as={uploadFile:async(e,t)=>{try{const n=(0,Dn.KR)(Xi,e);await(0,Dn.D)(n,t);return{success:!0,url:await(0,Dn.qk)(n)}}catch(n){return console.error("Upload file error:",n),{success:!1,error:n.message}}},deleteFile:async e=>{try{const t=(0,Dn.KR)(Xi,e);return await(0,Dn.XR)(t),{success:!0}}catch(t){return console.error("Delete file error:",t),{success:!1,error:t.message}}}},os={now:()=>Pn.Dc.now(),fromDate:e=>Pn.Dc.fromDate(e),toDate:e=>null===e||void 0===e?void 0:e.toDate(),serverTimestamp:()=>(0,Pn.O5)()},ls=Qi},4202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var w=b.prototype=new v;w.constructor=b,m(w,y.prototype),w.isPureReactComponent=!0;var x=Array.isArray,k=Object.prototype.hasOwnProperty,_={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var i,s={},a=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)k.call(t,i)&&!I.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:a,ref:o,props:s,_owner:_.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var N=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function C(e,t,i,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===s?"."+T(l,0):s,x(a)?(i="",null!=e&&(i=e.replace(N,"$&/")+"/"),C(a,t,i,"",function(e){return e})):null!=a&&(S(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(N,"$&/")+"/")+e)),t.push(a)),1;if(l=0,s=""===s?".":s+":",x(e))for(var c=0;c<e.length;c++){var u=s+T(o=e[c],c);l+=C(o,t,i,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=C(o=o.value,t,i,u=s+T(o,c++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var r=[],i=0;return C(e,r,"","",function(e){return t.call(n,e,i++)}),r}function j(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},D={transition:null},R={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:D,ReactCurrentOwner:_};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=a,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),s=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=_.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)k.call(t,c)&&!I.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:a,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:j}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},4391:(e,t,n)=>{var r=n(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4428:(e,t,n)=>{n.d(t,{As:()=>o,ak:()=>v,ds:()=>y,rC:()=>p,uH:()=>f,zp:()=>m});var r=n(2555),i=n(3984),s=n(5472);const a=864e5,o=async(e,t)=>{try{const n={alertResponse:0,storyEngagement:0,featuredCircle:0,recency:0},[r,i,s,a]=await Promise.all([l(e,t),c(e,t),u(e,t),d(e,t)]);n.alertResponse=r,n.storyEngagement=i,n.featuredCircle=s,n.recency=a;const o=Math.round(n.alertResponse+n.storyEngagement+n.featuredCircle+n.recency);return{total:Math.min(100,o),breakdown:n,level:h(o)}}catch(n){return console.error("Error calculating connection energy:",n),{total:0,breakdown:{},level:"spark"}}},l=async(e,t)=>{try{const n=(0,s.P)((0,s.rJ)(i.db,"alert_responses"),(0,s._M)("userId","==",e),(0,s._M)("responderId","==",t)),r=await(0,s.GG)(n);if(r.empty)return 0;const a=r.docs.map(e=>e.data()),o=a.reduce((e,t)=>e+t.responseTime,0)/a.length/60;let l=0;l=o<5?35:o<15?30:o<30?25:o<60?18:o<180?10:5;return l+Math.min(15,2*a.length)}catch(n){return console.error("Error calculating alert response score:",n),0}},c=async(e,t)=>0,u=async(e,t)=>{try{const[n,r]=await Promise.all([(0,s.x7)((0,s.H9)(i.db,"users",e)),(0,s.x7)((0,s.H9)(i.db,"users",t))]),a=n.exists()&&n.data().featuredCircle||[],o=r.exists()&&r.data().featuredCircle||[],l=a.includes(t),c=o.includes(e);return l&&c?15:l?9:c?8:0}catch(n){return console.error("Error calculating featured circle score:",n),0}},d=async(e,t)=>{try{const n=(0,s.P)((0,s.rJ)(i.db,"interactions"),(0,s._M)("userId","==",e),(0,s._M)("bestieId","==",t),(0,s.My)("createdAt","desc"),(0,s.AB)(1)),r=await(0,s.GG)(n),o=(0,s.P)((0,s.rJ)(i.db,"interactions"),(0,s._M)("userId","==",t),(0,s._M)("bestieId","==",e),(0,s.My)("createdAt","desc"),(0,s.AB)(1)),l=await(0,s.GG)(o);let c=null;if(r.empty||(c=r.docs[0].data().createdAt),!l.empty){const e=l.docs[0].data().createdAt;(!c||e.toMillis()>c.toMillis())&&(c=e)}if(!c)return 0;const u=(Date.now()-c.toMillis())/a;return u<1?10:u<3?8:u<7?6:u<14?4:u<30?2:0}catch(n){return console.error("Error calculating recency score:",n),0}},h=e=>e>=90?"unbreakable":e>=70?"powerful":e>=50?"strong":e>=30?"growing":"spark",f=e=>e>=90?"#10b981":e>=70?"#3b82f6":e>=50?"#8b5cf6":e>=30?"#f59e0b":"#ec4899",p=e=>e>=90?"\ud83d\udd25":e>=70?"\u26a1":e>=50?"\ud83d\udcaa":e>=30?"\ud83d\udd06":"\ud83c\udf31",m=async e=>{try{const t=await(0,s.x7)((0,s.H9)(i.db,"users",e));if(!t.exists())return{score:0,insights:[]};const n=t.data().featuredCircle||[];if(0===n.length)return{score:0,insights:["Add besties to your circle to start building connections"]};const a=n.map(t=>o(e,t).then(e=>(0,r.A)((0,r.A)({},e),{},{id:t}))),l=await Promise.all(a),c=l.reduce((e,t)=>e+t.total,0)/l.length;let u=c;n.length<5&&(u*=n.length/5);const d=g(e,l,n);return{score:Math.round(u),avgConnectionStrength:Math.round(c),circleSize:n.length,connections:l,insights:d}}catch(t){return console.error("Error calculating circle health:",t),{score:0,insights:["Error calculating circle health"]}}},g=(e,t,n)=>{const r=[],i=t.filter(e=>e.total<30);i.length>0&&r.push({type:"tip",message:"".concat(i.length," connection").concat(i.length>1?"s are":" is"," just getting started - keep building!"),action:"reach_out"}),n.length<5&&r.push({type:"info",message:"Add ".concat(5-n.length," more ").concat(4===n.length?"bestie":"besties"," to unlock full circle power"),action:"add_besties"});const s=t.filter(e=>e.breakdown.recency<4);return s.length>0&&r.push({type:"tip",message:"".concat(s.length," connection").concat(s.length>1?"s could":" could"," use some love - reach out today!"),action:"post_story"}),t.every(e=>e.total>=70)&&5===n.length&&r.push({type:"success",message:"Your circle is unstoppable! This is what real connection looks like \ud83d\udd25",action:null}),r},y=async(e,t)=>{try{const n=(0,s.P)((0,s.rJ)(i.db,"interactions"),(0,s._M)("userId","==",e),(0,s._M)("bestieId","==",t),(0,s.My)("createdAt","desc"),(0,s.AB)(1)),r=await(0,s.GG)(n);if(!r.empty)return r.docs[0].data().createdAt;const a=(0,s.P)((0,s.rJ)(i.db,"checkins"),(0,s._M)("userId","==",e),(0,s._M)("bestieIds","array-contains",t),(0,s.My)("createdAt","desc"),(0,s.AB)(1)),o=await(0,s.GG)(a);return o.empty?null:o.docs[0].data().createdAt}catch(n){return console.error("Error getting last interaction:",n),null}},v=e=>{if(!e)return"Never";const t=Date.now()-e.toMillis(),n=Math.floor(t/6e4),r=Math.floor(t/36e5),i=Math.floor(t/a);return n<1?"Just now":n<60?"".concat(n,"m ago"):r<24?"".concat(r,"h ago"):1===i?"Yesterday":i<7?"".concat(i,"d ago"):i<30?"".concat(Math.floor(i/7),"w ago"):i<365?"".concat(Math.floor(i/30),"mo ago"):"".concat(Math.floor(i/365),"y ago")}},4505:(e,t,n)=>{n.d(t,{Ay:()=>s});var r=n(3984),i=n(626);const s={extendCheckIn:(0,i.Qg)(r.functions,"extendCheckIn"),completeCheckIn:(0,i.Qg)(r.functions,"completeCheckIn"),sendBestieInvite:(0,i.Qg)(r.functions,"sendBestieInvite"),acceptBestieRequest:(0,i.Qg)(r.functions,"acceptBestieRequest"),declineBestieRequest:(0,i.Qg)(r.functions,"declineBestieRequest"),triggerEmergencySOS:(0,i.Qg)(r.functions,"triggerEmergencySOS"),createCheckoutSession:(0,i.Qg)(r.functions,"createCheckoutSession"),createPortalSession:(0,i.Qg)(r.functions,"createPortalSession"),sendTestAlert:(0,i.Qg)(r.functions,"sendTestAlert"),migratePhoneNumbers:(0,i.Qg)(r.functions,"migratePhoneNumbers")}},4528:(e,t,n)=>{n.d(t,{As:()=>h,OJ:()=>f});var r=n(2555),i=n(5043),s=n(3984),a=n(5472),o=n(2339),l=n(3063),c=n(7329),u=n(579);const d=(0,i.createContext)(),h=()=>{const e=(0,i.useContext)(d);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},f=e=>{let{children:t}=e;const[n,h]=(0,i.useState)(null),[f,p]=(0,i.useState)(null),[m,g]=(0,i.useState)(!0),y=(0,i.useRef)(null);return(0,i.useEffect)(()=>{const e=new URLSearchParams(window.location.search).get("invite");if(e){sessionStorage.setItem("pending_invite",e),localStorage.setItem("pending_invite",e);(async()=>{try{const t=(0,a.H9)(s.db,"users",e),n=await(0,a.x7)(t);if(n.exists()){const t=n.data(),r=JSON.stringify({uid:e,displayName:t.displayName,photoURL:t.photoURL});sessionStorage.setItem("inviter_info",r),localStorage.setItem("inviter_info",r)}}catch(t){console.log("Could not fetch inviter info (this is normal):",t.code)}})();const t=window.location.pathname;window.history.replaceState({},"",t)}},[]),(0,i.useEffect)(()=>{const e=s.auth.onAuthStateChanged(async e=>{if(h(e),e){l.A.setUser(e.uid);const n=(0,a.H9)(s.db,"users",e.uid),i=await(0,a.x7)(n),u=!i.exists();if(u)await(0,a.BN)(n,{displayName:e.displayName||"New User",email:e.email,phoneNumber:e.phoneNumber||null,photoURL:e.photoURL||null,stats:{joinedAt:a.Dc.now(),totalCheckIns:0,completedCheckIns:0,alertedCheckIns:0,totalBesties:0},notificationPreferences:{whatsapp:!1,email:!0},notificationsEnabled:!1,smsSubscription:{active:!1},lastActive:a.Dc.now(),onboardingCompleted:!1});else{const e={lastActive:a.Dc.now()};void 0===i.data().onboardingCompleted&&(e.onboardingCompleted=!0),i.data().notifications&&!i.data().notificationPreferences&&(e.notificationPreferences=i.data().notifications),void 0===i.data().notificationsEnabled&&(e.notificationsEnabled=!!i.data().fcmToken),await(0,a.mZ)(n,e)}const d=sessionStorage.getItem("pending_invite")||localStorage.getItem("pending_invite");if(d&&(console.log("\ud83d\udce8 Found pending invite"),console.log("\ud83d\udcca Invite Details:",{inviterUID:d,currentUserUID:e.uid,isSelfInvite:d===e.uid,sessionStorage:sessionStorage.getItem("pending_invite"),localStorage:localStorage.getItem("pending_invite"),inviterInfo:sessionStorage.getItem("inviter_info")||localStorage.getItem("inviter_info")}),await(async(e,t)=>{if(!e||!t)return console.log("\u26a0\ufe0f Invalid invite parameters - missing user or inviterUID"),sessionStorage.removeItem("pending_invite"),localStorage.removeItem("pending_invite"),sessionStorage.removeItem("inviter_info"),void localStorage.removeItem("inviter_info");if(t===e.uid)return console.log("\u26a0\ufe0f Self-invitation detected! Clearing stored invite."),sessionStorage.removeItem("pending_invite"),localStorage.removeItem("pending_invite"),sessionStorage.removeItem("inviter_info"),localStorage.removeItem("inviter_info"),void o.Ay.error("You can't add yourself as a bestie! \ud83d\ude05");console.log("\ud83d\udd04 Processing invite for user:",e.uid,"from inviter:",t);try{const i=(0,a.H9)(s.db,"users",e.uid),o=await(0,a.x7)(i),l=o.exists()?o.data():{},c=sessionStorage.getItem("inviter_info")||localStorage.getItem("inviter_info");let u="Your Bestie",d=null;if(c)try{const e=JSON.parse(c);u=e.displayName||"Your Bestie",d=e.photoURL}catch(n){console.log("Could not parse cached inviter info")}const h=[(0,a.P)((0,a.rJ)(s.db,"besties"),(0,a._M)("requesterId","==",t),(0,a._M)("recipientId","==",e.uid)),(0,a.P)((0,a.rJ)(s.db,"besties"),(0,a._M)("requesterId","==",e.uid),(0,a._M)("recipientId","==",t)),(0,a.P)((0,a.rJ)(s.db,"besties"),(0,a._M)("requesterId","==",t),(0,a._M)("recipientPhone","==",e.phoneNumber||e.email))];let f=!1;for(let t of h){const n=await(0,a.GG)(t);if(!n.empty){const t=n.docs[0],r=t.data();if("accepted"===r.status&&r.recipientId===e.uid)return console.log("\u2705 Bestie connection already exists and is accepted - skipping duplicate"),f=!0,sessionStorage.removeItem("pending_invite"),localStorage.removeItem("pending_invite"),sessionStorage.removeItem("inviter_info"),void localStorage.removeItem("inviter_info");console.log("\ud83d\udd04 Updating existing bestie connection to accepted"),await(0,a.mZ)((0,a.H9)(s.db,"besties",t.id),{status:"accepted",acceptedAt:a.Dc.now(),recipientId:e.uid,recipientName:l.displayName||e.displayName||"Unknown",recipientPhone:e.phoneNumber||l.phoneNumber||e.email,recipientPhotoURL:l.photoURL||e.photoURL||null}),f=!0;break}}f?console.log("\u2705 Updated existing bestie connection"):(console.log("\u2728 Creating new bestie connection"),await(0,a.gS)((0,a.rJ)(s.db,"besties"),{requesterId:t,recipientId:e.uid,status:"accepted",acceptedAt:a.Dc.now(),createdAt:a.Dc.now(),requesterName:u,requesterPhotoURL:d,recipientName:l.displayName||e.displayName||"Unknown",recipientPhone:e.phoneNumber||l.phoneNumber||e.email,recipientPhotoURL:l.photoURL||e.photoURL||null}),console.log("\u2705 Bestie connection created"));try{console.log("\ud83d\udd04 Updating featured circles and bestie lists");const e=l.featuredCircle||[],n=l.bestieUserIds||[],r={};n.includes(t)||(r.bestieUserIds=[...n,t]),!e.includes(t)&&e.length<5&&(r.featuredCircle=[...e,t]),Object.keys(r).length>0&&(await(0,a.mZ)(i,r),console.log("\u2705 Updated current user document"));const o=(0,a.H9)(s.db,"users",t),c=await(0,a.x7)(o);if(c.exists()){const e=c.data();e.displayName&&e.displayName!==u&&(u=e.displayName,d=e.photoURL||d,console.log("\u2705 Got real inviter name:",u))}}catch(r){console.error("Failed to update user documents:",r)}try{console.log("\ud83c\udf89 Creating celebration documents with real names"),await(0,a.gS)((0,a.rJ)(s.db,"bestie_celebrations"),{userId:e.uid,bestieId:t,bestieName:u,bestiePhotoURL:d,seen:!1,createdAt:a.Dc.now()}),await(0,a.gS)((0,a.rJ)(s.db,"bestie_celebrations"),{userId:t,bestieId:e.uid,bestieName:l.displayName||e.displayName||"Someone",bestiePhotoURL:l.photoURL||e.photoURL||null,seen:!1,createdAt:a.Dc.now()}),console.log("\u2705 Celebrations created with names:",u,"and",l.displayName||e.displayName)}catch(r){console.error("Failed to create celebration documents:",r)}sessionStorage.removeItem("pending_invite"),localStorage.removeItem("pending_invite")}catch(r){console.error("Auto-add bestie failed:",r),sessionStorage.removeItem("pending_invite"),localStorage.removeItem("pending_invite")}})(e,d),console.log("\u2705 Invite processing complete"),!u)){const e=sessionStorage.getItem("inviter_info")||localStorage.getItem("inviter_info");if(e){try{const{displayName:t}=JSON.parse(e);o.Ay.success("You're now besties with ".concat(t,"! \ud83d\udc9c"),{duration:5e3})}catch(t){console.error("Failed to parse inviter info:",t)}sessionStorage.removeItem("inviter_info"),localStorage.removeItem("inviter_info")}}y.current&&y.current(),y.current=(0,a.aQ)(n,t=>{if(t.exists()){const e=(0,r.A)({id:t.id},t.data());p(e),e.notificationsEnabled&&e.fcmToken&&!c.A.initialized&&(c.A.setupForegroundListener(),c.A.initialized=!0,console.log("\u2705 Push notification foreground listener initialized"))}else console.error("\u274c User document does not exist at path:","users/".concat(e.uid));g(!1)},e=>{console.error("\u274c Firestore listener error:",e),console.error("Error code:",e.code),console.error("Error message:",e.message),g(!1)})}else y.current&&(y.current(),y.current=null),l.A.setUser(null),p(null),g(!1)});return()=>{e(),y.current&&y.current()}},[]),(0,u.jsx)(d.Provider,{value:{currentUser:n,userData:f,loading:m},children:t})}},4774:(e,t,n)=>{n.d(t,{G:()=>i});var r=n(9119);function i(e){const t=(0,r.a)(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}},5043:(e,t,n)=>{e.exports=n(4202)},5472:(e,t,n)=>{n.d(t,{Dc:()=>Y,gS:()=>Au,hq:()=>Ou,rJ:()=>dc,kd:()=>Cu,H9:()=>hc,ol:()=>bc,x7:()=>Iu,GG:()=>Su,aU:()=>gc,GV:()=>Mu,AB:()=>uu,aQ:()=>ju,My:()=>lu,P:()=>ru,O5:()=>Ru,BN:()=>Nu,HM:()=>hu,mZ:()=>Tu,_M:()=>su});var r,i,s=n(52),a=n(8812),o=n(443),l=n(7700),c="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},u={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],a=t+(s^n&(i^s))+r[0]+3614090360&4294967295;a=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(a<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((s=(t=n+((a=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((i=s+((a=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function s(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,s=this.h,a=0;a<t;){if(0==s)for(;a<=r;)n(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(i[s++]=e.charCodeAt(a++),s==this.blockSize){n(this,i),s=0;break}}else for(;a<t;)if(i[s++]=e[a++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var a={};function o(e){return-128<=e&&128>e?function(e,t){var n=a;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new s([0|e],0>e?-1:0)}):new s([0|e],0>e?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return c;if(0>e)return m(l(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new s(t,0)}var c=o(0),d=o(1),h=o(16777216);function f(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function p(e){return-1==e.h}function m(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new s(n,~e.h).add(d)}function g(e,t){return e.add(m(t))}function y(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function v(e,t){this.g=e,this.h=t}function b(e,t){if(f(t))throw Error("division by zero");if(f(e))return new v(c,c);if(p(e))return t=b(m(e),t),new v(m(t.g),m(t.h));if(p(t))return t=b(e,m(t)),new v(m(t.g),t.h);if(30<e.g.length){if(p(e)||p(t))throw Error("slowDivide_ only works with positive integers.");for(var n=d,r=t;0>=r.l(e);)n=w(n),r=w(r);var i=x(n,1),s=x(r,1);for(r=x(r,2),n=x(n,2);!f(r);){var a=s.add(r);0>=a.l(e)&&(i=i.add(n),s=a),r=x(r,1),n=x(n,1)}return t=g(e,i.j(t)),new v(i,t)}for(i=c;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),a=(s=l(n)).j(t);p(a)||0<a.l(e);)a=(s=l(n-=r)).j(t);f(s)&&(s=d),i=i.add(s),e=g(e,a)}return new v(i,e)}function w(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new s(n,e.h)}function x(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],a=0;a<r;a++)i[a]=0<t?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new s(i,e.h)}(e=s.prototype).m=function(){if(p(this))return-m(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(f(this))return"0";if(p(this))return"-"+m(this).toString(e);for(var t=l(Math.pow(e,6)),n=this,r="";;){var i=b(n,t).g,s=((0<(n=g(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(f(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return p(e=g(this,e))?-1:f(e)?0:1},e.abs=function(){return p(this)?m(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var a=r+(65535&this.i(i))+(65535&e.i(i)),o=(a>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);r=o>>>16,a&=65535,o&=65535,n[i]=o<<16|a}return new s(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(f(this)||f(e))return c;if(p(this))return p(e)?m(this).j(m(e)):m(m(this).j(e));if(p(e))return m(this.j(m(e)));if(0>this.l(h)&&0>e.l(h))return l(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var a=this.i(r)>>>16,o=65535&this.i(r),u=e.i(i)>>>16,d=65535&e.i(i);n[2*r+2*i]+=o*d,y(n,2*r+2*i),n[2*r+2*i+1]+=a*d,y(n,2*r+2*i+1),n[2*r+2*i+1]+=o*u,y(n,2*r+2*i+1),n[2*r+2*i+2]+=a*u,y(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new s(n,0)},e.A=function(e){return b(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new s(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new s(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new s(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,i=u.Md5=t,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return m(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=l(Math.pow(n,8)),i=c,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),o=parseInt(t.substring(s,s+a),n);8>a?(a=l(Math.pow(n,a)),i=i.j(a).add(l(o))):i=(i=i.j(r)).add(l(o))}return i},r=u.Integer=s}).apply("undefined"!==typeof c?c:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var d,h,f,p,m,g,y,v,b="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},w={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof b&&b];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var a=e[s];if(!(a in i))break e;i=i[a]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,function(e,t){return t})}});var r=r||{},i=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function k(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function _(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function E(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function S(e){return/^[\s\xa0]*$/.test(e)}function N(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function T(e){return T[" "](e),e}T[" "]=function(){};var C=-1!=N().indexOf("Gecko")&&!(-1!=N().toLowerCase().indexOf("webkit")&&-1==N().indexOf("Edge"))&&!(-1!=N().indexOf("Trident")||-1!=N().indexOf("MSIE"))&&-1==N().indexOf("Edge");function A(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function j(e){const t={};for(const n in e)t[n]=e[n];return t}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<P.length;t++)n=P[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function R(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function O(e){i.setTimeout(()=>{throw e},0)}function M(){var e=B;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var L=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new F,e=>e.reset());class F{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let U,V=!1,B=new class{constructor(){this.h=this.g=null}add(e,t){const n=L.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},z=()=>{const e=i.Promise.resolve(void 0);U=()=>{e.then(q)}};var q=()=>{for(var e;e=M();){try{e.h.call(e.g)}catch(n){O(n)}var t=L;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}V=!1};function K(){this.s=this.s,this.C=this.C}function H(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}K.prototype.s=!1,K.prototype.ma=function(){this.s||(this.s=!0,this.N())},K.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},H.prototype.h=function(){this.defaultPrevented=!0};var W=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function G(e,t){if(H.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(C){e:{try{T(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:Q[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&G.aa.h.call(this)}}k(G,H);var Q={2:"touch",3:"pen",4:"mouse"};G.prototype.h=function(){G.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Y="closure_listenable_"+(1e6*Math.random()|0),J=0;function X(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++J,this.da=this.fa=!1}function $(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function Z(e){this.src=e,this.g={},this.h=0}function ee(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&($(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function te(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}Z.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var a=te(e,t,r,i);return-1<a?(t=e[a],n||(t.fa=!1)):((t=new X(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var ne="closure_lm_"+(1e6*Math.random()|0),re={};function ie(e,t,n,r,i){if(r&&r.once)return ae(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)ie(e,t[s],n,r,i);return null}return n=fe(n),e&&e[Y]?e.K(t,n,a(r)?!!r.capture:!!r,i):se(e,t,n,!1,r,i)}function se(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=a(i)?!!i.capture:!!i,l=de(e);if(l||(e[ne]=l=new Z(e)),(n=l.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=ue;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)W||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(ce(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ae(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)ae(e,t[s],n,r,i);return null}return n=fe(n),e&&e[Y]?e.L(t,n,a(r)?!!r.capture:!!r,i):se(e,t,n,!0,r,i)}function oe(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)oe(e,t[s],n,r,i);else r=a(r)?!!r.capture:!!r,n=fe(n),e&&e[Y]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=te(s=e.g[t],n,r,i))&&($(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=de(e))&&(t=e.g[t.toString()],e=-1,t&&(e=te(t,n,r,i)),(n=-1<e?t[e]:null)&&le(n))}function le(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[Y])ee(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(ce(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=de(t))?(ee(n,e),0==n.h&&(n.src=null,t[ne]=null)):$(e)}}}function ce(e){return e in re?re[e]:re[e]="on"+e}function ue(e,t){if(e.da)e=!0;else{t=new G(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&le(e),e=n.call(r,t)}return e}function de(e){return(e=e[ne])instanceof Z?e:null}var he="__closure_events_fn_"+(1e9*Math.random()>>>0);function fe(e){return"function"===typeof e?e:(e[he]||(e[he]=function(t){return e.handleEvent(t)}),e[he])}function pe(){K.call(this),this.i=new Z(this),this.M=this,this.F=null}function me(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new H(t,e);else if(t instanceof H)t.target=t.target||e;else{var i=t;D(t=new H(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var a=t.g=n[s];i=ge(a,r,!0,t)&&i}if(i=ge(a=t.g=e,r,!0,t)&&i,i=ge(a,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=ge(a=t.g=n[s],r,!1,t)&&i}function ge(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var a=t[s];if(a&&!a.da&&a.capture==n){var o=a.listener,l=a.ha||a.src;a.fa&&ee(e.i,a),i=!1!==o.call(l,r)&&i}}return i&&!r.defaultPrevented}function ye(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function ve(e){e.g=ye(()=>{e.g=null,e.i&&(e.i=!1,ve(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}k(pe,K),pe.prototype[Y]=!0,pe.prototype.removeEventListener=function(e,t,n,r){oe(this,e,t,n,r)},pe.prototype.N=function(){if(pe.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)$(n[r]);delete t.g[e],t.h--}}this.F=null},pe.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},pe.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class be extends K{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ve(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function we(e){K.call(this),this.h=e,this.g={}}k(we,K);var xe=[];function ke(e){A(e.g,function(e,t){this.g.hasOwnProperty(t)&&le(e)},e),e.g={}}we.prototype.N=function(){we.aa.N.call(this),ke(this)},we.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _e=i.JSON.stringify,Ie=i.JSON.parse,Ee=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function Se(){}function Ne(e){return e.h||(e.h=e.i())}function Te(){}Se.prototype.h=null;var Ce={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ae(){H.call(this,"d")}function je(){H.call(this,"c")}k(Ae,H),k(je,H);var Pe={},De=null;function Re(){return De=De||new pe}function Oe(e){H.call(this,Pe.La,e)}function Me(e){const t=Re();me(t,new Oe(t))}function Le(e,t){H.call(this,Pe.STAT_EVENT,e),this.stat=t}function Fe(e){const t=Re();me(t,new Le(t,e))}function Ue(e,t){H.call(this,Pe.Ma,e),this.size=t}function Ve(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){e()},t)}function Be(){this.g=!0}function ze(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var a=1;a<i.length;a++)i[a]=""}}}return _e(n)}catch(o){return t}}(e,n)+(r?" "+r:"")})}Pe.La="serverreachability",k(Oe,H),Pe.STAT_EVENT="statevent",k(Le,H),Pe.Ma="timingevent",k(Ue,H),Be.prototype.xa=function(){this.g=!1},Be.prototype.info=function(){};var qe,Ke={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},He={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function We(){}function Ge(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new we(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Qe}function Qe(){this.i=null,this.g="",this.h=!1}k(We,Se),We.prototype.g=function(){return new XMLHttpRequest},We.prototype.i=function(){return{}},qe=new We;var Ye={},Je={};function Xe(e,t,n){e.L=1,e.v=_t(vt(t)),e.m=n,e.P=!0,$e(e,null)}function $e(e,t){e.F=Date.now(),tt(e),e.A=vt(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Lt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Qe,e.g=En(e.j,n?t:null,!e.m),0<e.O&&(e.M=new be(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(xe[0]=i.toString()),i=xe);for(var s=0;s<i.length;s++){var a=ie(n,i[s],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.H?j(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Me(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s)for(var a="",o=s.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");a=2<=d.length&&"type"==d[1]?a+(u+"=")+c+"&":a+(u+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+a})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ze(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function et(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Je:(n=Number(t.substring(n,r)),isNaN(n)?Ye:(r+=1)+n>t.length?Je:(t=t.slice(r,r+n),e.C=r+n,t))}function tt(e){e.S=Date.now()+e.I,nt(e,e.I)}function nt(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ve(c(e.ba,e),t)}function rt(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function it(e){0==e.j.G||e.J||wn(e.j,e)}function st(e){rt(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ke(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function at(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||dt(n.h,e)))if(!e.K&&dt(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;bn(n),cn(n)}gn(n),Fe(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ve(c(n.Za,n),6e3));if(1>=ut(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else kn(n,11)}else if((e.K||n.g==e)&&bn(n),!S(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=c[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(ht(s,s.h),s.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,kt(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var a=e;if((r=n).qa=In(r,r.J?r.ia:null,r.W),a.K){ft(r.h,a);var o=a,l=r.L;l&&(o.I=l),o.B&&(rt(o),tt(o)),r.g=a}else mn(r);0<n.i.length&&dn(n)}else"stop"!=c[0]&&"close"!=c[0]||kn(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?kn(n,7):ln(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Me()}catch(u){}}Ge.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==rn(e)?t.j():this.Y(e)},Ge.prototype.Y=function(e){try{if(e==this.g)e:{const h=rn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||sn(this.g)))){this.J||4!=h||7==t||Me(),rt(this);var n=this.g.Z();this.X=n;t:if(Ze(this)){var r=sn(this.g);e="";var s=r.length,a=4==rn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){st(this),it(this);var o="";break t}this.h.i=new i.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(a&&t==s-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,s,a){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+a})}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Fe(12),st(this),it(this);break e}ze(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,at(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=et(this,o),e==Je){4==h&&(this.s=4,Fe(14),n=!1),ze(this.i,this.l,null,"[Incomplete Response]");break}if(e==Ye){this.s=4,Fe(15),ze(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}ze(this.i,this.l,e,null),at(this,e)}if(Ze(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,Fe(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),yn(d),d.M=!0,Fe(11))}}else ze(this.i,this.l,o,"[Invalid Chunked Response]"),st(this),it(this)}else ze(this.i,this.l,o,null),at(this,o);4==h&&st(this),this.o&&!this.J&&(4==h?wn(this.j,this):(this.o=!1,tt(this)))}else(function(e){const t={};e=(e.g&&2<=rn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(S(e[r]))continue;var n=R(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Fe(12)):(this.s=0,Fe(13)),st(this),it(this)}}}catch(x){}},Ge.prototype.cancel=function(){this.J=!0,st(this)},Ge.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Me(),Fe(17)),st(this),this.s=2,it(this)):nt(this,this.S-e)};var ot=class{constructor(e,t){this.g=e,this.map=t}};function lt(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ct(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ut(e){return e.h?1:e.g?e.g.size:0}function dt(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ht(e,t){e.g?e.g.add(t):e.h=t}function ft(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function pt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return _(e.i)}function mt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}lt.prototype.cancel=function(){if(this.i=pt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var gt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yt(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof yt){this.h=e.h,bt(this,e.j),this.o=e.o,this.g=e.g,wt(this,e.s),this.l=e.l;var t=e.i,n=new Dt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),xt(this,n),this.m=e.m}else e&&(t=String(e).match(gt))?(this.h=!1,bt(this,t[1]||"",!0),this.o=It(t[2]||""),this.g=It(t[3]||"",!0),wt(this,t[4]),this.l=It(t[5]||"",!0),xt(this,t[6]||"",!0),this.m=It(t[7]||"")):(this.h=!1,this.i=new Dt(null,this.h))}function vt(e){return new yt(e)}function bt(e,t,n){e.j=n?It(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function wt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function xt(e,t,n){t instanceof Dt?(e.i=t,function(e,t){t&&!e.j&&(Rt(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Ot(this,t),Lt(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=Et(t,jt)),e.i=new Dt(t,e.h))}function kt(e,t,n){e.i.set(t,n)}function _t(e){return kt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function It(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Et(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,St),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function St(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}yt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Et(t,Tt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(Et(t,Tt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Et(n,"/"==n.charAt(0)?At:Ct,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",Et(n,Pt)),e.join("")};var Nt,Tt=/[#\/\?@]/g,Ct=/[#\?:]/g,At=/[#\?]/g,jt=/[#\?@]/g,Pt=/#/g;function Dt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Rt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Ot(e,t){Rt(e),t=Ft(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Mt(e,t){return Rt(e),t=Ft(e,t),e.g.has(t)}function Lt(e,t,n){Ot(e,t),0<n.length&&(e.i=null,e.g.set(Ft(e,t),_(n)),e.h+=n.length)}function Ft(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ut(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function Vt(){this.g=new Ee}function Bt(e,t,n){const r=n||"";try{mt(e,function(e,n){let i=e;a(e)&&(i=_e(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function zt(e){this.l=e.Ub||null,this.j=e.eb||!1}function qt(e,t){pe.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Kt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Ht(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Wt(e)}function Wt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Gt(e){let t="";return A(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Qt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Gt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):kt(e,t,n))}function Yt(e){pe.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Dt.prototype).add=function(e,t){Rt(this),this.i=null,e=Ft(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Rt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.na=function(){Rt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){Rt(this);let t=[];if("string"===typeof e)Mt(this,e)&&(t=t.concat(this.g.get(Ft(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Rt(this),this.i=null,Mt(this,e=Ft(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),a=this.V(r);for(r=0;r<a.length;r++){var i=s;""!==a[r]&&(i+="="+encodeURIComponent(String(a[r]))),e.push(i)}}return this.i=e.join("&")},k(zt,Se),zt.prototype.g=function(){return new qt(this.l,this.j)},zt.prototype.i=(Nt={},function(){return Nt}),k(qt,pe),(e=qt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Wt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ht(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Wt(this)),this.g&&(this.readyState=3,Wt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Kt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ht(this):Wt(this),3==this.readyState&&Kt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Ht(this))},e.Qa=function(e){this.g&&(this.response=e,Ht(this))},e.ga=function(){this.g&&Ht(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(qt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),k(Yt,pe);var Jt=/^https?$/i,Xt=["POST","PUT"];function $t(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Zt(e),tn(e)}function Zt(e){e.A||(e.A=!0,me(e,"complete"),me(e,"error"))}function en(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=rn(e)||2!=e.Z()))if(e.u&&4==rn(e))ye(e.Ea,0,e);else if(me(e,"readystatechange"),4==rn(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===r){var a=String(e.D).match(gt)[1]||null;!a&&i.self&&i.self.location&&(a=i.self.location.protocol.slice(0,-1)),s=!Jt.test(a?a.toLowerCase():"")}n=s}if(n)me(e,"complete"),me(e,"success");else{e.m=6;try{var o=2<rn(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Zt(e)}}finally{tn(e)}}}function tn(e,t){if(e.g){nn(e);const r=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||me(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function nn(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function rn(e){return e.g?e.g.readyState:0}function sn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(I){return null}}function an(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function on(e){this.Aa=0,this.i=[],this.j=new Be,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=an("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=an("baseRetryDelayMs",5e3,e),this.cb=an("retryDelaySeedMs",1e4,e),this.Wa=an("forwardChannelMaxRetries",2,e),this.wa=an("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new lt(e&&e.concurrentRequestLimit),this.Da=new Vt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function ln(e){if(un(e),3==e.G){var t=e.U++,n=vt(e.I);if(kt(n,"SID",e.K),kt(n,"RID",t),kt(n,"TYPE","terminate"),fn(e,n),(t=new Ge(e,e.j,t)).L=2,t.v=_t(vt(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=En(t.j,null),t.g.ea(t.v)),t.F=Date.now(),tt(t)}_n(e)}function cn(e){e.g&&(yn(e),e.g.cancel(),e.g=null)}function un(e){cn(e),e.u&&(i.clearTimeout(e.u),e.u=null),bn(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function dn(e){if(!ct(e.h)&&!e.s){e.s=!0;var t=e.Ga;U||z(),V||(U(),V=!0),B.add(t,e),e.B=0}}function hn(e,t){var n;n=t?t.l:e.U++;const r=vt(e.I);kt(r,"SID",e.K),kt(r,"RID",n),kt(r,"AID",e.T),fn(e,r),e.m&&e.o&&Qt(r,e.m,e.o),n=new Ge(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=pn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),ht(e.h,n),Xe(n,r,t)}function fn(e,t){e.H&&A(e.H,function(e,n){kt(t,n,e)}),e.l&&mt({},function(e,n){kt(t,n,e)})}function pn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let a=0;a<n;a++){let n=i[a].g;const o=i[a].map;if(n-=t,0>n)t=Math.max(0,i[a].g-100),s=!1;else try{Bt(o,e,"req"+n+"_")}catch(x){r&&r(o)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function mn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;U||z(),V||(U(),V=!0),B.add(t,e),e.v=0}}function gn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ve(c(e.Fa,e),xn(e,e.v)),e.v++,!0)}function yn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function vn(e){e.g=new Ge(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=vt(e.qa);kt(t,"RID","rpc"),kt(t,"SID",e.K),kt(t,"AID",e.T),kt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&kt(t,"TO",e.ja),kt(t,"TYPE","xmlhttp"),fn(e,t),e.m&&e.o&&Qt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=_t(vt(t)),n.m=null,n.P=!0,$e(n,e)}function bn(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function wn(e,t){var n=null;if(e.g==t){bn(e),yn(e),e.g=null;var r=2}else{if(!dt(e.h,t))return;n=t.D,ft(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;me(r=Re(),new Ue(r,n)),dn(e)}else mn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(ut(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ve(c(e.Ga,e,t),xn(e,e.B)),e.B++,!0))}(e,t)||2==r&&gn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:kn(e,5);break;case 4:kn(e,10);break;case 3:kn(e,6);break;default:kn(e,2)}}function xn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function kn(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new yt(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||bt(r,"https"),_t(r),t?function(e,t){const n=new Be;if(i.Image){const r=new Image;r.onload=u(Ut,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Ut,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Ut,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Ut,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Be;const n=new AbortController,r=setTimeout(()=>{n.abort(),Ut(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Ut(0,0,!0,t):Ut(0,0,!1,t)}).catch(()=>{clearTimeout(r),Ut(0,0,!1,t)})}(r.toString(),n)}else Fe(2);e.G=0,e.l&&e.l.sa(t),_n(e),un(e)}function _n(e){if(e.G=0,e.ka=[],e.l){const t=pt(e.h);0==t.length&&0==e.i.length||(E(e.ka,t),E(e.ka,e.i),e.h.i.length=0,_(e.i),e.i.length=0),e.l.ra()}}function In(e,t,n){var r=n instanceof yt?vt(n):new yt(n);if(""!=r.g)t&&(r.g=t+"."+r.g),wt(r,r.s);else{var s=i.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var a=new yt(null);r&&bt(a,r),t&&(a.g=t),s&&wt(a,s),n&&(a.l=n),r=a}return n=e.D,t=e.ya,n&&t&&kt(r,n,t),kt(r,"VER",e.la),fn(e,r),r}function En(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Yt(new zt({eb:n})):new Yt(e.pa)).Ha(e.J),t}function Sn(){}function Nn(){}function Tn(e,t){pe.call(this),this.g=new on(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!S(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!S(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new jn(this)}function Cn(e){Ae.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function An(){je.call(this),this.status=1}function jn(e){this.g=e}(e=Yt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():qe.g(),this.v=this.o?Ne(this.o):Ne(qe),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(a){return void $t(this,a)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Xt,t,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{nn(this),this.u=!0,this.g.send(e),this.u=!1}catch(a){$t(this,a)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,me(this,"complete"),me(this,"abort"),tn(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tn(this,!0)),Yt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?en(this):this.bb())},e.bb=function(){en(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<rn(this)?this.g.status:-1}catch(Nt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(Nt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Ie(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=on.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Fe(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=In(this,null,this.W),dn(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Ge(this,this.j,e);let s=this.o;if(this.S&&(s?(s=j(s),D(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=pn(this,i,t),kt(n=vt(this.I),"RID",e),kt(n,"CVER",22),this.D&&kt(n,"X-HTTP-Session-Id",this.D),fn(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Gt(s)))+"&"+t:this.m&&Qt(n,this.m,s)),ht(this.h,i),this.Ua&&kt(n,"TYPE","init"),this.P?(kt(n,"$req",t),kt(n,"SID","null"),i.T=!0,Xe(i,n,null)):Xe(i,n,t),this.G=2}}else 3==this.G&&(e?hn(this,e):0==this.i.length||ct(this.h)||hn(this))},e.Fa=function(){if(this.u=null,vn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ve(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Fe(10),cn(this),vn(this))},e.Za=function(){null!=this.C&&(this.C=null,cn(this),gn(this),Fe(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Fe(2)):(this.j.info("Failed to ping google.com"),Fe(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=Sn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},Nn.prototype.g=function(e,t){return new Tn(e,t)},k(Tn,pe),Tn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Tn.prototype.close=function(){ln(this.g)},Tn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=_e(e),e=n);t.i.push(new ot(t.Ya++,e)),3==t.G&&dn(t)},Tn.prototype.N=function(){this.g.l=null,delete this.j,ln(this.g),delete this.g,Tn.aa.N.call(this)},k(Cn,Ae),k(An,je),k(jn,Sn),jn.prototype.ua=function(){me(this.g,"a")},jn.prototype.ta=function(e){me(this.g,new Cn(e))},jn.prototype.sa=function(e){me(this.g,new An)},jn.prototype.ra=function(){me(this.g,"b")},Nn.prototype.createWebChannel=Nn.prototype.g,Tn.prototype.send=Tn.prototype.o,Tn.prototype.open=Tn.prototype.m,Tn.prototype.close=Tn.prototype.close,v=w.createWebChannelTransport=function(){return new Nn},y=w.getStatEventTarget=function(){return Re()},g=w.Event=Pe,m=w.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ke.NO_ERROR=0,Ke.TIMEOUT=8,Ke.HTTP_ERROR=6,p=w.ErrorCode=Ke,He.COMPLETE="complete",f=w.EventType=He,Te.EventType=Ce,Ce.OPEN="a",Ce.CLOSE="b",Ce.ERROR="c",Ce.MESSAGE="d",pe.prototype.listen=pe.prototype.K,h=w.WebChannel=Te,w.FetchXmlHttpFactory=zt,Yt.prototype.listenOnce=Yt.prototype.L,Yt.prototype.getLastError=Yt.prototype.Ka,Yt.prototype.getLastErrorCode=Yt.prototype.Ba,Yt.prototype.getStatus=Yt.prototype.Z,Yt.prototype.getResponseJson=Yt.prototype.Oa,Yt.prototype.getResponseText=Yt.prototype.oa,Yt.prototype.send=Yt.prototype.ea,Yt.prototype.setWithCredentials=Yt.prototype.Ha,d=w.XhrIo=Yt}).apply("undefined"!==typeof b?b:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const x="@firebase/firestore";class k{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}k.UNAUTHENTICATED=new k(null),k.GOOGLE_CREDENTIALS=new k("google-credentials-uid"),k.FIRST_PARTY=new k("first-party-uid"),k.MOCK_USER=new k("mock-user");let _="10.14.0";const I=new o.Vy("@firebase/firestore");function E(){return I.logLevel}function S(e){if(I.logLevel<=o.$b.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(C);I.debug("Firestore (".concat(_,"): ").concat(e),...i)}}function N(e){if(I.logLevel<=o.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(C);I.error("Firestore (".concat(_,"): ").concat(e),...i)}}function T(e){if(I.logLevel<=o.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(C);I.warn("Firestore (".concat(_,"): ").concat(e),...i)}}function C(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(_,") INTERNAL ASSERTION FAILED: ")+e;throw N(t),new Error(t)}function j(e,t){e||A()}function P(e,t){return e}const D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class R extends l.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class O{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class M{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class L{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(k.UNAUTHENTICATED))}shutdown(){}}class F{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class U{constructor(e){this.t=e,this.currentUser=k.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){j(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new O;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new O,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},a=e=>{S("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(S("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new O)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(S("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(j("string"==typeof t.accessToken),new M(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return j(null===e||"string"==typeof e),new k(e)}}class V{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=k.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class B{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new V(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(k.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class z{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class q{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){j(void 0===this.o);const n=e=>{null!=e.error&&S("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.R;return this.R=e.token,S("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{S("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):S("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(j("string"==typeof e.token),this.R=e.token,new z(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function K(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class H{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=K(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function W(e,t){return e<t?-1:e>t?1:0}function G(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}function Q(e){return e+"\0"}class Y{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new R(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new R(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new R(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new R(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Y.fromMillis(Date.now())}static fromDate(e){return Y.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Y(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?W(this.nanoseconds,e.nanoseconds):W(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class J{constructor(e){this.timestamp=e}static fromTimestamp(e){return new J(e)}static min(){return new J(new Y(0,0))}static max(){return new J(new Y(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class X{constructor(e,t,n){void 0===t?t=0:t>e.length&&A(),void 0===n?n=e.length-t:n>e.length-t&&A(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===X.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof X?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class $ extends X{construct(e,t,n){return new $(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new R(D.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter(e=>e.length>0))}return new $(e)}static emptyPath(){return new $([])}}const Z=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ee extends X{construct(e,t,n){return new ee(e,t,n)}static isValidIdentifier(e){return Z.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ee.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new ee(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new R(D.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new R(D.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new R(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new R(D.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ee(t)}static emptyPath(){return new ee([])}}class te{constructor(e){this.path=e}static fromPath(e){return new te($.fromString(e))}static fromName(e){return new te($.fromString(e).popFirst(5))}static empty(){return new te($.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===$.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return $.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new te(new $(e.slice()))}}class ne{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function re(e){return e.fields.find(e=>2===e.kind)}function ie(e){return e.fields.filter(e=>2!==e.kind)}ne.UNKNOWN_ID=-1;class se{constructor(e,t){this.fieldPath=e,this.kind=t}}class ae{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ae(0,ce.min())}}function oe(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=J.fromTimestamp(1e9===r?new Y(n+1,0):new Y(n,r));return new ce(i,te.empty(),t)}function le(e){return new ce(e.readTime,e.key,-1)}class ce{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new ce(J.min(),te.empty(),-1)}static max(){return new ce(J.max(),te.empty(),-1)}}function ue(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=te.comparator(e.documentKey,t.documentKey),0!==n?n:W(e.largestBatchId,t.largestBatchId))}const de="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class he{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function fe(e){if(e.code!==D.FAILED_PRECONDITION||e.message!==de)throw e;S("LocalStore","Unexpectedly lost primary lease")}class pe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&A(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new pe((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof pe?t:pe.resolve(t)}catch(e){return pe.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):pe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):pe.reject(t)}static resolve(e){return new pe((t,n)=>{t(e)})}static reject(e){return new pe((t,n)=>{n(e)})}static waitFor(e){return new pe((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=pe.resolve(!1);for(const n of e)t=t.next(e=>e?pe.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new pe((n,r)=>{const i=e.length,s=new Array(i);let a=0;for(let o=0;o<i;o++){const l=o;t(e[l]).next(e=>{s[l]=e,++a,a===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new pe((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}class me{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new O,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new be(e,t.error)):this.V.resolve()},this.transaction.onerror=t=>{const n=Ie(t.target.error);this.V.reject(new be(e,n))}}static open(e,t,n,r){try{return new me(t,e.transaction(r,n))}catch(e){throw new be(t,e)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(S("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new xe(t)}}class ge{constructor(e,t,n){this.name=e,this.version=t,this.p=n,12.2===ge.S((0,l.ZQ)())&&N("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return S("SimpleDb","Removing database:",e),ke(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,l.zW)())return!1;if(ge.v())return!0;const e=(0,l.ZQ)(),t=ge.S(e),n=0<t&&t<10,r=ye(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static v(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.C)}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(S("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new be(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new R(D.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new R(D.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new be(e,r))},r.onupgradeneeded=e=>{S("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.p.O(t,r.transaction,e.oldVersion,this.version).next(()=>{S("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=e=>this.N(e)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.M(e);const t=me.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next(e=>(t.g(),e)).catch(e=>(t.abort(e),pe.reject(e))).toPromise();return s.catch(()=>{}),await t.m,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(S("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function ye(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class ve{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ke(this.B.delete())}}class be extends R{constructor(e,t){super(D.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(t)),this.name="IndexedDbTransactionError"}}function we(e){return"IndexedDbTransactionError"===e.name}class xe{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(S("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(S("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),ke(n)}add(e){return S("SimpleDb","ADD",this.store.name,e,e),ke(this.store.add(e))}get(e){return ke(this.store.get(e)).next(t=>(void 0===t&&(t=null),S("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return S("SimpleDb","DELETE",this.store.name,e),ke(this.store.delete(e))}count(){return S("SimpleDb","COUNT",this.store.name),ke(this.store.count())}U(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new pe((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}{const e=this.cursor(n),t=[];return this.W(e,(e,n)=>{t.push(n)}).next(()=>t)}}G(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new pe((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}})}j(e,t){S("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.H=!1;const r=this.cursor(n);return this.W(r,(e,t,n)=>n.delete())}J(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.W(r,t)}Y(e){const t=this.cursor({});return new pe((n,r)=>{t.onerror=e=>{const t=Ie(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next(e=>{e?r.continue():n()}):n()}})}W(e,t){const n=[];return new pe((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new ve(i),a=t(i.primaryKey,i.value,s);if(a instanceof pe){const e=a.catch(e=>(s.done(),pe.reject(e)));n.push(e)}s.isDone?r():null===s.K?i.continue():i.continue(s.K)}}).next(()=>pe.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ke(e){return new pe((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Ie(e.target.error);n(t)}})}let _e=!1;function Ie(e){const t=ge.S((0,l.ZQ)());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new R("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(t,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return _e||(_e=!0,setTimeout(()=>{throw e},0)),e}}return e}class Ee{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}X(e){S("IndexBackfiller","Scheduled in ".concat(e,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{S("IndexBackfiller","Documents written: ".concat(await this.Z.ee()))}catch(e){we(e)?S("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",e):await fe(e)}await this.X(6e4)})}}class Se{constructor(e,t){this.localStore=e,this.persistence=t}async ee(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const n=new Set;let r=t,i=!0;return pe.doWhile(()=>!0===i&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!n.has(t))return S("IndexBackfiller","Processing collection: ".concat(t)),this.ne(e,t,r).next(e=>{r-=e,n.add(t)});i=!1})).next(()=>t-r)}ne(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this.re(r,n)).next(n=>(S("IndexBackfiller","Updating offset: ".concat(n)),this.localStore.indexManager.updateCollectionGroup(e,t,n))).next(()=>i.size)}))}re(e,t){let n=e;return t.changes.forEach((e,t)=>{const r=le(t);ue(r,n)>0&&(n=r)}),new ce(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Ne{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function Te(e){return null==e}function Ce(e){return 0===e&&1/e==-1/0}function Ae(e){return"number"==typeof e&&Number.isInteger(e)&&!Ce(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function je(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=De(t)),t=Pe(e.get(n),t);return De(t)}function Pe(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=t}}return n}function De(e){return e+"\x01\x01"}function Re(e){const t=e.length;if(j(t>=2),2===t)return j("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),$.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("\x01",s);switch((t<0||t>n)&&A(),e.charAt(t+1)){case"\x01":const n=e.substring(s,t);let a;0===i.length?a=n:(i+=n,a=i,i=""),r.push(a);break;case"\x10":i+=e.substring(s,t),i+="\0";break;case"\x11":i+=e.substring(s,t+1);break;default:A()}s=t+2}return new $(r)}Ne.oe=-1;const Oe=["userId","batchId"];function Me(e,t){return[e,je(t)]}function Le(e,t,n){return[e,je(t),n]}const Fe={},Ue=["prefixPath","collectionGroup","readTime","documentId"],Ve=["prefixPath","collectionGroup","documentId"],Be=["collectionGroup","readTime","prefixPath","documentId"],ze=["canonicalId","targetId"],qe=["targetId","path"],Ke=["path","targetId"],He=["collectionId","parent"],We=["indexId","uid"],Ge=["uid","sequenceNumber"],Qe=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Ye=["indexId","uid","orderedDocumentKey"],Je=["userId","collectionPath","documentId"],Xe=["userId","collectionPath","largestBatchId"],$e=["userId","collectionGroup","largestBatchId"],Ze=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],et=[...Ze,"documentOverlays"],tt=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],nt=tt,rt=[...nt,"indexConfiguration","indexState","indexEntries"],it=rt,st=[...rt,"globals"];class at extends he{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function ot(e,t){const n=P(e);return ge.F(n._e,t)}function lt(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ct(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ut(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class dt{constructor(e,t){this.comparator=e,this.root=t||ft.EMPTY}insert(e,t){return new dt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ft.BLACK,null,null))}remove(e){return new dt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ft.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ht(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ht(this.root,e,this.comparator,!1)}getReverseIterator(){return new ht(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ht(this.root,e,this.comparator,!0)}}class ht{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ft{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:ft.RED,this.left=null!=r?r:ft.EMPTY,this.right=null!=i?i:ft.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new ft(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ft.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return ft.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw A();if(this.right.isRed())throw A();const e=this.left.check();if(e!==this.right.check())throw A();return e+(this.isRed()?0:1)}}ft.EMPTY=null,ft.RED=!0,ft.BLACK=!1,ft.EMPTY=new class{constructor(){this.size=0}get key(){throw A()}get value(){throw A()}get color(){throw A()}get left(){throw A()}get right(){throw A()}copy(e,t,n,r,i){return this}insert(e,t,n){return new ft(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class pt{constructor(e){this.comparator=e,this.data=new dt(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new mt(this.data.getIterator())}getIteratorFrom(e){return new mt(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof pt))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new pt(this.comparator);return t.data=e,t}}class mt{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function gt(e){return e.hasNext()?e.getNext():void 0}class yt{constructor(e){this.fields=e,e.sort(ee.comparator)}static empty(){return new yt([])}unionWith(e){let t=new pt(ee.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new yt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return G(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class vt extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class bt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new vt("Invalid base64 string: "+e):e}}(e);return new bt(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new bt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return W(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}bt.EMPTY_BYTE_STRING=new bt("");const wt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xt(e){if(j(!!e),"string"==typeof e){let t=0;const n=wt.exec(e);if(j(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:kt(e.seconds),nanos:kt(e.nanos)}}function kt(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function _t(e){return"string"==typeof e?bt.fromBase64String(e):bt.fromUint8Array(e)}function It(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Et(e){const t=e.mapValue.fields.__previous_value__;return It(t)?Et(t):t}function St(e){const t=xt(e.mapValue.fields.__local_write_time__.timestampValue);return new Y(t.seconds,t.nanos)}class Nt{constructor(e,t,n,r,i,s,a,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l}}class Tt{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Tt("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Tt&&e.projectId===this.projectId&&e.database===this.database}}const Ct={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},At={nullValue:"NULL_VALUE"};function jt(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?It(e)?4:Gt(e)?9007199254740991:Ht(e)?10:11:A()}function Pt(e,t){if(e===t)return!0;const n=jt(e);if(n!==jt(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return St(e).isEqual(St(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=xt(e.timestampValue),r=xt(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return _t(e.bytesValue).isEqual(_t(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return kt(e.geoPointValue.latitude)===kt(t.geoPointValue.latitude)&&kt(e.geoPointValue.longitude)===kt(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return kt(e.integerValue)===kt(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=kt(e.doubleValue),r=kt(t.doubleValue);return n===r?Ce(n)===Ce(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return G(e.arrayValue.values||[],t.arrayValue.values||[],Pt);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(lt(n)!==lt(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Pt(n[i],r[i])))return!1;return!0}(e,t);default:return A()}}function Dt(e,t){return void 0!==(e.values||[]).find(e=>Pt(e,t))}function Rt(e,t){if(e===t)return 0;const n=jt(e),r=jt(t);if(n!==r)return W(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return W(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=kt(e.integerValue||e.doubleValue),r=kt(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Ot(e.timestampValue,t.timestampValue);case 4:return Ot(St(e),St(t));case 5:return W(e.stringValue,t.stringValue);case 6:return function(e,t){const n=_t(e),r=_t(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=W(n[i],r[i]);if(0!==e)return e}return W(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=W(kt(e.latitude),kt(t.latitude));return 0!==n?n:W(kt(e.longitude),kt(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Mt(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const a=e.fields||{},o=t.fields||{},l=null===(n=a.value)||void 0===n?void 0:n.arrayValue,c=null===(r=o.value)||void 0===r?void 0:r.arrayValue,u=W((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(s=null==c?void 0:c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:Mt(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Ct.mapValue&&t===Ct.mapValue)return 0;if(e===Ct.mapValue)return 1;if(t===Ct.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let a=0;a<r.length&&a<s.length;++a){const e=W(r[a],s[a]);if(0!==e)return e;const t=Rt(n[r[a]],i[s[a]]);if(0!==t)return t}return W(r.length,s.length)}(e.mapValue,t.mapValue);default:throw A()}}function Ot(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return W(e,t);const n=xt(e),r=xt(t),i=W(n.seconds,r.seconds);return 0!==i?i:W(n.nanos,r.nanos)}function Mt(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=Rt(n[i],r[i]);if(e)return e}return W(n.length,r.length)}function Lt(e){return Ft(e)}function Ft(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=xt(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return _t(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return te.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Ft(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(Ft(e.fields[i]));return n+"}"}(e.mapValue):A()}function Ut(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Vt(e){return!!e&&"integerValue"in e}function Bt(e){return!!e&&"arrayValue"in e}function zt(e){return!!e&&"nullValue"in e}function qt(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Kt(e){return!!e&&"mapValue"in e}function Ht(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Wt(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return ct(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Wt(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Wt(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Gt(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}const Qt={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function Yt(e){return"nullValue"in e?At:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Ut(Tt.empty(),te.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?Ht(e)?Qt:{mapValue:{}}:A()}function Jt(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Ut(Tt.empty(),te.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?Qt:"mapValue"in e?Ht(e)?{mapValue:{}}:Ct:A()}function Xt(e,t){const n=Rt(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function $t(e,t){const n=Rt(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class Zt{constructor(e){this.value=e}static empty(){return new Zt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Kt(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Wt(t)}setAll(e){let t=ee.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Wt(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Kt(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Pt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Kt(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){ct(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Zt(Wt(this.value))}}function en(e){const t=[];return ct(e.fields,(e,n)=>{const r=new ee([e]);if(Kt(n)){const e=en(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new yt(t)}class tn{constructor(e,t,n,r,i,s,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new tn(e,0,J.min(),J.min(),J.min(),Zt.empty(),0)}static newFoundDocument(e,t,n,r){return new tn(e,1,t,J.min(),n,r,0)}static newNoDocument(e,t){return new tn(e,2,t,J.min(),J.min(),Zt.empty(),0)}static newUnknownDocument(e,t){return new tn(e,3,t,J.min(),J.min(),Zt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(J.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Zt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Zt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=J.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class nn{constructor(e,t){this.position=e,this.inclusive=t}}function rn(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],a=e.position[i];if(r=s.field.isKeyField()?te.comparator(te.fromName(a.referenceValue),n.key):Rt(a,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function sn(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Pt(e.position[n],t.position[n]))return!1;return!0}class an{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function on(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class ln{}class cn extends ln{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new bn(e,t,n):"array-contains"===t?new _n(e,n):"in"===t?new In(e,n):"not-in"===t?new En(e,n):"array-contains-any"===t?new Sn(e,n):new cn(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new wn(e,n):new xn(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Rt(t,this.value)):null!==t&&jt(this.value)===jt(t)&&this.matchesComparison(Rt(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return A()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class un extends ln{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new un(e,t)}matches(e){return dn(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function dn(e){return"and"===e.op}function hn(e){return"or"===e.op}function fn(e){return pn(e)&&dn(e)}function pn(e){for(const t of e.filters)if(t instanceof un)return!1;return!0}function mn(e){if(e instanceof cn)return e.field.canonicalString()+e.op.toString()+Lt(e.value);if(fn(e))return e.filters.map(e=>mn(e)).join(",");{const t=e.filters.map(e=>mn(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function gn(e,t){return e instanceof cn?function(e,t){return t instanceof cn&&e.op===t.op&&e.field.isEqual(t.field)&&Pt(e.value,t.value)}(e,t):e instanceof un?function(e,t){return t instanceof un&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&gn(n,t.filters[r]),!0)}(e,t):void A()}function yn(e,t){const n=e.filters.concat(t);return un.create(n,e.op)}function vn(e){return e instanceof cn?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Lt(e.value))}(e):e instanceof un?function(e){return e.op.toString()+" {"+e.getFilters().map(vn).join(" ,")+"}"}(e):"Filter"}class bn extends cn{constructor(e,t,n){super(e,t,n),this.key=te.fromName(n.referenceValue)}matches(e){const t=te.comparator(e.key,this.key);return this.matchesComparison(t)}}class wn extends cn{constructor(e,t){super(e,"in",t),this.keys=kn("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class xn extends cn{constructor(e,t){super(e,"not-in",t),this.keys=kn("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function kn(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>te.fromName(e.referenceValue))}class _n extends cn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Bt(t)&&Dt(t.arrayValue,this.value)}}class In extends cn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Dt(this.value.arrayValue,t)}}class En extends cn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Dt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Dt(this.value.arrayValue,t)}}class Sn extends cn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Bt(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Dt(this.value.arrayValue,e))}}class Nn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=a,this.ue=null}}function Tn(e){return new Nn(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Cn(e){const t=P(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>mn(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Te(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Lt(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Lt(e)).join(",")),t.ue=e}return t.ue}function An(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!on(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!gn(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!sn(e.startAt,t.startAt)&&sn(e.endAt,t.endAt)}function jn(e){return te.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Pn(e,t){return e.filters.filter(e=>e instanceof cn&&e.field.isEqual(t))}function Dn(e,t,n){let r=At,i=!0;for(const s of Pn(e,t)){let e=At,t=!0;switch(s.op){case"<":case"<=":e=Yt(s.value);break;case"==":case"in":case">=":e=s.value;break;case">":e=s.value,t=!1;break;case"!=":case"not-in":e=At}Xt({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];Xt({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function Rn(e,t,n){let r=Ct,i=!0;for(const s of Pn(e,t)){let e=Ct,t=!0;switch(s.op){case">=":case">":e=Jt(s.value),t=!1;break;case"==":case"in":case"<=":e=s.value;break;case"<":e=s.value,t=!1;break;case"!=":case"not-in":e=Ct}$t({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];$t({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class On{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Mn(e,t,n,r,i,s,a,o){return new On(e,t,n,r,i,s,a,o)}function Ln(e){return new On(e)}function Fn(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Un(e){return null!==e.collectionGroup}function Vn(e){const t=P(e);if(null===t.ce){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new pt(ee.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new an(r,n))}),e.has(ee.keyField().canonicalString())||t.ce.push(new an(ee.keyField(),n))}return t.ce}function Bn(e){const t=P(e);return t.le||(t.le=zn(t,Vn(e))),t.le}function zn(e,t){if("F"===e.limitType)return Tn(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new an(e.field,t)});const n=e.endAt?new nn(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new nn(e.startAt.position,e.startAt.inclusive):null;return Tn(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function qn(e,t){const n=e.filters.concat([t]);return new On(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Kn(e,t,n){return new On(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Hn(e,t){return An(Bn(e),Bn(t))&&e.limitType===t.limitType}function Wn(e){return"".concat(Cn(Bn(e)),"|lt:").concat(e.limitType)}function Gn(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>vn(e)).join(", "),"]")),Te(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Lt(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Lt(e)).join(",")),"Target(".concat(t,")")}(Bn(e)),"; limitType=").concat(e.limitType,")")}function Qn(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):te.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Vn(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=rn(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Vn(e),t))&&!(e.endAt&&!function(e,t,n){const r=rn(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Vn(e),t))}(e,t)}function Yn(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Jn(e){return(t,n)=>{let r=!1;for(const i of Vn(e)){const e=Xn(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Xn(e,t,n){const r=e.field.isKeyField()?te.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Rt(r,i):A()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return A()}}class $n{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ct(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return ut(this.inner)}size(){return this.innerSize}}const Zn=new dt(te.comparator);function er(){return Zn}const tr=new dt(te.comparator);function nr(){let e=tr;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function rr(e){let t=tr;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function ir(){return ar()}function sr(){return ar()}function ar(){return new $n(e=>e.toString(),(e,t)=>e.isEqual(t))}const or=new dt(te.comparator),lr=new pt(te.comparator);function cr(){let e=lr;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const ur=new pt(W);function dr(){return ur}function hr(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ce(t)?"-0":t}}function fr(e){return{integerValue:""+e}}function pr(e,t){return Ae(t)?fr(t):hr(e,t)}class mr{constructor(){this._=void 0}}function gr(e,t,n){return e instanceof br?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&It(t)&&(t=Et(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof wr?xr(e,t):e instanceof kr?_r(e,t):function(e,t){const n=vr(e,t),r=Er(n)+Er(e.Pe);return Vt(n)&&Vt(e.Pe)?fr(r):hr(e.serializer,r)}(e,t)}function yr(e,t,n){return e instanceof wr?xr(e,t):e instanceof kr?_r(e,t):n}function vr(e,t){return e instanceof Ir?function(e){return Vt(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class br extends mr{}class wr extends mr{constructor(e){super(),this.elements=e}}function xr(e,t){const n=Sr(t);for(const r of e.elements)n.some(e=>Pt(e,r))||n.push(r);return{arrayValue:{values:n}}}class kr extends mr{constructor(e){super(),this.elements=e}}function _r(e,t){let n=Sr(t);for(const r of e.elements)n=n.filter(e=>!Pt(e,r));return{arrayValue:{values:n}}}class Ir extends mr{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Er(e){return kt(e.integerValue||e.doubleValue)}function Sr(e){return Bt(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Nr{constructor(e,t){this.field=e,this.transform=t}}class Tr{constructor(e,t){this.version=e,this.transformResults=t}}class Cr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Cr}static exists(e){return new Cr(void 0,e)}static updateTime(e){return new Cr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ar(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class jr{}function Pr(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new zr(e.key,Cr.none()):new Lr(e.key,e.data,Cr.none());{const n=e.data,r=Zt.empty();let i=new pt(ee.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Fr(e.key,r,new yt(i.toArray()),Cr.none())}}function Dr(e,t,n){e instanceof Lr?function(e,t,n){const r=e.value.clone(),i=Vr(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Fr?function(e,t,n){if(!Ar(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Vr(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Ur(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Rr(e,t,n,r){return e instanceof Lr?function(e,t,n,r){if(!Ar(e.precondition,t))return n;const i=e.value.clone(),s=Br(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Fr?function(e,t,n,r){if(!Ar(e.precondition,t))return n;const i=Br(e.fieldTransforms,r,t),s=t.data;return s.setAll(Ur(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return Ar(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Or(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=vr(r.transform,e||null);null!=i&&(null===n&&(n=Zt.empty()),n.set(r.field,i))}return n||null}function Mr(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&G(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof wr&&t instanceof wr||e instanceof kr&&t instanceof kr?G(e.elements,t.elements,Pt):e instanceof Ir&&t instanceof Ir?Pt(e.Pe,t.Pe):e instanceof br&&t instanceof br}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Lr extends jr{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Fr extends jr{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ur(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Vr(e,t,n){const r=new Map;j(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],a=s.transform,o=t.data.field(s.field);r.set(s.field,yr(a,o,n[i]))}return r}function Br(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,gr(e,s,t))}return r}class zr extends jr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class qr extends jr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Kr{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Dr(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Rr(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Rr(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=sr();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let a=this.applyToLocalView(s,i.mutatedFields);a=t.has(r.key)?null:a;const o=Pr(s,a);null!==o&&n.set(r.key,o),s.isValidDocument()||s.convertToNoDocument(J.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),cr())}isEqual(e){return this.batchId===e.batchId&&G(this.mutations,e.mutations,(e,t)=>Mr(e,t))&&G(this.baseMutations,e.baseMutations,(e,t)=>Mr(e,t))}}class Hr{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){j(e.mutations.length===n.length);let r=or;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new Hr(e,t,n,r)}}class Wr{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Gr{constructor(e,t){this.count=e,this.unchangedNames=t}}var Qr,Yr;function Jr(e){switch(e){default:return A();case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0}}function Xr(e){if(void 0===e)return N("GRPC error has no .code"),D.UNKNOWN;switch(e){case Qr.OK:return D.OK;case Qr.CANCELLED:return D.CANCELLED;case Qr.UNKNOWN:return D.UNKNOWN;case Qr.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case Qr.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case Qr.INTERNAL:return D.INTERNAL;case Qr.UNAVAILABLE:return D.UNAVAILABLE;case Qr.UNAUTHENTICATED:return D.UNAUTHENTICATED;case Qr.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case Qr.NOT_FOUND:return D.NOT_FOUND;case Qr.ALREADY_EXISTS:return D.ALREADY_EXISTS;case Qr.PERMISSION_DENIED:return D.PERMISSION_DENIED;case Qr.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case Qr.ABORTED:return D.ABORTED;case Qr.OUT_OF_RANGE:return D.OUT_OF_RANGE;case Qr.UNIMPLEMENTED:return D.UNIMPLEMENTED;case Qr.DATA_LOSS:return D.DATA_LOSS;default:return A()}}(Yr=Qr||(Qr={}))[Yr.OK=0]="OK",Yr[Yr.CANCELLED=1]="CANCELLED",Yr[Yr.UNKNOWN=2]="UNKNOWN",Yr[Yr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Yr[Yr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Yr[Yr.NOT_FOUND=5]="NOT_FOUND",Yr[Yr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Yr[Yr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Yr[Yr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Yr[Yr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Yr[Yr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Yr[Yr.ABORTED=10]="ABORTED",Yr[Yr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Yr[Yr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Yr[Yr.INTERNAL=13]="INTERNAL",Yr[Yr.UNAVAILABLE=14]="UNAVAILABLE",Yr[Yr.DATA_LOSS=15]="DATA_LOSS";let $r=null;function Zr(){return new TextEncoder}const ei=new r([4294967295,4294967295],0);function ti(e){const t=Zr().encode(e),n=new i;return n.update(t),new Uint8Array(n.digest())}function ni(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),s=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new r([n,i],0),new r([s,a],0)]}class ri{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new ii("Invalid padding: ".concat(t));if(n<0)throw new ii("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new ii("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new ii("Invalid padding when bitmap length is 0: ".concat(t));this.Ie=8*e.length-t,this.Te=r.fromNumber(this.Ie)}Ee(e,t,n){let i=e.add(t.multiply(r.fromNumber(n)));return 1===i.compare(ei)&&(i=new r([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=ti(e),[n,r]=ni(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);if(!this.de(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new ri(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.Ie)return;const t=ti(e),[n,r]=ni(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class ii extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class si{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ai.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new si(J.min(),r,new dt(W),er(),cr())}}class ai{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ai(n,t,cr(),cr(),cr())}}class oi{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class li{constructor(e,t){this.targetId=e,this.me=t}}class ci{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bt.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class ui{constructor(){this.fe=0,this.ge=fi(),this.pe=bt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=cr(),t=cr(),n=cr();return this.ge.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:A()}}),new ai(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=fi()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,j(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class di{constructor(e){this.Le=e,this.Be=new Map,this.ke=er(),this.qe=hi(),this.Qe=new dt(W)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:A()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((e,n)=>{this.ze(n)&&t(n)})}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const i=r.target;if(jn(i))if(0===n){const e=new te(i.path);this.Ue(t,e,tn.newNoDocument(e,J.min()))}else j(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),i=n?this.Xe(n,e,r):1;if(0!==i){this.je(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==$r||$r.et(function(e,t,n,r,i){var s,a,o,l,c,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===i,hashCount:null!==(s=null==h?void 0:h.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(o=null===(a=null==h?void 0:h.bits)||void 0===a?void 0:a.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.me,this.Le.tt(),n,i))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,a;try{s=_t(n).toUint8Array()}catch(e){if(e instanceof vt)return T("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{a=new ri(s,r,i)}catch(e){return T(e instanceof ii?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===a.Ie?null:a}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.Le.tt(),s="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(s)||(this.Ue(t,n,null),r++)}),r}rt(e){const t=new Map;this.Be.forEach((n,r)=>{const i=this.Je(r);if(i){if(n.current&&jn(i.target)){const t=new te(i.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,tn.newNoDocument(t,e))}n.be&&(t.set(r,n.ve()),n.Ce())}});let n=cr();this.qe.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.ke.forEach((t,n)=>n.setReadTime(e));const r=new si(e,t,this.Qe,this.ke,n);return this.ke=er(),this.qe=hi(),this.Qe=new dt(W),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new ui,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new pt(W),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||S("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ui),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function hi(){return new dt(te.comparator)}function fi(){return new dt(te.comparator)}const pi={asc:"ASCENDING",desc:"DESCENDING"},mi={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gi={and:"AND",or:"OR"};class yi{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function vi(e,t){return e.useProto3Json||Te(t)?t:{value:t}}function bi(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function wi(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function xi(e,t){return bi(e,t.toTimestamp())}function ki(e){return j(!!e),J.fromTimestamp(function(e){const t=xt(e);return new Y(t.seconds,t.nanos)}(e))}function _i(e,t){return Ii(e,t).canonicalString()}function Ii(e,t){const n=function(e){return new $(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Ei(e){const t=$.fromString(e);return j(Gi(t)),t}function Si(e,t){return _i(e.databaseId,t.path)}function Ni(e,t){const n=Ei(t);if(n.get(1)!==e.databaseId.projectId)throw new R(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new R(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new te(ji(n))}function Ti(e,t){return _i(e.databaseId,t)}function Ci(e){const t=Ei(e);return 4===t.length?$.emptyPath():ji(t)}function Ai(e){return new $(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function ji(e){return j(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Pi(e,t,n){return{name:Si(e,t),fields:n.value.mapValue.fields}}function Di(e,t,n){const r=Ni(e,t.name),i=ki(t.updateTime),s=t.createTime?ki(t.createTime):J.min(),a=new Zt({mapValue:{fields:t.fields}}),o=tn.newFoundDocument(r,i,s,a);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function Ri(e,t){let n;if(t instanceof Lr)n={update:Pi(e,t.key,t.value)};else if(t instanceof zr)n={delete:Si(e,t.key)};else if(t instanceof Fr)n={update:Pi(e,t.key,t.data),updateMask:Wi(t.fieldMask)};else{if(!(t instanceof qr))return A();n={verify:Si(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof br)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof wr)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof kr)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ir)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw A()}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:xi(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:A()}(e,t.precondition)),n}function Oi(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?Cr.updateTime(ki(e.updateTime)):void 0!==e.exists?Cr.exists(e.exists):Cr.none()}(t.currentDocument):Cr.none(),r=t.updateTransforms?t.updateTransforms.map(t=>function(e,t){let n=null;if("setToServerValue"in t)j("REQUEST_TIME"===t.setToServerValue),n=new br;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new wr(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new kr(e)}else"increment"in t?n=new Ir(e,t.increment):A();const r=ee.fromServerFormat(t.fieldPath);return new Nr(r,n)}(e,t)):[];if(t.update){t.update.name;const i=Ni(e,t.update.name),s=new Zt({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new yt(t.map(e=>ee.fromServerFormat(e)))}(t.updateMask);return new Fr(i,s,e,n,r)}return new Lr(i,s,n,r)}if(t.delete){const r=Ni(e,t.delete);return new zr(r,n)}if(t.verify){const r=Ni(e,t.verify);return new qr(r,n)}return A()}function Mi(e,t){return{documents:[Ti(e,t.path)]}}function Li(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Ti(e,i);const s=function(e){if(0!==e.length)return Hi(un.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const a=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:qi(e.field),direction:Vi(e.dir)}}(e))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const o=vi(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:i}}function Fi(e){let t=Ci(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){j(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Ui(e);return t instanceof un&&fn(t)?t.getFilters():[t]}(n.where));let a=[];n.orderBy&&(a=function(e){return e.map(e=>function(e){return new an(Ki(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,Te(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new nn(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new nn(n,t)}(n.endAt)),Mn(t,i,a,s,o,"F",l,c)}function Ui(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Ki(e.unaryFilter.field);return cn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Ki(e.unaryFilter.field);return cn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ki(e.unaryFilter.field);return cn.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ki(e.unaryFilter.field);return cn.create(i,"!=",{nullValue:"NULL_VALUE"});default:return A()}}(e):void 0!==e.fieldFilter?function(e){return cn.create(Ki(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return A()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return un.create(e.compositeFilter.filters.map(e=>Ui(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return A()}}(e.compositeFilter.op))}(e):A()}function Vi(e){return pi[e]}function Bi(e){return mi[e]}function zi(e){return gi[e]}function qi(e){return{fieldPath:e.canonicalString()}}function Ki(e){return ee.fromServerFormat(e.fieldPath)}function Hi(e){return e instanceof cn?function(e){if("=="===e.op){if(qt(e.value))return{unaryFilter:{field:qi(e.field),op:"IS_NAN"}};if(zt(e.value))return{unaryFilter:{field:qi(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(qt(e.value))return{unaryFilter:{field:qi(e.field),op:"IS_NOT_NAN"}};if(zt(e.value))return{unaryFilter:{field:qi(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qi(e.field),op:Bi(e.op),value:e.value}}}(e):e instanceof un?function(e){const t=e.getFilters().map(e=>Hi(e));return 1===t.length?t[0]:{compositeFilter:{op:zi(e.op),filters:t}}}(e):A()}function Wi(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Gi(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Qi{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:J.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:J.min(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:bt.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new Qi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Yi{constructor(e){this.ct=e}}function Ji(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Xi(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:Si(e,t.key),fields:t.data.value.mapValue.fields,updateTime:bi(e,t.version.toTimestamp()),createTime:bi(e,t.createTime.toTimestamp())}}(e.ct,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:$i(t.version)};else{if(!t.isUnknownDocument())return A();r.unknownDocument={path:n.path.toArray(),version:$i(t.version)}}return r}function Xi(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function $i(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Zi(e){const t=new Y(e.seconds,e.nanoseconds);return J.fromTimestamp(t)}function es(e,t){const n=(t.baseMutations||[]).map(t=>Oi(e.ct,t));for(let s=0;s<t.mutations.length-1;++s){const e=t.mutations[s];if(s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform){const n=t.mutations[s+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const r=t.mutations.map(t=>Oi(e.ct,t)),i=Y.fromMillis(t.localWriteTimeMs);return new Kr(t.batchId,i,n,r)}function ts(e){const t=Zi(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Zi(e.lastLimboFreeSnapshotVersion):J.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return j(1===e.documents.length),Bn(Ln(Ci(e.documents[0])))}(e.query):function(e){return Bn(Fi(e))}(e.query),new Qi(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,bt.fromBase64String(e.resumeToken))}function ns(e,t){const n=$i(t.snapshotVersion),r=$i(t.lastLimboFreeSnapshotVersion);let i;i=jn(t.target)?Mi(e.ct,t.target):Li(e.ct,t.target)._t;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Cn(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function rs(e){const t=Fi({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Kn(t,t.limit,"L"):t}function is(e,t){return new Wr(t.largestBatchId,Oi(e.ct,t.overlayMutation))}function ss(e,t){const n=t.path.lastSegment();return[e,je(t.path.popLast()),n]}function as(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:$i(r.readTime),documentKey:je(r.documentKey.path),largestBatchId:r.largestBatchId}}class os{getBundleMetadata(e,t){return ls(e).get(t).next(e=>{if(e)return function(e){return{id:e.bundleId,createTime:Zi(e.createTime),version:e.version}}(e)})}saveBundleMetadata(e,t){return ls(e).put(function(e){return{bundleId:e.id,createTime:$i(ki(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return cs(e).get(t).next(e=>{if(e)return function(e){return{name:e.name,query:rs(e.bundledQuery),readTime:Zi(e.readTime)}}(e)})}saveNamedQuery(e,t){return cs(e).put(function(e){return{name:e.name,readTime:$i(ki(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function ls(e){return ot(e,"bundles")}function cs(e){return ot(e,"namedQueries")}class us{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const n=t.uid||"";return new us(e,n)}getOverlay(e,t){return ds(e).get(ss(this.userId,t)).next(e=>e?is(this.serializer,e):null)}getOverlays(e,t){const n=ir();return pe.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){const r=[];return n.forEach((n,i)=>{const s=new Wr(t,i);r.push(this.ht(e,s))}),pe.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach(e=>r.add(je(e.getCollectionPath())));const i=[];return r.forEach(t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(ds(e).j("collectionPathOverlayIndex",r))}),pe.waitFor(i)}getOverlaysForCollection(e,t,n){const r=ir(),i=je(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return ds(e).U("collectionPathOverlayIndex",s).next(e=>{for(const t of e){const e=is(this.serializer,t);r.set(e.getKey(),e)}return r})}getOverlaysForCollectionGroup(e,t,n,r){const i=ir();let s;const a=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ds(e).J({index:"collectionGroupOverlayIndex",range:a},(e,t,n)=>{const a=is(this.serializer,t);i.size()<r||a.largestBatchId===s?(i.set(a.getKey(),a),s=a.largestBatchId):n.done()}).next(()=>i)}ht(e,t){return ds(e).put(function(e,t,n){const[r,i,s]=ss(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Ri(e.ct,n.mutation)}}(this.serializer,this.userId,t))}}function ds(e){return ot(e,"documentOverlays")}class hs{Pt(e){return ot(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(e=>{const t=null==e?void 0:e.value;return t?bt.fromUint8Array(t):bt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class fs{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(kt(e.integerValue));else if("doubleValue"in e){const n=kt(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),Ce(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=xt(n)),t.Rt("".concat(n.seconds||"")),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(_t(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?Gt(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Ht(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):A()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const r of Object.keys(n))this.Vt(r,t),this.Tt(n[r],t)}wt(e,t){var n,r;const i=e.fields||{};this.dt(t,53);const s="value",a=(null===(r=null===(n=i[s].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.dt(t,15),t.At(kt(a)),this.Vt(s,t),this.Tt(i[s],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const r of n)this.Tt(r,t)}yt(e,t){this.dt(t,37),te.fromName(e).path.forEach(e=>{this.dt(t,60),this.Dt(e,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}function ps(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function ms(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=ps(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}fs.vt=new fs;class gs{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ft(n.value),n=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ot(n.value),n=t.next();this.Nt()}Lt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ft(e);else if(e<2048)this.Ft(960|e>>>6),this.Ft(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|e>>>12),this.Ft(128|63&e>>>6),this.Ft(128|63&e);else{const e=t.codePointAt(0);this.Ft(240|e>>>18),this.Ft(128|63&e>>>12),this.Ft(128|63&e>>>6),this.Ft(128|63&e)}}this.Mt()}Bt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ot(e);else if(e<2048)this.Ot(960|e>>>6),this.Ot(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ot(480|e>>>12),this.Ot(128|63&e>>>6),this.Ot(128|63&e);else{const e=t.codePointAt(0);this.Ot(240|e>>>18),this.Ot(128|63&e>>>12),this.Ot(128|63&e>>>6),this.Ot(128|63&e)}}this.Nt()}kt(e){const t=this.qt(e),n=ms(t);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Kt(e){const t=this.qt(e),n=ms(t);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Ft(e){const t=255&e;0===t?(this.Ut(0),this.Ut(255)):255===t?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;0===t?(this.Gt(0),this.Gt(255)):255===t?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class ys{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class vs{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class bs{constructor(){this.jt=new gs,this.Ht=new ys(this.jt),this.Jt=new vs(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return 0===e?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}class ws{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Zt(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new ws(this.indexId,this.documentKey,this.arrayValue,n)}}function xs(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=ks(e.arrayValue,t.arrayValue),0!==n?n:(n=ks(e.directionalValue,t.directionalValue),0!==n?n:te.comparator(e.documentKey,t.documentKey)))}function ks(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class _s{constructor(e){this.Xt=new pt((e,t)=>ee.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const e=t;e.isInequality()?this.Xt=this.Xt.add(e):this.tn.push(e)}}get nn(){return this.Xt.size>1}rn(e){if(j(e.collectionGroup===this.collectionId),this.nn)return!1;const t=re(e);if(void 0!==t&&!this.sn(t))return!1;const n=ie(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.sn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.Xt.size>0){const e=this.Xt.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.on(e,t)||!this._n(this.en[s++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(s>=this.en.length||!this._n(this.en[s++],e))return!1}return!0}an(){if(this.nn)return null;let e=new pt(ee.comparator);const t=[];for(const n of this.tn)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new se(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new se(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new se(n.field,"asc"===n.dir?0:1)));return new ne(ne.UNKNOWN_ID,this.collectionId,t,ae.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Is(e){var t,n;if(j(e instanceof cn||e instanceof un),e instanceof cn){if(e instanceof In){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map(t=>cn.create(e.field,"==",t)))||[];return un.create(r,"or")}return e}const r=e.filters.map(e=>Is(e));return un.create(r,e.op)}function Es(e){if(0===e.getFilters().length)return[];const t=Cs(Is(e));return j(Ts(t)),Ss(t)||Ns(t)?[t]:t.getFilters()}function Ss(e){return e instanceof cn}function Ns(e){return e instanceof un&&fn(e)}function Ts(e){return Ss(e)||Ns(e)||function(e){if(e instanceof un&&hn(e)){for(const t of e.getFilters())if(!Ss(t)&&!Ns(t))return!1;return!0}return!1}(e)}function Cs(e){if(j(e instanceof cn||e instanceof un),e instanceof cn)return e;if(1===e.filters.length)return Cs(e.filters[0]);const t=e.filters.map(e=>Cs(e));let n=un.create(t,e.op);return n=Ps(n),Ts(n)?n:(j(n instanceof un),j(dn(n)),j(n.filters.length>1),n.filters.reduce((e,t)=>As(e,t)))}function As(e,t){let n;return j(e instanceof cn||e instanceof un),j(t instanceof cn||t instanceof un),n=e instanceof cn?t instanceof cn?function(e,t){return un.create([e,t],"and")}(e,t):js(e,t):t instanceof cn?js(t,e):function(e,t){if(j(e.filters.length>0&&t.filters.length>0),dn(e)&&dn(t))return yn(e,t.getFilters());const n=hn(e)?e:t,r=hn(e)?t:e,i=n.filters.map(e=>As(e,r));return un.create(i,"or")}(e,t),Ps(n)}function js(e,t){if(dn(t))return yn(t,e.getFilters());{const n=t.filters.map(t=>As(e,t));return un.create(n,"or")}}function Ps(e){if(j(e instanceof cn||e instanceof un),e instanceof cn)return e;const t=e.getFilters();if(1===t.length)return Ps(t[0]);if(pn(e))return e;const n=t.map(e=>Ps(e)),r=[];return n.forEach(t=>{t instanceof cn?r.push(t):t instanceof un&&(t.op===e.op?r.push(...t.filters):r.push(t))}),1===r.length?r[0]:un.create(r,e.op)}class Ds{constructor(){this.un=new Rs}addToCollectionParentIndex(e,t){return this.un.add(t),pe.resolve()}getCollectionParents(e,t){return pe.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return pe.resolve()}deleteFieldIndex(e,t){return pe.resolve()}deleteAllFieldIndexes(e){return pe.resolve()}createTargetIndexes(e,t){return pe.resolve()}getDocumentsMatchingTarget(e,t){return pe.resolve(null)}getIndexType(e,t){return pe.resolve(0)}getFieldIndexes(e,t){return pe.resolve([])}getNextCollectionGroupToUpdate(e){return pe.resolve(null)}getMinOffset(e,t){return pe.resolve(ce.min())}getMinOffsetFromCollectionGroup(e,t){return pe.resolve(ce.min())}updateCollectionGroup(e,t,n){return pe.resolve()}updateIndexEntries(e,t){return pe.resolve()}}class Rs{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new pt($.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new pt($.comparator)).toArray()}}const Os=new Uint8Array(0);class Ms{constructor(e,t){this.databaseId=t,this.cn=new Rs,this.ln=new $n(e=>Cn(e),(e,t)=>An(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const i={collectionId:n,parent:je(r)};return Ls(e).put(i)}return pe.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[Q(t),""],!1,!0);return Ls(e).U(r).next(e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Re(r.parent))}return n})}addFieldIndex(e,t){const n=Us(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=Vs(e);return i.next(e=>{n.put(as(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const n=Us(e),r=Vs(e),i=Fs(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Us(e),n=Fs(e),r=Vs(e);return t.j().next(()=>n.j()).next(()=>r.j())}createTargetIndexes(e,t){return pe.forEach(this.hn(t),t=>this.getIndexType(e,t).next(n=>{if(0===n||1===n){const n=new _s(t).an();if(null!=n)return this.addFieldIndex(e,n)}}))}getDocumentsMatchingTarget(e,t){const n=Fs(e);let r=!0;const i=new Map;return pe.forEach(this.hn(t),t=>this.Pn(e,t).next(e=>{r&&(r=!!e),i.set(t,e)})).next(()=>{if(r){let e=cr();const r=[];return pe.forEach(i,(i,s)=>{S("IndexedDbIndexManager","Using index ".concat(function(e){return"id=".concat(e.indexId,"|cg=").concat(e.collectionGroup,"|f=").concat(e.fields.map(e=>"".concat(e.fieldPath,":").concat(e.kind)).join(","))}(i)," to execute ").concat(Cn(t)));const a=function(e,t){const n=re(t);if(void 0===n)return null;for(const r of Pn(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(s,i),o=function(e,t){const n=new Map;for(const r of ie(t))for(const t of Pn(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),l=function(e,t){const n=[];let r=!0;for(const i of ie(t)){const t=0===i.kind?Dn(e,i.fieldPath,e.startAt):Rn(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new nn(n,r)}(s,i),c=function(e,t){const n=[];let r=!0;for(const i of ie(t)){const t=0===i.kind?Rn(e,i.fieldPath,e.endAt):Dn(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new nn(n,r)}(s,i),u=this.In(i,s,l),d=this.In(i,s,c),h=this.Tn(i,s,o),f=this.En(i.indexId,a,u,l.inclusive,d,c.inclusive,h);return pe.forEach(f,i=>n.G(i,t.limit).next(t=>{t.forEach(t=>{const n=te.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))})}))}).next(()=>r)}return pe.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(t=0===e.filters.length?[e]:Es(un.create(e.filters,"and")).map(t=>Tn(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,n,r,i,s,a){const o=(null!=t?t.length:1)*Math.max(n.length,i.length),l=o/(null!=t?t.length:1),c=[];for(let u=0;u<o;++u){const o=t?this.dn(t[u/l]):Os,d=this.An(e,o,n[u%l],r),h=this.Rn(e,o,i[u%l],s),f=a.map(t=>this.An(e,o,t,!0));c.push(...this.createRange(d,h,f))}return c}An(e,t,n,r){const i=new ws(e,te.empty(),t,n);return r?i:i.Zt()}Rn(e,t,n,r){const i=new ws(e,te.empty(),t,n);return r?i.Zt():i}Pn(e,t){const n=new _s(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(e=>{let t=null;for(const r of e)n.rn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t})}getIndexType(e,t){let n=2;const r=this.hn(t);return pe.forEach(r,t=>this.Pn(e,t).next(e=>{e?0!==n&&e.fields.length<function(e){let t=new pt(ee.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})).next(()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n)}Vn(e,t){const n=new bs;for(const r of ie(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.Yt(r.kind);fs.vt.It(e,i)}return n.zt()}dn(e){const t=new bs;return fs.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const n=new bs;return fs.vt.It(Ut(this.databaseId,t),n.Yt(function(e){const t=ie(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.zt()}Tn(e,t,n){if(null===n)return[];let r=[];r.push(new bs);let i=0;for(const s of ie(e)){const e=n[i++];for(const n of r)if(this.fn(t,s.fieldPath)&&Bt(e))r=this.gn(r,s,e);else{const t=n.Yt(s.kind);fs.vt.It(e,t)}}return this.pn(r)}In(e,t,n){return this.Tn(e,t,n.position)}pn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].zt();return t}gn(e,t,n){const r=[...e],i=[];for(const s of n.arrayValue.values||[])for(const e of r){const n=new bs;n.seed(e.zt()),fs.vt.It(s,n.Yt(t.kind)),i.push(n)}return i}fn(e,t){return!!e.filters.find(e=>e instanceof cn&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){const n=Us(e),r=Vs(e);return(t?n.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.U()).next(e=>{const t=[];return pe.forEach(e,e=>r.get([e.indexId,this.uid]).next(n=>{t.push(function(e,t){const n=t?new ae(t.sequenceNumber,new ce(Zi(t.readTime),new te(Re(t.documentKey)),t.largestBatchId)):ae.empty(),r=e.fields.map(e=>{let[t,n]=e;return new se(ee.fromServerFormat(t),n)});return new ne(e.indexId,e.collectionGroup,r,n)}(e,n))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:W(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,n){const r=Us(e),i=Vs(e);return this.yn(e).next(e=>r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(t=>pe.forEach(t,t=>i.put(as(t.indexId,this.uid,e,n)))))}updateIndexEntries(e,t){const n=new Map;return pe.forEach(t,(t,r)=>{const i=n.get(t.collectionGroup);return(i?pe.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next(i=>(n.set(t.collectionGroup,i),pe.forEach(i,n=>this.wn(e,t,n).next(t=>{const i=this.Sn(r,n);return t.isEqual(i)?pe.resolve():this.bn(e,r,n,t,i)}))))})}Dn(e,t,n,r){return Fs(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.mn(n,t.key),documentKey:t.key.path.toArray()})}vn(e,t,n,r){return Fs(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.mn(n,t.key),t.key.path.toArray()])}wn(e,t,n){const r=Fs(e);let i=new pt(xs);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,t)])},(e,r)=>{i=i.add(new ws(n.indexId,t,r.arrayValue,r.directionalValue))}).next(()=>i)}Sn(e,t){let n=new pt(xs);const r=this.Vn(t,e);if(null==r)return n;const i=re(t);if(null!=i){const s=e.data.field(i.fieldPath);if(Bt(s))for(const i of s.arrayValue.values||[])n=n.add(new ws(t.indexId,e.key,this.dn(i),r))}else n=n.add(new ws(t.indexId,e.key,Os,r));return n}bn(e,t,n,r,i){S("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),a=t.getIterator();let o=gt(s),l=gt(a);for(;o||l;){let e=!1,t=!1;if(o&&l){const r=n(o,l);r<0?t=!0:r>0&&(e=!0)}else null!=o?t=!0:e=!0;e?(r(l),l=gt(a)):t?(i(o),o=gt(s)):(o=gt(s),l=gt(a))}}(r,i,xs,r=>{s.push(this.Dn(e,t,n,r))},r=>{s.push(this.vn(e,t,n,r))}),pe.waitFor(s)}yn(e){let t=1;return Vs(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,n,r)=>{r.done(),t=n.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((e,t)=>xs(e,t)).filter((e,t,n)=>!t||0!==xs(e,n[t-1]));const r=[];r.push(e);for(const s of n){const n=xs(s,e),i=xs(s,t);if(0===n)r[0]=e.Zt();else if(n>0&&i<0)r.push(s),r.push(s.Zt());else if(i>0)break}r.push(t);const i=[];for(let s=0;s<r.length;s+=2){if(this.Cn(r[s],r[s+1]))return[];const e=[r[s].indexId,this.uid,r[s].arrayValue,r[s].directionalValue,Os,[]],t=[r[s+1].indexId,this.uid,r[s+1].arrayValue,r[s+1].directionalValue,Os,[]];i.push(IDBKeyRange.bound(e,t))}return i}Cn(e,t){return xs(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Bs)}getMinOffset(e,t){return pe.mapArray(this.hn(t),t=>this.Pn(e,t).next(e=>e||A())).next(Bs)}}function Ls(e){return ot(e,"collectionParents")}function Fs(e){return ot(e,"indexEntries")}function Us(e){return ot(e,"indexConfiguration")}function Vs(e){return ot(e,"indexState")}function Bs(e){j(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;ue(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new ce(t.readTime,t.documentKey,n)}const zs={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class qs{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new qs(e,qs.DEFAULT_COLLECTION_PERCENTILE,qs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Ks(e,t,n){const r=e.store("mutations"),i=e.store("documentMutations"),s=[],a=IDBKeyRange.only(n.batchId);let o=0;const l=r.J({range:a},(e,t,n)=>(o++,n.delete()));s.push(l.next(()=>{j(1===o)}));const c=[];for(const u of n.mutations){const e=Le(t,u.key.path,n.batchId);s.push(i.delete(e)),c.push(u.key)}return pe.waitFor(s).next(()=>c)}function Hs(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw A();t=e.noDocument}return JSON.stringify(t).length}qs.DEFAULT_COLLECTION_PERCENTILE=10,qs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qs.DEFAULT=new qs(41943040,qs.DEFAULT_COLLECTION_PERCENTILE,qs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qs.DISABLED=new qs(-1,0,0);class Ws{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Fn={}}static lt(e,t,n,r){j(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new Ws(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Qs(e).J({index:"userMutationsIndex",range:n},(e,n,r)=>{t=!1,r.done()}).next(()=>t)}addMutationBatch(e,t,n,r){const i=Ys(e),s=Qs(e);return s.add({}).next(a=>{j("number"==typeof a);const o=new Kr(a,t,n,r),l=function(e,t,n){const r=n.baseMutations.map(t=>Ri(e.ct,t)),i=n.mutations.map(t=>Ri(e.ct,t));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,o),c=[];let u=new pt((e,t)=>W(e.canonicalString(),t.canonicalString()));for(const e of r){const t=Le(this.userId,e.key.path,a);u=u.add(e.key.path.popLast()),c.push(s.put(l)),c.push(i.put(t,Fe))}return u.forEach(t=>{c.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Fn[a]=o.keys()}),pe.waitFor(c).next(()=>o)})}lookupMutationBatch(e,t){return Qs(e).get(t).next(e=>e?(j(e.userId===this.userId),es(this.serializer,e)):null)}Mn(e,t){return this.Fn[t]?pe.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){const n=e.keys();return this.Fn[t]=n,n}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return Qs(e).J({index:"userMutationsIndex",range:r},(e,t,r)=>{t.userId===this.userId&&(j(t.batchId>=n),i=es(this.serializer,t)),r.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Qs(e).J({index:"userMutationsIndex",range:t,reverse:!0},(e,t,r)=>{n=t.batchId,r.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Qs(e).U("userMutationsIndex",t).next(e=>e.map(e=>es(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Me(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return Ys(e).J({range:r},(n,r,s)=>{const[a,o,l]=n,c=Re(o);if(a===this.userId&&t.path.isEqual(c))return Qs(e).get(l).next(e=>{if(!e)throw A();j(e.userId===this.userId),i.push(es(this.serializer,e))});s.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new pt(W);const r=[];return t.forEach(t=>{const i=Me(this.userId,t.path),s=IDBKeyRange.lowerBound(i),a=Ys(e).J({range:s},(e,r,i)=>{const[s,a,o]=e,l=Re(a);s===this.userId&&t.path.isEqual(l)?n=n.add(o):i.done()});r.push(a)}),pe.waitFor(r).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=Me(this.userId,n),s=IDBKeyRange.lowerBound(i);let a=new pt(W);return Ys(e).J({range:s},(e,t,i)=>{const[s,o,l]=e,c=Re(o);s===this.userId&&n.isPrefixOf(c)?c.length===r&&(a=a.add(l)):i.done()}).next(()=>this.xn(e,a))}xn(e,t){const n=[],r=[];return t.forEach(t=>{r.push(Qs(e).get(t).next(e=>{if(null===e)throw A();j(e.userId===this.userId),n.push(es(this.serializer,e))}))}),pe.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return Ks(e._e,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),pe.forEach(n,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return pe.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return Ys(e).J({range:n},(e,t,n)=>{if(e[0]===this.userId){const t=Re(e[1]);r.push(t)}else n.done()}).next(()=>{j(0===r.length)})})}containsKey(e,t){return Gs(e,this.userId,t)}Nn(e){return Js(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Gs(e,t,n){const r=Me(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Ys(e).J({range:s,H:!0},(e,n,r)=>{const[s,o,l]=e;s===t&&o===i&&(a=!0),r.done()}).next(()=>a)}function Qs(e){return ot(e,"mutations")}function Ys(e){return ot(e,"documentMutations")}function Js(e){return ot(e,"mutationQueues")}class Xs{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Xs(0)}static kn(){return new Xs(-1)}}class $s{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const n=new Xs(t.highestTargetId);return t.highestTargetId=n.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(e=>J.fromTimestamp(new Y(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.qn(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Qn(e,r)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(t,n),this.Qn(e,n))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Zs(e).delete(t.targetId)).next(()=>this.qn(e)).next(t=>(j(t.targetCount>0),t.targetCount-=1,this.Qn(e,t)))}removeTargets(e,t,n){let r=0;const i=[];return Zs(e).J((s,a)=>{const o=ts(a);o.sequenceNumber<=t&&null===n.get(o.targetId)&&(r++,i.push(this.removeTargetData(e,o)))}).next(()=>pe.waitFor(i)).next(()=>r)}forEachTarget(e,t){return Zs(e).J((e,n)=>{const r=ts(n);t(r)})}qn(e){return ea(e).get("targetGlobalKey").next(e=>(j(null!==e),e))}Qn(e,t){return ea(e).put("targetGlobalKey",t)}Kn(e,t){return Zs(e).put(ns(this.serializer,t))}$n(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(e=>e.targetCount)}getTargetData(e,t){const n=Cn(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return Zs(e).J({range:r,index:"queryTargetsIndex"},(e,n,r)=>{const s=ts(n);An(t,s.target)&&(i=s,r.done())}).next(()=>i)}addMatchingKeys(e,t,n){const r=[],i=ta(e);return t.forEach(t=>{const s=je(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))}),pe.waitFor(r)}removeMatchingKeys(e,t,n){const r=ta(e);return pe.forEach(t,t=>{const i=je(t.path);return pe.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])})}removeMatchingKeysForTargetId(e,t){const n=ta(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=ta(e);let i=cr();return r.J({range:n,H:!0},(e,t,n)=>{const r=Re(e[1]),s=new te(r);i=i.add(s)}).next(()=>i)}containsKey(e,t){const n=je(t.path),r=IDBKeyRange.bound([n],[Q(n)],!1,!0);let i=0;return ta(e).J({index:"documentTargetsIndex",H:!0,range:r},(e,t,n)=>{let[r,s]=e;0!==r&&(i++,n.done())}).next(()=>i>0)}ot(e,t){return Zs(e).get(t).next(e=>e?ts(e):null)}}function Zs(e){return ot(e,"targets")}function ea(e){return ot(e,"targetGlobal")}function ta(e){return ot(e,"targetDocuments")}function na(e,t){let[n,r]=e,[i,s]=t;const a=W(n,i);return 0===a?W(r,s):a}class ra{constructor(e){this.Un=e,this.buffer=new pt(na),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();na(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ia{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.jn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return null!==this.jn}Hn(e){S("LruGarbageCollector","Garbage collection scheduled in ".concat(e,"ms")),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){we(e)?S("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await fe(e)}await this.Hn(3e5)})}}class sa{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return pe.resolve(Ne.oe);const n=new ra(t);return this.Jn.forEachTarget(e,e=>n.zn(e.sequenceNumber)).next(()=>this.Jn.Zn(e,e=>n.zn(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(S("LruGarbageCollector","Garbage collection skipped; disabled"),pe.resolve(zs)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(S("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),zs):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let n,r,i,s,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(S("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,a=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(c=Date.now(),E()<=o.$b.DEBUG&&S("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(s-u,"ms\n\tDetermined least recently used ").concat(r," in ")+(a-s)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(l-a)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(c-l)+"ms\n"+"Total Duration: ".concat(c-u,"ms")),pe.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}function aa(e,t){return new sa(e,t)}class oa{constructor(e,t){this.db=e,this.garbageCollector=aa(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}er(e){let t=0;return this.Zn(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(e,n)=>t(n))}addReference(e,t,n){return la(e,n)}removeReference(e,t,n){return la(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return la(e,t)}nr(e,t){return function(e,t){let n=!1;return Js(e).Y(r=>Gs(e,r,t).next(e=>(e&&(n=!0),pe.resolve(!e)))).next(()=>n)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.tr(e,(s,a)=>{if(a<=t){const t=this.nr(e,s).next(t=>{if(!t)return i++,n.getEntry(e,s).next(()=>(n.removeEntry(s,J.min()),ta(e).delete(function(e){return[0,je(e.path)]}(s))))});r.push(t)}}).next(()=>pe.waitFor(r)).next(()=>n.apply(e)).next(()=>i)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return la(e,t)}tr(e,t){const n=ta(e);let r,i=Ne.oe;return n.J({index:"documentTargetsIndex"},(e,n)=>{let[s,a]=e,{path:o,sequenceNumber:l}=n;0===s?(i!==Ne.oe&&t(new te(Re(r)),i),i=l,r=o):i=Ne.oe}).next(()=>{i!==Ne.oe&&t(new te(Re(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function la(e,t){return ta(e).put(function(e,t){return{targetId:0,path:je(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class ca{constructor(){this.changes=new $n(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,tn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?pe.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ua{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return pa(e).put(n)}removeEntry(e,t,n){return pa(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Xi(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.rr(e,n)))}getEntry(e,t){let n=tn.newInvalidDocument(t);return pa(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ma(t))},(e,r)=>{n=this.ir(t,r)}).next(()=>n)}sr(e,t){let n={size:0,document:tn.newInvalidDocument(t)};return pa(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ma(t))},(e,r)=>{n={document:this.ir(t,r),size:Hs(r)}}).next(()=>n)}getEntries(e,t){let n=er();return this._r(e,t,(e,t)=>{const r=this.ir(e,t);n=n.insert(e,r)}).next(()=>n)}ar(e,t){let n=er(),r=new dt(te.comparator);return this._r(e,t,(e,t)=>{const i=this.ir(e,t);n=n.insert(e,i),r=r.insert(e,Hs(t))}).next(()=>({documents:n,ur:r}))}_r(e,t,n){if(t.isEmpty())return pe.resolve();let r=new pt(ya);t.forEach(e=>r=r.add(e));const i=IDBKeyRange.bound(ma(r.first()),ma(r.last())),s=r.getIterator();let a=s.getNext();return pa(e).J({index:"documentKeyIndex",range:i},(e,t,r)=>{const i=te.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;a&&ya(a,i)<0;)n(a,null),a=s.getNext();a&&a.isEqual(i)&&(n(a,t),a=s.hasNext()?s.getNext():null),a?r.$(ma(a)):r.done()}).next(()=>{for(;a;)n(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,n,r,i){const s=t.path,a=[s.popLast().toArray(),s.lastSegment(),Xi(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],o=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return pa(e).U(IDBKeyRange.bound(a,o,!0)).next(e=>{null==i||i.incrementDocumentReadCount(e.length);let n=er();for(const i of e){const e=this.ir(te.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(Qn(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n})}getAllFromCollectionGroup(e,t,n,r){let i=er();const s=ga(t,n),a=ga(t,ce.max());return pa(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,a,!0)},(e,t,n)=>{const s=this.ir(te.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()}).next(()=>i)}newChangeBuffer(e){return new ha(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return fa(e).get("remoteDocumentGlobalKey").next(e=>(j(!!e),e))}rr(e,t){return fa(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const e=function(e,t){let n;if(t.document)n=Di(e.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=te.fromSegments(t.noDocument.path),r=Zi(t.noDocument.readTime);n=tn.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return A();{const e=te.fromSegments(t.unknownDocument.path),r=Zi(t.unknownDocument.version);n=tn.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new Y(e[0],e[1]);return J.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(J.min()))return e}return tn.newInvalidDocument(e)}}function da(e){return new ua(e)}class ha extends ca{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new $n(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){const t=[];let n=0,r=new pt((e,t)=>W(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{const a=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,a.readTime)),s.isValidDocument()){const o=Ji(this.cr.serializer,s);r=r.add(i.path.popLast());const l=Hs(o);n+=l-a.size,t.push(this.cr.addEntry(e,i,o))}else if(n-=a.size,this.trackRemovals){const n=Ji(this.cr.serializer,s.convertToNoDocument(J.min()));t.push(this.cr.addEntry(e,i,n))}}),r.forEach(n=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,n))}),t.push(this.cr.updateMetadata(e,n)),pe.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(e=>(this.lr.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(e=>{let{documents:t,ur:n}=e;return n.forEach((e,n)=>{this.lr.set(e,{size:n,readTime:t.get(e).readTime})}),t})}}function fa(e){return ot(e,"remoteDocumentGlobal")}function pa(e){return ot(e,"remoteDocumentsV14")}function ma(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function ga(e,t){const n=t.documentKey.path.toArray();return[e,Xi(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function ya(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=W(n[s],r[s]),i)return i;return i=W(n.length,r.length),i||(i=W(n[n.length-2],r[r.length-2]),i||W(n[n.length-1],r[r.length-1]))}class va{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ba{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Rr(n.mutation,e,yt.empty(),Y.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,cr()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cr();const r=ir();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=nr();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=ir();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,cr()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=er();const s=ar(),a=ar();return t.forEach((e,t)=>{const a=n.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof Fr)?i=i.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),Rr(a.mutation,t,a.mutation.getFieldMask(),Y.now())):s.set(t.key,yt.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return a.set(e,new va(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),a))}recalculateAndSaveOverlays(e,t){const n=ar();let r=new dt((e,t)=>e-t),i=cr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let a=n.get(e)||yt.empty();a=i.applyToLocalView(s,a),n.set(e,a);const o=(r.get(i.batchId)||cr()).add(e);r=r.insert(i.batchId,o)})}).next(()=>{const s=[],a=r.getReverseIterator();for(;a.hasNext();){const r=a.getNext(),o=r.key,l=r.value,c=sr();l.forEach(e=>{if(!i.has(e)){const r=Pr(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,c))}return pe.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return te.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Un(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):pe.resolve(ir());let a=-1,o=i;return s.next(t=>pe.forEach(t,(t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),i.get(t)?pe.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,o,t,cr())).next(e=>({batchId:a,changes:rr(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new te(t)).next(e=>{let t=nr();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=nr();return this.indexManager.getCollectionParents(e,i).next(a=>pe.forEach(a,a=>{const o=function(e,t){return new On(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,tn.newInvalidDocument(r)))});let n=nr();return e.forEach((e,r)=>{const s=i.get(e);void 0!==s&&Rr(s.mutation,r,yt.empty(),Y.now()),Qn(t,r)&&(n=n.insert(e,r))}),n})}}class wa{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return pe.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:ki(e.createTime)}}(t)),pe.resolve()}getNamedQuery(e,t){return pe.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:rs(e.bundledQuery),readTime:ki(e.readTime)}}(t)),pe.resolve()}}class xa{constructor(){this.overlays=new dt(te.comparator),this.Ir=new Map}getOverlay(e,t){return pe.resolve(this.overlays.get(t))}getOverlays(e,t){const n=ir();return pe.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.ht(e,t,r)}),pe.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Ir.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.Ir.delete(n)),pe.resolve()}getOverlaysForCollection(e,t,n){const r=ir(),i=t.length+1,s=new te(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return pe.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new dt((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=ir(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=ir(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=r)););return pe.resolve(a)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Ir.get(r.largestBatchId).delete(n.key);this.Ir.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Wr(t,n));let i=this.Ir.get(t);void 0===i&&(i=cr(),this.Ir.set(t,i)),this.Ir.set(t,i.add(n.key))}}class ka{constructor(){this.sessionToken=bt.EMPTY_BYTE_STRING}getSessionToken(e){return pe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,pe.resolve()}}class _a{constructor(){this.Tr=new pt(Ia.Er),this.dr=new pt(Ia.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new Ia(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Vr(new Ia(e,t))}mr(e,t){e.forEach(e=>this.removeReference(e,t))}gr(e){const t=new te(new $([])),n=new Ia(t,e),r=new Ia(t,e+1),i=[];return this.dr.forEachInRange([n,r],e=>{this.Vr(e),i.push(e.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new te(new $([])),n=new Ia(t,e),r=new Ia(t,e+1);let i=cr();return this.dr.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new Ia(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Ia{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return te.comparator(e.key,t.key)||W(e.wr,t.wr)}static Ar(e,t){return W(e.wr,t.wr)||te.comparator(e.key,t.key)}}class Ea{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new pt(Ia.Er)}checkEmpty(e){return pe.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Kr(i,t,n,r);this.mutationQueue.push(s);for(const a of r)this.br=this.br.add(new Ia(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return pe.resolve(s)}lookupMutationBatch(e,t){return pe.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.vr(n),i=r<0?0:r;return pe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return pe.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return pe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ia(t,0),r=new Ia(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,r],e=>{const t=this.Dr(e.wr);i.push(t)}),pe.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new pt(W);return t.forEach(e=>{const t=new Ia(e,0),r=new Ia(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,r],e=>{n=n.add(e.wr)})}),pe.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;te.isDocumentKey(i)||(i=i.child(""));const s=new Ia(new te(i),0);let a=new pt(W);return this.br.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.wr)),!0)},s),pe.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(e=>{const n=this.Dr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){j(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return pe.forEach(t.mutations,r=>{const i=new Ia(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,t){const n=new Ia(t,0),r=this.br.firstAfterOrEqual(n);return pe.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,pe.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Sa{constructor(e){this.Mr=e,this.docs=new dt(te.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return pe.resolve(n?n.document.mutableCopy():tn.newInvalidDocument(t))}getEntries(e,t){let n=er();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():tn.newInvalidDocument(e))}),pe.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=er();const s=t.path,a=new te(s.child("")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||ue(le(a),n)<=0||(r.has(a.key)||Qn(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return pe.resolve(i)}getAllFromCollectionGroup(e,t,n,r){A()}Or(e,t){return pe.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Na(this)}getSize(e){return pe.resolve(this.size)}}class Na extends ca{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(n)}),pe.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class Ta{constructor(e){this.persistence=e,this.Nr=new $n(e=>Cn(e),An),this.lastRemoteSnapshotVersion=J.min(),this.highestTargetId=0,this.Lr=0,this.Br=new _a,this.targetCount=0,this.kr=Xs.Bn()}forEachTarget(e,t){return this.Nr.forEach((e,n)=>t(n)),pe.resolve()}getLastRemoteSnapshotVersion(e){return pe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return pe.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),pe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),pe.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Xs(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,pe.resolve()}updateTargetData(e,t){return this.Kn(t),pe.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,pe.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Nr.forEach((s,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.Nr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),pe.waitFor(i).next(()=>r)}getTargetCount(e){return pe.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return pe.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),pe.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),pe.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),pe.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return pe.resolve(n)}containsKey(e,t){return pe.resolve(this.Br.containsKey(t))}}class Ca{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Ne(0),this.Kr=!1,this.Kr=!0,this.$r=new ka,this.referenceDelegate=e(this),this.Ur=new Ta(this),this.indexManager=new Ds,this.remoteDocumentCache=function(e){return new Sa(e)}(e=>this.referenceDelegate.Wr(e)),this.serializer=new Yi(t),this.Gr=new wa(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new xa,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new Ea(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){S("MemoryPersistence","Starting transaction:",e);const r=new Aa(this.Qr.next());return this.referenceDelegate.zr(),n(r).next(e=>this.referenceDelegate.jr(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Hr(e,t){return pe.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,t)))}}class Aa extends he{constructor(e){super(),this.currentSequenceNumber=e}}class ja{constructor(e){this.persistence=e,this.Jr=new _a,this.Yr=null}static Zr(e){return new ja(e)}get Xr(){if(this.Yr)return this.Yr;throw A()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),pe.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),pe.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),pe.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(e=>this.Xr.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Xr.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return pe.forEach(this.Xr,n=>{const r=te.fromPath(n);return this.ei(e,r).next(e=>{e||t.removeEntry(r,J.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return pe.or([()=>pe.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class Pa{constructor(e){this.serializer=e}O(e,t,n,r){const i=new me("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Oe,{unique:!0}),e.createObjectStore("documentMutations")}(e),Da(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=pe.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),Da(e)),s=s.next(()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:J.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(i))),n<4&&r>=4&&(0!==n&&(s=s.next(()=>function(e,t){return t.store("mutations").U().next(n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Oe,{unique:!0});const r=t.store("mutations"),i=n.map(e=>r.put(e));return pe.waitFor(i)})}(e,i))),s=s.next(()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),n<5&&r>=5&&(s=s.next(()=>this.ni(i))),n<6&&r>=6&&(s=s.next(()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),n<7&&r>=7&&(s=s.next(()=>this.ii(i))),n<8&&r>=8&&(s=s.next(()=>this.si(e,i))),n<9&&r>=9&&(s=s.next(()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)})),n<10&&r>=10&&(s=s.next(()=>this.oi(i))),n<11&&r>=11&&(s=s.next(()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&r>=12&&(s=s.next(()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:Je});t.createIndex("collectionPathOverlayIndex",Xe,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",$e,{unique:!1})}(e)})),n<13&&r>=13&&(s=s.next(()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:Ue});t.createIndex("documentKeyIndex",Ve),t.createIndex("collectionGroupIndex",Be)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&r>=14&&(s=s.next(()=>this.ai(e,i))),n<15&&r>=15&&(s=s.next(()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:We}).createIndex("sequenceNumberIndex",Ge,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Qe}).createIndex("documentKeyIndex",Ye,{unique:!1})}(e))),n<16&&r>=16&&(s=s.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),n<17&&r>=17&&(s=s.next(()=>{!function(e){e.createObjectStore("globals",{keyPath:"name"})}(e)})),s}ri(e){let t=0;return e.store("remoteDocuments").J((e,n)=>{t+=Hs(n)}).next(()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.U().next(t=>pe.forEach(t,t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",r).next(n=>pe.forEach(n,n=>{j(n.userId===t.userId);const r=es(this.serializer,n);return Ks(e,t.userId,r).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(e=>{const r=[];return n.J((n,i)=>{const s=new $(n),a=function(e){return[0,je(e)]}(s);r.push(t.get(a).next(n=>n?pe.resolve():(n=>t.put({targetId:0,path:je(n),sequenceNumber:e.highestListenSequenceNumber}))(s)))}).next(()=>pe.waitFor(r))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:He});const n=t.store("collectionParents"),r=new Rs,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:je(r)})}};return t.store("remoteDocuments").J({H:!0},(e,t)=>{const n=new $(e);return i(n.popLast())}).next(()=>t.store("documentMutations").J({H:!0},(e,t)=>{let[n,r,s]=e;const a=Re(r);return i(a.popLast())}))}oi(e){const t=e.store("targets");return t.J((e,n)=>{const r=ts(n),i=ns(this.serializer,r);return t.put(i)})}_i(e,t){const n=t.store("remoteDocuments"),r=[];return n.J((e,n)=>{const i=t.store("remoteDocumentsV14"),s=function(e){return e.document?new te($.fromString(e.document.name).popFirst(5)):e.noDocument?te.fromSegments(e.noDocument.path):e.unknownDocument?te.fromSegments(e.unknownDocument.path):A()}(n).path.toArray(),a={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(a))}).next(()=>pe.waitFor(r))}ai(e,t){const n=t.store("mutations"),r=da(this.serializer),i=new Ca(ja.Zr,this.serializer.ct);return n.U().next(e=>{const n=new Map;return e.forEach(e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:cr();es(this.serializer,e).keys().forEach(e=>r=r.add(e)),n.set(e.userId,r)}),pe.forEach(n,(e,n)=>{const s=new k(n),a=us.lt(this.serializer,s),o=i.getIndexManager(s),l=Ws.lt(s,this.serializer,o,i.referenceDelegate);return new ba(r,l,a,o).recalculateAndSaveOverlaysForDocumentKeys(new at(t,Ne.oe),e).next()})})}}function Da(e){e.createObjectStore("targetDocuments",{keyPath:qe}).createIndex("documentTargetsIndex",Ke,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",ze,{unique:!0}),e.createObjectStore("targetGlobal")}const Ra="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Oa{constructor(e,t,n,r,i,s,a,o,l,c){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:17;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.ui=i,this.window=s,this.document=a,this.ci=l,this.li=c,this.hi=u,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=e=>Promise.resolve(),!Oa.D())throw new R(D.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new oa(this,r),this.Ai=t+"main",this.serializer=new Yi(o),this.Ri=new ge(this.Ai,this.hi,new Pa(this.serializer)),this.$r=new hs,this.Ur=new $s(this.referenceDelegate,this.serializer),this.remoteDocumentCache=da(this.serializer),this.Gr=new os,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,!1===c&&N("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new R(D.FAILED_PRECONDITION,Ra);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Ne(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>La(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(e=>{e||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(we(e))return S("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return S("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Ma(e).get("owner").next(e=>pe.resolve(this.vi(e)))}Ci(e){return La(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const t=ot(e,"clientMetadata");return t.U().next(e=>{const n=this.xi(e,18e5),r=e.filter(e=>-1===n.indexOf(e));return pe.forEach(r,e=>t.delete(e.clientId)).next(()=>r)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?pe.resolve(!0):Ma(e).get("owner").next(t=>{if(null!==t&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new R(D.FAILED_PRECONDITION,Ra);return!1}}return!(!this.networkEnabled||!this.inForeground)||La(e).U().next(e=>void 0===this.xi(e,5e3).find(e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&S("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new at(e,Ne.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(e=>this.Mi(e.updateTimeMs,t)&&!this.Ni(e.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>La(e).U().next(e=>this.xi(e,18e5).map(e=>e.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Ws.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Ms(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return us.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,n){S("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 17===e?st:16===e?it:15===e?rt:14===e?nt:13===e?tt:12===e?et:11===e?Ze:void A()}(this.hi);let s;return this.Ri.runTransaction(e,r,i,r=>(s=new at(r,this.Qr?this.Qr.next():Ne.oe),"readwrite-primary"===t?this.wi(s).next(e=>!!e||this.Si(s)).next(t=>{if(!t)throw N("Failed to obtain primary lease for action '".concat(e,"'.")),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new R(D.FAILED_PRECONDITION,de);return n(s)}).next(e=>this.Di(s).next(()=>e)):this.Ki(s).next(()=>n(s)))).then(e=>(s.raiseOnCommittedEvent(),e))}Ki(e){return Ma(e).get("owner").next(e=>{if(null!==e&&this.Mi(e.leaseTimestampMs,5e3)&&!this.Ni(e.ownerId)&&!this.vi(e)&&!(this.li||this.allowTabSynchronization&&e.allowTabSynchronization))throw new R(D.FAILED_PRECONDITION,Ra)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ma(e).put("owner",t)}static D(){return ge.D()}bi(e){const t=Ma(e);return t.get("owner").next(e=>this.vi(e)?(S("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):pe.resolve())}Mi(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(N("Detected an update time that is in the future: ".concat(e," > ").concat(n)),!1))}fi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground="visible"===this.document.visibilityState)}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Pi=()=>{this.Li();const e=/(?:Version|Mobile)\/1[456]/;(0,l.nr)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const n=null!==(null===(t=this.Vi)||void 0===t?void 0:t.getItem(this.Oi(e)));return S("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return N("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){N("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch(e){}}Oi(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}function Ma(e){return ot(e,"owner")}function La(e){return ot(e,"clientMetadata")}function Fa(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class Ua{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=r}static Wi(e,t){let n=cr(),r=cr();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Ua(e,t.fromCache,n,r)}}class Va{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Ba{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=(0,l.nr)()?8:ye((0,l.ZQ)())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.Yi(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.Zi(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new Va;return this.Xi(e,t,n).next(r=>{if(i.result=r,this.zi)return this.es(e,t,n,r.size)})}).next(()=>i.result)}es(e,t,n,r){return n.documentReadCount<this.ji?(E()<=o.$b.DEBUG&&S("QueryEngine","SDK will not create cache indexes for query:",Gn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),pe.resolve()):(E()<=o.$b.DEBUG&&S("QueryEngine","Query:",Gn(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Hi*r?(E()<=o.$b.DEBUG&&S("QueryEngine","The SDK decides to create cache indexes for query:",Gn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Bn(t))):pe.resolve())}Yi(e,t){if(Fn(t))return pe.resolve(null);let n=Bn(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=Kn(t,null,"F"),n=Bn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=cr(...r);return this.Ji.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.ts(t,r);return this.ns(t,s,i,n.readTime)?this.Yi(e,Kn(t,null,"F")):this.rs(e,s,t,n)}))})))}Zi(e,t,n,r){return Fn(t)||r.isEqual(J.min())?pe.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const s=this.ts(t,i);return this.ns(t,s,n,r)?pe.resolve(null):(E()<=o.$b.DEBUG&&S("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Gn(t)),this.rs(e,s,t,oe(r,-1)).next(e=>e))})}ts(e,t){let n=new pt(Jn(e));return t.forEach((t,r)=>{Qn(e,r)&&(n=n.add(r))}),n}ns(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Xi(e,t,n){return E()<=o.$b.DEBUG&&S("QueryEngine","Using full collection scan to execute query:",Gn(t)),this.Ji.getDocumentsMatchingQuery(e,t,ce.min(),n)}rs(e,t,n,r){return this.Ji.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class za{constructor(e,t,n,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new dt(W),this._s=new $n(e=>Cn(e),An),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ba(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function qa(e,t,n,r){return new za(e,t,n,r)}async function Ka(e,t){const n=P(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.ls(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let a=cr();for(const e of r){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return n.localDocuments.getDocuments(e,a).next(e=>({hs:e,removedBatchIds:i,addedBatchIds:s}))})})}function Ha(e){const t=P(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Ur.getLastRemoteSnapshotVersion(e))}function Wa(e,t,n){let r=cr(),i=cr();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=er();return n.forEach((n,s)=>{const a=e.get(n);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(J.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):S("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),{Ps:r,Is:i}})}function Ga(e,t){const n=P(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function Qa(e,t){const n=P(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Ur.getTargetData(e,t).next(i=>i?(r=i,pe.resolve(r)):n.Ur.allocateTargetId(e).next(i=>(r=new Qi(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.os.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e})}async function Ya(e,t,n){const r=P(e),i=r.os.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!we(e))throw e;S("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.os=r.os.remove(t),r._s.delete(i.target)}function Ja(e,t,n){const r=P(e);let i=J.min(),s=cr();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=P(e),i=r._s.get(n);return void 0!==i?pe.resolve(r.os.get(i)):r.Ur.getTargetData(t,n)}(r,e,Bn(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.ss.getDocumentsMatchingQuery(e,t,n?i:J.min(),n?s:cr())).next(e=>(Xa(r,Yn(t),e),{documents:e,Ts:s})))}function Xa(e,t,n){let r=e.us.get(t)||J.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.us.set(t,r)}class $a{constructor(){this.activeTargetIds=dr()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Za{constructor(){this.so=new $a,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new $a,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class eo{_o(e){}shutdown(){}}class to{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){S("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){S("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let no=null;function ro(){return null===no?no=268435456+Math.round(2147483648*Math.random()):no++,"0x"+no.toString(16)}const io={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class so{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const ao="WebChannelConnection";class oo extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo="projects/".concat(n,"/databases/").concat(r),this.Co="(default)"===this.databaseId.database?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}get Fo(){return!1}Mo(e,t,n,r,i){const s=ro(),a=this.xo(e,t.toUriEncodedString());S("RestConnection","Sending RPC '".concat(e,"' ").concat(s,":"),a,n);const o={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(o,r,i),this.No(e,a,o,n).then(t=>(S("RestConnection","Received RPC '".concat(e,"' ").concat(s,": "),t),t),t=>{throw T("RestConnection","RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",a,"request:",n),t})}Lo(e,t,n,r,i,s){return this.Mo(e,t,n,r,i)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+_,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}xo(e,t){const n=io[e];return"".concat(this.Do,"/v1/").concat(t,":").concat(n)}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,r){const i=ro();return new Promise((s,a)=>{const o=new d;o.setWithCredentials(!0),o.listenOnce(f.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case p.NO_ERROR:const t=o.getResponseJson();S(ao,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),s(t);break;case p.TIMEOUT:S(ao,"RPC '".concat(e,"' ").concat(i," timed out")),a(new R(D.DEADLINE_EXCEEDED,"Request time out"));break;case p.HTTP_ERROR:const n=o.getStatus();if(S(ao,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(t)>=0?t:D.UNKNOWN}(t.status);a(new R(e,t.message))}else a(new R(D.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new R(D.UNAVAILABLE,"Connection failed."));break;default:A()}}finally{S(ao,"RPC '".concat(e,"' ").concat(i," completed."))}});const l=JSON.stringify(r);S(ao,"RPC '".concat(e,"' ").concat(i," sending request:"),r),o.send(t,"POST",l,n,15)})}Bo(e,t,n){const r=ro(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=v(),a=y(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Oo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=i.join("");S(ao,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),o);const u=s.createWebChannel(c,o);let d=!1,f=!1;const p=new so({Io:t=>{f?S(ao,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(d||(S(ao,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),d=!0),S(ao,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},To:()=>u.close()}),b=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return b(u,h.EventType.OPEN,()=>{f||(S(ao,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),p.yo())}),b(u,h.EventType.CLOSE,()=>{f||(f=!0,S(ao,"RPC '".concat(e,"' stream ").concat(r," transport closed")),p.So())}),b(u,h.EventType.ERROR,t=>{f||(f=!0,T(ao,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),p.So(new R(D.UNAVAILABLE,"The operation could not be completed")))}),b(u,h.EventType.MESSAGE,t=>{var n;if(!f){const i=t.data[0];j(!!i);const s=i,a=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(a){S(ao,"RPC '".concat(e,"' stream ").concat(r," received error:"),a);const t=a.status;let n=function(e){const t=Qr[e];if(void 0!==t)return Xr(t)}(t),i=a.message;void 0===n&&(n=D.INTERNAL,i="Unknown error status: "+t+" with message "+a.message),f=!0,p.So(new R(n,i)),u.close()}else S(ao,"RPC '".concat(e,"' stream ").concat(r," received:"),i),p.bo(i)}}),b(a,g.STAT_EVENT,t=>{t.stat===m.PROXY?S(ao,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===m.NOPROXY&&S(ao,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{p.wo()},0),p}}function lo(){return"undefined"!=typeof window?window:null}function co(){return"undefined"!=typeof document?document:null}function uo(e){return new yi(e,!0)}class ho{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=r,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-n);r>0&&S("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.Ko," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class fo{constructor(e,t,n,r,i,s,a,o){this.ui=e,this.Ho=n,this.Jo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new ho(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===D.RESOURCE_EXHAUSTED?(N(t.toString()),N("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===D.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.Yo===t&&this.P_(n,r)},t=>{e(()=>{const e=new R(D.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)})})}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(e=>{n(()=>this.I_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.e_?this.E_(e):this.onNext(e))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return S("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(S("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class po extends fo{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:A()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(j(void 0===t||"string"==typeof t),bt.fromBase64String(t||"")):(j(void 0===t||t instanceof Buffer||t instanceof Uint8Array),bt.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(e){const t=void 0===e.code?D.UNKNOWN:Xr(e.code);return new R(t,e.message||"")}(a);n=new ci(r,i,s,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ni(e,r.document.name),s=ki(r.document.updateTime),a=r.document.createTime?ki(r.document.createTime):J.min(),o=new Zt({mapValue:{fields:r.document.fields}}),l=tn.newFoundDocument(i,s,a,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new oi(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Ni(e,r.document),s=r.readTime?ki(r.readTime):J.min(),a=tn.newNoDocument(i,s),o=r.removedTargetIds||[];n=new oi([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Ni(e,r.document),s=r.removedTargetIds||[];n=new oi([],s,i,null)}else{if(!("filter"in t))return A();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new Gr(r,i),a=e.targetId;n=new li(a,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return J.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?J.min():t.readTime?ki(t.readTime):J.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=Ai(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=jn(r)?{documents:Mi(e,r)}:{query:Li(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=wi(e,t.resumeToken);const r=vi(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(J.min())>0){n.readTime=bi(e,t.snapshotVersion.toTimestamp());const r=vi(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return A()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=Ai(this.serializer),t.removeTarget=e,this.a_(t)}}class mo extends fo{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return j(!!e.streamToken),this.lastStreamToken=e.streamToken,j(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){j(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(j(void 0!==t),e.map(e=>function(e,t){let n=e.updateTime?ki(e.updateTime):ki(t);return n.isEqual(J.min())&&(n=ki(t)),new Tr(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=ki(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=Ai(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Ri(this.serializer,e))};this.a_(t)}}class go extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new R(D.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,a]=i;return this.connection.Mo(e,Ii(t,n),r,s,a)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new R(D.UNKNOWN,e.toString())})}Lo(e,t,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[a,o]=s;return this.connection.Lo(e,Ii(t,n),r,a,o,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new R(D.UNKNOWN,e.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class yo{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.D_?(N(t),this.D_=!1):S("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class vo{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(e=>{n.enqueueAndForget(async()=>{No(this)&&(S("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=P(e);t.L_.add(4),await wo(t),t.q_.set("Unknown"),t.L_.delete(4),await bo(t)}(this))})}),this.q_=new yo(n,r)}}async function bo(e){if(No(e))for(const t of e.B_)await t(!0)}async function wo(e){for(const t of e.B_)await t(!1)}function xo(e,t){const n=P(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),So(n)?Eo(n):Wo(n).r_()&&_o(n,t))}function ko(e,t){const n=P(e),r=Wo(n);n.N_.delete(t),r.r_()&&Io(n,t),0===n.N_.size&&(r.r_()?r.o_():No(n)&&n.q_.set("Unknown"))}function _o(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(J.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Wo(e).A_(t)}function Io(e,t){e.Q_.xe(t),Wo(e).R_(t)}function Eo(e){e.Q_=new di({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),Wo(e).start(),e.q_.v_()}function So(e){return No(e)&&!Wo(e).n_()&&e.N_.size>0}function No(e){return 0===P(e).L_.size}function To(e){e.Q_=void 0}async function Co(e){e.q_.set("Online")}async function Ao(e){e.N_.forEach((t,n)=>{_o(e,t)})}async function jo(e,t){To(e),So(e)?(e.q_.M_(t),Eo(e)):e.q_.set("Unknown")}async function Po(e,t,n){if(e.q_.set("Online"),t instanceof ci&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.N_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.N_.delete(r),e.Q_.removeTarget(r))}(e,t)}catch(n){S("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Do(e,n)}else if(t instanceof oi?e.Q_.Ke(t):t instanceof li?e.Q_.He(t):e.Q_.We(t),!n.isEqual(J.min()))try{const t=await Ha(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.N_.get(r);i&&e.N_.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.N_.get(t);if(!r)return;e.N_.set(t,r.withResumeToken(bt.EMPTY_BYTE_STRING,r.snapshotVersion)),Io(e,t);const i=new Qi(r.target,t,n,r.sequenceNumber);_o(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){S("RemoteStore","Failed to raise snapshot:",t),await Do(e,t)}}async function Do(e,t,n){if(!we(t))throw t;e.L_.add(1),await wo(e),e.q_.set("Offline"),n||(n=()=>Ha(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{S("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await bo(e)})}function Ro(e,t){return t().catch(n=>Do(e,n,t))}async function Oo(e){const t=P(e),n=Go(t);let r=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;Mo(t);)try{const e=await Ga(t.localStore,r);if(null===e){0===t.O_.length&&n.o_();break}r=e.batchId,Lo(t,e)}catch(e){await Do(t,e)}Fo(t)&&Uo(t)}function Mo(e){return No(e)&&e.O_.length<10}function Lo(e,t){e.O_.push(t);const n=Go(e);n.r_()&&n.V_&&n.m_(t.mutations)}function Fo(e){return No(e)&&!Go(e).n_()&&e.O_.length>0}function Uo(e){Go(e).start()}async function Vo(e){Go(e).p_()}async function Bo(e){const t=Go(e);for(const n of e.O_)t.m_(n.mutations)}async function zo(e,t,n){const r=e.O_.shift(),i=Hr.from(r,t,n);await Ro(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Oo(e)}async function qo(e,t){t&&Go(e).V_&&await async function(e,t){if(function(e){return Jr(e)&&e!==D.ABORTED}(t.code)){const n=e.O_.shift();Go(e).s_(),await Ro(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Oo(e)}}(e,t),Fo(e)&&Uo(e)}async function Ko(e,t){const n=P(e);n.asyncQueue.verifyOperationInProgress(),S("RemoteStore","RemoteStore received new credentials");const r=No(n);n.L_.add(3),await wo(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await bo(n)}async function Ho(e,t){const n=P(e);t?(n.L_.delete(2),await bo(n)):t||(n.L_.add(2),await wo(n),n.q_.set("Unknown"))}function Wo(e){return e.K_||(e.K_=function(e,t,n){const r=P(e);return r.w_(),new po(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:Co.bind(null,e),Ro:Ao.bind(null,e),mo:jo.bind(null,e),d_:Po.bind(null,e)}),e.B_.push(async t=>{t?(e.K_.s_(),So(e)?Eo(e):e.q_.set("Unknown")):(await e.K_.stop(),To(e))})),e.K_}function Go(e){return e.U_||(e.U_=function(e,t,n){const r=P(e);return r.w_(),new mo(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Vo.bind(null,e),mo:qo.bind(null,e),f_:Bo.bind(null,e),g_:zo.bind(null,e)}),e.B_.push(async t=>{t?(e.U_.s_(),await Oo(e)):(await e.U_.stop(),e.O_.length>0&&(S("RemoteStore","Stopping write stream with ".concat(e.O_.length," pending writes")),e.O_=[]))})),e.U_}class Qo{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new O,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,a=new Qo(e,t,s,r,i);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new R(D.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Yo(e,t){if(N("AsyncQueue","".concat(t,": ").concat(e)),we(e))return new R(D.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Jo{constructor(e){this.comparator=e?(t,n)=>e(t,n)||te.comparator(t.key,n.key):(e,t)=>te.comparator(e.key,t.key),this.keyedMap=nr(),this.sortedSet=new dt(this.comparator)}static emptySet(e){return new Jo(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Jo))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Jo;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Xo{constructor(){this.W_=new dt(te.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):A():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,n)=>{e.push(n)}),e}}class $o{constructor(e,t,n,r,i,s,a,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new $o(e,t,Jo.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Hn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Zo{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class el{constructor(){this.queries=tl(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=P(e),r=n.queries;n.queries=tl(),r.forEach((e,n)=>{for(const r of n.j_)r.onError(t)})}(this,new R(D.ABORTED,"Firestore shutting down"))}}function tl(){return new $n(e=>Wn(e),Hn)}async function nl(e,t){const n=P(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.H_()&&t.J_()&&(r=2):(s=new Zo,r=t.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=Yo(e,"Initialization of query '".concat(Gn(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,s),s.j_.push(t),t.Z_(n.onlineState),s.z_&&t.X_(s.z_)&&al(n)}async function rl(e,t){const n=P(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.j_.indexOf(t);e>=0&&(s.j_.splice(e,1),0===s.j_.length?i=t.J_()?0:1:!s.H_()&&t.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function il(e,t){const n=P(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(i)&&(r=!0);t.z_=i}}r&&al(n)}function sl(e,t,n){const r=P(e),i=r.queries.get(t);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(t)}function al(e){e.Y_.forEach(e=>{e.next()})}var ol,ll;(ll=ol||(ol={})).ea="default",ll.Cache="cache";class cl{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new $o(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=$o.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ol.Cache}}class ul{constructor(e){this.key=e}}class dl{constructor(e){this.key=e}}class hl{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=cr(),this.mutatedKeys=cr(),this.Aa=Jn(e),this.Ra=new Jo(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new Xo,r=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=Qn(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.ga(c,u)||(n.track({type:2,doc:u}),f=!0,(o&&this.Aa(u,o)>0||l&&this.Aa(u,l)<0)&&(a=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(o||l)&&(a=!0)),f&&(u?(s=s.add(u),i=h?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Ra:s,fa:n,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return A()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc)),this.pa(n),r=null!=r&&r;const a=t&&!r?this.ya():[],o=0===this.da.size&&this.current&&!r?1:0,l=o!==this.Ea;return this.Ea=o,0!==s.length||l?{snapshot:new $o(this.query,e.Ra,i,s,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Xo,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(e=>this.Ta=this.Ta.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ta=this.Ta.delete(e)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=cr(),this.Ra.forEach(e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))});const t=[];return e.forEach(e=>{this.da.has(e)||t.push(new dl(e))}),this.da.forEach(n=>{e.has(n)||t.push(new ul(n))}),t}ba(e){this.Ta=e.Ts,this.da=cr();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return $o.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class fl{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class pl{constructor(e){this.key=e,this.va=!1}}class ml{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new $n(e=>Wn(e),Hn),this.Ma=new Map,this.xa=new Set,this.Oa=new dt(te.comparator),this.Na=new Map,this.La=new _a,this.Ba={},this.ka=new Map,this.qa=Xs.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function gl(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Ll(e);let i;const s=r.Fa.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await vl(r,t,n,!0),i}async function yl(e,t){const n=Ll(e);await vl(n,t,!0,!1)}async function vl(e,t,n,r){const i=await Qa(e.localStore,Bn(t)),s=i.targetId,a=e.sharedClientState.addLocalQueryTarget(s,n);let o;return r&&(o=await bl(e,t,s,"current"===a,i.resumeToken)),e.isPrimaryClient&&n&&xo(e.remoteStore,i),o}async function bl(e,t,n,r,i){e.Ka=(t,n,r)=>async function(e,t,n,r){let i=t.view.ma(n);i.ns&&(i=await Ja(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ma(n,i)}));const s=r&&r.targetChanges.get(t.targetId),a=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s,a);return jl(e,t.targetId,o.wa),o.snapshot}(e,t,n,r);const s=await Ja(e.localStore,t,!0),a=new hl(t,s.Ts),o=a.ma(s.documents),l=ai.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=a.applyChanges(o,e.isPrimaryClient,l);jl(e,n,c.wa);const u=new fl(t,n,a);return e.Fa.set(t,u),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),c.snapshot}async function wl(e,t,n){const r=P(e),i=r.Fa.get(t),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(e=>!Hn(e,t))),void r.Fa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ya(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&ko(r.remoteStore,i.targetId),Cl(r,i.targetId)}).catch(fe)):(Cl(r,i.targetId),await Ya(r.localStore,i.targetId,!0))}async function xl(e,t){const n=P(e),r=n.Fa.get(t),i=n.Ma.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ko(n.remoteStore,r.targetId))}async function kl(e,t){const n=P(e);try{const e=await function(e,t){const n=P(e),r=t.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const a=[];t.targetChanges.forEach((s,o)=>{const l=i.get(o);if(!l)return;a.push(n.Ur.removeMatchingKeys(e,s.removedDocuments,o).next(()=>n.Ur.addMatchingKeys(e,s.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(bt.EMPTY_BYTE_STRING,J.min()).withLastLimboFreeSnapshotVersion(J.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,s)&&a.push(n.Ur.updateTargetData(e,c))});let o=er(),l=cr();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),a.push(Wa(e,s,t.documentUpdates).next(e=>{o=e.Ps,l=e.Is})),!r.isEqual(J.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next(t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,r));a.push(t)}return pe.waitFor(a).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(n.os=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Na.get(t);r&&(j(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.va=!0:e.modifiedDocuments.size>0?j(r.va):e.removedDocuments.size>0&&(j(r.va),r.va=!1))}),await Rl(n,e,t)}catch(e){await fe(e)}}function _l(e,t,n){const r=P(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Fa.forEach((n,r)=>{const i=r.view.Z_(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=P(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.j_)i.Z_(t)&&(r=!0)}),r&&al(n)}(r.eventManager,t),e.length&&r.Ca.d_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Il(e,t,n){const r=P(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Na.get(t),s=i&&i.key;if(s){let e=new dt(te.comparator);e=e.insert(s,tn.newNoDocument(s,J.min()));const n=cr().add(s),i=new si(J.min(),new Map,new dt(W),e,n);await kl(r,i),r.Oa=r.Oa.remove(s),r.Na.delete(t),Dl(r)}else await Ya(r.localStore,t,!1).then(()=>Cl(r,t,n)).catch(fe)}async function El(e,t){const n=P(e),r=t.batch.batchId;try{const e=await function(e,t){const n=P(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let a=pe.resolve();return s.forEach(e=>{a=a.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);j(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=cr();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);Tl(n,r,null),Nl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Rl(n,e)}catch(e){await fe(e)}}async function Sl(e,t,n){const r=P(e);try{const e=await function(e,t){const n=P(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(j(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Tl(r,t,n),Nl(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Rl(r,e)}catch(n){await fe(n)}}function Nl(e,t){(e.ka.get(t)||[]).forEach(e=>{e.resolve()}),e.ka.delete(t)}function Tl(e,t,n){const r=P(e);let i=r.Ba[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ba[r.currentUser.toKey()]=i}}function Cl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Ma.get(t))e.Fa.delete(r),n&&e.Ca.$a(r,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(t=>{e.La.containsKey(t)||Al(e,t)})}function Al(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(ko(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),Dl(e))}function jl(e,t,n){for(const r of n)r instanceof ul?(e.La.addReference(r.key,t),Pl(e,r)):r instanceof dl?(S("SyncEngine","Document no longer in limbo: "+r.key),e.La.removeReference(r.key,t),e.La.containsKey(r.key)||Al(e,r.key)):A()}function Pl(e,t){const n=t.key,r=n.path.canonicalString();e.Oa.get(n)||e.xa.has(r)||(S("SyncEngine","New document in limbo: "+n),e.xa.add(r),Dl(e))}function Dl(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new te($.fromString(t)),r=e.qa.next();e.Na.set(r,new pl(n)),e.Oa=e.Oa.insert(n,r),xo(e.remoteStore,new Qi(Bn(Ln(n.path)),r,"TargetPurposeLimboResolution",Ne.oe))}}async function Rl(e,t,n){const r=P(e),i=[],s=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((e,o)=>{a.push(r.Ka(o,t,n).then(e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,i?"current":"not-current")}if(e){i.push(e);const t=Ua.Wi(o.targetId,e);s.push(t)}}))}),await Promise.all(a),r.Ca.d_(i),await async function(e,t){const n=P(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>pe.forEach(t,t=>pe.forEach(t.$i,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>pe.forEach(t.Ui,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!we(e))throw e;S("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.os.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.os=n.os.insert(e,i)}}}(r.localStore,s))}async function Ol(e,t){const n=P(e);if(!n.currentUser.isEqual(t)){S("SyncEngine","User change. New user:",t.toKey());const e=await Ka(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach(e=>{e.forEach(e=>{e.reject(new R(D.CANCELLED,t))})}),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Rl(n,e.hs)}}function Ml(e,t){const n=P(e),r=n.Na.get(t);if(r&&r.va)return cr().add(r.key);{let e=cr();const r=n.Ma.get(t);if(!r)return e;for(const t of r){const r=n.Fa.get(t);e=e.unionWith(r.view.Va)}return e}}function Ll(e){const t=P(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=kl.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ml.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Il.bind(null,t),t.Ca.d_=il.bind(null,t.eventManager),t.Ca.$a=sl.bind(null,t.eventManager),t}function Fl(e){const t=P(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=El.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Sl.bind(null,t),t}class Ul{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=uo(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return qa(this.persistence,new Ba,e.initialUser,this.serializer)}Ga(e){return new Ca(ja.Zr,this.serializer)}Wa(e){return new Za}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ul.provider={build:()=>new Ul};class Vl extends Ul{constructor(e,t,n){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Fl(this.Ja.syncEngine),await Oo(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return qa(this.persistence,new Ba,e.initialUser,this.serializer)}ja(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new ia(n,e.asyncQueue,t)}Ha(e,t){const n=new Se(t,this.persistence);return new Ee(e.asyncQueue,n)}Ga(e){const t=Fa(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?qs.withCacheSize(this.cacheSizeBytes):qs.DEFAULT;return new Oa(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,lo(),co(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new Za}}class Bl{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>_l(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ol.bind(null,this.syncEngine),await Ho(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new el}createDatastore(e){const t=uo(e.databaseInfo.databaseId),n=function(e){return new oo(e)}(e.databaseInfo);return function(e,t,n,r){return new go(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new vo(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>_l(this.syncEngine,e,0),to.D()?new to:new eo)}createSyncEngine(e,t){return function(e,t,n,r,i,s,a){const o=new ml(e,t,n,r,i,s);return a&&(o.Qa=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=P(e);S("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await wo(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Bl.provider={build:()=>new Bl};class zl{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):N("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class ql{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=k.UNAUTHENTICATED,this.clientId=H.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{S("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(S("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new O;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Yo(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Kl(e,t){e.asyncQueue.verifyOperationInProgress(),S("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Ka(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Hl(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Wl(e);S("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Ko(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Ko(t.remoteStore,n)),e._onlineComponents=t}async function Wl(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){S("FirestoreClient","Using user provided OfflineComponentProvider");try{await Kl(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===D.FAILED_PRECONDITION||e.code===D.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;T("Error using user provided cache. Falling back to memory cache: "+n),await Kl(e,new Ul)}}else S("FirestoreClient","Using default OfflineComponentProvider"),await Kl(e,new Ul);return e._offlineComponents}async function Gl(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(S("FirestoreClient","Using user provided OnlineComponentProvider"),await Hl(e,e._uninitializedComponentsProvider._online)):(S("FirestoreClient","Using default OnlineComponentProvider"),await Hl(e,new Bl))),e._onlineComponents}function Ql(e){return Gl(e).then(e=>e.syncEngine)}async function Yl(e){const t=await Gl(e),n=t.eventManager;return n.onListen=gl.bind(null,t.syncEngine),n.onUnlisten=wl.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=yl.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=xl.bind(null,t.syncEngine),n}function Jl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new O;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new zl({next:o=>{s.Za(),t.enqueueAndForget(()=>rl(e,a));const l=o.docs.has(n);!l&&o.fromCache?i.reject(new R(D.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&r&&"server"===r.source?i.reject(new R(D.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:e=>i.reject(e)}),a=new cl(Ln(n.path),s,{includeMetadataChanges:!0,_a:!0});return nl(e,a)}(await Yl(e),e.asyncQueue,t,n,r)),r.promise}function Xl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new O;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new zl({next:n=>{s.Za(),t.enqueueAndForget(()=>rl(e,a)),n.fromCache&&"server"===r.source?i.reject(new R(D.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),a=new cl(n,s,{includeMetadataChanges:!0,_a:!0});return nl(e,a)}(await Yl(e),e.asyncQueue,t,n,r)),r.promise}function $l(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Zl=new Map;function ec(e,t,n){if(!n)throw new R(D.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function tc(e){if(!te.isDocumentKey(e))throw new R(D.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function nc(e){if(te.isDocumentKey(e))throw new R(D.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function rc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":A()}function ic(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new R(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=rc(e);throw new R(D.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function sc(e,t){if(t<=0)throw new R(D.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}class ac{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new R(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new R(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new R(D.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$l(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new R(D.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new R(D.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new R(D.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class oc{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ac({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new R(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new R(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ac(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new L;switch(e.type){case"firstParty":return new B(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new R(D.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Zl.get(e);t&&(S("ComponentProvider","Removing Datastore"),Zl.delete(e),t.terminate())}(this),Promise.resolve()}}class lc{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new lc(this.firestore,e,this._query)}}class cc{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new uc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new cc(this.firestore,e,this._key)}}class uc extends lc{constructor(e,t,n){super(e,t,Ln(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new cc(this.firestore,null,new te(e))}withConverter(e){return new uc(this.firestore,e,this._path)}}function dc(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=(0,l.Ku)(e),ec("collection","path",t),e instanceof oc){const n=$.fromString(t,...r);return nc(n),new uc(e,null,n)}{if(!(e instanceof cc||e instanceof uc))throw new R(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child($.fromString(t,...r));return nc(n),new uc(e.firestore,null,n)}}function hc(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=(0,l.Ku)(e),1===arguments.length&&(t=H.newId()),ec("doc","path",t),e instanceof oc){const n=$.fromString(t,...r);return tc(n),new cc(e,null,new te(n))}{if(!(e instanceof cc||e instanceof uc))throw new R(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child($.fromString(t,...r));return tc(n),new cc(e.firestore,e instanceof uc?e.converter:null,new te(n))}}class fc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new ho(this,"async_queue_retry"),this.Vu=()=>{const e=co();e&&S("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=co();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=co();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new O;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!we(e))throw e;S("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw N("INTERNAL UNHANDLED ERROR: ",t),e}).then(e=>(this.du=!1,e))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=Qo.createAndSchedule(this,e,t,n,e=>this.yu(e));return this.Tu.push(r),r}fu(){this.Eu&&A()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function pc(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class mc extends oc{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new fc,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new fc(e),this._firestoreClient=void 0,await e}}}function gc(e,t){const n="object"==typeof e?e:(0,s.Sx)(),r="string"==typeof e?e:t||"(default)",i=(0,s.j6)(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=(0,l.yU)("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(e=ic(e,oc))._getSettings(),a="".concat(t,":").concat(n);if("firestore.googleapis.com"!==s.host&&s.host!==a&&T("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=k.MOCK_USER;else{t=(0,l.Fy)(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new R(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new k(s)}e._authCredentials=new F(new M(t,n))}}(i,...e)}return i}function yc(e){if(e._terminated)throw new R(D.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||vc(e),e._firestoreClient}function vc(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new Nt(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,$l(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new ql(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function bc(e,t){T("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings();return wc(e,Bl.provider,{build:e=>new Vl(e,n.cacheSizeBytes,null==t?void 0:t.forceOwnership)}),Promise.resolve()}function wc(e,t,n){if((e=ic(e,mc))._firestoreClient||e._terminated)throw new R(D.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new R(D.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},vc(e)}class xc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xc(bt.fromBase64String(e))}catch(e){throw new R(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new xc(bt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class kc{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new R(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ee(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class _c{constructor(e){this._methodName=e}}class Ic{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new R(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new R(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return W(this._lat,e._lat)||W(this._long,e._long)}}class Ec{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const Sc=/^__.*__$/;class Nc{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Fr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Lr(e,this.data,t,this.fieldTransforms)}}class Tc{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Fr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Cc(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw A()}}class Ac{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Ac(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.Ou(e),r}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Yc(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(Cc(this.Cu)&&Sc.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class jc{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||uo(e)}Qu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Ac({Cu:e,methodName:t,qu:n,path:ee.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pc(e){const t=e._freezeSettings(),n=uo(e._databaseId);return new jc(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Dc(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=e.Qu(s.merge||s.mergeFields?2:0,t,n,i);Hc("Data must be an object, but it was:",a,r);const o=qc(r,a);let l,c;if(s.merge)l=new yt(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Wc(t,r,n);if(!a.contains(i))throw new R(D.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));Jc(e,i)||e.push(i)}l=new yt(e),c=a.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=a.fieldTransforms;return new Nc(new Zt(o),l,c)}class Rc extends _c{_toFieldTransform(e){if(2!==e.Cu)throw 1===e.Cu?e.Bu("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Bu("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rc}}function Oc(e,t,n){return new Ac({Cu:3,qu:t.settings.qu,methodName:e._methodName,xu:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class Mc extends _c{_toFieldTransform(e){return new Nr(e.path,new br)}isEqual(e){return e instanceof Mc}}class Lc extends _c{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=Oc(this,e,!0),n=this.Ku.map(e=>zc(e,t)),r=new wr(n);return new Nr(e.path,r)}isEqual(e){return e instanceof Lc&&(0,l.bD)(this.Ku,e.Ku)}}class Fc extends _c{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Ir(e.serializer,pr(e.serializer,this.$u));return new Nr(e.path,t)}isEqual(e){return e instanceof Fc&&this.$u===e.$u}}function Uc(e,t,n,r){const i=e.Qu(1,t,n);Hc("Data must be an object, but it was:",i,r);const s=[],a=Zt.empty();ct(r,(e,r)=>{const o=Qc(t,e,n);r=(0,l.Ku)(r);const c=i.Nu(o);if(r instanceof Rc)s.push(o);else{const e=zc(r,c);null!=e&&(s.push(o),a.set(o,e))}});const o=new yt(s);return new Tc(a,o,i.fieldTransforms)}function Vc(e,t,n,r,i,s){const a=e.Qu(1,t,n),o=[Wc(t,r,n)],c=[i];if(s.length%2!=0)throw new R(D.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let l=0;l<s.length;l+=2)o.push(Wc(t,s[l])),c.push(s[l+1]);const u=[],d=Zt.empty();for(let f=o.length-1;f>=0;--f)if(!Jc(u,o[f])){const e=o[f];let t=c[f];t=(0,l.Ku)(t);const n=a.Nu(e);if(t instanceof Rc)u.push(e);else{const r=zc(t,n);null!=r&&(u.push(e),d.set(e,r))}}const h=new yt(u);return new Tc(d,h,a.fieldTransforms)}function Bc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return zc(n,e.Qu(r?4:3,t))}function zc(e,t){if(Kc(e=(0,l.Ku)(e)))return Hc("Unsupported field value:",t,e),qc(e,t);if(e instanceof _c)return function(e,t){if(!Cc(t.Cu))throw t.Bu("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Bu("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=zc(i,t.Lu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,l.Ku)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return pr(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Y.fromDate(e);return{timestampValue:bi(t.serializer,n)}}if(e instanceof Y){const n=new Y(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:bi(t.serializer,n)}}if(e instanceof Ic)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof xc)return{bytesValue:wi(t.serializer,e._byteString)};if(e instanceof cc){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Bu("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:_i(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Ec)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return hr(t.serializer,e)})}}}}}}(e,t);throw t.Bu("Unsupported field value: ".concat(rc(e)))}(e,t)}function qc(e,t){const n={};return ut(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ct(e,(e,r)=>{const i=zc(r,t.Mu(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function Kc(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Y||e instanceof Ic||e instanceof xc||e instanceof cc||e instanceof _c||e instanceof Ec)}function Hc(e,t,n){if(!Kc(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=rc(n);throw"an object"===r?t.Bu(e+" a custom object"):t.Bu(e+" "+r)}}function Wc(e,t,n){if((t=(0,l.Ku)(t))instanceof kc)return t._internalPath;if("string"==typeof t)return Qc(e,t);throw Yc("Field path arguments must be of type string or ",e,!1,void 0,n)}const Gc=new RegExp("[~\\*/\\[\\]]");function Qc(e,t,n){if(t.search(Gc)>=0)throw Yc("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new kc(...t.split("."))._internalPath}catch(r){throw Yc("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Yc(e,t,n,r,i){const s=r&&!r.isEmpty(),a=void 0!==i;let o="Function ".concat(t,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=" in field ".concat(r)),a&&(l+=" in document ".concat(i)),l+=")"),new R(D.INVALID_ARGUMENT,o+e+l)}function Jc(e,t){return e.some(e=>e.isEqual(t))}class Xc{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new cc(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new $c(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Zc("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class $c extends Xc{data(){return super.data()}}function Zc(e,t){return"string"==typeof t?Qc(e,t):t instanceof kc?t._internalPath:t._delegate._internalPath}function eu(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new R(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class tu{}class nu extends tu{}function ru(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof tu&&n.push(t),n=n.concat(i),function(e){const t=e.filter(e=>e instanceof au).length,n=e.filter(e=>e instanceof iu).length;if(t>1||t>0&&n>0)throw new R(D.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)e=a._apply(e);return e}class iu extends nu{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new iu(e,t,n)}_apply(e){const t=this._parse(e);return gu(e._query,t),new lc(e.firestore,e.converter,qn(e._query,t))}_parse(e){const t=Pc(e.firestore),n=function(e,t,n,r,i,s,a){let o;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new R(D.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){mu(a,s);const t=[];for(const n of a)t.push(pu(r,e,n));o={arrayValue:{values:t}}}else o=pu(r,e,a)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||mu(a,s),o=Bc(n,t,a,"in"===s||"not-in"===s);return cn.create(i,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function su(e,t,n){const r=t,i=Zc("where",e);return iu._create(i,r,n)}class au extends tu{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new au(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:un.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)gu(n,i),n=qn(n,i)}(e._query,t),new lc(e.firestore,e.converter,qn(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class ou extends nu{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new ou(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new R(D.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new R(D.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new an(t,n)}(e._query,this._field,this._direction);return new lc(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new On(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function lu(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Zc("orderBy",e);return ou._create(n,t)}class cu extends nu{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new cu(e,t,n)}_apply(e){return new lc(e.firestore,e.converter,Kn(e._query,this._limit,this._limitType))}}function uu(e){return sc("limit",e),cu._create("limit",e,"F")}class du extends nu{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new du(e,t,n)}_apply(e){const t=fu(e,this.type,this._docOrFields,this._inclusive);return new lc(e.firestore,e.converter,function(e,t){return new On(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}function hu(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return du._create("startAfter",t,!1)}function fu(e,t,n,r){if(n[0]=(0,l.Ku)(n[0]),n[0]instanceof Xc)return function(e,t,n,r,i){if(!r)throw new R(D.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));const s=[];for(const a of Vn(e))if(a.field.isKeyField())s.push(Ut(t,r.key));else{const e=r.data.field(a.field);if(It(e))throw new R(D.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=a.field.canonicalString();throw new R(D.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(e,"' (used as the orderBy) does not exist."))}s.push(e)}return new nn(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=Pc(e.firestore);return function(e,t,n,r,i,s){const a=e.explicitOrderBy;if(i.length>a.length)throw new R(D.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));const o=[];for(let l=0;l<i.length;l++){const s=i[l];if(a[l].field.isKeyField()){if("string"!=typeof s)throw new R(D.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof s));if(!Un(e)&&-1!==s.indexOf("/"))throw new R(D.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(s,"' contains a slash."));const n=e.path.child($.fromString(s));if(!te.isDocumentKey(n))throw new R(D.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(n,"' is not because it contains an odd number of segments."));const i=new te(n);o.push(Ut(t,i))}else{const e=Bc(n,r,s);o.push(e)}}return new nn(o,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function pu(e,t,n){if("string"==typeof(n=(0,l.Ku)(n))){if(""===n)throw new R(D.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Un(t)&&-1!==n.indexOf("/"))throw new R(D.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child($.fromString(n));if(!te.isDocumentKey(r))throw new R(D.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Ut(e,new te(r))}if(n instanceof cc)return Ut(e,n._key);throw new R(D.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(rc(n),"."))}function mu(e,t){if(!Array.isArray(e)||0===e.length)throw new R(D.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function gu(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new R(D.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new R(D.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class yu{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(jt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return kt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_t(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw A()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return ct(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(e=>kt(e.doubleValue));return new Ec(i)}convertGeoPoint(e){return new Ic(kt(e.latitude),kt(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Et(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(St(e));default:return null}}convertTimestamp(e){const t=xt(e);return new Y(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=$.fromString(e);j(Gi(n));const r=new Tt(n.get(1),n.get(3)),i=new te(n.popFirst(5));return r.isEqual(t)||N("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function vu(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class bu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wu extends Xc{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new xu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Zc("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class xu extends wu{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class ku{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new bu(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new xu(this._firestore,this._userDataWriter,n.key,n,new bu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new R(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new xu(e._firestore,e._userDataWriter,n.doc.key,n.doc,new bu(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new xu(e._firestore,e._userDataWriter,t.doc.key,t.doc,new bu(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:_u(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function _u(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return A()}}function Iu(e){e=ic(e,cc);const t=ic(e.firestore,mc);return Jl(yc(t),e._key).then(n=>Du(t,e,n))}class Eu extends yu{constructor(e){super(),this.firestore=e}convertBytes(e){return new xc(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new cc(this.firestore,null,t)}}function Su(e){e=ic(e,lc);const t=ic(e.firestore,mc),n=yc(t),r=new Eu(t);return eu(e._query),Xl(n,e._query).then(n=>new ku(t,r,e,n))}function Nu(e,t,n){e=ic(e,cc);const r=ic(e.firestore,mc),i=vu(e.converter,t,n);return Pu(r,[Dc(Pc(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Cr.none())])}function Tu(e,t,n){e=ic(e,cc);const r=ic(e.firestore,mc),i=Pc(r);let s;for(var a=arguments.length,o=new Array(a>3?a-3:0),c=3;c<a;c++)o[c-3]=arguments[c];return s="string"==typeof(t=(0,l.Ku)(t))||t instanceof kc?Vc(i,"updateDoc",e._key,t,n,o):Uc(i,"updateDoc",e._key,t),Pu(r,[s.toMutation(e._key,Cr.exists(!0))])}function Cu(e){return Pu(ic(e.firestore,mc),[new zr(e._key,Cr.none())])}function Au(e,t){const n=ic(e.firestore,mc),r=hc(e),i=vu(e.converter,t);return Pu(n,[Dc(Pc(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Cr.exists(!1))]).then(()=>r)}function ju(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s,a;e=(0,l.Ku)(e);let o={includeMetadataChanges:!1,source:"default"},c=0;"object"!=typeof n[c]||pc(n[c])||(o=n[c],c++);const u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(pc(n[c])){const e=n[c];n[c]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[c+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[c+2]=null===(a=e.complete)||void 0===a?void 0:a.bind(e)}let d,h,f;if(e instanceof cc)h=ic(e.firestore,mc),f=Ln(e._key.path),d={next:t=>{n[c]&&n[c](Du(h,e,t))},error:n[c+1],complete:n[c+2]};else{const t=ic(e,lc);h=ic(t.firestore,mc),f=t._query;const r=new Eu(h);d={next:e=>{n[c]&&n[c](new ku(h,r,t,e))},error:n[c+1],complete:n[c+2]},eu(e._query)}return function(e,t,n,r){const i=new zl(r),s=new cl(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>nl(await Yl(e),s)),()=>{i.Za(),e.asyncQueue.enqueueAndForget(async()=>rl(await Yl(e),s))}}(yc(h),f,u,d)}function Pu(e,t){return function(e,t){const n=new O;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=Fl(e);try{const e=await function(e,t){const n=P(e),r=Y.now(),i=t.reduce((e,t)=>e.add(t.key),cr());let s,a;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=er(),l=cr();return n.cs.getEntries(e,i).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,o)).next(i=>{s=i;const a=[];for(const e of t){const t=Or(e,s.get(e.key).overlayedDocument);null!=t&&a.push(new Fr(e.key,t,en(t.value.mapValue),Cr.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,a,t)}).next(t=>{a=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:a.batchId,changes:rr(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ba[e.currentUser.toKey()];r||(r=new dt(W)),r=r.insert(t,n),e.Ba[e.currentUser.toKey()]=r}(r,e.batchId,n),await Rl(r,e.changes),await Oo(r.remoteStore)}catch(e){const t=Yo(e,"Failed to persist write");n.reject(t)}}(await Ql(e),t,n)),n.promise}(yc(e),t)}function Du(e,t,n){const r=n.docs.get(t._key),i=new Eu(e);return new wu(e,i,t._key,r,new bu(n.hasPendingWrites,n.fromCache),t.converter)}function Ru(){return new Mc("serverTimestamp")}function Ou(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Lc("arrayUnion",t)}function Mu(e){return new Fc("increment",e)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){_=e}(s.MF),(0,s.om)(new a.uA("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),a=new mc(new U(e.getProvider("auth-internal")),new q(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new R(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Tt(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),(0,s.KO)(x,"4.7.3",e),(0,s.KO)(x,"4.7.3","esm2017")}()},5979:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(5043),i=n(579);const s=e=>{let{message:t}=e;const[n,s]=(0,r.useState)(!1),[a,o]=(0,r.useState)("left"),l=(0,r.useRef)(null),c=(0,r.useRef)(null);(0,r.useEffect)(()=>{const e=e=>{!c.current||c.current.contains(e.target)||l.current.contains(e.target)||s(!1)};if(n)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[n]),(0,r.useEffect)(()=>{if(n&&l.current){const e=l.current.getBoundingClientRect(),t=window.innerWidth,n=200;e.left+n>t-20?o("right"):o("left")}},[n]);return(0,i.jsxs)("div",{className:"relative inline-block ml-2",children:[(0,i.jsx)("button",{ref:l,type:"button",onClick:e=>{e.stopPropagation(),s(!n)},className:"text-primary dark:text-purple-400 hover:text-pink-600 dark:hover:text-pink-400 transition-colors",title:"Learn more",children:(0,i.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),n&&(0,i.jsx)("div",{ref:c,className:"absolute ".concat("right"===a?"right-0":"left-0"," top-full mt-2 z-50 animate-scale-up"),style:{minWidth:"160px",maxWidth:"200px"},children:(0,i.jsxs)("div",{className:"bg-white dark:bg-gray-800 bg-opacity-100 dark:bg-opacity-100 rounded-lg shadow-xl border-2 border-primary dark:border-purple-400 p-2.5",children:[(0,i.jsxs)("div",{className:"flex items-start gap-1.5",children:[(0,i.jsx)("span",{className:"text-sm flex-shrink-0",children:"\u2139\ufe0f"}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("p",{className:"text-xs text-gray-900 dark:text-gray-100 leading-snug font-medium",children:t}),(0,i.jsx)("button",{onClick:()=>s(!1),className:"mt-1.5 text-primary dark:text-purple-400 text-xs font-semibold underline hover:no-underline",children:"Got it!"})]})]}),(0,i.jsx)("div",{className:"absolute bottom-full ".concat("right"===a?"right-3":"left-3"," w-0 h-0 border-l-6 border-r-6 border-b-6 border-transparent border-b-primary dark:border-b-purple-400")})]})})]})}},6815:(e,t,n)=>{n.d(t,{F6:()=>a,Nw:()=>s,my:()=>r,w4:()=>i});Math.pow(10,8);const r=6048e5,i=864e5,s=43200,a=1440},7234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function x(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,D(k);else{var t=r(u);null!==t&&R(x,t.startTime-e)}}function k(e,n){m=!1,g&&(g=!1,v(S),S=-1),p=!0;var s=f;try{for(w(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!C());){var a=h.callback;if("function"===typeof a){h.callback=null,f=h.priorityLevel;var o=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&i(c),w(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&R(x,d.startTime-n),l=!1}return l}finally{h=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,I=!1,E=null,S=-1,N=5,T=-1;function C(){return!(t.unstable_now()-T<N)}function A(){if(null!==E){var e=t.unstable_now();T=e;var n=!0;try{n=E(!0,e)}finally{n?_():(I=!1,E=null)}}else I=!1}if("function"===typeof b)_=function(){b(A)};else if("undefined"!==typeof MessageChannel){var j=new MessageChannel,P=j.port2;j.port1.onmessage=A,_=function(){P.postMessage(null)}}else _=function(){y(A,0)};function D(e){E=e,I||(I=!0,_())}function R(e,n){S=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,D(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(v(S),S=-1):g=!0,R(x,s-a))):(e.sortIndex=o,n(c,e),m||p||(m=!0,D(k))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},7329:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(3984),i=n(5472),s=n(2339),a=n(579);const o="BPXtVOACRBaCM1AtO7sUvFGfc7_nzwvZPVh4BRDCth2-c8a_FI7_l-jszYjgtSnw_f2pJ5OAo9CgnBIUClpPm3s";const l=new class{constructor(){this.initialized=!1,this.token=null}isSupported(){return"Notification"in window&&"serviceWorker"in navigator&&"PushManager"in window}getPermissionStatus(){return this.isSupported()?Notification.permission:"unsupported"}async requestPermission(){if(!this.isSupported())throw new Error("Push notifications are not supported in this browser");if("granted"===Notification.permission)return!0;if("denied"===Notification.permission)throw new Error("PERMISSION_DENIED");try{return"granted"===await Notification.requestPermission()}catch(e){throw console.error("Permission request error:",e),new Error("PERMISSION_BLOCKED")}}async initializeServiceWorker(){if(!("serviceWorker"in navigator))return console.warn("Service Worker not supported"),null;try{const e=await navigator.serviceWorker.register("/firebase-messaging-sw.js");if(console.log("Service Worker registered:",e),await navigator.serviceWorker.ready,e.active){const t={apiKey:"AIzaSyBcyjovZATPYqCN4yQNM99DTQ2K0dWcVyo",authDomain:"bestiesapp.firebaseapp.com",projectId:"bestiesapp",storageBucket:"bestiesapp.firebasestorage.app",messagingSenderId:"816425843858",appId:"1:816425843858:web:60eaaa2ddd094b6e797a4b"};e.active.postMessage({type:"INIT_FIREBASE",config:t,vapidKey:o}),console.log("Sent Firebase config to service worker")}return e}catch(e){return console.error("Service Worker registration failed:",e),null}}async getToken(){try{0;const t=await this.initializeServiceWorker();if(!t)return console.error("Could not register service worker"),s.Ay.error("Service worker registration failed. Check browser console for details.",{duration:6e3}),null;await navigator.serviceWorker.ready,await new Promise(e=>setTimeout(e,2e3));try{const e=await(0,r.getToken)(r.messaging,{vapidKey:o,serviceWorkerRegistration:t});return e?(console.log("FCM Token obtained:",e),this.token=e,e):(console.warn("No FCM token available. This might be a permission or configuration issue."),s.Ay.error("Could not get FCM token. Check browser console and ensure notifications are allowed.",{duration:6e3}),null)}catch(e){return console.error("Error getting FCM token:",e),"messaging/permission-blocked"===e.code?s.Ay.error("Notification permission is blocked. Please enable in browser settings.",{duration:6e3}):"messaging/registration-token-not-found"===e.code?s.Ay.error("Service worker not ready. Please refresh the page and try again.",{duration:6e3}):s.Ay.error("Push notification error: ".concat(e.message),{duration:6e3}),null}}catch(t){return console.error("Error getting FCM token:",t),s.Ay.error("Failed to get push notification token: ".concat(t.message),{duration:6e3}),null}}async saveTokenToFirestore(e){try{const t=r.auth.currentUser;return t?(await(0,i.mZ)((0,i.H9)(r.db,"users",t.uid),{fcmToken:e,notificationsEnabled:!0,lastTokenUpdate:new Date}),console.log("FCM token saved to Firestore"),!0):(console.warn("No user logged in to save token"),!1)}catch(t){return console.error("Error saving FCM token:",t),!1}}async enableNotifications(){try{if(!this.isSupported())return s.Ay.error("Push notifications are not supported in your browser"),!1;try{if(!await this.requestPermission())return s.Ay.error("Notification permission denied. Please enable notifications in your browser settings."),!1}catch(e){if("PERMISSION_DENIED"===e.message)return s.Ay.error("Push notifications are blocked. Go to your browser settings to enable them.",{duration:6e3}),!1;if("PERMISSION_BLOCKED"===e.message)return s.Ay.error("Could not request notification permission. Please enable notifications in your browser settings.",{duration:6e3}),!1;throw e}const t=await this.getToken();if(!t)return s.Ay.error("Could not get notification token"),!1;return await this.saveTokenToFirestore(t)?(this.setupForegroundListener(),this.initialized=!0,s.Ay.success("Push notifications enabled!"),!0):(s.Ay.error("Could not save notification settings"),!1)}catch(e){return console.error("Error enabling notifications:",e),s.Ay.error("Failed to enable notifications"),!1}}async disableNotifications(){try{const e=r.auth.currentUser;return!!e&&(await(0,i.mZ)((0,i.H9)(r.db,"users",e.uid),{notificationsEnabled:!1,fcmToken:null}),this.token=null,this.initialized=!1,s.Ay.success("Push notifications disabled"),!0)}catch(e){return console.error("Error disabling notifications:",e),s.Ay.error("Failed to disable notifications"),!1}}setupForegroundListener(){(0,r.onMessage)(r.messaging,e=>{console.log("Foreground message received:",e);const{title:t,body:n,icon:r}=e.notification||{};s.Ay.custom(e=>(0,a.jsxs)("div",{className:"".concat(e.visible?"animate-enter":"animate-leave"," max-w-md w-full bg-white shadow-lg rounded-lg pointer-events-auto flex ring-1 ring-black ring-opacity-5"),children:[(0,a.jsx)("div",{className:"flex-1 w-0 p-4",children:(0,a.jsxs)("div",{className:"flex items-start",children:[r&&(0,a.jsx)("div",{className:"flex-shrink-0 pt-0.5",children:(0,a.jsx)("img",{className:"h-10 w-10 rounded-full",src:r,alt:""})}),(0,a.jsxs)("div",{className:"ml-3 flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:t}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:n})]})]})}),(0,a.jsx)("div",{className:"flex border-l border-gray-200",children:(0,a.jsx)("button",{onClick:()=>s.Ay.dismiss(e.id),className:"w-full border border-transparent rounded-none rounded-r-lg p-4 flex items-center justify-center text-sm font-medium text-primary hover:text-primary/80 focus:outline-none",children:"Close"})})]}),{duration:6e3,position:"top-right"}),"Notification"in window&&"granted"===Notification.permission&&new Notification(t,{body:n,icon:r||"/logo192.png",badge:"/logo192.png",tag:"besties-notification",requireInteraction:!1})})}async sendTestNotification(){return"Notification"in window&&"granted"===Notification.permission&&(new Notification("Besties Test Notification",{body:"Push notifications are working!",icon:"/logo192.png",badge:"/logo192.png"}),!0)}}},7688:(e,t,n)=>{n.d(t,{Ay:()=>s});var r=n(5043),i=n(2339);const s=()=>{const[e,t]=(0,r.useState)(!1),n=(0,r.useRef)(null),s=(0,r.useCallback)(async r=>{let{optimisticUpdate:s,serverUpdate:a,onSuccess:o,onError:l,rollback:c,successMessage:u,errorMessage:d="Something went wrong. Please try again.",showLoadingToast:h=!1,loadingMessage:f="Processing...",skipSuccessToast:p=!1}=r;if(e)return console.warn("Request already in progress"),{success:!1,error:"Request in progress"};t(!0);let m=null;n.current=new AbortController;try{s&&s(),h&&(m=i.Ay.loading(f));const e=await a();return o&&o(e),u&&!p?m?i.Ay.success(u,{id:m}):i.Ay.success(u):m&&i.Ay.dismiss(m),t(!1),{success:!0,data:e}}catch(g){0,c&&c(),l&&l(g);const e=g.message||d;return m?i.Ay.error(e,{id:m}):i.Ay.error(e),t(!1),{success:!1,error:e}}},[e]),a=(0,r.useCallback)(()=>{n.current&&n.current.abort(),t(!1)},[]);return{executeOptimistic:s,isProcessing:e,cancel:a}}},7700:(e,t,n)=>{n.d(t,{Am:()=>P,FA:()=>N,Fy:()=>m,I9:()=>D,Im:()=>C,Ku:()=>q,T9:()=>h,Tj:()=>u,Uj:()=>a,XA:()=>f,ZQ:()=>g,bD:()=>A,c1:()=>v,cY:()=>p,dM:()=>E,eX:()=>I,g:()=>S,hp:()=>R,jZ:()=>y,lT:()=>x,lV:()=>w,nr:()=>k,p9:()=>z,sr:()=>b,tD:()=>O,u:()=>o,yU:()=>d,zW:()=>_});const r=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,a=s?e[i+1]:0,o=i+2<e.length,l=o?e[i+2]:0,c=t>>2,u=(3&t)<<4|a>>4;let d=(15&a)<<2|l>>6,h=63&l;o||(h=64,s||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(r(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const l=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==a||null==o||null==l)throw new s;const c=t<<2|a>>4;if(r.push(c),64!==o){const e=a<<4&240|o>>2;if(r.push(e),64!==l){const e=o<<6&192|l;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class s extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a=function(e){return function(e){const t=r(e);return i.encodeByteArray(t,!0)}(e).replace(/\./g,"")},o=function(e){try{return i.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const l=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,c=()=>{try{return l()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyBcyjovZATPYqCN4yQNM99DTQ2K0dWcVyo",REACT_APP_FIREBASE_APP_ID:"1:816425843858:web:60eaaa2ddd094b6e797a4b",REACT_APP_FIREBASE_AUTH_DOMAIN:"bestiesapp.firebaseapp.com",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-6E24DQXPHX",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"816425843858",REACT_APP_FIREBASE_PROJECT_ID:"bestiesapp",REACT_APP_FIREBASE_STORAGE_BUCKET:"bestiesapp.firebasestorage.app",REACT_APP_FIREBASE_VAPID_KEY:"BPXtVOACRBaCM1AtO7sUvFGfc7_nzwvZPVh4BRDCth2-c8a_FI7_l-jszYjgtSnw_f2pJ5OAo9CgnBIUClpPm3s",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyBIotp3fl0_9y7xbyPUI79hsZR9Cw3g4l4",REACT_APP_STRIPE_PUBLISHABLE_KEY:"pk_live_51SR1CfEelNu8QcRAALMompJfse2B7tXODHYIpbcRcawyAN3fMi75mMAXpTyP66c444ydSE0Y01yczaw64TgyKW85005IvwbRX2"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&o(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},u=e=>{var t,n;return null===(n=null===(t=c())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},d=e=>{const t=u(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},h=()=>{var e;return null===(e=c())||void 0===e?void 0:e.config},f=e=>{var t;return null===(t=c())||void 0===t?void 0:t["_".concat(e)]};class p{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function m(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[a(JSON.stringify({alg:"none",type:"JWT"})),a(JSON.stringify(s)),""].join(".")}function g(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function y(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())}function v(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function b(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function w(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function x(){const e=g();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function k(){return!function(){var e;const t=null===(e=c())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _(){try{return"object"===typeof indexedDB}catch(e){return!1}}function I(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}function E(){return!("undefined"===typeof navigator||!navigator.cookieEnabled)}class S extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,S.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,N.prototype.create)}}class N{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(T,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new S(n,s,t)}}const T=/\{\$([^}]+)}/g;function C(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function A(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(j(n)&&j(s)){if(!A(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function j(e){return null!==e&&"object"===typeof e}function P(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function D(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function R(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function O(e,t){const n=new M(e,t);return n.subscribe.bind(n)}class M{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=L),void 0===r.error&&(r.error=L),void 0===r.complete&&(r.complete=L);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function L(){}const F=1e3,U=2,V=144e5,B=.5;function z(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:F)*Math.pow(t,e),r=Math.round(B*n*(Math.random()-.5)*2);return Math.min(V,n+r)}function q(e){return e&&e._delegate?e._delegate:e}},7766:(e,t,n)=>{n.d(t,{A:()=>i});n(5043);var r=n(579);const i=e=>{var t;let{photoURL:n,name:i,requestAttention:s,size:a="md",className:o="",showBubble:l=!0}=e;const c={sm:"w-8 h-8 text-xs",md:"w-10 h-10 text-sm",lg:"w-12 h-12 text-base",xl:"w-16 h-16 text-lg"},u={sm:"text-xs px-2 py-1",md:"text-xs px-2 py-1",lg:"text-sm px-3 py-1",xl:"text-sm px-3 py-2"},d=c[a]||c.md,h=u[a]||u.md,f=l&&(null===s||void 0===s?void 0:s.active)&&(null===s||void 0===s?void 0:s.tag);return(0,r.jsxs)("div",{className:"relative inline-block ".concat(o),children:[n?(0,r.jsx)("img",{src:n,alt:i,className:"".concat(d," rounded-full object-cover ring-2 ring-white shadow-md"),onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}):null,(0,r.jsx)("div",{className:"".concat(d," bg-gradient-primary rounded-full flex items-center justify-center text-white font-display ring-2 ring-white shadow-md"),style:{display:n?"none":"flex"},children:(null===i||void 0===i||null===(t=i[0])||void 0===t?void 0:t.toUpperCase())||"?"}),f&&(0,r.jsx)("div",{className:"absolute -top-2 -right-2 z-10 animate-bounce-slow max-w-[calc(100vw-4rem)] sm:max-w-none",children:(0,r.jsxs)("div",{className:"bg-purple-500 text-white rounded-full ".concat(h," font-semibold shadow-lg relative"),style:{maxWidth:"min(200px, calc(100vw - 2rem))",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[(0,r.jsx)("span",{className:"block truncate",children:s.tag}),(0,r.jsx)("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-l-transparent border-r-4 border-r-transparent border-t-4 border-t-purple-500"})]})})]})}},7950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},8147:(e,t,n)=>{n.d(t,{XR:()=>Ee,qk:()=>Ie,c7:()=>Ne,KR:()=>Se,D:()=>_e});var r=n(52),i=n(7700),s=n(8812);const a="firebasestorage.googleapis.com",o="storageBucket";class l extends i.g{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(d(e),"Firebase Storage: ".concat(t," (").concat(d(e),")")),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,l.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return d(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}var c,u;function d(e){return"storage/"+e}function h(){return new l(c.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function f(){return new l(c.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function p(){return new l(c.CANCELED,"User canceled the upload/download.")}function m(){return new l(c.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function g(e){return new l(c.INVALID_ARGUMENT,e)}function y(){return new l(c.APP_DELETED,"The Firebase app was deleted.")}function v(e,t){return new l(c.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function b(e){throw new l(c.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(c||(c={}));class w{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=w.makeFromUrl(e,t)}catch(i){return new w(e,"")}if(""===n.path)return n;throw r=e,new l(c.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),u=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(o,"/").concat("v[A-Za-z0-9_]+","/b/").concat(r,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp("^https?://".concat(t===a?"(?:storage.googleapis.com|storage.cloud.google.com)":t,"/").concat(r,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:s}];for(let a=0;a<u.length;a++){const t=u[a],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let i=r[t.indices.path];i||(i=""),n=new w(e,i),t.postModify(n);break}}if(null==n)throw function(e){return new l(c.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class x{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function k(e){return"string"===typeof e||e instanceof String}function _(e){return I()&&e instanceof Blob}function I(){return"undefined"!==typeof Blob}function E(e,t,n,r){if(r<t)throw g("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw g("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function S(e,t,n){let r=t;return null==n&&(r="https://".concat(t)),"".concat(n,"://").concat(r,"/v0").concat(e)}function N(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function T(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(u||(u={}));class C{constructor(e,t,n,r,i,s,a,o,l,c,u){let d=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=a,this.errorCallback_=o,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=u,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new A(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===u.NO_ERROR,i=n.getStatus();if(!t||T(i,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===u.ABORT;return void e(!1,new A(!1,null,t))}const s=-1!==this.successCodes_.indexOf(i);e(!0,new A(s,n))})},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());void 0!==e?n(e):n()}catch(s){r(s)}else if(null!==i){const e=h();e.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,e)):r(e)}else if(t.canceled){r(this.appDelete_?y():p())}else{r(f())}};this.canceled_?t(0,new A(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,s=null,a=!1,o=0;function l(){return 2===o}let c=!1;function u(){if(!c){c=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function d(t){i=setTimeout(()=>{i=null,e(f,l())},t)}function h(){s&&clearTimeout(s)}function f(e){if(c)return void h();for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e)return h(),void u.call(null,e,...n);if(l()||a)return h(),void u.call(null,e,...n);let s;r<64&&(r*=2),1===o?(o=2,s=0):s=1e3*(r+Math.random()),d(s)}let p=!1;function m(e){p||(p=!0,h(),c||(null!==i?(e||(o=2),clearTimeout(i),d(0)):e||(o=1)))}return d(0),s=setTimeout(()=>{a=!0,m(!0)},n),m}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class A{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function j(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function P(){const e=j();for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0!==e){const t=new e;for(let e=0;e<n.length;e++)t.append(n[e]);return t.getBlob()}if(I())return new Blob(n);throw new l(c.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function D(e){if("undefined"===typeof atob)throw t="base-64",new l(c.UNSUPPORTED_ENVIRONMENT,"".concat(t," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));var t;return atob(e)}const R="raw",O="base64",M="base64url",L="data_url";class F{constructor(e,t){this.data=e,this.contentType=t||null}}function U(e,t){switch(e){case R:return new F(V(t));case O:case M:return new F(B(e,t));case L:return new F(function(e){const t=new z(e);return t.base64?B(O,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(n){throw v(L,"Malformed data URL.")}return V(t)}(t.rest)}(t),new z(t).contentType)}throw h()}function V(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r)){if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function B(e,t){switch(e){case O:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw v(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case M:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw v(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=D(t)}catch(i){if(i.message.includes("polyfill"))throw i;throw v(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class z{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw v(L,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class q{constructor(e,t){let n=0,r="";_(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(_(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new q(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new q(n,!0)}}static getBlob(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(I()){const e=t.map(e=>e instanceof q?e.data_:e);return new q(P.apply(null,e))}{const e=t.map(e=>k(e)?U(R,e).data:e.data_);let n=0;e.forEach(e=>{n+=e.byteLength});const r=new Uint8Array(n);let i=0;return e.forEach(e=>{for(let t=0;t<e.length;t++)r[i++]=e[t]}),new q(r,!0)}}uploadData(){return this.data_}}function K(e){let t;try{t=JSON.parse(e)}catch(r){return null}return"object"!==typeof(n=t)||Array.isArray(n)?null:t;var n}function H(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function W(e,t){return t}class G{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||W}}let Q=null;function Y(){if(Q)return Q;const e=[];e.push(new G("bucket")),e.push(new G("generation")),e.push(new G("metageneration")),e.push(new G("name","fullPath",!0));const t=new G("name");t.xform=function(e,t){return function(e){return!k(e)||e.length<2?e:H(e)}(t)},e.push(t);const n=new G("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new G("timeCreated")),e.push(new G("updated")),e.push(new G("md5Hash",null,!0)),e.push(new G("cacheControl",null,!0)),e.push(new G("contentDisposition",null,!0)),e.push(new G("contentEncoding",null,!0)),e.push(new G("contentLanguage",null,!0)),e.push(new G("contentType",null,!0)),e.push(new G("metadata","customMetadata",!0)),Q=e,Q}function J(e,t,n){const r={type:"file"},i=n.length;for(let s=0;s<i;s++){const e=n[s];r[e.local]=e.xform(r,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,i=new w(n,r);return t._makeStorageReference(i)}})}(r,e),r}function X(e,t,n){const r=K(t);if(null===r)return null;return J(e,r,n)}function $(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const r=t[i];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}class Z{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function ee(e){if(!e)throw h()}function te(e,t){return function(n,r){const i=X(e,r,t);return ee(null!==i),i}}function ne(e,t){return function(n,r){const i=X(e,r,t);return ee(null!==i),function(e,t,n,r){const i=K(t);if(null===i)return null;if(!k(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const a=encodeURIComponent;return s.split(",").map(t=>{const i=e.bucket,s=e.fullPath;return S("/b/"+a(i)+"/o/"+a(s),n,r)+N({alt:"media",token:t})})[0]}(i,r,e.host,e._protocol)}}function re(e){return function(t,n){let r;var i,s;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new l(c.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new l(c.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(s=e.bucket,r=new l(c.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,r=new l(c.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function ie(e){const t=re(e);return function(n,r){let i=t(n,r);var s;return 404===n.getStatus()&&(s=e.path,i=new l(c.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")),i.serverResponse=r.serverResponse,i}}function se(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function ae(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};const o=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();a["Content-Type"]="multipart/related; boundary="+o;const l=se(t,r,i),c="--"+o+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+$(l,n)+"\r\n--"+o+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",u="\r\n--"+o+"--",d=q.getBlob(c,r,u);if(null===d)throw m();const h={name:l.fullPath},f=S(s,e.host,e._protocol),p=e.maxUploadRetryTime,g=new Z(f,"POST",te(e,n),p);return g.urlParams=h,g.headers=a,g.body=d.uploadData(),g.errorHandler=re(t),g}let oe=null;class le{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=u.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=u.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=u.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r){if(this.sent_)throw b("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw b("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw b("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw b("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw b("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class ce extends le{initXhr(){this.xhr_.responseType="text"}}function ue(){return oe?oe():new ce}class de{constructor(e,t){this._service=e,this._location=t instanceof w?t:w.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new de(e,t)}get root(){const e=new w(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return H(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new w(this._location.bucket,e);return new de(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new l(c.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function he(e,t,n){e._throwIfRoot("uploadBytes");const r=ae(e.storage,e._location,Y(),new q(t,!0),n);return e.storage.makeRequestWithTokens(r,ue).then(t=>({metadata:t,ref:e}))}function fe(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=S(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,s=new Z(r,"GET",ne(e,n),i);return s.errorHandler=ie(t),s}(e.storage,e._location,Y());return e.storage.makeRequestWithTokens(t,ue).then(e=>{if(null===e)throw new l(c.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})}function pe(e){e._throwIfRoot("deleteObject");const t=function(e,t){const n=S(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,i=new Z(n,"DELETE",function(e,t){},r);return i.successCodes=[200,204],i.errorHandler=ie(t),i}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,ue)}function me(e,t){const n=function(e,t){const n=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new w(e._location.bucket,n);return new de(e.storage,r)}function ge(e,t){if(e instanceof be){const n=e;if(null==n._bucket)throw new l(c.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+o+"' property when initializing the app?");const r=new de(n,n._bucket);return null!=t?ge(r,t):r}return void 0!==t?me(e,t):e}function ye(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof be)return new de(e,t);throw g("To use ref(service, url), the first argument must be a Storage instance.")}return ge(e,t)}function ve(e,t){const n=null===t||void 0===t?void 0:t[o];return null==n?null:w.makeFromBucketSpec(n,e)}class be{constructor(e,t,n,r,i){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=a,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?w.makeFromBucketSpec(r,this._host):ve(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=w.makeFromBucketSpec(this._url,e):this._bucket=ve(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){E("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){E("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new de(this,e)}_makeRequest(e,t,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new x(y());{const s=function(e,t,n,r,i,s){let a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];const o=N(e.urlParams),l=e.url+o,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(c,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,r),new C(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,a)}(e,this._appId,n,r,t,this._firebaseVersion,i);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const we="@firebase/storage",xe="0.13.2",ke="storage";function _e(e,t,n){return he(e=(0,i.Ku)(e),t,n)}function Ie(e){return fe(e=(0,i.Ku)(e))}function Ee(e){return pe(e=(0,i.Ku)(e))}function Se(e,t){return ye(e=(0,i.Ku)(e),t)}function Ne(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.Sx)(),t=arguments.length>1?arguments[1]:void 0;e=(0,i.Ku)(e);const n=(0,r.j6)(e,ke).getImmediate({identifier:t}),s=(0,i.yU)("storage");return s&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n),e._protocol="http";const{mockUserToken:s}=r;s&&(e._overrideAuthToken="string"===typeof s?s:(0,i.Fy)(s,e.app.options.projectId))}(e,t,n,r)}(n,...s),n}function Te(e,t){let{instanceIdentifier:n}=t;const i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),a=e.getProvider("app-check-internal");return new be(i,s,a,n,r.MF)}(0,r.om)(new s.uA(ke,Te,"PUBLIC").setMultipleInstances(!0)),(0,r.KO)(we,xe,""),(0,r.KO)(we,xe,"esm2017")},8176:(e,t,n)=>{n.d(t,{q:()=>i});let r={};function i(){return r}},8812:(e,t,n)=>{n.d(t,{h1:()=>o,uA:()=>i});var r=n(7700);class i{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const s="[DEFAULT]";class a{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:s})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===s?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(a){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.component?this.component.multipleInstances?e:s:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class o{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new a(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},8853:(e,t,n)=>{e.exports=n(7234)},9119:(e,t,n)=>{function r(e){const t=Object.prototype.toString.call(e);return e instanceof Date||"object"===typeof e&&"[object Date]"===t?new e.constructor(+e):"number"===typeof e||"[object Number]"===t||"string"===typeof e||"[object String]"===t?new Date(e):new Date(NaN)}n.d(t,{a:()=>r})},9628:(e,t,n)=>{n.d(t,{A:()=>r});const r=new class{constructor(){this.isSupported="vibrate"in navigator}light(){this.isSupported&&navigator.vibrate(10)}medium(){this.isSupported&&navigator.vibrate(30)}heavy(){this.isSupported&&navigator.vibrate(50)}success(){this.isSupported&&navigator.vibrate([50,30,50])}warning(){this.isSupported&&navigator.vibrate([30,20,30,20,30])}error(){this.isSupported&&navigator.vibrate([100,50,100])}emergency(){this.isSupported&&navigator.vibrate([100,50,100,50,100])}selection(){this.isSupported&&navigator.vibrate(5)}}},9852:(e,t,n)=>{n.d(t,{incrementEmergencyContactCount:()=>o,yZ:()=>s});var r=n(3984),i=n(5472);const s=async(e,t,n)=>{try{const s=(0,i.P)((0,i.rJ)(r.db,"alert_responses"),(0,i._M)("checkInId","==",e),(0,i._M)("responderId","==",n));if(!(await(0,i.GG)(s)).empty)return;const o=(0,i.H9)(r.db,"checkins",e),l=await(0,i.x7)(o);if(!l.exists())return;const c=l.data(),u=c.alertedAt||c.alertTime;if(!u)return;const d=Date.now()-u.toMillis();await(0,i.gS)((0,i.rJ)(r.db,"alert_responses"),{checkInId:e,userId:t,responderId:n,responseTime:d,respondedAt:(0,i.O5)(),createdAt:(0,i.O5)()}),console.log("Alert response logged: ".concat(n," responded to ").concat(t,"'s alert in ").concat(Math.round(d/1e3),"s")),await a(t,n,"alert_response")}catch(s){console.error("Error logging alert response:",s)}},a=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"general";try{await(0,i.gS)((0,i.rJ)(r.db,"interactions"),{userId:e,bestieId:t,type:n,createdAt:(0,i.O5)()}),console.log("Interaction logged: ".concat(e," <-> ").concat(t," (").concat(n,")"))}catch(s){console.error("Error logging interaction:",s)}},o=async e=>{try{const t=(0,i.H9)(r.db,"users",e);await(0,i.mZ)(t,{"stats.timesSelectedAsEmergencyContact":(0,i.GV)(1)}),console.log("Emergency contact count incremented for ".concat(e))}catch(t){console.error("Error incrementing emergency contact count:",t)}}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var o=2&i&&r;("object"==typeof o||"function"==typeof o)&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(e=>a[e]=()=>r[e]);return a.default=()=>r,n.d(s,a),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+"."+{48:"84794ecf",69:"d5a7e135",88:"1d037651",102:"76fb3265",138:"71d9a34a",206:"a485a8bd",211:"5d9ab4db",235:"a3a6f9f4",237:"f7fa842c",239:"0a2ff048",265:"6db11157",317:"5f1ee003",321:"0df37e9a",338:"4345b1e1",385:"6d3f1172",392:"fd5db58c",475:"40bb8cbd",492:"aa1e0070",495:"ae011b81",619:"063eb98d",639:"0fc60e55",683:"7689867f",738:"91c2aba7",759:"7611afb1",768:"25676a22",774:"082d639f",775:"6289c212",838:"c2e92f65",858:"50164e56",977:"daad99c5"}[e]+".chunk.js",n.miniCssF=e=>"static/css/"+e+"."+{48:"61c11cf0",235:"3b641641"}[e]+".chunk.css",n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="besties-frontend:";n.l=(r,i,s,a)=>{if(e[r])e[r].push(i);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+s){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=r),e[r]=[i];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach(e=>e(n)),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{if("undefined"!==typeof document){var e=e=>new Promise((t,r)=>{var i=n.miniCssF(e),s=n.p+i;if(((e,t)=>{for(var n=document.getElementsByTagName("link"),r=0;r<n.length;r++){var i=(a=n[r]).getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(i===e||i===t))return a}var s=document.getElementsByTagName("style");for(r=0;r<s.length;r++){var a;if((i=(a=s[r]).getAttribute("data-href"))===e||i===t)return a}})(i,s))return t();((e,t,r,i,s)=>{var a=document.createElement("link");a.rel="stylesheet",a.type="text/css",n.nc&&(a.nonce=n.nc),a.onerror=a.onload=n=>{if(a.onerror=a.onload=null,"load"===n.type)i();else{var r=n&&n.type,o=n&&n.target&&n.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+r+": "+o+")");l.name="ChunkLoadError",l.code="CSS_CHUNK_LOAD_FAILED",l.type=r,l.request=o,a.parentNode&&a.parentNode.removeChild(a),s(l)}},a.href=t,r?r.parentNode.insertBefore(a,r.nextSibling):document.head.appendChild(a)})(e,s,null,t,r)}),t={792:0};n.f.miniCss=(n,r)=>{t[n]?r.push(t[n]):0!==t[n]&&{48:1,235:1}[n]&&r.push(t[n]=e(n).then(()=>{t[n]=0},e=>{throw delete t[n],e}))}}})(),(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var s=new Promise((n,r)=>i=e[t]=[n,r]);r.push(i[2]=s);var a=n.p+n.u(t),o=new Error;n.l(a,r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,i[1](o)}},"chunk-"+t,t)}};var t=(t,r)=>{var i,s,[a,o,l]=r,c=0;if(a.some(t=>0!==e[t])){for(i in o)n.o(o,i)&&(n.m[i]=o[i]);if(l)l(n)}for(t&&t(r);c<a.length;c++)s=a[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunkbesties_frontend=self.webpackChunkbesties_frontend||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n(5043),i=n.t(r,2),s=n(4391),a=n(3216),o=n(7950),l=n.t(o,2),c=n(1387);function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function d(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const h=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(Ze){}new Map;const f=i.startTransition;l.flushSync,i.useId;function p(e){let{basename:t,children:n,future:i,window:s}=e,o=r.useRef();null==o.current&&(o.current=(0,c.zR)({window:s,v5Compat:!0}));let l=o.current,[u,d]=r.useState({action:l.action,location:l.location}),{v7_startTransition:h}=i||{},p=r.useCallback(e=>{h&&f?f(()=>d(e)):d(e)},[d,h]);return r.useLayoutEffect(()=>l.listen(p),[l,p]),r.useEffect(()=>(0,a.V8)(i),[i]),r.createElement(a.Ix,{basename:t,children:n,location:u.location,navigationType:u.action,navigator:l,future:i})}const m="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,g=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,y=r.forwardRef(function(e,t){let n,{onClick:i,relative:s,reloadDocument:o,replace:l,state:f,target:p,to:y,preventScrollReset:v,viewTransition:b}=e,w=d(e,h),{basename:x}=r.useContext(a.jb),k=!1;if("string"===typeof y&&g.test(y)&&(n=y,m))try{let e=new URL(window.location.href),t=y.startsWith("//")?new URL(e.protocol+y):new URL(y),n=(0,c.pb)(t.pathname,x);t.origin===e.origin&&null!=n?y=n+t.search+t.hash:k=!0}catch(Ze){}let _=(0,a.$P)(y,{relative:s}),I=function(e,t){let{target:n,replace:i,state:s,preventScrollReset:o,relative:l,viewTransition:u}=void 0===t?{}:t,d=(0,a.Zp)(),h=(0,a.zy)(),f=(0,a.x$)(e,{relative:l});return r.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==i?i:(0,c.AO)(h)===(0,c.AO)(f);d(e,{replace:n,state:s,preventScrollReset:o,relative:l,viewTransition:u})}},[h,d,f,i,s,n,e,o,l,u])}(y,{replace:l,state:f,target:p,preventScrollReset:v,relative:s,viewTransition:b});return r.createElement("a",u({},w,{href:n||_,onClick:k||o?i:function(e){i&&i(e),e.defaultPrevented||I(e)},ref:t,target:p}))});var v,b;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(v||(v={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(b||(b={}));var w=n(2339),x=n(3984),k=n(4528),_=n(3889),I=n(3063),E=n(579);class S extends r.Component{constructor(e){super(e),this.handleReload=()=>{window.location.reload()},this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){I.A.logError({type:"react_error",message:e.message,stack:e.stack,componentStack:t.componentStack}),this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?(0,E.jsx)("div",{className:"min-h-screen bg-pattern flex items-center justify-center p-4",children:(0,E.jsxs)("div",{className:"card max-w-2xl w-full p-8 text-center",children:[(0,E.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\ude14"}),(0,E.jsx)("h1",{className:"text-3xl font-display text-text-primary mb-4",children:"Oops! Something went wrong"}),(0,E.jsx)("p",{className:"text-text-secondary mb-6",children:"We're sorry for the inconvenience. The error has been logged and we'll fix it soon."}),!1,(0,E.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,E.jsx)("button",{onClick:this.handleReload,className:"btn btn-primary",children:"Reload Page"}),(0,E.jsx)("button",{onClick:()=>window.location.href="/",className:"btn btn-secondary",children:"Go Home"})]})]})}):this.props.children}}const N=S,T=e=>{let{children:t}=e;const{currentUser:n,userData:i,loading:s}=(0,k.As)();return(0,r.useEffect)(()=>{console.group("\ud83d\udd12 AdminRoute Debug"),console.log("loading:",s),console.log("currentUser:",n),console.log("currentUser.uid:",null===n||void 0===n?void 0:n.uid),console.log("userData:",i),console.log("userData?.isAdmin:",null===i||void 0===i?void 0:i.isAdmin),console.log("Will redirect:",!(null!==i&&void 0!==i&&i.isAdmin)),console.groupEnd()},[s,n,i]),s?(console.log("\u23f3 AdminRoute: Still loading..."),(0,E.jsx)("div",{className:"min-h-screen bg-pattern flex items-center justify-center",children:(0,E.jsx)("div",{className:"spinner"})})):null!==i&&void 0!==i&&i.isAdmin?(console.log("\u2705 AdminRoute: Access granted"),t):(console.error("\u274c AdminRoute: Access denied. userData?.isAdmin =",null===i||void 0===i?void 0:i.isAdmin),(0,E.jsx)(a.C5,{to:"/",replace:!0}))},C=()=>{const{pathname:e}=(0,a.zy)();return(0,r.useEffect)(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),null};var A=n(2555),j=n(5472);const P=()=>{const[e,t]=(0,r.useState)(null),[n,i]=(0,r.useState)(!1);(0,r.useEffect)(()=>{s()},[]);const s=async()=>{const e=x.auth.currentUser;if(e)try{const n=(0,j.P)((0,j.rJ)(x.db,"circle_milestones"),(0,j._M)("userId","==",e.uid),(0,j._M)("celebrated","==",!1)),r=await(0,j.GG)(n);if(!r.empty){const e=r.docs[0],n=(0,A.A)({id:e.id},e.data());t(n),i(!0),setTimeout(async()=>{await(0,j.mZ)((0,j.H9)(x.db,"circle_milestones",e.id),{celebrated:!0})},5e3)}}catch(n){console.error("Error checking for milestones:",n)}},a=()=>{i(!1),setTimeout(()=>t(null),300)};if(!e||!n)return null;const o=(()=>{switch(e.type){case"days_in_circle":return{icon:"\ud83c\udf89",title:"".concat(e.value," Days Together!"),message:"You and ".concat(e.bestie||"your bestie"," have been in each other's circles for ").concat(e.value," days. That's real commitment!"),color:"from-purple-500 to-pink-500"};case"check_ins_together":return{icon:"\u2705",title:"".concat(e.value," Check-Ins Together!"),message:"You've done ".concat(e.value," check-ins with ").concat(e.bestie||"your bestie",". You're building serious trust!"),color:"from-blue-500 to-cyan-500"};case"alerts_responded":return{icon:"\ud83d\udea8",title:"".concat(e.value," Alerts Answered!"),message:"You've responded to ".concat(e.value," alerts. You're a real hero to your circle!"),color:"from-orange-500 to-red-500"};case"streak":return{icon:"\ud83d\udd25",title:"".concat(e.value," Day Streak!"),message:"You've checked your circle for ".concat(e.value," days in a row. Keep that energy going!"),color:"from-green-500 to-emerald-500"};default:return{icon:"\u2b50",title:"Milestone Achieved!",message:"You hit an important milestone in your circle!",color:"from-purple-500 to-pink-500"}}})();return(0,E.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[9999] p-4 backdrop-blur-sm transition-opacity duration-300 ".concat(n?"opacity-100":"opacity-0"),onClick:a,children:(0,E.jsxs)("div",{className:"bg-gradient-to-br ".concat(o.color," p-8 rounded-2xl max-w-md w-full shadow-2xl transform transition-all duration-300 ").concat(n?"scale-100":"scale-95"),onClick:e=>e.stopPropagation(),children:[(0,E.jsx)("div",{className:"absolute inset-0 overflow-hidden rounded-2xl pointer-events-none",children:Array.from({length:30}).map((e,t)=>(0,E.jsx)("div",{className:"absolute w-2 h-2 bg-white rounded-full animate-confetti",style:{left:"".concat(100*Math.random(),"%"),top:"-10%",animationDelay:"".concat(2*Math.random(),"s"),animationDuration:"".concat(2+2*Math.random(),"s")}},t))}),(0,E.jsxs)("div",{className:"relative z-10 text-center text-white",children:[(0,E.jsx)("div",{className:"text-7xl mb-4 animate-bounce",children:o.icon}),(0,E.jsx)("h2",{className:"text-3xl font-display font-bold mb-3 drop-shadow-lg",children:o.title}),(0,E.jsx)("p",{className:"text-lg mb-6 drop-shadow opacity-95",children:o.message}),(0,E.jsx)("button",{onClick:a,className:"bg-white text-gray-800 px-6 py-3 rounded-full font-semibold hover:bg-gray-100 transition-all shadow-lg transform hover:scale-105",children:"Awesome! \ud83c\udf89"})]}),(0,E.jsx)("style",{children:"\n          @keyframes confetti {\n            0% {\n              transform: translateY(0) rotate(0deg);\n              opacity: 1;\n            }\n            100% {\n              transform: translateY(500px) rotate(720deg);\n              opacity: 0;\n            }\n          }\n          .animate-confetti {\n            animation: confetti linear forwards;\n          }\n        "})]})})},D=()=>{var e;const{currentUser:t,userData:i}=(0,k.As)(),[s,a]=(0,r.useState)([]),[o,l]=(0,r.useState)(null),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)(!1),f=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!d)return;(()=>{const e=["#9333ea","#ec4899","#8b5cf6","#d946ef","#a855f7"],t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.pointerEvents="none",t.style.zIndex="10000",document.body.appendChild(t);for(let r=0;r<100;r++){const n=document.createElement("div");n.style.position="absolute",n.style.width="10px",n.style.height="10px",n.style.backgroundColor=e[Math.floor(Math.random()*e.length)],n.style.left=100*Math.random()+"%",n.style.top="-10px",n.style.opacity=Math.random(),n.style.transform="rotate(".concat(360*Math.random(),"deg)");const r=3*Math.random()+2,i=.5*Math.random();n.style.animation="fall ".concat(r,"s linear ").concat(i,"s forwards"),t.appendChild(n)}const n=document.createElement("style");n.innerHTML="\n        @keyframes fall {\n          to {\n            transform: translateY(100vh) rotate(720deg);\n            opacity: 0;\n          }\n        }\n      ",document.head.appendChild(n),setTimeout(()=>{t.remove(),n.remove()},5e3)})()},[d]),(0,r.useEffect)(()=>{if(!t||null===i||void 0===i||!i.onboardingCompleted)return;(async()=>{try{const e=(0,j.P)((0,j.rJ)(x.db,"bestie_celebrations"),(0,j._M)("userId","==",t.uid),(0,j._M)("seen","==",!1)),n=await(0,j.GG)(e);if(!n.empty){const e=n.docs.map(e=>(0,A.A)({id:e.id},e.data()));a(e),l(e[0]),u(e[0].id),h(!0)}}catch(e){console.error("Error checking for celebrations:",e)}})()},[t,i]);const p=async e=>{try{const t=f.current;if(!t)return;const r=(await n.e(239).then(n.t.bind(n,5239,23))).default,i=(await r(t,{backgroundColor:null,scale:2})).toDataURL("image/png"),s=o.bestieName&&"Your Bestie"!==o.bestieName?"".concat(o.bestieName," and I are now besties on Besties App! \ud83d\udc9c"):"I just made a new bestie on Besties App! \ud83d\udc9c",a="https://bestiesapp.web.app";switch(e){case"twitter":window.open("https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(s),"&url=").concat(encodeURIComponent(a)),"_blank");break;case"facebook":window.open("https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(a),"&quote=").concat(encodeURIComponent(s)),"_blank");break;case"download":const e=document.createElement("a");e.download="besties-celebration.png",e.href=i,e.click()}}catch(t){console.error("Error sharing:",t)}};return d&&o?(0,E.jsx)("div",{className:"fixed inset-0 bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center z-[9999] p-4",children:(0,E.jsxs)("div",{className:"max-w-md w-full",children:[(0,E.jsx)("div",{ref:f,className:"bg-gradient-to-br from-purple-500 to-pink-500 p-4 sm:p-6 md:p-8 rounded-3xl",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"text-5xl sm:text-6xl md:text-8xl mb-4 sm:mb-6 animate-bounce",children:"\ud83c\udf89"}),(0,E.jsx)("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-display text-white mb-3 sm:mb-4 px-2",children:o.bestieName&&"Your Bestie"!==o.bestieName?"You and ".concat(o.bestieName," are besties!"):"You're connected!"}),(0,E.jsx)("p",{className:"text-base sm:text-lg md:text-xl text-white/90 mb-2 px-2",children:"You can now add each other as emergency contacts"}),(0,E.jsxs)("div",{className:"flex justify-center items-center gap-3 sm:gap-4 my-6 sm:my-8",children:[(0,E.jsx)("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-white rounded-full flex items-center justify-center shadow-xl overflow-hidden flex-shrink-0",children:o.bestiePhotoURL?(0,E.jsx)("img",{src:o.bestiePhotoURL,alt:o.bestieName,className:"w-full h-full object-cover"}):(0,E.jsx)("div",{className:"text-2xl sm:text-3xl text-purple-600",children:(null===(e=o.bestieName)||void 0===e?void 0:e[0])||"?"})}),(0,E.jsx)("div",{className:"text-3xl sm:text-4xl animate-pulse flex-shrink-0",children:"\ud83d\udc9c"}),(0,E.jsx)("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-white rounded-full flex items-center justify-center shadow-xl overflow-hidden flex-shrink-0",children:null!==i&&void 0!==i&&i.photoURL?(0,E.jsx)("img",{src:i.photoURL,alt:"You",className:"w-full h-full object-cover"}):(0,E.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-purple-600",children:"YOU"})})]}),(0,E.jsxs)("p",{className:"text-sm sm:text-base text-white/80 mb-4 sm:mb-6 px-2",children:[o.bestieName," will be notified if you don't check in on time"]})]})}),s.length>1&&(0,E.jsx)("div",{className:"text-center mt-4",children:(0,E.jsxs)("p",{className:"text-white text-sm",children:[s.length-1," more celebration",s.length>2?"s":""," remaining"]})}),(0,E.jsxs)("div",{className:"mt-4 sm:mt-6 flex justify-center gap-3 sm:gap-4",children:[(0,E.jsx)("button",{onClick:()=>p("twitter"),className:"bg-white/20 hover:bg-white/30 text-white rounded-full p-2 sm:p-3 transition-all",title:"Share on Twitter",children:(0,E.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{d:"M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"})})}),(0,E.jsx)("button",{onClick:()=>p("facebook"),className:"bg-white/20 hover:bg-white/30 text-white rounded-full p-2 sm:p-3 transition-all",title:"Share on Facebook",children:(0,E.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{d:"M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"})})}),(0,E.jsx)("button",{onClick:()=>p("download"),className:"bg-white/20 hover:bg-white/30 text-white rounded-full p-2 sm:p-3 transition-all",title:"Download image",children:(0,E.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})})]}),(0,E.jsx)("div",{className:"flex justify-center mt-4 sm:mt-6",children:(0,E.jsx)("button",{onClick:async()=>{if(c)try{await(0,j.mZ)((0,j.H9)(x.db,"bestie_celebrations",c),{seen:!0})}catch(t){console.error("Error marking celebration as seen:",t)}const e=s.slice(1);e.length>0?(a(e),l(e[0]),u(e[0].id)):(h(!1),l(null),u(null))},className:"btn bg-white text-purple-600 hover:bg-white/90 text-base sm:text-lg px-6 sm:px-8 py-3 sm:py-4 font-bold",children:"Continue \u2192"})})]})}):null};var R=n(711);const O=()=>{const e=(0,a.zy)(),{isDark:t}=(0,_.D)(),n=t=>e.pathname===t;return(0,E.jsx)("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 ".concat(t?"bg-gray-900 border-gray-700":"bg-white border-gray-200"," border-t shadow-lg z-[9999] transition-colors"),style:{position:"fixed",bottom:0,width:"100%"},children:(0,E.jsxs)("div",{className:"flex items-center justify-around py-3 safe-area-inset-bottom",children:[(0,E.jsxs)(y,{to:"/",className:"flex flex-col items-center gap-1 transition-colors ".concat(n("/")?"text-primary":t?"text-gray-300":"text-text-secondary"),children:[(0,E.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),(0,E.jsx)("span",{className:"text-xs font-semibold",children:"Home"})]}),(0,E.jsxs)(y,{to:"/besties",className:"flex flex-col items-center gap-1 transition-colors ".concat(n("/besties")?"text-primary":t?"text-gray-300":"text-text-secondary"),children:[(0,E.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,E.jsx)("span",{className:"text-xs font-semibold",children:"Besties"})]}),(0,E.jsxs)(y,{to:"/profile",className:"flex flex-col items-center gap-1 transition-colors ".concat(n("/profile")?"text-primary":t?"text-gray-300":"text-text-secondary"),children:[(0,E.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,E.jsx)("span",{className:"text-xs font-semibold",children:"Profile"})]})]})})},M=()=>{const e=(0,a.Zp)(),{currentUser:t}=(0,k.As)(),[n,i]=(0,r.useState)(!1),[s,o]=(0,r.useState)([]),[l,c]=(0,r.useState)(0),u=(0,r.useRef)(null);(0,r.useEffect)(()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&i(!1)};if(n)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[n]),(0,r.useEffect)(()=>{if(null===t||void 0===t||!t.uid)return;const e=(0,j.P)((0,j.rJ)(x.db,"notifications"),(0,j._M)("userId","==",t.uid),(0,j.My)("createdAt","desc")),n=(0,j.aQ)(e,e=>{const t=e.docs.map(e=>(0,A.A)({id:e.id},e.data()));o(t),c(t.filter(e=>!e.read).length)});return()=>n()},[null===t||void 0===t?void 0:t.uid]);const d=async e=>{try{await(0,j.mZ)((0,j.H9)(x.db,"notifications",e),{read:!0})}catch(t){console.error("Error marking notification as read:",t)}},h=e=>{switch(e){case"bestie_request":return"\ud83d\udc9c";case"check_in_alert":return"\u23f0";case"missed_check_in":return"\u26a0\ufe0f";case"request_attention":return"\ud83d\udc4b";case"badge_earned":return"\ud83c\udfc6";case"system":return"\ud83d\udce2";default:return"\ud83d\udd14"}},f=e=>{if(!e)return"";const t=e.toDate?e.toDate():new Date(e),n=new Date-t,r=Math.floor(n/6e4),i=Math.floor(n/36e5),s=Math.floor(n/864e5);return r<1?"Just now":r<60?"".concat(r,"m ago"):i<24?"".concat(i,"h ago"):s<7?"".concat(s,"d ago"):t.toLocaleDateString()};return(0,E.jsxs)("div",{className:"relative",ref:u,children:[(0,E.jsxs)("button",{onClick:()=>i(!n),className:"relative p-2 hover:bg-gray-100 rounded-full transition-colors",children:[(0,E.jsxs)("svg",{viewBox:"0 0 24 24",className:"w-6 h-6",children:[(0,E.jsx)("defs",{children:(0,E.jsxs)("linearGradient",{id:"bellGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,E.jsx)("stop",{offset:"0%",stopColor:"#ec4899"}),(0,E.jsx)("stop",{offset:"50%",stopColor:"#a855f7"}),(0,E.jsx)("stop",{offset:"100%",stopColor:"#d946ef"})]})}),(0,E.jsx)("path",{d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9",fill:"none",stroke:"url(#bellGradient)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),l>0&&(0,E.jsx)("div",{className:"absolute -top-1 -right-1 bg-gradient-to-br from-rose-500 to-pink-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse shadow-lg",children:l>9?"9+":l})]}),n&&(0,E.jsxs)("div",{className:"absolute top-full right-0 mt-2 w-80 bg-white rounded-xl shadow-2xl border-2 border-gray-200 z-50 max-h-96 overflow-hidden flex flex-col",children:[(0,E.jsx)("div",{className:"p-4 border-b-2 border-gray-100 bg-gradient-to-r from-pink-50 to-purple-50",children:(0,E.jsxs)("h3",{className:"font-display text-lg text-text-primary flex items-center justify-between",children:[(0,E.jsx)("span",{children:"Notifications"}),l>0&&(0,E.jsxs)("span",{className:"text-xs bg-primary text-white px-2 py-1 rounded-full",children:[l," new"]})]})}),(0,E.jsx)("div",{className:"overflow-y-auto flex-1",children:0===s.length?(0,E.jsxs)("div",{className:"p-8 text-center",children:[(0,E.jsx)("div",{className:"text-4xl mb-2",children:"\ud83d\udd14"}),(0,E.jsx)("p",{className:"text-text-secondary text-sm",children:"No notifications yet"}),(0,E.jsx)("p",{className:"text-text-secondary text-xs mt-1",children:"We'll notify you about check-ins, bestie requests, and more"})]}):(0,E.jsx)("div",{className:"divide-y divide-gray-100",children:s.map(t=>(0,E.jsx)("button",{onClick:()=>(t=>{switch(t.read||d(t.id),t.type){case"bestie_request":case"missed_check_in":case"request_attention":e("/besties");break;case"check_in_alert":e("/history");break;case"badge_earned":e("/profile")}i(!1)})(t),className:"w-full p-4 text-left hover:bg-gradient-to-r hover:from-pink-50 hover:to-purple-50 transition-colors ".concat(t.read?"":"bg-purple-50/30"),children:(0,E.jsxs)("div",{className:"flex gap-3",children:[(0,E.jsx)("div",{className:"flex-shrink-0 text-2xl",children:h(t.type)}),(0,E.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,E.jsx)("p",{className:"text-sm ".concat(t.read?"text-gray-700":"font-semibold text-gray-900"),children:t.title}),(0,E.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:t.message}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:f(t.createdAt)})]}),!t.read&&(0,E.jsx)("div",{className:"flex-shrink-0",children:(0,E.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full"})})]})},t.id))})}),l>0&&(0,E.jsx)("div",{className:"p-3 border-t-2 border-gray-100 bg-gray-50",children:(0,E.jsx)("button",{onClick:async()=>{const e=s.filter(e=>!e.read);for(const t of e)await d(t.id)},className:"w-full text-center text-sm font-semibold text-primary hover:text-primary-dark transition-colors",children:"Mark all as read"})})]})]})};var L=n(7766);const F=e=>{var t;let{photoURL:n,name:i,size:s="md"}=e;const[a,o]=(0,r.useState)(!1),l={sm:"w-8 h-8",md:"w-10 h-10",lg:"w-12 h-12"};return(0,r.useEffect)(()=>{const e=setInterval(()=>{o(!0),setTimeout(()=>{o(!1)},1500)},3500);return()=>clearInterval(e)},[]),(0,E.jsxs)("div",{className:"relative",style:{perspective:"1000px"},children:[(0,E.jsxs)("div",{className:"".concat(l[s]," rounded-full relative transition-transform duration-1500 ease-in-out ").concat(a?"animate-coin-flip":""),style:{transformStyle:"preserve-3d"},children:[(0,E.jsx)("div",{className:"absolute inset-0 ".concat(l[s]," rounded-full overflow-hidden border-2 border-primary shadow-md"),style:{backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden"},children:n?(0,E.jsx)("img",{src:n,alt:i,className:"w-full h-full object-cover"}):(0,E.jsx)("div",{className:"w-full h-full bg-gradient-primary flex items-center justify-center text-white font-bold text-lg",children:(null===i||void 0===i||null===(t=i.charAt(0))||void 0===t?void 0:t.toUpperCase())||"?"})}),(0,E.jsx)("div",{className:"absolute inset-0 ".concat(l[s]," rounded-full overflow-hidden border-2 border-primary shadow-md bg-gradient-primary flex items-center justify-center"),style:{backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:(0,E.jsx)("span",{className:"text-white font-display text-xs font-bold",children:"B"})})]}),(0,E.jsx)("style",{children:"\n        @keyframes coin-flip {\n          0% {\n            transform: rotateY(0deg);\n          }\n          100% {\n            transform: rotateY(1440deg); /* 4 full rotations (360 * 4) */\n          }\n        }\n\n        .animate-coin-flip {\n          animation: coin-flip 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);\n        }\n\n        .duration-1500 {\n          transition-duration: 1500ms;\n        }\n      "})]})},U=()=>{var e;const{userData:t}=(0,k.As)(),{isDark:n,toggle:i}=(0,_.D)(),s=(0,a.zy)(),o=(0,a.Zp)(),[l,c]=(0,r.useState)(!1),u=(0,r.useRef)(null),d=e=>s.pathname===e;(0,r.useEffect)(()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&c(!1)};if(l)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[l]);return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("header",{className:"hidden md:block ".concat(n?"bg-gray-900":"bg-white"," shadow-sm sticky top-0 z-40 transition-colors"),children:(0,E.jsx)("div",{className:"max-w-7xl mx-auto px-4",children:(0,E.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,E.jsx)(y,{to:"/",className:"flex items-center",children:(0,E.jsx)("span",{className:"font-display text-2xl text-gradient",children:"Besties"})}),(0,E.jsxs)("nav",{className:"hidden md:flex items-center gap-6",children:[(0,E.jsx)(y,{to:"/",className:"font-semibold transition-colors ".concat(d("/")?"text-primary":n?"text-gray-300 hover:text-primary":"text-text-secondary hover:text-primary"),children:"Home"}),(0,E.jsx)(y,{to:"/besties",className:"font-semibold transition-colors ".concat(d("/besties")?"text-primary":n?"text-gray-300 hover:text-primary":"text-text-secondary hover:text-primary"),children:"Besties"}),(0,E.jsx)(y,{to:"/profile",className:"font-semibold transition-colors ".concat(d("/profile")?"text-primary":n?"text-gray-300 hover:text-primary":"text-text-secondary hover:text-primary"),children:"Profile"})]}),(0,E.jsxs)("div",{className:"flex items-center gap-3",children:[(0,E.jsx)(M,{}),(0,E.jsxs)("div",{className:"relative",ref:u,children:[(0,E.jsx)("button",{onClick:()=>c(!l),className:"hover:opacity-90 transition-opacity relative",children:null!==t&&void 0!==t&&null!==(e=t.requestAttention)&&void 0!==e&&e.active?(0,E.jsx)(L.A,{photoURL:null===t||void 0===t?void 0:t.photoURL,name:(null===t||void 0===t?void 0:t.displayName)||"User",requestAttention:null===t||void 0===t?void 0:t.requestAttention,size:"md",showBubble:!0}):(0,E.jsx)(F,{photoURL:null===t||void 0===t?void 0:t.photoURL,name:(null===t||void 0===t?void 0:t.displayName)||"User",size:"md"})}),l&&(0,E.jsxs)("div",{className:"absolute right-0 mt-2 w-48 ".concat(n?"bg-gray-800 border-gray-700":"bg-white border-gray-200"," rounded-lg shadow-lg border overflow-hidden animate-scale-up transition-colors"),children:[(0,E.jsxs)("div",{className:"px-4 py-3 ".concat(n?"border-gray-700":"border-gray-200"," border-b"),children:[(0,E.jsx)("div",{className:"font-semibold ".concat(n?"text-gray-100":"text-text-primary"," truncate"),children:(null===t||void 0===t?void 0:t.displayName)||"User"}),(0,E.jsx)("div",{className:"text-xs ".concat(n?"text-gray-400":"text-text-secondary"," truncate"),children:null===t||void 0===t?void 0:t.email})]}),(0,E.jsxs)("button",{onClick:()=>{c(!1),o("/profile")},className:"w-full px-4 py-2 text-left ".concat(n?"hover:bg-gray-700 text-gray-100":"hover:bg-gray-50 text-text-primary"," transition-colors flex items-center gap-2"),children:[(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Profile"]}),(0,E.jsxs)("button",{onClick:()=>{c(!1),o("/settings")},className:"w-full px-4 py-2 text-left ".concat(n?"hover:bg-gray-700 text-gray-100":"hover:bg-gray-50 text-text-primary"," transition-colors flex items-center gap-2"),children:[(0,E.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Settings"]}),(0,E.jsxs)("button",{onClick:()=>{c(!1),o("/history")},className:"w-full px-4 py-2 text-left ".concat(n?"hover:bg-gray-700 text-gray-100":"hover:bg-gray-50 text-text-primary"," transition-colors flex items-center gap-2"),children:[(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"History"]}),(0,E.jsxs)("button",{onClick:()=>{c(!1),o("/about")},className:"w-full px-4 py-2 text-left ".concat(n?"hover:bg-gray-700 text-gray-100":"hover:bg-gray-50 text-text-primary"," transition-colors flex items-center gap-2"),children:[(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"About Besties"]}),(0,E.jsx)("div",{className:"".concat(n?"border-gray-700":"border-gray-200"," border-t"),children:(0,E.jsxs)("button",{onClick:()=>{i(),w.Ay.success("".concat(n?"Light":"Dark"," mode enabled"))},className:"w-full px-4 py-2 text-left ".concat(n?"hover:bg-gray-700 text-gray-100":"hover:bg-gray-50 text-text-primary"," transition-colors flex items-center justify-between"),children:[(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[n?(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),(0,E.jsx)("span",{children:n?"Light Mode":"Dark Mode"})]}),(0,E.jsx)("span",{className:"text-xs ".concat(n?"text-gray-400":"text-text-secondary"),children:n?"\u2600\ufe0f":"\ud83c\udf19"})]})}),(0,E.jsx)("div",{className:"".concat(n?"border-gray-700":"border-gray-200"," border-t"),children:(0,E.jsxs)("button",{onClick:async()=>{(await x.authService.signOut()).success?(w.Ay.success("Signed out successfully"),o("/login")):w.Ay.error("Sign out failed")},className:"w-full px-4 py-2 text-left ".concat(n?"hover:bg-red-900/30":"hover:bg-red-50"," transition-colors flex items-center gap-2 text-red-600"),children:[(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Sign Out"]})})]})]})]})]})})}),(0,E.jsx)("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 ".concat(n?"bg-gray-900 border-gray-700":"bg-white border-gray-200"," border-t shadow-lg z-[9999] transition-colors"),style:{position:"fixed",bottom:0,width:"100%"},children:(0,E.jsxs)("div",{className:"flex items-center justify-around py-3 safe-area-inset-bottom",children:[(0,E.jsxs)(y,{to:"/",className:"flex flex-col items-center gap-1 transition-colors ".concat(d("/")?"text-primary":n?"text-gray-300":"text-text-secondary"),children:[(0,E.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),(0,E.jsx)("span",{className:"text-xs font-semibold",children:"Home"})]}),(0,E.jsxs)(y,{to:"/besties",className:"flex flex-col items-center gap-1 transition-colors ".concat(d("/besties")?"text-primary":n?"text-gray-300":"text-text-secondary"),children:[(0,E.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,E.jsx)("span",{className:"text-xs font-semibold",children:"Besties"})]}),(0,E.jsxs)(y,{to:"/profile",className:"flex flex-col items-center gap-1 transition-colors ".concat(d("/profile")?"text-primary":n?"text-gray-300":"text-text-secondary"),children:[(0,E.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,E.jsx)("span",{className:"text-xs font-semibold",children:"Profile"})]})]})})]})},V=(e,t)=>{const[n,i]=(0,r.useState)(e),[s,a]=(0,r.useState)({}),[o,l]=(0,r.useState)({}),c=(e,n)=>{const r=t[e];if(!r)return"";if(r.required&&!n)return r.requiredMessage||"".concat(e," is required \ud83d\udc9c");if(r.minLength&&n.length<r.minLength)return r.minLengthMessage||"Must be at least ".concat(r.minLength," characters \ud83d\udccf");if(r.maxLength&&n.length>r.maxLength)return r.maxLengthMessage||"Must be less than ".concat(r.maxLength," characters \u2702\ufe0f");if(r.email){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n))return r.emailMessage||"Please enter a valid email \ud83d\udce7"}if(r.phone){if(!/^[\d\s+\-()]+$/.test(n))return r.phoneMessage||"Please enter a valid phone number \ud83d\udcf1"}if(r.url)try{new URL(n)}catch(i){return r.urlMessage||"Please enter a valid URL \ud83d\udd17"}return r.custom&&!r.custom(n)?r.customMessage||"Invalid value":r.pattern&&!r.pattern.test(n)?r.patternMessage||"Invalid format":""};return{values:n,errors:s,touched:o,handleChange:(e,t)=>{if(i(n=>(0,A.A)((0,A.A)({},n),{},{[e]:t})),o[e]){const n=c(e,t);a(t=>(0,A.A)((0,A.A)({},t),{},{[e]:n}))}},handleBlur:e=>{l(t=>(0,A.A)((0,A.A)({},t),{},{[e]:!0}));const t=c(e,n[e]);a(n=>(0,A.A)((0,A.A)({},n),{},{[e]:t}))},validateAll:()=>{const e={};return Object.keys(t).forEach(t=>{const r=c(t,n[t]);r&&(e[t]=r)}),a(e),0===Object.keys(e).length},reset:()=>{i(e),a({}),l({})},isValid:0===Object.keys(s).length}},B=()=>{const[e,t]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1),{values:s,errors:o,handleChange:l,handleBlur:c,validateAll:u}=V({email:"",password:"",displayName:""},{email:{required:!0,email:!0,requiredMessage:"Email is required \ud83d\udce7",emailMessage:"Please enter a valid email address \ud83d\udc9c"},password:{required:!0,minLength:6,requiredMessage:"Password is required \ud83d\udd12",minLengthMessage:"Password must be at least 6 characters \ud83d\udd10"},displayName:{required:e,minLength:2,requiredMessage:"Name is required \u2728",minLengthMessage:"Name must be at least 2 characters \ud83d\udc9c"}}),[d,h]=(0,r.useState)("+61"),[f,p]=(0,r.useState)(""),[m,g]=(0,r.useState)(""),[y,v]=(0,r.useState)(null),[b,k]=(0,r.useState)(!1),[_,S]=(0,r.useState)(!1),[N,T]=(0,r.useState)(""),C=(0,a.Zp)();(0,r.useEffect)(()=>{I.A.trackFunnelStep("signup","view_login_page")},[]),(0,r.useEffect)(()=>{if(b&&!_){setTimeout(async()=>{try{T("Setting up verification...");x.authService.setupRecaptcha("recaptcha-container").success?(S(!0),T("")):(T(""),w.Ay.error("Verification setup failed. Please refresh the page."))}catch(e){T(""),console.error("reCAPTCHA setup error:",e)}},100)}},[b,_]);const A=async()=>{i(!0),T("Opening Google sign-in..."),I.A.trackFunnelStep("signup","click_google_signin");try{const e=await x.authService.signInWithGoogle();i(!1),T(""),e.success?(I.A.trackFunnelStep("signup","complete_google_signin"),w.Ay.success("Welcome to Besties!"),C("/")):(I.A.logCustomError("Google sign-in failed",{error:e.error}),w.Ay.error(e.error||"Sign in failed"))}catch(e){i(!1),T(""),w.Ay.error("Sign in failed. Please try again.")}};return(0,E.jsx)("div",{className:"min-h-screen bg-pattern flex items-center justify-center p-4",children:(0,E.jsxs)("div",{className:"w-full max-w-md",children:[(0,E.jsxs)("div",{className:"text-center mb-8 animate-fade-in",children:[(0,E.jsx)("h1",{className:"font-display text-6xl text-gradient mb-2",children:"Besties"}),(0,E.jsx)("p",{className:"text-xl text-text-secondary font-semibold",children:"Your besties have your back \ud83d\udc9c"})]}),(0,E.jsxs)("div",{className:"card p-8 animate-slide-up",children:[N&&(0,E.jsx)("div",{className:"mb-4 p-3 bg-gray-100 dark:bg-gray-700 rounded-lg text-center",children:(0,E.jsxs)("p",{className:"text-sm font-semibold text-primary flex items-center justify-center gap-2",children:[(0,E.jsx)("span",{className:"inline-block w-4 h-4 border-2 border-primary border-t-transparent rounded-full animate-spin"}),N]})}),(0,E.jsxs)("button",{onClick:A,disabled:n,className:"w-full btn btn-primary mb-3",children:[(0,E.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[(0,E.jsx)("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,E.jsx)("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,E.jsx)("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,E.jsx)("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),(0,E.jsxs)("button",{onClick:()=>k(!b),className:"w-full btn btn-secondary mb-3",children:[(0,E.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Continue with Phone"]}),b&&(0,E.jsx)("div",{className:"mb-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:y?(0,E.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(!0),T("Verifying code..."),I.A.trackFunnelStep("signup","click_phone_verify_code");try{const e=await x.authService.verifyPhoneCode(y,m);i(!1),T(""),e.success?(I.A.trackFunnelStep("signup","complete_phone_signin"),w.Ay.success("Welcome to Besties!"),C("/")):(I.A.logCustomError("Phone code verification failed",{error:e.error}),w.Ay.error(e.error||"Invalid code"))}catch(t){i(!1),T(""),w.Ay.error("Verification failed. Please try again.")}},className:"space-y-3",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-semibold text-text-primary mb-2",children:"Verification Code"}),(0,E.jsx)("input",{type:"text",inputMode:"numeric",value:m,onChange:e=>g(e.target.value),className:"input",placeholder:"123456",required:!0,maxLength:6,autoComplete:"one-time-code"})]}),(0,E.jsx)("button",{type:"submit",disabled:n,className:"w-full btn btn-primary",children:n?"Verifying...":"Verify Code"}),(0,E.jsx)("button",{type:"button",onClick:()=>{v(null),g("")},className:"w-full btn btn-secondary",children:"Back"})]}):(0,E.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),_){i(!0),T("Sending verification code..."),I.A.trackFunnelStep("signup","click_phone_send_code");try{const e=f.startsWith("+")?f:"".concat(d).concat(f.replace(/\s/g,"")),t=x.authService.setupRecaptcha("recaptcha-container");if(!t.success)return w.Ay.error("Verification not ready. Please try again."),i(!1),void T("");const n=await x.authService.sendPhoneVerification(e,t.verifier);i(!1),T(""),n.success?(v(n.confirmationResult),w.Ay.success("Verification code sent!"),I.A.trackFunnelStep("signup","phone_code_sent")):(I.A.logCustomError("Phone verification failed",{error:n.error}),w.Ay.error(n.error||"Failed to send code"))}catch(t){i(!1),T(""),I.A.logCustomError("Phone send code error",{error:t.message}),w.Ay.error("Failed to send code. Please try again.")}}else w.Ay.error("Please wait for verification to be ready...")},className:"space-y-3",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-semibold text-text-primary mb-2",children:"Phone Number"}),(0,E.jsxs)("div",{className:"flex gap-2",children:[(0,E.jsxs)("select",{value:d,onChange:e=>h(e.target.value),className:"input w-20",children:[(0,E.jsx)("option",{value:"+1",children:"+1"}),(0,E.jsx)("option",{value:"+44",children:"+44"}),(0,E.jsx)("option",{value:"+61",children:"+61"}),(0,E.jsx)("option",{value:"+91",children:"+91"})]}),(0,E.jsx)("input",{type:"tel",value:f,onChange:e=>{const t=e.target.value.replace(/\s/g,"");let n=t;"+61"===d&&t.length>3?(n=t.slice(0,3),t.length>3&&(n+=" "+t.slice(3,6)),t.length>6&&(n+=" "+t.slice(6,9))):"+1"===d&&t.length>3?(n=t.slice(0,3),t.length>3&&(n+=" "+t.slice(3,6)),t.length>6&&(n+=" "+t.slice(6,10))):"+44"===d&&t.length>4?(n=t.slice(0,4),t.length>4&&(n+=" "+t.slice(4,10))):"+91"===d&&t.length>5&&(n=t.slice(0,5),t.length>5&&(n+=" "+t.slice(5,10))),p(n)},className:"input flex-1",placeholder:"435123456",required:!0})]})]}),!_&&(0,E.jsxs)("div",{className:"flex items-center justify-center gap-2 text-xs text-text-secondary",children:[(0,E.jsx)("div",{className:"w-3 h-3 border-2 border-primary border-t-transparent rounded-full animate-spin"}),(0,E.jsx)("span",{children:"Preparing verification..."})]}),(0,E.jsxs)("button",{type:"submit",disabled:n||!_,className:"w-full btn btn-primary flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n&&(0,E.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),n?"Sending Code...":"Send Verification Code"]}),(0,E.jsx)("div",{id:"recaptcha-container"})]})}),(0,E.jsxs)("button",{onClick:A,disabled:!0,className:"w-full btn bg-[#1877F2] text-white hover:bg-[#166FE5] mb-6 opacity-50 cursor-not-allowed",title:"Facebook login coming soon",children:[(0,E.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Continue with Facebook (Coming Soon)"]}),(0,E.jsxs)("div",{className:"relative mb-6",children:[(0,E.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,E.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})}),(0,E.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,E.jsx)("span",{className:"px-2 bg-white dark:bg-gray-800 text-text-secondary",children:"Or"})})]}),(0,E.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),!u())return void w.Ay.error("Please fix the errors before continuing \ud83d\udc9c");let n;i(!0),I.A.trackFunnelStep("signup",e?"click_email_signup":"click_email_signin"),n=e?await x.authService.signUpWithEmail(s.email,s.password,s.displayName):await x.authService.signInWithEmail(s.email,s.password),i(!1),n.success?(I.A.trackFunnelStep("signup",e?"complete_email_signup":"complete_email_signin"),w.Ay.success(e?"Account created!":"Welcome back!"),C("/")):(I.A.logCustomError("Email auth failed",{error:n.error,isSignUp:e}),w.Ay.error(n.error||"Authentication failed"))},className:"space-y-4",children:[e&&(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-semibold text-text-primary mb-2",children:"Display Name"}),(0,E.jsx)("input",{type:"text",value:s.displayName,onChange:e=>l("displayName",e.target.value),onBlur:()=>c("displayName"),className:"input ".concat(o.displayName?"border-red-500 dark:border-red-400":""),placeholder:"Your name"}),o.displayName&&(0,E.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:o.displayName})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-semibold text-text-primary mb-2",children:"Email"}),(0,E.jsx)("input",{type:"email",value:s.email,onChange:e=>l("email",e.target.value),onBlur:()=>c("email"),className:"input ".concat(o.email?"border-red-500 dark:border-red-400":""),placeholder:"you@example.com"}),o.email&&(0,E.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:o.email})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-semibold text-text-primary mb-2",children:"Password"}),(0,E.jsx)("input",{type:"password",value:s.password,onChange:e=>l("password",e.target.value),onBlur:()=>c("password"),className:"input ".concat(o.password?"border-red-500 dark:border-red-400":""),placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"}),o.password&&(0,E.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:o.password})]}),(0,E.jsx)("button",{type:"submit",disabled:n,className:"w-full btn btn-secondary",children:n?"Please wait...":e?"Sign Up":"Sign In"})]}),(0,E.jsx)("div",{className:"mt-6 text-center",children:(0,E.jsx)("button",{onClick:()=>t(!e),className:"text-primary font-semibold hover:underline",children:e?"Already have an account? Sign In":"Don't have an account? Sign Up"})})]}),(0,E.jsx)("div",{className:"text-center mt-6 text-sm text-text-secondary",children:(0,E.jsxs)("p",{children:["By continuing, you agree to our"," ",(0,E.jsx)("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Terms of Service"})," ","and"," ",(0,E.jsx)("a",{href:"/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Privacy Policy"})]})})]})})};var z=n(9628),q=n(3007),K=n(8147),H=n(7688),W=n(4505);const G=()=>{const e=(0,a.Zp)(),t=[{text:"Welcome home, beautiful! \ud83d\udc96",subtext:"We're so relieved you're safe"},{text:"You made it safely! \u2728",subtext:"Your besties can rest easy now"},{text:"Safe and sound! \ud83c\udf38",subtext:"Taking care of yourself like a queen"},{text:"You're safe! \ud83d\udc95",subtext:"That's all that matters"}],[n]=(0,r.useState)(()=>t[Math.floor(Math.random()*t.length)]);return(0,r.useEffect)(()=>{const t=setTimeout(()=>{e("/")},2e3);return()=>clearTimeout(t)},[e]),(0,E.jsxs)("div",{className:"fixed inset-0 bg-gradient-to-br from-emerald-50 via-green-50 via-teal-50 to-cyan-50 dark:from-emerald-900/30 dark:via-green-900/30 dark:to-teal-900/30 flex items-center justify-center p-4 overflow-hidden z-50",children:[(0,E.jsx)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(12)].map((e,t)=>(0,E.jsx)("div",{className:"absolute animate-celebration-float",style:{left:"".concat(100*Math.random(),"%"),top:"".concat(100*Math.random(),"%"),animationDelay:"".concat(2*Math.random(),"s"),animationDuration:"".concat(3+3*Math.random(),"s"),opacity:.4+.4*Math.random()},children:(0,E.jsx)("span",{className:"text-2xl md:text-3xl",children:["\ud83c\udf89","\u2728","\ud83d\udc9a","\ud83c\udf1f","\ud83d\udcab","\ud83c\udf8a"][Math.floor(6*Math.random())]})},t))}),(0,E.jsx)("div",{className:"w-full max-w-sm md:max-w-lg text-center relative z-10 px-2",children:(0,E.jsxs)("div",{className:"relative bg-white/95 dark:bg-gray-800/95 backdrop-blur-xl rounded-3xl p-6 md:p-10 shadow-[0_20px_60px_rgba(16,185,129,0.3)]",children:[(0,E.jsxs)("div",{className:"relative w-24 h-24 md:w-32 md:h-32 mx-auto mb-6",children:[(0,E.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-300 via-green-300 to-teal-300 rounded-full animate-pulse-slow opacity-40 blur-xl"}),(0,E.jsx)("div",{className:"relative w-24 h-24 md:w-32 md:h-32 flex items-center justify-center",children:(0,E.jsxs)("svg",{viewBox:"0 0 100 100",className:"w-20 h-20 md:w-28 md:h-28",children:[(0,E.jsx)("defs",{children:(0,E.jsxs)("linearGradient",{id:"successGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,E.jsx)("stop",{offset:"0%",stopColor:"#10b981"}),(0,E.jsx)("stop",{offset:"50%",stopColor:"#34d399"}),(0,E.jsx)("stop",{offset:"100%",stopColor:"#6ee7b7"})]})}),(0,E.jsx)("circle",{cx:"50",cy:"50",r:"35",fill:"url(#successGradient)",className:"animate-scale-bounce"}),(0,E.jsx)("path",{d:"M30,50 L42,62 L70,34",fill:"none",stroke:"white",strokeWidth:"6",strokeLinecap:"round",strokeLinejoin:"round",className:"animate-draw-success"})]})})]}),(0,E.jsx)("h2",{className:"font-display text-2xl md:text-4xl bg-gradient-to-r from-emerald-500 via-green-500 to-teal-500 bg-clip-text text-transparent mb-2 md:mb-3 leading-tight",children:n.text}),(0,E.jsx)("p",{className:"text-base md:text-xl text-text-secondary font-semibold mb-6 md:mb-8",children:n.subtext}),(0,E.jsxs)("div",{className:"flex justify-center items-center gap-2 md:gap-3 mb-4 md:mb-6",children:[(0,E.jsx)("span",{className:"text-2xl md:text-3xl animate-bounce-gentle",children:"\ud83c\udf89"}),(0,E.jsx)("span",{className:"text-2xl md:text-3xl animate-bounce-gentle",style:{animationDelay:"0.2s"},children:"\ud83d\udc9a"}),(0,E.jsx)("span",{className:"text-2xl md:text-3xl animate-bounce-gentle",style:{animationDelay:"0.4s"},children:"\u2728"})]}),(0,E.jsx)("p",{className:"text-xs text-gray-400 dark:text-gray-500 italic",children:"Until next time, stay safe bestie! \ud83d\udc95"})]})}),(0,E.jsx)("style",{children:"\n        @keyframes celebration-float {\n          0% {\n            transform: translateY(100vh) rotate(0deg);\n            opacity: 0;\n          }\n          10% {\n            opacity: 1;\n          }\n          90% {\n            opacity: 1;\n          }\n          100% {\n            transform: translateY(-100vh) rotate(360deg);\n            opacity: 0;\n          }\n        }\n        @keyframes pulse-slow {\n          0%, 100% { transform: scale(1); opacity: 0.4; }\n          50% { transform: scale(1.3); opacity: 0.2; }\n        }\n        @keyframes scale-bounce {\n          0% { transform: scale(0); }\n          50% { transform: scale(1.1); }\n          100% { transform: scale(1); }\n        }\n        @keyframes draw-success {\n          0% { stroke-dasharray: 0, 100; }\n          100% { stroke-dasharray: 100, 0; }\n        }\n        @keyframes bounce-gentle {\n          0%, 100% { transform: translateY(0); }\n          50% { transform: translateY(-10px); }\n        }\n        .animate-celebration-float {\n          animation: celebration-float 5s ease-in-out infinite;\n        }\n        .animate-pulse-slow {\n          animation: pulse-slow 3s ease-in-out infinite;\n        }\n        .animate-scale-bounce {\n          animation: scale-bounce 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);\n        }\n        .animate-draw-success {\n          animation: draw-success 0.8s ease-in-out 0.3s forwards;\n          stroke-dasharray: 100;\n          stroke-dashoffset: 100;\n        }\n        .animate-bounce-gentle {\n          animation: bounce-gentle 1s ease-in-out infinite;\n        }\n      "})]})},Q=e=>{let{timeLeft:t,duration:n,isAlerted:r,onExtend:i,extendingButton:s,onEditTime:a}=e;return(0,E.jsxs)("div",{className:"mb-6",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,E.jsx)("span",{className:"text-base font-semibold text-text-secondary",children:"Time remaining:"}),(0,E.jsx)("span",{className:"font-display text-3xl ".concat(0===t?"text-danger":"text-primary"),children:0===t?"EXPIRED":(e=>{const t=Math.floor(e/1e3),n=Math.floor(t/3600),r=Math.floor(t%3600/60),i=t%60;return n>0?"".concat(n,"h ").concat(r,"m ").concat(i,"s"):"".concat(r,"m ").concat(i,"s")})(t)})]}),(0,E.jsx)("div",{className:"progress-bar h-3",children:(0,E.jsx)("div",{className:"progress-fill",style:{width:"".concat((()=>{const e=60*n*1e3,r=e-t;return Math.min(100,Math.max(0,r/e*100))})(),"%")}})}),!r&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)("div",{className:"grid grid-cols-3 gap-2 mt-3",children:[(0,E.jsx)("button",{onClick:()=>i(15),disabled:null!==s,className:"btn btn-secondary text-sm py-2 active:scale-95",children:"+15m"}),(0,E.jsx)("button",{onClick:()=>i(30),disabled:null!==s,className:"btn btn-secondary text-sm py-2 active:scale-95",children:"+30m"}),(0,E.jsx)("button",{onClick:()=>i(60),disabled:null!==s,className:"btn btn-secondary text-sm py-2 active:scale-95",children:"+60m"})]}),a&&(0,E.jsx)("button",{onClick:a,className:"w-full mt-2 text-xs text-primary hover:text-primary-dark transition-colors underline",children:"\u270f\ufe0f Set specific time"})]})]})},Y=e=>{let{photoURLs:t,isAlerted:n,uploadingPhoto:r,onPhotoUpload:i,onRemovePhoto:s}=e;const{isDark:a}=(0,_.D)();return(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsxs)("div",{className:"text-sm font-semibold text-text-secondary mb-2",children:["Photos (",t.length,"/5)"]}),0===t.length&&(0,E.jsxs)("div",{className:"mb-3 p-8 rounded-xl ".concat(a?"bg-gray-800":"bg-gray-100"," flex flex-col items-center justify-center border-2 border-dashed ").concat(a?"border-gray-600":"border-gray-300"),children:[(0,E.jsx)("div",{className:"text-6xl mb-2 opacity-50",children:"\ud83d\uddbc\ufe0f"}),(0,E.jsx)("div",{className:"text-sm font-semibold ".concat(a?"text-gray-400":"text-gray-500"),children:"No photos yet"})]}),t.length>0&&(0,E.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-3",children:t.map((e,t)=>(0,E.jsxs)("div",{className:"relative aspect-square",children:[(0,E.jsx)("img",{src:e,alt:"Check-in ".concat(t+1),className:"w-full h-full object-cover rounded-xl"}),!n&&(0,E.jsx)("button",{onClick:()=>s(t),className:"absolute top-1 right-1 bg-red-500 text-white w-6 h-6 rounded-full text-sm font-bold hover:bg-red-600 flex items-center justify-center",children:"\u2715"})]},t))}),!n&&t.length<5&&(0,E.jsxs)("label",{className:"border-2 border-dashed ".concat(a?"border-gray-600 hover:bg-primary/10":"border-gray-300 hover:bg-primary/5"," rounded-xl p-6 flex flex-col items-center justify-center cursor-pointer hover:border-primary transition-all"),children:[(0,E.jsx)("div",{className:"text-4xl mb-2",children:"\ud83d\udcf7"}),(0,E.jsx)("div",{className:"text-sm font-semibold ".concat(a?"text-gray-300":"text-gray-600"),children:r?"Uploading...":t.length>0?"Add More Photos":"Add Photos"}),(0,E.jsx)("div",{className:"text-xs ".concat(a?"text-gray-400":"text-gray-500"," mt-1"),children:"Click to upload (up to 5, max 5MB each)"}),(0,E.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:i,className:"hidden",disabled:r})]})]})},J=e=>{let{notes:t,setNotes:n,editingNotes:r,setEditingNotes:i,onSaveNotes:s,isAlerted:a,checkInNotes:o}=e;const{isDark:l}=(0,_.D)();return(0,E.jsx)("div",{className:"mb-4",children:r?(0,E.jsxs)("div",{children:[(0,E.jsx)("textarea",{value:t,onChange:e=>n(e.target.value),className:"w-full p-3 border-2 ".concat(l?"border-gray-600 bg-gray-800 text-gray-100":"border-gray-300 bg-white text-gray-900"," rounded-xl focus:border-primary focus:outline-none resize-none"),rows:"3",placeholder:"Add notes about your check-in..."}),(0,E.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,E.jsx)("button",{onClick:s,className:"btn btn-primary text-sm flex-1",children:"\ud83d\udcbe Save Notes"}),(0,E.jsx)("button",{onClick:()=>{i(!1),n(o||"")},className:"btn btn-secondary text-sm flex-1",children:"Cancel"})]})]}):(0,E.jsx)("div",{children:t?(0,E.jsxs)("div",{className:"".concat(l?"bg-gray-800":"bg-gray-50"," p-3 rounded-xl"),children:[(0,E.jsxs)("div",{className:"flex items-start justify-between mb-1",children:[(0,E.jsx)("div",{className:"text-xs font-semibold ".concat(l?"text-gray-400":"text-gray-500"),children:"NOTES:"}),!a&&(0,E.jsx)("button",{onClick:()=>{z.A.light(),i(!0)},className:"text-xs text-primary font-semibold hover:underline",children:"Edit"})]}),(0,E.jsx)("p",{className:"text-sm text-text-secondary",children:t})]}):!a&&(0,E.jsx)("button",{onClick:()=>{z.A.light(),i(!0)},className:"w-full border-2 border-dashed ".concat(l?"border-gray-600 text-gray-300 hover:bg-primary/10":"border-gray-300 text-gray-600 hover:bg-primary/5"," rounded-xl p-3 text-sm font-semibold hover:border-primary transition-all"),children:"\ud83d\udcdd Add Notes"})})})},X=e=>{let{enteredPasscode:t,setEnteredPasscode:n,onSubmit:r,onClose:i,isDark:s}=e;return(0,E.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,E.jsxs)("div",{className:"".concat(s?"bg-gray-800":"bg-white"," rounded-2xl max-w-md w-full p-6"),children:[(0,E.jsx)("h2",{className:"text-2xl font-display ".concat(s?"text-gray-100":"text-text-primary"," mb-2"),children:"\ud83d\udd12 Enter Passcode"}),(0,E.jsx)("p",{className:"text-text-secondary mb-4",children:"Enter your safety passcode to mark yourself safe"}),(0,E.jsx)("div",{className:"mb-6",children:(0,E.jsx)("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",value:t,onChange:e=>n(e.target.value.replace(/\D/g,"")),onKeyPress:e=>{"Enter"===e.key&&r()},className:"w-full px-3 py-3 border-2 ".concat(s?"border-gray-600 bg-gray-700 text-gray-100":"border-gray-300 bg-white text-gray-900"," rounded-lg focus:border-primary focus:outline-none text-center text-3xl tracking-widest"),placeholder:"\u2022\u2022\u2022\u2022",maxLength:6,autoFocus:!0})}),(0,E.jsxs)("div",{className:"flex gap-3",children:[(0,E.jsx)("button",{onClick:i,className:"flex-1 btn btn-secondary",children:"Cancel"}),(0,E.jsx)("button",{onClick:r,disabled:!t,className:"flex-1 btn btn-success",children:"Confirm"})]}),(0,E.jsx)("p",{className:"text-xs text-text-secondary text-center mt-4",children:"Forgot your passcode? Update it in Settings"})]})})},$=e=>{let{isOpen:t,onClose:n,checkInId:i,currentAlertTime:s,onTimeUpdated:a,isDark:o}=e;const[l,c]=(0,r.useState)("");if(!t)return null;return(0,E.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:n,children:(0,E.jsxs)("div",{className:"".concat(o?"bg-gray-800":"bg-white"," rounded-2xl p-6 max-w-sm w-full shadow-xl"),onClick:e=>e.stopPropagation(),children:[(0,E.jsx)("h3",{className:"text-lg font-display text-text-primary mb-4 text-center",children:"\u23f0 Set Alert Time"}),(0,E.jsx)("p",{className:"text-sm text-text-secondary mb-4 text-center",children:"Choose when you want to be reminded to check in"}),(0,E.jsx)("input",{type:"datetime-local",value:l,onChange:e=>c(e.target.value),min:(new Date).toISOString().slice(0,16),className:"w-full p-3 rounded-xl border-2 ".concat(o?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"," text-text-primary mb-4")}),(0,E.jsxs)("div",{className:"flex gap-2",children:[(0,E.jsx)("button",{onClick:n,className:"flex-1 btn btn-secondary",children:"Cancel"}),(0,E.jsx)("button",{onClick:async()=>{if(!l)return void w.Ay.error("Please select a time");const e=new Date(l);if(e<=new Date)w.Ay.error("Please select a future time");else try{await(0,j.mZ)((0,j.H9)(x.db,"checkins",i),{alertTime:j.Dc.fromDate(e)}),a(e),w.Ay.success("Alert time updated!"),n(),c("")}catch(t){console.error("Error updating alert time:",t),w.Ay.error("Failed to update alert time")}},className:"flex-1 btn btn-primary",children:"Save"})]})]})})},Z=e=>{var t,i;let{checkIn:s}=e;const{currentUser:o,userData:l}=(0,k.As)(),{isDark:c}=(0,_.D)(),u=(0,a.Zp)(),[d,h]=(0,r.useState)(0),[f,p]=(0,r.useState)(null),[m,g]=(0,r.useState)(!1),[y,v]=(0,r.useState)(s.notes||""),[b,I]=(0,r.useState)((null===(t=s.photoURLs)||void 0===t?void 0:t.length)>0?s.photoURLs.filter(e=>e&&""!==e.trim()):s.photoURL?[s.photoURL]:[]),[S,N]=(0,r.useState)(!1),[T,C]=(0,r.useState)(null),{executeOptimistic:A}=(0,H.Ay)(),{completeCheckIn:P,loading:D,showSafeLoader:R,setShowSafeLoader:O}=function(e,t){const n=(0,a.Zp)(),[i,s]=(0,r.useState)(!1),[o,l]=(0,r.useState)(!1);return{completeCheckIn:async()=>{l(!0);try{var r;s(!0);const o=await W.Ay.completeCheckIn({checkInId:e});var i;if(null===(r=o.data)||void 0===r||!r.success)throw new Error((null===(i=o.error)||void 0===i?void 0:i.message)||"Failed to complete check-in");const l=(0,j.H9)(x.db,"checkins",e),c=await(0,j.x7)(l);if(!c.exists()||"completed"!==c.data().status)throw new Error("Check-in status verification failed");try{const e=(0,j.rJ)(x.db,"notifications"),n=(0,j.P)(e,(0,j._M)("userId","==",t.uid),(0,j._M)("type","in",["checkin_reminder","checkin_urgent"])),r=(await(0,j.GG)(n)).docs.map(e=>(0,j.kd)(e.ref));await Promise.all(r)}catch(a){console.error("Error deleting check-in notifications:",a)}const u=c.data(),d=u.duration||0;(0,x.logAnalyticsEvent)("checkin_completed",{duration:d,was_extended:u.extended||!1}),setTimeout(()=>{n("/"),w.Ay.success("You're safe! Welcome home \ud83d\udc9c",{duration:4e3,icon:"\u2705"})},2e3)}catch(a){console.error("Error completing check-in:",a),l(!1),w.Ay.error("Failed to complete check-in. Please try again.")}finally{s(!1)}},loading:i,showSafeLoader:o,setShowSafeLoader:l}}(s.id,o),{currentLocation:M,setCurrentLocation:L,updatingLocation:F,updateLocation:U}=function(e){const[t,n]=(0,r.useState)(!1),[i,s]=(0,r.useState)(""),a=async()=>{if(navigator.geolocation){n(!0),w.Ay.loading("Getting your location...",{id:"location-update"});try{const t=await new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(e,t,{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})}),{latitude:r,longitude:i,accuracy:a}=t.coords,o=await fetch("https://maps.googleapis.com/maps/api/geocode/json?latlng=".concat(r,",").concat(i,"&key=").concat("AIzaSyBIotp3fl0_9y7xbyPUI79hsZR9Cw3g4l4")),l=await o.json();let c="GPS: ".concat(r.toFixed(6),", ").concat(i.toFixed(6));l.results&&l.results.length>0&&(c=l.results[0].formatted_address),await(0,j.mZ)((0,j.H9)(x.db,"checkins",e),{location:c,gpsCoords:{lat:r,lng:i},locationAccuracy:a,locationUpdatedAt:j.Dc.now()}),s(c),w.Ay.dismiss("location-update"),w.Ay.success("Location updated! (\xb1".concat(Math.round(a),"m accuracy)")),n(!1)}catch(t){console.error("Error updating location:",t),w.Ay.dismiss("location-update"),1===t.code?(w.Ay.error("Location permission denied. Please enable location access in your browser settings.",{duration:6e3,icon:"\ud83d\udccd"}),setTimeout(async()=>{try{"prompt"===(await navigator.permissions.query({name:"geolocation"})).state&&(w.Ay.loading("Requesting location permission...",{id:"location-perm-card"}),navigator.geolocation.getCurrentPosition(()=>{w.Ay.dismiss("location-perm-card"),w.Ay.success("Location permission granted!"),a()},()=>{w.Ay.dismiss("location-perm-card"),w.Ay.error("Please enable location in your browser settings: Settings \u2192 Privacy \u2192 Location",{duration:6e3})},{enableHighAccuracy:!0,timeout:5e3}))}catch(e){console.log("Permissions API not supported")}},2e3)):2===t.code?w.Ay.error("Location unavailable. Make sure GPS/Location Services are enabled on your device.",{duration:5e3}):3===t.code?w.Ay.error("Location timeout. Please move to an area with better GPS signal and try again.",{duration:5e3}):w.Ay.error("Failed to update location. Please try again."),n(!1)}}else w.Ay.error("Geolocation is not supported by your browser")};return{currentLocation:i,setCurrentLocation:s,updatingLocation:t,updateLocation:a}}(s.id),[V,B]=(0,r.useState)(!1),[Z,ee]=(0,r.useState)(""),[te,ne]=(0,r.useState)(!1),[re,ie]=(0,r.useState)("");(0,r.useEffect)(()=>{var e;const t=(null===(e=s.photoURLs)||void 0===e?void 0:e.length)>0?s.photoURLs.filter(e=>e&&""!==e.trim()):s.photoURL?[s.photoURL]:[];I(t)},[s.photoURLs,s.photoURL]),(0,r.useEffect)(()=>{const e=()=>{const e=(T||s.alertTime.toDate())-new Date;h(Math.max(0,e))};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[s.alertTime,T]);const se=async function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null!==l&&void 0!==l&&null!==(e=l.security)&&void 0!==e&&e.safetyPasscode?B(!0):(t||z.A.success(),await P())};(0,r.useEffect)(()=>{s.location&&L(s.location)},[s.location,L]);const ae=async()=>{O(!0);try{await W.Ay.completeCheckIn({checkInId:s.id});const e={userId:s.userId,checkInId:s.id,type:"alert",_internal_duress:!0,message:"\ud83d\udea8 DURESS CODE USED - ".concat((null===l||void 0===l?void 0:l.displayName)||"User"," may be in danger!"),location:s.location,timestamp:j.Dc.now(),priority:"critical"};await(0,j.gS)((0,j.rJ)(x.db,"alerts"),e),setTimeout(()=>{u("/"),w.Ay.success("You're safe! Welcome home \ud83d\udc9c",{duration:4e3,icon:"\u2705"})},2e3)}catch(e){console.error("Error handling duress code:",e),setTimeout(()=>{u("/"),w.Ay.success("You're safe! Welcome home \ud83d\udc9c",{duration:4e3,icon:"\u2705"})},2e3)}},oe="alerted"===s.status;return R?(0,E.jsx)(G,{}):(0,E.jsxs)("div",{className:"card p-6 ".concat(oe?"border-2 border-danger":""),children:[(0,E.jsx)(Q,{timeLeft:d,duration:s.duration,isAlerted:oe,onExtend:async e=>{z.A.light();const t=T||s.alertTime.toDate(),r=new Date(t.getTime()+60*e*1e3);C(r),p(e),w.Ay.success("Extended by ".concat(e," minutes!"),{duration:2e3});try{var i;const t=await W.Ay.extendCheckIn({checkInId:s.id,additionalMinutes:e});var a;if(null===(i=t.data)||void 0===i||!i.success)throw new Error((null===(a=t.error)||void 0===a?void 0:a.message)||"Failed to extend check-in");{const t=(0,j.H9)(x.db,"checkins",s.id),r=await(0,j.x7)(t);if(!r.exists())throw new Error("Unable to verify extension");{C(r.data().alertTime.toDate());const{logAnalyticsEvent:t}=n(3984);t("checkin_extended",{minutes_added:e,checkin_id:s.id})}}}catch(o){console.error("Error extending check-in:",o),C(null),"unavailable"===o.code?w.Ay.error("Cannot reach server. Extension cancelled.",{duration:4e3}):w.Ay.error(o.message||"Failed to extend check-in. Extension cancelled.",{duration:4e3})}finally{p(null)}},extendingButton:f,onEditTime:()=>ne(!0)}),!oe&&(0,E.jsx)("button",{onClick:se,disabled:D,className:"w-full btn btn-success text-lg mb-6",children:"\u2705 I'm Safe!"}),oe&&(0,E.jsxs)("div",{className:"bg-danger/10 border border-danger rounded-xl p-4 text-center mb-6",children:[(0,E.jsx)("p",{className:"font-semibold text-danger mb-2",children:"\ud83d\udea8 Your besties have been alerted!"}),(0,E.jsx)("p",{className:"text-sm text-text-secondary mb-4",children:"They know you haven't checked in"}),(0,E.jsx)("button",{onClick:()=>{z.A.warning(),se(!0)},disabled:D,className:"btn btn-success w-full",children:"\u2705 I'm Safe! (False Alarm)"})]}),(0,E.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,E.jsx)("div",{className:"flex-1",children:(0,E.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,E.jsx)("h3",{className:"font-display text-lg text-text-primary",children:M||"No location set"}),oe&&(0,E.jsx)("span",{className:"badge badge-warning text-xs",children:"ALERTED"})]})})}),(b.length>0||!oe)&&(0,E.jsx)(Y,{photoURLs:b,isAlerted:oe,uploadingPhoto:S,onPhotoUpload:async e=>{z.A.medium();const t=Array.from(e.target.files);if(0===t.length)return;if(b.length+t.length>5)return void w.Ay.error("You can only have up to 5 photos per check-in");for(const i of t)if(i.size>5242880)return void w.Ay.error("".concat(i.name," is too large. Photos must be less than 5MB"));N(!0);const n=t.map(e=>URL.createObjectURL(e)),r=[...b];await A({optimisticUpdate:()=>{I([...b,...n])},serverUpdate:async()=>{try{const i=[];for(let n=0;n<t.length;n++){const r=t[n];try{const e=(0,K.KR)(x.storage,"checkin-photos/".concat(s.userId,"/").concat(Date.now(),"_").concat(n,"_").concat(r.name));await(0,K.D)(e,r);const t=await(0,K.qk)(e);t&&i.push(t)}catch(e){console.error("Error uploading photo ".concat(n,":"),e),w.Ay.error("Failed to upload ".concat(r.name))}}const a=[...r,...i].filter(e=>void 0!==e&&null!==e);return await(0,j.mZ)((0,j.H9)(x.db,"checkins",s.id),{photoURLs:a}),I(a),n.forEach(e=>URL.revokeObjectURL(e)),a}finally{N(!1)}},rollback:()=>{I(r),n.forEach(e=>URL.revokeObjectURL(e)),N(!1)},successMessage:"".concat(t.length," photo").concat(t.length>1?"s":""," uploaded!"),errorMessage:"Failed to upload photos"})},onRemovePhoto:async e=>{z.A.light();const t=[...b],n=b.filter((t,n)=>n!==e).filter(e=>void 0!==e&&null!==e);await A({optimisticUpdate:()=>{I(n)},serverUpdate:async()=>{await(0,j.mZ)((0,j.H9)(x.db,"checkins",s.id),{photoURLs:n})},rollback:()=>{I(t)},successMessage:"Photo removed",errorMessage:"Failed to remove photo"})}}),(0,E.jsx)(J,{notes:y,setNotes:v,editingNotes:m,setEditingNotes:g,onSaveNotes:async()=>{const e=s.notes||"";await A({optimisticUpdate:()=>{g(!1)},serverUpdate:async()=>{await(0,j.mZ)((0,j.H9)(x.db,"checkins",s.id),{notes:y})},rollback:()=>{v(e),g(!0)},successMessage:"Notes updated!",errorMessage:"Failed to save notes"})},isAlerted:oe,checkInNotes:s.notes}),!oe&&(0,E.jsx)("div",{className:"mb-4",children:(0,E.jsxs)("button",{onClick:()=>{z.A.medium(),U()},disabled:F,className:"w-full border-2 border-dashed ".concat(c?"border-gray-600 text-gray-300 hover:bg-primary/10":"border-gray-300 text-gray-600 hover:bg-primary/5"," rounded-xl p-3 text-sm font-semibold hover:border-primary transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"),children:["\ud83d\udccd ",F?"Updating Location...":"Note Current Location"]})}),(s.meetingWith||s.socialMediaLinks)&&(0,E.jsxs)("div",{className:"mb-4",children:[s.meetingWith&&(0,E.jsxs)("div",{className:"".concat(c?"bg-gray-800":"bg-gray-50"," p-3 rounded-xl mb-2"),children:[(0,E.jsx)("div",{className:"text-xs font-semibold ".concat(c?"text-gray-400":"text-gray-500"," mb-1"),children:"MEETING WITH:"}),(0,E.jsx)("p",{className:"text-sm text-text-primary font-semibold",children:s.meetingWith})]}),s.socialMediaLinks&&(0,E.jsxs)("div",{className:"".concat(c?"bg-purple-900/30":"bg-purple-50"," p-3 rounded-xl border-2 ").concat(c?"border-purple-800":"border-purple-200"),children:[(0,E.jsx)("div",{className:"text-xs font-semibold ".concat(c?"text-purple-300":"text-purple-700"," mb-1"),children:"THEIR SOCIAL MEDIA:"}),(0,E.jsx)("p",{className:"text-sm text-text-primary",children:s.socialMediaLinks})]})]}),(0,E.jsx)("div",{className:"mb-4",children:(0,E.jsxs)("div",{className:"text-sm text-text-secondary mb-2",children:["Watching over you: ",(null===(i=s.bestieIds)||void 0===i?void 0:i.length)||0," besties"]})}),(0,E.jsxs)("div",{className:"mt-4 text-xs text-text-secondary text-center",children:["Started ",(0,q.m)(s.createdAt.toDate(),{addSuffix:!0})]}),V&&(0,E.jsx)(X,{enteredPasscode:Z,setEnteredPasscode:ee,onSubmit:async()=>{var e,t;const n=null===l||void 0===l||null===(e=l.security)||void 0===e?void 0:e.safetyPasscode,r=null===l||void 0===l||null===(t=l.security)||void 0===t?void 0:t.duressCode;if(Z){if(r&&Z===r)return B(!1),ee(""),void await ae();if(Z===n)return z.A.success(),B(!1),ee(""),void await P();w.Ay.error("Incorrect passcode"),ee("")}else w.Ay.error("Please enter your passcode")},onClose:()=>{B(!1),ee("")},isDark:c}),(0,E.jsx)($,{isOpen:te,onClose:()=>ne(!1),checkInId:s.id,currentAlertTime:T||s.alertTime.toDate(),onTimeUpdated:e=>C(e),isDark:c})]})};var ee=n(5979);const te=e=>{let{onClose:t}=e;const n=(0,a.Zp)(),[i,s]=(0,r.useState)(""),[o,l]=(0,r.useState)(30);return(0,E.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:(0,E.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full p-6",onClick:e=>e.stopPropagation(),children:[(0,E.jsxs)("h2",{className:"text-2xl font-display text-text-primary mb-4 flex items-center gap-2",children:[(0,E.jsx)("span",{children:"\ud83d\ude97"})," Rideshare Check-In"]}),(0,E.jsx)("p",{className:"text-sm text-text-secondary mb-6",children:"Enter your vehicle registration and select duration"}),(0,E.jsxs)("div",{className:"mb-6",children:[(0,E.jsx)("label",{className:"block text-sm font-semibold text-text-primary mb-2",children:"Registration / License Plate"}),(0,E.jsx)("input",{type:"text",value:i,onChange:e=>s(e.target.value.toUpperCase()),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),e.target.blur())},placeholder:"ABC123",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 dark:border-gray-600 focus:border-primary focus:outline-none text-lg font-semibold text-center",autoFocus:!0})]}),(0,E.jsxs)("div",{className:"mb-6",children:[(0,E.jsxs)("label",{className:"block text-sm font-semibold text-text-primary mb-2",children:["Duration: ",o," minutes"]}),(0,E.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-3",children:[10,15,30,45].map(e=>(0,E.jsxs)("button",{type:"button",onClick:()=>l(e),className:"py-2 px-3 rounded-lg text-sm font-semibold transition-all ".concat(o===e?"bg-gradient-primary text-white shadow-lg":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:[e,"m"]},e))}),(0,E.jsx)("input",{type:"range",min:"10",max:"90",step:"5",value:o,onChange:e=>l(parseInt(e.target.value)),className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer slider"}),(0,E.jsxs)("div",{className:"flex justify-between text-xs text-text-secondary mt-1",children:[(0,E.jsx)("span",{children:"10 min"}),(0,E.jsx)("span",{children:"90 min"})]})]}),(0,E.jsxs)("div",{className:"flex gap-3",children:[(0,E.jsx)("button",{onClick:t,className:"flex-1 btn btn-secondary",children:"Cancel"}),(0,E.jsx)("button",{onClick:()=>{i.trim()&&(z.A.light(),n("/create",{state:{quickType:"rideshare",rego:i.trim(),duration:o,skipLocation:!0,activity:{name:"\ud83d\ude97 Rideshare",emoji:"\ud83d\ude97"}}}))},disabled:!i.trim(),className:"flex-1 btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Start Check-In"})]})]})})},ne=e=>{let{onClose:t}=e;const n=(0,a.Zp)(),[i,s]=(0,r.useState)(15);return(0,E.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:(0,E.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full p-6",onClick:e=>e.stopPropagation(),children:[(0,E.jsxs)("h2",{className:"text-2xl font-display text-text-primary mb-4 flex items-center gap-2",children:[(0,E.jsx)("span",{children:"\ud83d\udeb6\u200d\u2640\ufe0f"})," Walking Alone"]}),(0,E.jsx)("p",{className:"text-sm text-text-secondary mb-6",children:"Select duration and start your check-in. You can add location details during your walk."}),(0,E.jsxs)("div",{className:"mb-6",children:[(0,E.jsxs)("label",{className:"block text-sm font-semibold text-text-primary mb-2",children:["Duration: ",i," minutes"]}),(0,E.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-3",children:[10,15,30,45].map(e=>(0,E.jsxs)("button",{type:"button",onClick:()=>s(e),className:"py-2 px-3 rounded-lg text-sm font-semibold transition-all ".concat(i===e?"bg-gradient-primary text-white shadow-lg":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:[e,"m"]},e))}),(0,E.jsx)("input",{type:"range",min:"10",max:"90",step:"5",value:i,onChange:e=>s(parseInt(e.target.value)),className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer slider"}),(0,E.jsxs)("div",{className:"flex justify-between text-xs text-text-secondary mt-1",children:[(0,E.jsx)("span",{children:"10 min"}),(0,E.jsx)("span",{children:"90 min"})]})]}),(0,E.jsxs)("div",{className:"flex gap-3",children:[(0,E.jsx)("button",{onClick:t,className:"flex-1 btn btn-secondary",children:"Cancel"}),(0,E.jsx)("button",{onClick:()=>{z.A.light(),n("/create",{state:{quickType:"walking",duration:i,skipLocation:!0,activity:{name:"\ud83d\udeb6\u200d\u2640\ufe0f Walking Alone",emoji:"\ud83d\udeb6\u200d\u2640\ufe0f"}}})},className:"flex-1 btn btn-primary",children:"Start Check-In"})]})]})})},re=e=>{let{onClose:t}=e;const n=(0,a.Zp)(),[i,s]=(0,r.useState)(""),[o,l]=(0,r.useState)(30);return(0,E.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:(0,E.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full p-6",onClick:e=>e.stopPropagation(),children:[(0,E.jsxs)("h2",{className:"text-2xl font-display text-text-primary mb-4 flex items-center gap-2",children:[(0,E.jsx)("span",{children:"\ud83d\udc64"})," Quick Meet"]}),(0,E.jsx)("p",{className:"text-sm text-text-secondary mb-6",children:"Enter who you're meeting and select duration"}),(0,E.jsxs)("div",{className:"mb-6",children:[(0,E.jsx)("label",{className:"block text-sm font-semibold text-text-primary mb-2",children:"Who are you meeting?"}),(0,E.jsx)("input",{type:"text",value:i,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),e.target.blur())},placeholder:"e.g., Sarah from Marketplace",className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 dark:border-gray-600 focus:border-primary focus:outline-none",autoFocus:!0})]}),(0,E.jsxs)("div",{className:"mb-6",children:[(0,E.jsxs)("label",{className:"block text-sm font-semibold text-text-primary mb-2",children:["Duration: ",o," minutes"]}),(0,E.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-3",children:[10,15,30,45].map(e=>(0,E.jsxs)("button",{type:"button",onClick:()=>l(e),className:"py-2 px-3 rounded-lg text-sm font-semibold transition-all ".concat(o===e?"bg-gradient-primary text-white shadow-lg":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:[e,"m"]},e))}),(0,E.jsx)("input",{type:"range",min:"10",max:"90",step:"5",value:o,onChange:e=>l(parseInt(e.target.value)),className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer slider"}),(0,E.jsxs)("div",{className:"flex justify-between text-xs text-text-secondary mt-1",children:[(0,E.jsx)("span",{children:"10 min"}),(0,E.jsx)("span",{children:"90 min"})]})]}),(0,E.jsxs)("div",{className:"flex gap-3",children:[(0,E.jsx)("button",{onClick:t,className:"flex-1 btn btn-secondary",children:"Cancel"}),(0,E.jsx)("button",{onClick:()=>{i.trim()&&(z.A.light(),n("/create",{state:{quickType:"quickmeet",meetingWith:i.trim(),duration:o,skipLocation:!0,activity:{name:"\ud83d\udc64 Meeting Someone",emoji:"\ud83d\udc64"}}}))},disabled:!i.trim(),className:"flex-1 btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Start Check-In"})]})]})})},ie=()=>{const e=(0,a.Zp)(),[t,n]=(0,r.useState)(!1),[i,s]=(0,r.useState)(!1),[o,l]=(0,r.useState)(!1);return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)("div",{className:"mb-6",children:[(0,E.jsxs)("div",{className:"flex items-center mb-4",children:[(0,E.jsx)("h2",{className:"text-xl font-display text-text-primary",children:"Quick Check-In"}),(0,E.jsx)(ee.A,{message:"Start a quick safety check-in! Choose a preset (rideshare, walking, or meeting someone) or create a custom check-in. Your selected besties will be notified if you don't check back in. \u2728"})]}),(0,E.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[(0,E.jsxs)("button",{onClick:()=>{z.A.light(),n(!0)},className:"card p-4 hover:shadow-card-hover transition-all hover:scale-105 active:scale-95 bg-gradient-to-br from-amber-400 to-orange-500 text-white",children:[(0,E.jsx)("div",{className:"text-3xl mb-2",children:"\ud83d\ude97"}),(0,E.jsx)("div",{className:"font-display text-sm",children:"Rideshare"})]}),(0,E.jsxs)("button",{onClick:()=>{z.A.light(),s(!0)},className:"card p-4 hover:shadow-card-hover transition-all hover:scale-105 active:scale-95 bg-gradient-to-br from-blue-400 to-cyan-500 text-white",children:[(0,E.jsx)("div",{className:"text-3xl mb-2",children:"\ud83d\udeb6\u200d\u2640\ufe0f"}),(0,E.jsx)("div",{className:"font-display text-sm",children:"Walking"})]}),(0,E.jsxs)("button",{onClick:()=>{z.A.light(),l(!0)},className:"card p-4 hover:shadow-card-hover transition-all hover:scale-105 active:scale-95 bg-gradient-to-br from-purple-400 to-indigo-500 text-white",children:[(0,E.jsx)("div",{className:"text-3xl mb-2",children:"\ud83d\udc64"}),(0,E.jsx)("div",{className:"font-display text-sm",children:"Quick Meet"})]})]}),(0,E.jsxs)("button",{onClick:()=>{z.A.light(),e("/create")},className:"w-full card p-4 hover:shadow-card-hover transition-all hover:scale-105 active:scale-95 bg-gradient-to-br from-rose-400 to-pink-500 text-white",children:[(0,E.jsx)("div",{className:"text-3xl mb-2",children:"\u2728"}),(0,E.jsx)("div",{className:"font-display text-lg",children:"Create Custom Check-In"})]})]}),t&&(0,E.jsx)(te,{onClose:()=>n(!1)}),i&&(0,E.jsx)(ne,{onClose:()=>s(!1)}),o&&(0,E.jsx)(re,{onClose:()=>l(!1)})]})},se=e=>{let{onClose:t,circleCount:n}=e;const r=e=>{const n=window.location.origin,r="Hey! I'm using Besties to stay safe when I go out. It's a safety app where your close friends can check in on you. Want to be part of my safety circle? \ud83d\udc9c\n\nJoin me on Besties: ".concat(n),i=encodeURIComponent(r),s=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);switch(e){case"whatsapp":s?window.location.href="whatsapp://send?text=".concat(i):window.open("https://wa.me/?text=".concat(i),"_blank");break;case"messenger":s?(window.location.href="fb-messenger://share?link=".concat(encodeURIComponent(n)),setTimeout(()=>{window.open("https://www.facebook.com/dialog/send?link=".concat(encodeURIComponent(n),"&app_id=&redirect_uri=").concat(encodeURIComponent(n)),"_blank")},1500)):window.open("https://www.facebook.com/dialog/send?link=".concat(encodeURIComponent(n),"&app_id=&redirect_uri=").concat(encodeURIComponent(n)),"_blank","width=600,height=400");break;case"instagram":navigator.clipboard.writeText(r).then(()=>{w.Ay.success("Message copied! Opening Instagram DMs..."),s?(window.location.href="instagram://direct/inbox",setTimeout(()=>{window.open("https://www.instagram.com/direct/inbox/","_blank")},1500)):window.open("https://www.instagram.com/direct/inbox/","_blank")}).catch(()=>{w.Ay.error("Failed to copy message")});break;case"sms":window.location.href="sms:?body=".concat(i);break;case"facebook":const e=encodeURIComponent("Join my safety circle on Besties! \ud83d\udc9c"),t=encodeURIComponent(n);s?(window.location.href="fb://profile",setTimeout(()=>{window.open("https://www.facebook.com/sharer/sharer.php?u=".concat(t,"&quote=").concat(e),"_blank")},1500)):window.open("https://www.facebook.com/sharer/sharer.php?u=".concat(t,"&quote=").concat(e),"_blank","width=600,height=400")}w.Ay.success("Opening ".concat(e,"...")),t()};return(0,E.jsx)("div",{className:"fixed inset-0 bg-black/60 dark:bg-black/75 flex items-center justify-center z-50 p-4 backdrop-blur-sm",onClick:t,children:(0,E.jsxs)("div",{className:"card max-w-lg w-full p-0 animate-scale-up overflow-hidden relative bg-gradient-to-br from-pink-50 via-purple-50 to-pink-50 dark:from-pink-900/20 dark:via-purple-900/20 dark:to-pink-900/20 border-2 border-pink-200 dark:border-pink-600 shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,E.jsx)("button",{onClick:t,className:"absolute top-4 right-4 z-10 w-8 h-8 rounded-full bg-white dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center justify-center transition-colors shadow-md text-gray-700 dark:text-gray-300",children:"\u2715"}),(0,E.jsxs)("div",{className:"bg-gradient-to-r from-primary via-purple-500 to-pink-500 p-4 md:p-8 text-center relative overflow-hidden",children:[(0,E.jsx)("div",{className:"absolute top-0 right-0 w-24 h-24 md:w-32 md:h-32 bg-white/10 rounded-full -mr-12 md:-mr-16 -mt-12 md:-mt-16"}),(0,E.jsx)("div",{className:"absolute bottom-0 left-0 w-16 h-16 md:w-24 md:h-24 bg-white/10 rounded-full -ml-8 md:-ml-12 -mb-8 md:-mb-12"}),(0,E.jsxs)("div",{className:"relative z-10",children:[(0,E.jsx)("div",{className:"text-4xl md:text-6xl mb-2 md:mb-3 animate-bounce-slow",children:"\ud83d\udc9c"}),(0,E.jsx)("h3",{className:"text-xl md:text-3xl font-display text-white mb-2 drop-shadow-lg",children:"Complete Your Circle!"}),(0,E.jsx)("div",{className:"inline-block bg-white/20 backdrop-blur-sm px-3 md:px-4 py-1.5 md:py-2 rounded-full",children:(0,E.jsxs)("p",{className:"text-white font-semibold text-sm md:text-base",children:[(0,E.jsx)("span",{className:"text-xl md:text-2xl font-display",children:n}),(0,E.jsx)("span",{className:"text-white/80",children:" / "}),(0,E.jsx)("span",{className:"text-xl md:text-2xl font-display",children:"5"}),(0,E.jsx)("span",{className:"text-xs md:text-sm ml-2",children:"besties"})]})})]})]}),(0,E.jsxs)("div",{className:"p-4 md:p-6",children:[(0,E.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl md:rounded-2xl p-3 md:p-5 mb-4 md:mb-6 shadow-lg border-2 border-pink-100 dark:border-pink-800",children:(0,E.jsxs)("div",{className:"flex items-start gap-2 md:gap-3",children:[(0,E.jsx)("div",{className:"text-2xl md:text-3xl flex-shrink-0",children:"\ud83d\udee1\ufe0f"}),(0,E.jsxs)("div",{children:[(0,E.jsx)("h4",{className:"font-display text-base md:text-lg text-primary dark:text-purple-400 mb-1 md:mb-2",children:"Why you need 5 besties"}),(0,E.jsx)("p",{className:"text-xs md:text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:"A full circle means maximum protection! Your 5 trusted friends will get alerts when you check in and can help if something goes wrong. The more besties, the safer you are. \ud83d\udc95"})]})]})}),(0,E.jsxs)("div",{className:"mb-4 md:mb-6",children:[(0,E.jsx)("h4",{className:"text-base md:text-lg font-display text-center text-primary dark:text-purple-400 mb-3 md:mb-4",children:"\u2728 Invite Friends to Join You \u2728"}),(0,E.jsxs)("div",{className:"grid grid-cols-3 gap-2 md:gap-3",children:[(0,E.jsxs)("button",{onClick:()=>r("whatsapp"),className:"flex flex-col items-center gap-1 md:gap-2 p-2 md:p-4 rounded-lg md:rounded-xl bg-[#25D366] hover:bg-[#20BA5A] text-white transition-all hover:scale-105 shadow-md",title:"Share on WhatsApp",children:[(0,E.jsx)("svg",{className:"w-6 h-6 md:w-10 md:h-10",fill:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})}),(0,E.jsx)("span",{className:"text-[10px] md:text-sm font-semibold",children:"WhatsApp"})]}),(0,E.jsxs)("button",{onClick:()=>r("messenger"),className:"flex flex-col items-center gap-1 md:gap-2 p-2 md:p-4 rounded-lg md:rounded-xl bg-[#0084FF] hover:bg-[#0073E6] text-white transition-all hover:scale-105 shadow-md",title:"Share on Messenger",children:[(0,E.jsx)("svg",{className:"w-6 h-6 md:w-10 md:h-10",fill:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{d:"M12 0C5.373 0 0 4.975 0 11.111c0 3.497 1.745 6.616 4.472 8.652V24l4.086-2.242c1.09.301 2.246.464 3.442.464 6.627 0 12-4.974 12-11.111C24 4.975 18.627 0 12 0zm1.191 14.963l-3.055-3.26-5.963 3.26L10.732 8l3.131 3.259L19.752 8l-6.561 6.963z"})}),(0,E.jsx)("span",{className:"text-[10px] md:text-sm font-semibold",children:"Messenger"})]}),(0,E.jsxs)("button",{onClick:()=>r("instagram"),className:"flex flex-col items-center gap-1 md:gap-2 p-2 md:p-4 rounded-lg md:rounded-xl bg-gradient-to-r from-[#833AB4] via-[#FD1D1D] to-[#F77737] hover:opacity-90 text-white transition-all hover:scale-105 shadow-md",title:"Share on Instagram",children:[(0,E.jsx)("svg",{className:"w-6 h-6 md:w-10 md:h-10",fill:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})}),(0,E.jsx)("span",{className:"text-[10px] md:text-sm font-semibold",children:"Instagram"})]}),(0,E.jsxs)("button",{onClick:()=>r("sms"),className:"flex flex-col items-center gap-1 md:gap-2 p-2 md:p-4 rounded-lg md:rounded-xl bg-success hover:bg-green-600 text-white transition-all hover:scale-105 shadow-md",title:"Share via SMS",children:[(0,E.jsx)("svg",{className:"w-6 h-6 md:w-10 md:h-10",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),(0,E.jsx)("span",{className:"text-[10px] md:text-sm font-semibold",children:"SMS"})]}),(0,E.jsxs)("button",{onClick:()=>r("facebook"),className:"flex flex-col items-center gap-1 md:gap-2 p-2 md:p-4 rounded-lg md:rounded-xl bg-[#1877F2] hover:bg-[#166FE5] text-white transition-all hover:scale-105 shadow-md",title:"Share on Facebook",children:[(0,E.jsx)("svg",{className:"w-6 h-6 md:w-10 md:h-10",fill:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),(0,E.jsx)("span",{className:"text-[10px] md:text-sm font-semibold",children:"Facebook"})]}),(0,E.jsxs)("button",{onClick:t,className:"flex flex-col items-center gap-1 md:gap-2 p-2 md:p-4 rounded-lg md:rounded-xl bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 transition-all hover:scale-105 shadow-md",children:[(0,E.jsx)("div",{className:"w-6 h-6 md:w-10 md:h-10 flex items-center justify-center text-xl md:text-2xl",children:"\ud83d\udc4b"}),(0,E.jsx)("span",{className:"text-[10px] md:text-sm font-semibold",children:"Maybe Later"})]})]})]}),(0,E.jsx)("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 italic",children:"\ud83d\udc95 Building your safety circle is one of the smartest things you can do"})]}),(0,E.jsx)("style",{children:"\n          @keyframes bounce-slow {\n            0%, 100% { transform: translateY(0); }\n            50% { transform: translateY(-10px); }\n          }\n          .animate-bounce-slow {\n            animation: bounce-slow 2s ease-in-out infinite;\n          }\n        "})]})})};var ae=n(4428);const oe=e=>{let{slots:t,connectionStrengths:n,loadingConnections:i}=e;return(0,E.jsxs)("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",style:{zIndex:0,overflow:"visible"},viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid meet",children:[(0,E.jsx)("defs",{children:t.map((e,t)=>{if(!e)return null;const i=n[e.id],s=(null===i||void 0===i?void 0:i.total)||0,a=(0,ae.uH)(s),o=.2+s/100*.6,l=(e=>{const t=(72*e-90)*(Math.PI/180);return{x:50+45*Math.cos(t),y:50+45*Math.sin(t)}})(t);return(0,E.jsxs)(r.Fragment,{children:[(0,E.jsxs)("linearGradient",{id:"gradient-".concat(t),gradientUnits:"userSpaceOnUse",x1:"50",y1:"50",x2:l.x,y2:l.y,children:[(0,E.jsx)("stop",{offset:"0%",stopColor:a,stopOpacity:o}),(0,E.jsx)("stop",{offset:"50%",stopColor:a,stopOpacity:1.5*o}),(0,E.jsx)("stop",{offset:"100%",stopColor:a,stopOpacity:o})]}),(0,E.jsxs)("filter",{id:"glow-".concat(t),children:[(0,E.jsx)("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),(0,E.jsxs)("feMerge",{children:[(0,E.jsx)("feMergeNode",{in:"coloredBlur"}),(0,E.jsx)("feMergeNode",{in:"SourceGraphic"})]})]})]},"defs-".concat(t))})}),t.map((e,t)=>{if(!e)return null;const i=(72*t-90)*(Math.PI/180),s=50+45*Math.cos(i),a=50+45*Math.sin(i),o=n[e.id],l=(null===o||void 0===o?void 0:o.total)||0,c=1+l/100*2;return(0,E.jsxs)(r.Fragment,{children:[(0,E.jsx)("line",{x1:"50",y1:"50",x2:s,y2:a,stroke:(0,ae.uH)(l),strokeOpacity:.4+l/100*.4,strokeWidth:c,strokeDasharray:"4 2",filter:"url(#glow-".concat(t,")"),className:"animate-pulse-connection"}),(0,E.jsx)("circle",{cx:"50",cy:"50",r:l>=50?"4":"3",fill:"#10b981",opacity:.4+l/100*.6,className:"animate-particle",style:{"--target-x":"".concat(s),"--target-y":"".concat(a),animationDelay:"".concat(.5*t,"s"),animationDuration:l>=70?"2s":"3s"}}),l>=50&&(0,E.jsx)("circle",{cx:"50",cy:"50",r:"3",fill:"#34d399",opacity:.5,className:"animate-particle",style:{"--target-x":"".concat(s),"--target-y":"".concat(a),animationDelay:"".concat(.5*t+1,"s"),animationDuration:"2.5s"}}),l>=90&&(0,E.jsx)("circle",{cx:"50",cy:"50",r:"4",fill:"#10b981",opacity:.7,className:"animate-particle",style:{"--target-x":"".concat(s),"--target-y":"".concat(a),animationDelay:"".concat(.5*t+.5,"s"),animationDuration:"1.8s"}})]},"line-".concat(t))})]})},le=e=>{let{loadingConnections:t,circleBestiesLength:n,overallHealth:r,showVibeTooltip:i,setShowVibeTooltip:s}=e;return(0,E.jsx)("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10",children:(0,E.jsx)("div",{className:"w-20 h-20 md:w-24 md:h-24 bg-gradient-primary rounded-full flex flex-col items-center justify-center text-white shadow-2xl border-4 border-white ring-4 ring-purple-200 animate-breathe relative group",children:t?(0,E.jsx)("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}):0===n?(0,E.jsxs)("div",{className:"text-center px-2",children:[(0,E.jsx)("div",{className:"text-2xl mb-0.5",children:"\ud83d\udc9c"}),(0,E.jsxs)("div",{className:"text-[10px] font-semibold leading-tight",children:["Begin",(0,E.jsx)("br",{}),"Here"]})]}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{className:"text-2xl md:text-3xl font-bold leading-none",children:r}),(0,E.jsx)("div",{className:"text-xs font-semibold opacity-90",children:"Your Vibe"}),(0,E.jsx)("button",{onClick:e=>{e.stopPropagation(),s(!i)},className:"absolute -top-2 -right-2 w-6 h-6 md:w-5 md:h-5 bg-white rounded-full flex items-center justify-center shadow-md cursor-pointer hover:scale-110 transition-transform active:scale-95 z-40",children:(0,E.jsx)("span",{className:"text-sm md:text-xs",children:"\u2139\ufe0f"})}),i&&(0,E.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-4 z-50 animate-fade-in",children:(0,E.jsxs)("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white px-4 py-3 rounded-xl text-xs font-semibold shadow-2xl max-w-xs",children:[(0,E.jsx)("div",{className:"font-bold mb-1",children:"Your Circle Strength"}),(0,E.jsxs)("div",{className:"text-white/90 text-xs whitespace-normal w-48",children:[r>=90&&"\ud83d\udd25 Unbreakable - You and your circle are inseparable!",r>=70&&r<90&&"\u26a1 Powerful - Strong bonds, keep nurturing them!",r>=50&&r<70&&"\ud83d\udcaa Strong - Solid friendships, growing stronger!",r>=30&&r<50&&"\ud83d\udd06 Growing - Building momentum together!",r<30&&"\ud83c\udf31 Spark - Just getting started, lots of potential!"]}),(0,E.jsx)("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full w-0 h-0 border-l-4 border-r-4 border-b-4 border-transparent border-b-pink-600"})]})})]})})})},ce=e=>{let{bestie:t,index:n,selectedSlot:r,setSelectedSlot:i,connectionStrength:s,loadingConnections:a,lastSeenTime:o,getStatusInfo:l,handleViewProfile:c,setShowReplaceModal:u,handleRemoveFromCircle:d}=e;const h=l(t),f=(72*n-90)*(Math.PI/180),p=50+45*Math.cos(f),m=50+45*Math.sin(f);return(0,E.jsx)("div",{className:"absolute",style:{left:"".concat(p,"%"),top:"".concat(m,"%"),transform:"translate(-50%, -50%)"},children:(0,E.jsxs)("div",{className:"relative group",children:[(0,E.jsx)("button",{onClick:()=>i(r===n?null:n),className:"relative hover:scale-110 transition-all duration-300",children:(0,E.jsxs)("div",{className:"w-14 h-14 md:w-16 md:h-16 rounded-full shadow-xl border-4 border-white hover:shadow-2xl ".concat((null===s||void 0===s?void 0:s.total)>=90?"ring-6 ring-amber-400 shadow-[0_0_20px_rgba(251,191,36,0.6)]":(null===s||void 0===s?void 0:s.total)>=70?"ring-5 ring-purple-400 shadow-[0_0_15px_rgba(168,85,247,0.5)]":(null===s||void 0===s?void 0:s.total)>=50?"ring-4 ring-pink-400 shadow-[0_0_10px_rgba(236,72,153,0.4)]":"".concat(h.ringColor," ring-4")," hover:ring-6 overflow-hidden flex items-center justify-center relative ").concat((null===s||void 0===s?void 0:s.total)>=90?"animate-breathe-glow":(null===s||void 0===s?void 0:s.total)>=70?"animate-pulse-glow":"animate-breathe-subtle"),style:{animationDelay:"".concat(.3*n,"s")},children:[(0,E.jsx)(L.A,{photoURL:t.photoURL,name:t.name||"Bestie",requestAttention:t.requestAttention,size:"xl",showBubble:!0,className:"w-full h-full"}),(0,E.jsx)("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 ".concat(h.color," rounded-full border-2 border-white flex items-center justify-center text-xs shadow-lg animate-pulse-gentle"),children:h.emoji}),s&&!a&&(0,E.jsx)("div",{className:"absolute -top-1 -left-1 w-8 h-8 rounded-full border-2 flex items-center justify-center shadow-lg ".concat(s.total>=90?"bg-gradient-to-br from-amber-400 to-orange-500 border-amber-300 shadow-[0_0_12px_rgba(251,191,36,0.8)] animate-pulse-glow":"bg-gradient-to-br from-white to-gray-100 border-purple-300"),children:(0,E.jsx)("span",{className:"text-base",children:(0,ae.rC)(s.total)})}),t.isMutual&&(0,E.jsx)("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-gradient-to-br from-pink-400 to-rose-500 rounded-full border-2 border-white flex items-center justify-center shadow-lg animate-pulse-gentle",children:(0,E.jsx)("span",{className:"text-xs",children:"\ud83d\udc95"})})]})}),(0,E.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-3 opacity-0 group-hover:opacity-100 md:group-hover:opacity-100 transition-all duration-200 pointer-events-none z-20 transform group-hover:-translate-y-1",children:(0,E.jsxs)("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white px-3 py-2 md:px-4 md:py-3 rounded-xl text-xs font-semibold shadow-2xl max-w-[90vw] md:max-w-none md:min-w-max",children:[(0,E.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,E.jsx)("div",{className:"font-bold text-sm",children:t.name||"Unknown"}),t.isMutual&&(0,E.jsx)("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded-full flex items-center gap-1",children:"\ud83d\udc95 Mutual"})]}),s&&!a&&(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)("div",{className:"flex items-center gap-2 text-white/90 mb-1",children:[(0,E.jsx)("span",{className:"text-lg",children:(0,ae.rC)(s.total)}),(0,E.jsxs)("span",{children:[s.total,"/100"]}),(0,E.jsx)("span",{className:"capitalize px-2 py-0.5 bg-white/20 rounded-full text-xs",children:s.level})]})}),o&&(0,E.jsxs)("div",{className:"text-white/90 text-xs mt-2 flex items-center gap-1",children:[(0,E.jsx)("span",{children:"\ud83d\udcac"}),(0,E.jsxs)("span",{children:["Last connected: ",(0,ae.ak)(o)]})]}),t.isMutual&&(0,E.jsx)("div",{className:"text-white/80 text-xs mt-2 italic",children:"You're both in each other's top 5 \u2728"}),(0,E.jsx)("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-pink-600"})]})}),r===n&&(0,E.jsxs)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 bg-white dark:bg-gray-800 rounded-lg shadow-xl border-2 border-gray-200 dark:border-gray-700 p-2 z-[9999] w-40 md:w-auto",children:[(0,E.jsx)("button",{onClick:()=>c(t.id),className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded text-sm font-semibold text-gray-700",children:"\ud83d\udc64 View Profile"}),(0,E.jsx)("button",{onClick:()=>u(!0),className:"w-full text-left px-3 py-2 hover:bg-gray-100 rounded text-sm font-semibold text-gray-700",children:"\ud83d\udd04 Replace"}),(0,E.jsx)("button",{onClick:()=>d(n),className:"w-full text-left px-3 py-2 hover:bg-red-50 rounded text-sm font-semibold text-red-600",children:"\u274c Remove"})]})]})})},ue=e=>{let{index:t,circleBestiesLength:n,setShowShareModal:r}=e;const i=["bg-pink-500","bg-purple-500","bg-blue-500","bg-green-500","bg-orange-500"],s=(72*t-90)*(Math.PI/180),a=50+45*Math.cos(s),o=50+45*Math.sin(s);return(0,E.jsx)("div",{className:"absolute",style:{left:"".concat(a,"%"),top:"".concat(o,"%"),transform:"translate(-50%, -50%)"},children:(0,E.jsxs)("button",{onClick:()=>r(!0),className:"w-14 h-14 md:w-16 md:h-16 border-4 border-dashed ".concat(i[t].replace("bg-","border-")," rounded-full flex flex-col items-center justify-center ").concat(i[t].replace("bg-","text-")," font-bold hover:scale-110 hover:bg-purple-50 transition-all shadow-lg hover:shadow-xl animate-pulse-slow relative group"),title:"Add someone who has your back",children:[(0,E.jsx)("span",{className:"text-2xl",children:"+"}),(0,E.jsx)("span",{className:"text-[8px] opacity-70 mt-0.5",children:"Add"}),(0,E.jsx)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 opacity-0 group-hover:opacity-100 transition-all duration-200 pointer-events-none z-20",children:(0,E.jsxs)("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white px-3 py-2 rounded-lg text-xs font-semibold whitespace-nowrap shadow-xl",children:[0===n?"Your first bestie \u2728":"Add another one \ud83d\udc9c",(0,E.jsx)("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-pink-600"})]})})]})})},de=e=>{let{circleBestiesLength:t,overallHealth:n,loadingConnections:r}=e;const i=(0,a.Zp)();return(0,E.jsxs)("div",{className:"text-center mt-6 space-y-3",children:[t<5&&(0,E.jsxs)("div",{className:"inline-flex items-center gap-2 bg-white px-4 py-3 rounded-full shadow-md border-2 border-purple-200",children:[(0,E.jsx)("span",{className:"text-2xl",children:"\u2b50"}),(0,E.jsxs)("div",{className:"text-left",children:[(0,E.jsxs)("div",{className:"font-display text-base md:text-lg text-gradient font-bold leading-tight",children:[t,"/5 In Your Circle"]}),t>0&&!r&&(0,E.jsxs)("div",{className:"text-xs text-gray-600",children:[n>=90&&"Unbreakable vibes \ud83d\udd25",n>=70&&n<90&&"Super strong energy \u26a1",n>=50&&n<70&&"Solid connections \ud83d\udcaa",n>=30&&n<50&&"Building momentum \ud83d\udd06",n<30&&"Just getting started \ud83c\udf31"]})]})]}),(0,E.jsx)("div",{className:"text-xs md:text-sm text-gray-600",children:5===t?"Your circle is complete! Keep nurturing these connections \ud83d\udc9c":0===t?"Your 5 closest people - the ones you can call at 3am. Start building your circle \u2728":1===t?"Amazing start! Add 4 more to complete your inner circle \ud83c\udf1f":"".concat(5-t," more to go! You're building something special \ud83d\udcab")}),t>0&&!r&&(0,E.jsxs)("button",{onClick:()=>i("/circle-health"),className:"mt-2 px-6 py-2 bg-gradient-primary text-white rounded-full font-semibold text-sm hover:shadow-lg hover:scale-105 transition-all flex items-center gap-2 mx-auto",children:[(0,E.jsx)("span",{children:"See Your Stats"}),(0,E.jsx)("span",{className:"text-base",children:"\u2728"})]})]})},he=e=>{let{show:t,onClose:n,allBesties:r,circleBesties:i,onReplace:s}=e;if(!t)return null;const a=r.filter(e=>!i.find(t=>t.id===e.id));return(0,E.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:n,children:(0,E.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-sm w-full max-h-96 overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,E.jsx)("h3",{className:"text-xl font-display mb-4",children:"Replace with:"}),(0,E.jsxs)("div",{className:"space-y-2",children:[a.map(e=>(0,E.jsxs)("button",{onClick:()=>s(e),className:"w-full flex items-center gap-3 p-3 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,E.jsx)(L.A,{photoURL:e.photoURL,name:e.name||"Unknown",requestAttention:e.requestAttention,size:"md",showBubble:!0}),(0,E.jsx)("div",{className:"text-left",children:(0,E.jsx)("div",{className:"font-semibold",children:e.name||"Unknown"})})]},e.id)),0===a.length&&(0,E.jsx)("p",{className:"text-center text-gray-500 py-4",children:"All besties are in your circle!"})]}),(0,E.jsx)("button",{onClick:n,className:"mt-4 w-full btn btn-secondary",children:"Cancel"})]})})},fe=()=>(0,E.jsx)("style",{children:"\n      @keyframes fade-in {\n        from {\n          opacity: 0;\n          transform: translate(-50%, -10px);\n        }\n        to {\n          opacity: 1;\n          transform: translate(-50%, 0);\n        }\n      }\n      .animate-fade-in {\n        animation: fade-in 0.2s ease-out forwards;\n      }\n      @keyframes breathe {\n        0%, 100% {\n          transform: scale(1);\n        }\n        50% {\n          transform: scale(1.05);\n        }\n      }\n      .animate-breathe {\n        animation: breathe 4s ease-in-out infinite;\n      }\n      .animate-breathe-subtle {\n        animation: breathe 5s ease-in-out infinite;\n      }\n      @keyframes breathe-glow {\n        0%, 100% {\n          transform: scale(1);\n          box-shadow: 0 10px 40px rgba(251, 191, 36, 0.4), 0 0 20px rgba(251, 191, 36, 0.6);\n        }\n        50% {\n          transform: scale(1.05);\n          box-shadow: 0 15px 60px rgba(251, 191, 36, 0.6), 0 0 30px rgba(251, 191, 36, 0.8);\n        }\n      }\n      .animate-breathe-glow {\n        animation: breathe-glow 3s ease-in-out infinite;\n      }\n      @keyframes pulse-glow {\n        0%, 100% {\n          opacity: 1;\n          transform: scale(1);\n        }\n        50% {\n          opacity: 0.8;\n          transform: scale(1.05);\n        }\n      }\n      .animate-pulse-glow {\n        animation: pulse-glow 2s ease-in-out infinite;\n      }\n      @keyframes pulse-gentle {\n        0%, 100% {\n          transform: scale(1);\n          opacity: 1;\n        }\n        50% {\n          transform: scale(1.1);\n          opacity: 0.9;\n        }\n      }\n      .animate-pulse-gentle {\n        animation: pulse-gentle 2s ease-in-out infinite;\n      }\n      @keyframes pulse-slow {\n        0%, 100% {\n          opacity: 1;\n        }\n        50% {\n          opacity: 0.6;\n        }\n      }\n      .animate-pulse-slow {\n        animation: pulse-slow 2s ease-in-out infinite;\n      }\n      @keyframes pulse-connection {\n        0%, 100% {\n          opacity: 0.8;\n        }\n        50% {\n          opacity: 1;\n        }\n      }\n      .animate-pulse-connection {\n        animation: pulse-connection 3s ease-in-out infinite;\n      }\n      @keyframes particle {\n        0% {\n          cx: 50%;\n          cy: 50%;\n          opacity: 1;\n        }\n        100% {\n          cx: var(--target-x);\n          cy: var(--target-y);\n          opacity: 0;\n        }\n      }\n      .animate-particle {\n        animation: particle 3s linear infinite;\n      }\n      @keyframes gradient-shift {\n        0%, 100% {\n          background-position: 0% 50%;\n        }\n        50% {\n          background-position: 100% 50%;\n        }\n      }\n      .animate-gradient-shift {\n        background: linear-gradient(120deg, #fdf2f8, #fce7f3, #fff7ed, #fef3c7);\n        background-size: 200% 200%;\n        animation: gradient-shift 8s ease infinite;\n      }\n    "}),pe=e=>{let{userId:t,onAddClick:n}=e;const i=(0,a.Zp)(),[s,o]=(0,r.useState)([]),[l,c]=(0,r.useState)([]),[u,d]=(0,r.useState)(!0),[h,f]=(0,r.useState)(null),[p,m]=(0,r.useState)(!1),[g,y]=(0,r.useState)(!1),[v,b]=(0,r.useState)({}),[k,_]=(0,r.useState)({}),[I,S]=(0,r.useState)(!0),[N,T]=(0,r.useState)(0),[C,A]=(0,r.useState)(!1),P=async e=>{S(!0);const n=e.map(async e=>{try{const[n,r]=await Promise.all([(0,ae.As)(t,e.id),(0,ae.ds)(t,e.id)]);return{bestieId:e.id,strength:n,lastInteraction:r}}catch(n){return console.error("Error loading connection data for ".concat(e.id,":"),n),{bestieId:e.id,strength:null,lastInteraction:null}}}),r=await Promise.all(n),i={},s={};r.forEach(e=>{let{bestieId:t,strength:n,lastInteraction:r}=e;n&&(i[t]=n),r&&(s[t]=r)}),b(i),_(s);const a=Object.values(i).map(e=>e.total),o=a.length>0?a.reduce((e,t)=>e+t,0)/a.length:0,l=e.length<5?o*(e.length/5):o;T(Math.round(l)),S(!1)};(0,r.useEffect)(()=>{(async()=>{if(t)try{const[r,i]=await Promise.all([(0,j.GG)((0,j.P)((0,j.rJ)(x.db,"besties"),(0,j._M)("requesterId","==",t),(0,j._M)("status","==","accepted"))),(0,j.GG)((0,j.P)((0,j.rJ)(x.db,"besties"),(0,j._M)("recipientId","==",t),(0,j._M)("status","==","accepted")))]),s=[];r.docs.forEach(e=>s.push(e.data().recipientId)),i.docs.forEach(e=>s.push(e.data().requesterId));const a=s.map(e=>(0,j.x7)((0,j.H9)(x.db,"users",e))),l=await Promise.all(a),u={};l.forEach((e,t)=>{e.exists()&&(u[s[t]]=e.data())});const h=s.filter(e=>{var t;const n=u[e];return"all_besties"===((null===n||void 0===n||null===(t=n.privacySettings)||void 0===t?void 0:t.checkInVisibility)||"all_besties")});let f={};if(h.length>0){const e=h.map(e=>(0,j.GG)((0,j.P)((0,j.rJ)(x.db,"checkins"),(0,j._M)("userId","==",e),(0,j._M)("status","in",["active","alerted"]))).then(t=>({bestieId:e,hasActive:!t.empty})));(await Promise.all(e)).forEach(e=>{let{bestieId:t,hasActive:n}=e;f[t]=n})}const p=[];for(const n of r.docs){var e;const r=n.data(),i=u[r.recipientId]||{};let s=!1;const a=(null===(e=i.privacySettings)||void 0===e?void 0:e.checkInVisibility)||"all_besties";("all_besties"===a||"circle"===a&&(i.featuredCircle||[]).includes(t))&&(s=f[r.recipientId]||!1);const o=(i.featuredCircle||[]).includes(t);p.push({id:r.recipientId,name:i.displayName||"Bestie",photoURL:i.photoURL||null,requestAttention:i.requestAttention||null,hasActiveCheckIn:s,isMutual:o})}for(const e of i.docs){var n;const r=e.data(),i=u[r.requesterId]||{};let s=!1;const a=(null===(n=i.privacySettings)||void 0===n?void 0:n.checkInVisibility)||"all_besties";("all_besties"===a||"circle"===a&&(i.featuredCircle||[]).includes(t))&&(s=f[r.requesterId]||!1);const o=(i.featuredCircle||[]).includes(t);p.push({id:r.requesterId,name:i.displayName||"Bestie",photoURL:i.photoURL||null,requestAttention:i.requestAttention||null,hasActiveCheckIn:s,isMutual:o})}o(p);const m=await(0,j.x7)((0,j.H9)(x.db,"users",t)),g=m.exists()&&m.data().featuredCircle||[],y=g.map(e=>p.find(t=>t.id===e)).filter(Boolean),v=y.length<p.length&&y.length<5;if(v){const e=p.filter(e=>!g.includes(e.id));y.push(...e.slice(0,5-y.length))}const b=y.slice(0,5);c(b),d(!1),v&&b.length>0&&D(b).catch(e=>console.error("Error saving featured circle:",e)),P(b)}catch(r){console.error("Error loading besties:",r),d(!1)}})()},[t]);const D=async e=>{const n=e.map(e=>e.id);await(0,j.mZ)((0,j.H9)(x.db,"users",t),{featuredCircle:n})},R=async e=>{if(l.length<5)return w.Ay.error("Circle must be full to remove members. Use Replace instead."),void f(null);const t=l.filter((t,n)=>n!==e);c(t),await D(t),f(null),w.Ay.success("Removed from circle")},O=e=>{i("/user/".concat(e)),f(null)},M=e=>{var t;return null!==(t=e.requestAttention)&&void 0!==t&&t.active?{color:"bg-purple-500",ringColor:"ring-purple-400",glowColor:"#a855f7",label:"Needs support",emoji:"\ud83d\udc9c"}:e.hasActiveCheckIn?{color:"bg-yellow-500",ringColor:"ring-yellow-400",glowColor:"#f59e0b",label:"Active check-in",emoji:"\u23f0"}:{color:"bg-green-500",ringColor:"ring-green-400",glowColor:"#10b981",label:"Safe",emoji:"\u2713"}},L=Array.from({length:5},(e,t)=>l[t]||null);return u?(0,E.jsx)("div",{className:"card p-8 flex items-center justify-center",children:(0,E.jsx)("div",{className:"spinner"})}):(0,E.jsxs)("div",{className:"card p-6 md:p-8 mb-6 bg-gradient-to-br from-purple-50 via-pink-50 to-orange-50 border-2 border-purple-100 relative overflow-hidden",onClick:()=>{C&&A(!1)},children:[(0,E.jsx)("div",{className:"absolute inset-0 opacity-30 animate-gradient-shift pointer-events-none"}),(0,E.jsxs)("div",{className:"relative z-10",children:[(0,E.jsx)("div",{className:"text-center mb-6",children:(0,E.jsxs)("div",{className:"flex items-center justify-center",children:[(0,E.jsx)("h3",{className:"text-2xl md:text-3xl font-display mb-1 text-black dark:text-white",children:"\ud83d\udc9c Your Bestie Circle"}),(0,E.jsx)(ee.A,{message:"Your inner circle of 5 closest people - the ones you can call at 3am! Connection strength grows based on your interactions. Click besties to view profiles or manage your circle. \ud83d\udc9c"})]})}),(0,E.jsx)("div",{className:"relative w-full max-w-md mx-auto aspect-square mb-6",children:(0,E.jsxs)("div",{className:"absolute inset-0",children:[(0,E.jsx)(oe,{slots:L,connectionStrengths:v,loadingConnections:I}),(0,E.jsx)(le,{loadingConnections:I,circleBestiesLength:l.length,overallHealth:N,showVibeTooltip:C,setShowVibeTooltip:A}),L.map((e,t)=>{const n=e?v[e.id]:null,r=e?k[e.id]:null;return e?(0,E.jsx)(ce,{bestie:e,index:t,selectedSlot:h,setSelectedSlot:f,connectionStrength:n,loadingConnections:I,lastSeenTime:r,getStatusInfo:M,handleViewProfile:O,setShowReplaceModal:m,handleRemoveFromCircle:R},t):(0,E.jsx)(ue,{index:t,circleBestiesLength:l.length,setShowShareModal:y},t)})]})}),(0,E.jsx)(de,{circleBestiesLength:l.length,overallHealth:N,loadingConnections:I})]}),(0,E.jsx)(fe,{}),(0,E.jsx)(he,{show:p,onClose:()=>m(!1),allBesties:s,circleBesties:l,onReplace:async e=>{const t=[...l];t[h]=e,c(t),await D(t),m(!1),f(null),w.Ay.success("Bestie replaced"),P(t)}}),g&&(0,E.jsx)(se,{onClose:()=>y(!1),circleCount:l.length})]})};var me=n(1655);const ge=e=>{var t;let{weeklySummary:n,hasWeekOfActivity:r,userData:i,bestiesCount:s}=e;return(0,E.jsxs)("div",{className:"card p-6 mb-6",children:[(0,E.jsxs)("div",{className:"flex items-center mb-4",children:[(0,E.jsx)("h2",{className:"text-xl font-display text-gray-800 dark:text-gray-200",children:"Weekly Summary"}),(0,E.jsx)(ee.A,{message:"Your personalized weekly activity summary! Track your check-ins and bestie connections. You'll get detailed insights after your first week. \ud83d\udcca"})]}),(0,E.jsx)("div",{className:"bg-gradient-to-r from-pink-50 to-purple-50 dark:from-pink-900/30 dark:to-purple-900/30 rounded-xl p-4",children:(0,E.jsxs)("div",{className:"flex items-start gap-3",children:[(0,E.jsx)("span",{className:"text-4xl",children:n.emoji}),(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsx)("h3",{className:"font-semibold text-lg text-gray-800 dark:text-gray-200 mb-1",children:n.message}),(0,E.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:["\ud83d\udca1 ",n.tip]}),r&&(0,E.jsxs)("div",{className:"flex gap-4 text-sm",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("span",{className:"font-semibold text-primary",children:(null===i||void 0===i||null===(t=i.stats)||void 0===t?void 0:t.totalCheckIns)||0}),(0,E.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:" check-ins"})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("span",{className:"font-semibold text-secondary",children:s}),(0,E.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:" besties"})]})]})]})]})})]})};var ye=n(626);const ve=e=>{let{hasActiveAlert:t=!1}=e;const{currentUser:i,userData:s}=(0,k.As)(),[a,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)(null),[u,d]=(0,r.useState)(!1),[h,f]=(0,r.useState)(0),[p,m]=(0,r.useState)(!1),[g,y]=(0,r.useState)(""),v=(0,r.useRef)(null),b=(0,r.useRef)(null),_=(0,r.useRef)(null),{executeOptimistic:I}=(0,H.Ay)();(0,r.useEffect)(()=>{if(!u)return;const e=e=>(e.preventDefault(),e.returnValue="Emergency alert is active! Hold the cancel button for 10 seconds to dismiss.",e.returnValue);return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[u]),(0,r.useEffect)(()=>()=>{v.current&&(clearInterval(v.current),v.current=null),b.current&&(clearInterval(b.current),b.current=null)},[]);const S=()=>{v.current&&(clearInterval(v.current),v.current=null),o(!1),c(null),(0,w.Ay)("SOS cancelled")},N=async()=>{await I({optimisticUpdate:()=>{o(!1),d(!0)},serverUpdate:async()=>{let e="Location unavailable";if(navigator.geolocation)try{const t=await new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(e,t,{timeout:3e3})});e="GPS: ".concat(t.coords.latitude.toFixed(4),", ").concat(t.coords.longitude.toFixed(4))}catch(s){console.error("Location error:",s)}const t=(0,ye.Qg)(x.functions,"triggerEmergencySOS"),r=await t({location:e,isReversePIN:!1}),{logAnalyticsEvent:i}=n(3984);return i("sos_triggered",{is_reverse_pin:!1,has_location:!!e}),r},rollback:()=>{d(!1),o(!1)},successMessage:"\ud83d\udea8 Emergency alert sent to all besties!",errorMessage:"Failed to send emergency alert. Please try again.",skipSuccessToast:!1})},T=()=>{_.current=Date.now(),f(0),b.current=setInterval(()=>{const e=Date.now()-_.current,t=Math.min(e/1e4*100,100);f(t),t>=100&&P()},50)},C=()=>{b.current&&(clearInterval(b.current),b.current=null),f(0),w.Ay.error("Hold button for 10 seconds to cancel alert")},A=()=>{var e,t;const n=null===s||void 0===s||null===(e=s.security)||void 0===e?void 0:e.safetyPasscode,r=null===s||void 0===s||null===(t=s.security)||void 0===t?void 0:t.duressCode;g===n?(m(!1),y(""),d(!1),f(0),w.Ay.success("Emergency alert cancelled")):g===r&&r?(m(!1),y(""),w.Ay.success("Emergency alert cancelled"),(async()=>{try{let t="Location unavailable";if(navigator.geolocation)try{const e=await new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(e,t,{timeout:3e3})});t="GPS: ".concat(e.coords.latitude.toFixed(4),", ").concat(e.coords.longitude.toFixed(4))}catch(e){console.error("Location error:",e)}await(0,j.gS)((0,j.rJ)(x.db,"emergency_sos"),{userId:i.uid,userName:(null===s||void 0===s?void 0:s.displayName)||"User",location:t,timestamp:j.Dc.now(),status:"active",type:"duress",message:"\ud83d\udea8 DURESS CODE USED - User is in danger and being forced to cancel!"})}catch(t){console.error("Error sending duress alert:",t)}})(),setTimeout(()=>{d(!1),f(0)},1e3)):(w.Ay.error("Incorrect passcode"),y(""))},P=()=>{var e;b.current&&(clearInterval(b.current),b.current=null),null!==s&&void 0!==s&&null!==(e=s.security)&&void 0!==e&&e.safetyPasscode?m(!0):(d(!1),f(0),w.Ay.success("Emergency alert cancelled"))};return u?(0,E.jsx)("div",{className:"fixed inset-0 bg-orange-500/95 z-[9999] flex items-center justify-center p-4 overflow-y-auto",children:(0,E.jsxs)("div",{className:"text-center max-w-md w-full my-8",children:[(0,E.jsx)("div",{className:"text-8xl mb-6",children:"\ud83d\udea8"}),(0,E.jsx)("h2",{className:"text-4xl font-display text-white mb-4",children:"EMERGENCY ALERT SENT"}),(0,E.jsx)("p",{className:"text-xl text-white mb-8",children:"Your besties have been notified!"}),(0,E.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-2xl p-4 mb-6",children:[(0,E.jsx)("h3",{className:"text-white font-bold text-lg mb-3",children:"\ud83d\udcde Call Emergency Services"}),(0,E.jsxs)("a",{href:"tel:".concat("112"),className:"bg-white/30 hover:bg-white/40 backdrop-blur-sm rounded-lg p-6 transition-all block mb-3",children:[(0,E.jsx)("div",{className:"text-5xl mb-2",children:"\ud83d\udea8"}),(0,E.jsx)("div",{className:"text-white text-5xl font-bold mb-2",children:"112"}),(0,E.jsx)("div",{className:"text-white text-sm font-semibold",children:"Tap to call"})]}),(0,E.jsx)("p",{className:"text-white/80 text-xs mt-3",children:"112 is the international emergency number and works in most countries worldwide"})]}),(0,E.jsxs)("div",{className:"relative",children:[(0,E.jsxs)("button",{onMouseDown:T,onMouseUp:C,onMouseLeave:C,onTouchStart:T,onTouchEnd:C,className:"btn bg-white text-orange-600 text-xl px-12 py-6 font-bold relative overflow-hidden w-full",children:[(0,E.jsx)("div",{className:"absolute inset-0 bg-green-500/30 transition-all",style:{width:"".concat(h,"%")}}),(0,E.jsx)("span",{className:"relative z-10",children:0===h?"HOLD TO CANCEL":"".concat(Math.ceil((100-h)/10),"s")})]}),(0,E.jsx)("p",{className:"text-sm text-white mt-4",children:"Hold for 10 seconds to cancel the emergency alert"})]})]})}):a?(0,E.jsx)("div",{className:"fixed inset-0 bg-danger/95 z-50 flex items-center justify-center p-4",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"text-9xl font-display text-white mb-8 animate-pulse",children:l}),(0,E.jsx)("h2",{className:"text-3xl font-display text-white mb-4",children:"EMERGENCY SOS"}),(0,E.jsx)("p",{className:"text-xl text-white mb-8",children:"Sending alert to all besties..."}),(0,E.jsx)("button",{onClick:S,className:"btn bg-white text-danger text-xl px-12 py-4",children:"CANCEL"})]})}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)("button",{onClick:()=>{z.A.emergency(),c(5),o(!0),v.current=setInterval(()=>{c(e=>e<=1?(clearInterval(v.current),v.current=null,N(),null):(z.A.warning(),e-1))},1e3)},className:"fixed bottom-20 right-4 w-16 h-16 ".concat(t?"bg-yellow-500 animate-pulse":"bg-danger"," text-white rounded-full shadow-xl hover:shadow-2xl hover:scale-110 active:scale-95 flex flex-col items-center justify-center transition-all duration-200 z-40"),title:"Emergency SOS - Hold for 5 seconds",children:[(0,E.jsx)("span",{className:"text-2xl",children:t?"\u26a0\ufe0f":"\ud83c\udd98"}),(0,E.jsx)("span",{className:"text-[10px] font-bold",children:t?"ALERT":"SOS"})]}),p&&(0,E.jsx)("div",{className:"fixed inset-0 bg-black/70 z-[10000] flex items-center justify-center p-4",children:(0,E.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-sm w-full p-6 animate-scale-up",children:[(0,E.jsx)("h2",{className:"text-2xl font-display text-text-primary mb-2 text-center",children:"\ud83d\udd12 Enter Safety Passcode"}),(0,E.jsx)("p",{className:"text-sm text-text-secondary mb-6 text-center",children:"Verify your passcode to cancel the emergency alert"}),(0,E.jsx)("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",value:g,onChange:e=>y(e.target.value),onKeyPress:e=>{"Enter"===e.key&&A()},className:"w-full px-4 py-3 rounded-xl border-2 border-gray-300 dark:border-gray-600 focus:border-primary focus:outline-none text-center text-2xl font-bold tracking-widest mb-4",placeholder:"\u2022\u2022\u2022\u2022",autoFocus:!0,maxLength:8}),(0,E.jsxs)("div",{className:"flex gap-3",children:[(0,E.jsx)("button",{onClick:()=>{m(!1),y("")},className:"flex-1 btn btn-secondary",children:"Cancel"}),(0,E.jsx)("button",{onClick:A,disabled:!g,className:"flex-1 btn btn-primary disabled:opacity-50",children:"Verify"})]}),(0,E.jsxs)("p",{className:"text-xs text-text-secondary text-center mt-4",children:["Don't have a passcode set? ",(0,E.jsx)("a",{href:"/settings",className:"text-primary underline",children:"Set one up"})]})]})})]})},be=e=>{let{currentUser:t,userData:n}=e;const[i,s]=(0,r.useState)(!1),[a,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!1),[h,f]=(0,r.useState)(!1),[p,m]=(0,r.useState)(null),[g,y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=e=>{e.preventDefault(),console.log("beforeinstallprompt event captured"),m(e),y(!0)};return window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",()=>{console.log("PWA was installed"),m(null),y(!1)}),()=>{window.removeEventListener("beforeinstallprompt",e)}},[]),(0,r.useEffect)(()=>{var e;if(!0===(null===n||void 0===n||null===(e=n.settings)||void 0===e?void 0:e.dismissedAddToHomeScreen))return;const t=navigator.userAgent,r=/iPhone|iPad|iPod/.test(t),i=/Android/.test(t),a=/Safari/.test(t)&&!/Chrome|CriOS|FxiOS|EdgiOS/.test(t),l=/Chrome|CriOS/.test(t)&&!/EdgiOS/.test(t);o(r),c(i),d(a),f(l);if(window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone)return;(()=>{var e,t;const r=(null===n||void 0===n||null===(e=n.stats)||void 0===e?void 0:e.completedCheckIns)||0,i=null===n||void 0===n||null===(t=n.settings)||void 0===t?void 0:t.lastDismissedInstallPrompt;if(r>=1){var s;if(!i)return!0;if(r>((null===n||void 0===n||null===(s=n.settings)||void 0===s?void 0:s.dismissedAtCheckInCount)||0))return!0}return!1})()&&setTimeout(()=>{s(!0)},2e3)},[n]);const v=async()=>{if(s(!1),z.A.light(),t)try{var e;await(0,j.mZ)((0,j.H9)(x.db,"users",t.uid),{"settings.lastDismissedInstallPrompt":new Date,"settings.dismissedAtCheckInCount":(null===n||void 0===n||null===(e=n.stats)||void 0===e?void 0:e.completedCheckIns)||0})}catch(r){console.error("Error saving dismissal:",r)}},b=async()=>{if(s(!1),z.A.light(),t)try{await(0,j.mZ)((0,j.H9)(x.db,"users",t.uid),{"settings.dismissedAddToHomeScreen":!0})}catch(e){console.error("Error saving dismissal:",e)}};return i?(0,E.jsxs)("div",{className:"fixed inset-0 bg-black/50 flex items-end md:items-center justify-center z-50 p-4 animate-fade-in",children:[(0,E.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-t-3xl md:rounded-3xl max-w-md w-full p-6 animate-slide-up shadow-2xl",children:[(0,E.jsxs)("div",{className:"text-center mb-4",children:[(0,E.jsx)("div",{className:"text-4xl mb-2",children:"\ud83d\udcf1"}),(0,E.jsx)("h2",{className:"text-2xl font-display text-text-primary mb-2",children:"Add Besties to Home Screen"}),(0,E.jsx)("p",{className:"text-sm text-text-secondary",children:"Quick access to safety check-ins, just like a real app! \u2728"})]}),g&&p&&(0,E.jsxs)("div",{className:"mb-6",children:[(0,E.jsx)("button",{onClick:async()=>{if(p&&g){z.A.medium(),p.prompt();const{outcome:e}=await p.userChoice;console.log("User response to install prompt: ".concat(e)),"accepted"===e?(console.log("User accepted the install prompt"),s(!1),t&&await(0,j.mZ)((0,j.H9)(x.db,"users",t.uid),{"settings.installedPWA":!0})):"dismissed"===e&&(console.log("User dismissed the install prompt"),v()),m(null),y(!1)}},className:"w-full btn btn-primary text-lg py-4",children:"\ud83d\udcf2 Install App"}),(0,E.jsx)("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 mt-2",children:"One tap to add Besties to your home screen!"})]}),a&&u&&(0,E.jsxs)("div",{className:"mb-6 p-4 bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-900/30 dark:to-purple-900/30 rounded-xl border-2 border-blue-200 dark:border-blue-700",children:[(0,E.jsx)("h3",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-3 text-center",children:"\ud83d\udcf2 Quick Setup:"}),(0,E.jsxs)("div",{className:"space-y-3",children:[(0,E.jsxs)("div",{className:"flex items-start gap-3",children:[(0,E.jsx)("div",{className:"w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"1"}),(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsxs)("p",{className:"text-sm text-gray-800 dark:text-gray-200",children:["Tap the ",(0,E.jsx)("strong",{children:"Share button"})," at the bottom of Safari"]}),(0,E.jsx)("div",{className:"mt-2 flex justify-center",children:(0,E.jsx)("div",{className:"relative",children:(0,E.jsx)("svg",{className:"w-12 h-12 text-blue-500 animate-bounce-slow",fill:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{d:"M16 5l-1.42 1.42-1.59-1.59V16h-1.98V4.83L9.42 6.42 8 5l4-4 4 4zm4 5v11c0 1.1-.9 2-2 2H6c-1.1 0-2-.9-2-2V10c0-1.1.9-2 2-2h3v2H6v11h12V10h-3V8h3c1.1 0 2 .9 2 2z"})})})})]})]}),(0,E.jsxs)("div",{className:"flex items-start gap-3",children:[(0,E.jsx)("div",{className:"w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"2"}),(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsxs)("p",{className:"text-sm text-gray-800 dark:text-gray-200",children:["Scroll down and tap ",(0,E.jsx)("strong",{children:'"Add to Home Screen"'})]}),(0,E.jsx)("div",{className:"mt-2 flex justify-center",children:(0,E.jsx)("div",{className:"text-3xl animate-point-down",children:"\ud83d\udc47"})})]})]}),(0,E.jsxs)("div",{className:"flex items-start gap-3",children:[(0,E.jsx)("div",{className:"w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"3"}),(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsxs)("p",{className:"text-sm text-gray-800 dark:text-gray-200",children:["Tap ",(0,E.jsx)("strong",{children:'"Add"'})," in the top right"]}),(0,E.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"\u2705 Done! Find Besties on your home screen"})]})]})]})]}),l&&h&&!g&&(0,E.jsxs)("div",{className:"mb-6 p-4 bg-gradient-to-br from-green-50 to-blue-50 dark:from-green-900/30 dark:to-blue-900/30 rounded-xl border-2 border-green-200 dark:border-green-700",children:[(0,E.jsx)("h3",{className:"font-semibold text-green-900 dark:text-green-100 mb-3 text-center",children:"\ud83d\udcf2 Quick Setup:"}),(0,E.jsxs)("div",{className:"space-y-3",children:[(0,E.jsxs)("div",{className:"flex items-start gap-3",children:[(0,E.jsx)("div",{className:"w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"1"}),(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsxs)("p",{className:"text-sm text-gray-800 dark:text-gray-200",children:["Tap the ",(0,E.jsx)("strong",{children:"menu button"})," (\u22ee) at the top right"]}),(0,E.jsx)("div",{className:"mt-2 flex justify-center",children:(0,E.jsxs)("div",{className:"flex flex-col gap-1 animate-pulse",children:[(0,E.jsx)("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),(0,E.jsx)("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),(0,E.jsx)("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"})]})})]})]}),(0,E.jsxs)("div",{className:"flex items-start gap-3",children:[(0,E.jsx)("div",{className:"w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"2"}),(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsxs)("p",{className:"text-sm text-gray-800 dark:text-gray-200",children:["Tap ",(0,E.jsx)("strong",{children:'"Add to Home screen"'})," or ",(0,E.jsx)("strong",{children:'"Install app"'})]}),(0,E.jsx)("div",{className:"mt-2 flex justify-center",children:(0,E.jsx)("div",{className:"text-3xl animate-point-down",children:"\u261d\ufe0f"})})]})]}),(0,E.jsxs)("div",{className:"flex items-start gap-3",children:[(0,E.jsx)("div",{className:"w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center font-bold flex-shrink-0",children:"3"}),(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsxs)("p",{className:"text-sm text-gray-800 dark:text-gray-200",children:["Tap ",(0,E.jsx)("strong",{children:'"Install"'})]}),(0,E.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"\u2705 Done! Find Besties on your home screen"})]})]})]})]}),a&&!u&&(0,E.jsx)("div",{className:"mb-6 p-4 bg-yellow-50 dark:bg-yellow-900/30 rounded-xl border-2 border-yellow-300 dark:border-yellow-700",children:(0,E.jsxs)("p",{className:"text-sm text-yellow-900 dark:text-yellow-100 text-center",children:["\u26a0\ufe0f You're using ",h?"Chrome":"a browser",". To add Besties to your home screen, please open this page in ",(0,E.jsx)("strong",{children:"Safari"}),"."]})}),!a&&!l&&g&&(0,E.jsx)("div",{className:"mb-6",children:(0,E.jsx)("p",{className:"text-sm text-center text-gray-600 dark:text-gray-400",children:"Click the button above to install Besties on your computer for quick access!"})}),(0,E.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,E.jsxs)("div",{className:"flex gap-3",children:[(0,E.jsx)("button",{onClick:v,className:"flex-1 btn btn-secondary",children:"No Thanks"}),!g&&(0,E.jsx)("button",{onClick:b,className:"flex-1 btn btn-primary",children:"Got It!"})]}),(0,E.jsx)("button",{onClick:b,className:"text-xs text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 py-1",children:"Don't show this again"})]}),(0,E.jsx)("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 mt-3",children:g?"This makes Besties faster and easier to access \ud83d\udc9c":"Installing makes Besties work offline and load faster \ud83d\udc9c"})]}),(0,E.jsx)("style",{children:"\n        @keyframes fade-in {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n\n        @keyframes slide-up {\n          from {\n            opacity: 0;\n            transform: translateY(100px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n\n        @keyframes point-down {\n          0%, 100% {\n            transform: translateY(0);\n          }\n          50% {\n            transform: translateY(8px);\n          }\n        }\n\n        @keyframes bounce-slow {\n          0%, 100% {\n            transform: translateY(0);\n          }\n          50% {\n            transform: translateY(-10px);\n          }\n        }\n\n        .animate-fade-in {\n          animation: fade-in 0.3s ease-out;\n        }\n\n        .animate-slide-up {\n          animation: slide-up 0.4s ease-out;\n        }\n\n        .animate-point-down {\n          display: inline-block;\n          animation: point-down 1.5s ease-in-out infinite;\n        }\n\n        .animate-bounce-slow {\n          animation: bounce-slow 2s ease-in-out infinite;\n        }\n      "})]}):null},we=()=>{const[e,t]=(0,r.useState)(navigator.onLine),[n,i]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{const e=()=>{t(!0),setTimeout(()=>i(!1),2e3)},n=()=>{t(!1),i(!0)};return window.addEventListener("online",e),window.addEventListener("offline",n),navigator.onLine||i(!0),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}},[]),n?(0,E.jsxs)("div",{className:"fixed top-0 left-0 right-0 z-50 p-3 text-center text-sm font-semibold shadow-lg transform transition-all duration-300 ".concat(e?"bg-gradient-to-r from-green-400 to-emerald-500 text-white translate-y-0":"bg-gradient-to-r from-orange-400 to-red-500 text-white translate-y-0"),style:{animation:"slide-down 0.3s ease-out"},children:[e?(0,E.jsx)("span",{children:"\u2728 You're back online! \ud83d\udc9c"}):(0,E.jsx)("span",{children:"\ud83d\udcf5 You're offline - Some features won't work"}),(0,E.jsx)("style",{children:"\n        @keyframes slide-down {\n          from {\n            transform: translateY(-100%);\n          }\n          to {\n            transform: translateY(0);\n          }\n        }\n      "})]}):null},xe=e=>{let{onClose:t}=e;const{currentUser:n}=(0,k.As)(),[i,s]=(0,r.useState)(!1),a="https://besties.app/invite/".concat(null===n||void 0===n?void 0:n.uid),o="Hey! Join me on Besties - the app that keeps us safe when we're out. Check-in when you're heading somewhere and your friends will have your back. ".concat(a);return(0,E.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:(0,E.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full p-6 max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,E.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,E.jsx)("h2",{className:"text-2xl font-display text-gradient",children:"\ud83c\udf89 Invite Friends"}),(0,E.jsx)("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 text-2xl transition-colors",children:"\xd7"})]}),(0,E.jsx)("p",{className:"text-text-secondary mb-6",children:"Share Besties with your friends and help build a stronger safety network together! \ud83d\udc9c"}),(0,E.jsxs)("div",{className:"mb-6",children:[(0,E.jsx)("label",{className:"block text-sm font-semibold text-text-primary mb-2",children:"Your Invite Link"}),(0,E.jsxs)("div",{className:"flex gap-2",children:[(0,E.jsx)("input",{type:"text",value:a,readOnly:!0,className:"flex-1 px-4 py-3 rounded-xl border-2 border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-sm text-gray-700 dark:text-gray-300 focus:outline-none"}),(0,E.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(a),s(!0),z.A.light(),w.Ay.success("Link copied!"),setTimeout(()=>s(!1),2e3)},className:"px-6 py-3 rounded-xl font-semibold text-sm transition-all ".concat(i?"bg-green-500 text-white":"bg-primary text-white hover:bg-primary-dark"),children:i?"\u2713 Copied":"Copy"})]})]}),(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsx)("label",{className:"block text-sm font-semibold text-text-primary mb-3",children:"Share via"}),(0,E.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,E.jsxs)("button",{onClick:()=>{const e="https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(a));window.open(e,"_blank","width=600,height=400"),z.A.light()},className:"flex items-center gap-3 p-4 rounded-xl border-2 border-gray-200 dark:border-gray-600 hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all group",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center text-white text-xl",children:"f"}),(0,E.jsx)("span",{className:"font-semibold text-sm text-gray-700 dark:text-gray-300 group-hover:text-blue-600",children:"Facebook"})]}),(0,E.jsxs)("button",{onClick:()=>{const e="fb-messenger://share?link=".concat(encodeURIComponent(a));window.open(e,"_blank"),z.A.light()},className:"flex items-center gap-3 p-4 rounded-xl border-2 border-gray-200 dark:border-gray-600 hover:border-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all group",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-500 rounded-lg flex items-center justify-center text-white text-xl",children:"\ud83d\udcac"}),(0,E.jsx)("span",{className:"font-semibold text-sm text-gray-700 dark:text-gray-300 group-hover:text-blue-600",children:"Messenger"})]}),(0,E.jsxs)("button",{onClick:()=>{const e="https://wa.me/?text=".concat(encodeURIComponent(o));window.open(e,"_blank"),z.A.light()},className:"flex items-center gap-3 p-4 rounded-xl border-2 border-gray-200 dark:border-gray-600 hover:border-green-500 hover:bg-green-50 dark:hover:bg-green-900/20 transition-all group",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center text-white text-xl",children:"\ud83d\udcac"}),(0,E.jsx)("span",{className:"font-semibold text-sm text-gray-700 dark:text-gray-300 group-hover:text-green-600",children:"WhatsApp"})]}),(0,E.jsxs)("button",{onClick:()=>{const e="https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(o));window.open(e,"_blank","width=600,height=400"),z.A.light()},className:"flex items-center gap-3 p-4 rounded-xl border-2 border-gray-200 dark:border-gray-600 hover:border-sky-500 hover:bg-sky-50 dark:hover:bg-sky-900/20 transition-all group",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-sky-500 rounded-lg flex items-center justify-center text-white text-xl",children:"\ud835\udd4f"}),(0,E.jsx)("span",{className:"font-semibold text-sm text-gray-700 dark:text-gray-300 group-hover:text-sky-600",children:"Twitter"})]}),(0,E.jsxs)("button",{onClick:()=>{window.location.href="sms:?&body=".concat(encodeURIComponent(o)),z.A.light()},className:"flex items-center gap-3 p-4 rounded-xl border-2 border-gray-200 dark:border-gray-600 hover:border-purple-500 hover:bg-purple-50 dark:hover:bg-purple-900/20 transition-all group",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center text-white text-xl",children:"\ud83d\udcac"}),(0,E.jsx)("span",{className:"font-semibold text-sm text-gray-700 dark:text-gray-300 group-hover:text-purple-600",children:"SMS"})]}),(0,E.jsxs)("button",{onClick:()=>{const e=o;window.location.href="mailto:?subject=".concat(encodeURIComponent("Join me on Besties!"),"&body=").concat(encodeURIComponent(e)),z.A.light()},className:"flex items-center gap-3 p-4 rounded-xl border-2 border-gray-200 dark:border-gray-600 hover:border-orange-500 hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-all group",children:[(0,E.jsx)("div",{className:"w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center text-white text-xl",children:"\u2709\ufe0f"}),(0,E.jsx)("span",{className:"font-semibold text-sm text-gray-700 dark:text-gray-300 group-hover:text-orange-600",children:"Email"})]})]})]}),(0,E.jsx)("button",{onClick:t,className:"w-full btn btn-secondary mt-4",children:"Close"})]})})};var ke=n(9852);const _e=()=>{var e,t,n,i,s;const{currentUser:o,userData:l,loading:c}=(0,k.As)(),u=(0,a.Zp)(),[d,h]=(0,r.useState)([]),[f,p]=(0,r.useState)(!0),[m,g]=(0,r.useState)(!1),[y,v]=(0,r.useState)([]),[b,w]=(0,r.useState)([]),[_,I]=(0,r.useState)(0);(0,r.useEffect)(()=>{c||l&&!1===l.onboardingCompleted&&u("/onboarding")},[l,c,u]),(0,r.useEffect)(()=>{if(c)return;(sessionStorage.getItem("pending_invite")||localStorage.getItem("pending_invite"))&&!o&&u("/login")},[o,c,u]),(0,r.useEffect)(()=>{if(!o)return;const e=(0,j.P)((0,j.rJ)(x.db,"checkins"),(0,j._M)("userId","==",o.uid),(0,j._M)("status","in",["active","alerted"])),t=(0,j.aQ)(e,e=>{const t=[];e.forEach(e=>{t.push((0,A.A)({id:e.id},e.data()))}),h(t),p(!1)},e=>{console.error("Error loading check-ins:",e),h([]),p(!1)}),n=(0,j.P)((0,j.rJ)(x.db,"checkins"),(0,j._M)("bestieIds","array-contains",o.uid),(0,j._M)("status","==","alerted")),r=(0,j.aQ)(n,async e=>{const t=[];for(const n of e.docs){const e=n.data(),r=await(0,j.x7)((0,j.H9)(x.db,"users",e.userId)),i=r.exists()?r.data().displayName:"Bestie";t.push((0,A.A)((0,A.A)({id:n.id},e),{},{userName:i}))}w(t)},e=>{console.error("Error loading alerted check-ins:",e),w([])});return()=>{t(),r()}},[o]),(0,r.useEffect)(()=>{if(!o||!l)return;(async()=>{try{const e=l.featuredCircle||[];if(0===e.length)return void v([]);const t=[];for(const n of e){const e=await(0,j.x7)((0,j.H9)(x.db,"users",n));if(e.exists()){const r=e.data();t.push({userId:n,name:r.displayName||"Bestie",phone:r.phone})}}v(t)}catch(e){console.error("Error loading besties:",e)}})()},[o,l]),(0,r.useEffect)(()=>{if(!o)return;(async()=>{try{var e,t,n,r;const i=(0,j.P)((0,j.rJ)(x.db,"checkins"),(0,j._M)("bestieIds","array-contains",o.uid)),s=await(0,j.GG)(i);I(s.size);const a=(null===l||void 0===l||null===(e=l.stats)||void 0===e||null===(t=e.firstCheckInDate)||void 0===t||null===(n=t.toDate)||void 0===n?void 0:n.call(t))||(null===l||void 0===l||null===(r=l.stats)||void 0===r?void 0:r.firstCheckInDate);if(a){const e=new Date,t=Math.abs(e-a);Math.ceil(t/864e5)}}catch(i){console.error("Error loading analytics:",i)}})()},[o,l]);const S=()=>{var e,t,n,r;const i=(null===l||void 0===l||null===(e=l.stats)||void 0===e||null===(t=e.firstCheckInDate)||void 0===t||null===(n=t.toDate)||void 0===n?void 0:n.call(t))||(null===l||void 0===l||null===(r=l.stats)||void 0===r?void 0:r.firstCheckInDate);if(!i)return!1;const s=new Date;return s.setDate(s.getDate()-7),i<=s},N=(()=>{var e;if(!S())return{status:"new",emoji:"\ud83c\udf31",message:"Building your safety journey",tip:"You'll get your weekly summary after you have one week of activity!"};const t=(null===l||void 0===l||null===(e=l.stats)||void 0===e?void 0:e.totalCheckIns)||0,n=y.length||0;return t>=7&&n>=3?{status:"excellent",emoji:"\ud83c\udf1f",message:"You're absolutely crushing it this week!",tip:"Keep up the amazing safety habits!"}:t>=3||n>=3?{status:"good",emoji:"\ud83d\udcaa",message:"You're doing great! Keep it up!",tip:"Try to check in regularly and add more besties."}:{status:"needsWork",emoji:"\ud83d\udc9c",message:"Let's build your safety network!",tip:"Start by adding your closest friends as besties."}})();return f?(0,E.jsx)("div",{className:"min-h-screen bg-pattern",children:(0,E.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,E.jsx)("div",{className:"spinner"})})}):(0,E.jsxs)("div",{className:"min-h-screen bg-pattern",children:[(0,E.jsx)(we,{}),(0,E.jsxs)("div",{className:"max-w-4xl mx-auto p-4 pb-20",children:[0===d.length&&(0,E.jsxs)("div",{className:"card p-6 mb-6 shadow-lg ring-2 ring-purple-200 dark:ring-purple-800 ring-opacity-50",children:[(0,E.jsxs)("div",{className:"mb-4 flex items-center",children:[(0,E.jsx)("h3",{className:"font-display text-lg text-text-primary",children:"Your Safety Stats"}),(0,E.jsx)(ee.A,{message:"Track your safety journey! These stats show your completed check-ins, bestie connections, and streaks. Keep building those safety habits! \ud83d\udc9c"})]}),(0,E.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"text-3xl font-display text-primary",children:(null===l||void 0===l||null===(e=l.stats)||void 0===e?void 0:e.completedCheckIns)||0}),(0,E.jsx)("div",{className:"text-sm text-text-secondary",children:"Check-ins"})]}),(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"text-3xl font-display text-secondary",children:(null===l||void 0===l||null===(t=l.stats)||void 0===t?void 0:t.totalBesties)||0}),(0,E.jsx)("div",{className:"text-sm text-text-secondary",children:"Besties"})]}),(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"text-3xl font-display text-orange-500",children:(null===l||void 0===l||null===(n=l.stats)||void 0===n?void 0:n.currentStreak)||0}),(0,E.jsx)("div",{className:"text-sm text-text-secondary",children:"Current Streak"})]}),(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"text-3xl font-display text-accent",children:(null===l||void 0===l||null===(i=l.stats)||void 0===i?void 0:i.longestStreak)||0}),(0,E.jsx)("div",{className:"text-sm text-text-secondary",children:"Longest Streak"})]})]})]}),0===d.length&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(ie,{}),(0,E.jsx)(pe,{userId:null===o||void 0===o?void 0:o.uid}),(0,E.jsx)(ge,{weeklySummary:N,hasWeekOfActivity:S(),userData:l,bestiesCount:y.length})]}),b.length>0&&(0,E.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)("h2",{className:"text-xl font-display text-text-primary",children:"\u26a0\ufe0f Urgent Alerts"}),(0,E.jsx)("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full font-bold animate-pulse",children:b.length})]}),b.map(e=>{var t;return(0,E.jsx)("div",{className:"card p-6 bg-red-50 dark:bg-red-900/20 border-2 border-red-500",children:(0,E.jsxs)("div",{className:"flex items-start gap-4",children:[(0,E.jsx)("div",{className:"text-4xl",children:"\ud83d\udea8"}),(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsxs)("h3",{className:"font-display text-lg text-red-900 dark:text-red-100 mb-2",children:[e.userName," Missed Check-In!"]}),(0,E.jsxs)("div",{className:"text-sm text-red-800 dark:text-red-200 space-y-1",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("strong",{children:"Location:"})," ",e.location||"Unknown"]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("strong",{children:"Expected back:"})," ",null===(t=e.alertTime)||void 0===t?void 0:t.toDate().toLocaleString()]}),e.notes&&(0,E.jsxs)("div",{children:[(0,E.jsx)("strong",{children:"Notes:"})," ",e.notes]})]}),(0,E.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,E.jsx)("button",{onClick:()=>{z.A.medium(),u("/user/".concat(e.userId)),(0,ke.yZ)(e.id,e.userId,o.uid)},className:"btn btn-sm bg-purple-600 hover:bg-purple-700 text-white",children:"\ud83d\udc64 View Profile"}),(0,E.jsx)("button",{onClick:()=>{u("/history/".concat(e.id)),(0,ke.yZ)(e.id,e.userId,o.uid)},className:"btn btn-sm bg-red-600 hover:bg-red-700 text-white",children:"View Details \u2192"})]})]})]})},e.id)})]}),d.length>0&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,E.jsx)("h2",{className:"text-xl font-display text-text-primary",children:"Active Check-Ins"}),d.map(e=>(0,E.jsx)(Z,{checkIn:e},e.id))]}),(0,E.jsxs)("div",{className:"card p-6 mb-6 bg-gradient-to-br from-orange-50 to-amber-50 dark:from-orange-900/20 dark:to-amber-900/20 border-2 border-orange-200 dark:border-orange-700 opacity-75",children:[(0,E.jsx)("h3",{className:"text-lg font-display text-orange-900 dark:text-orange-100 mb-2 text-center",children:"\ud83c\udd98 Need an Exit Strategy?"}),(0,E.jsx)("p",{className:"text-sm text-orange-700 dark:text-orange-300 mb-3 text-center",children:"Feeling uncomfortable? We're working on a way to help you get out safely."}),(0,E.jsx)("div",{className:"text-center",children:(0,E.jsx)("span",{className:"inline-block px-4 py-2 bg-orange-200 dark:bg-orange-800/50 text-orange-800 dark:text-orange-200 rounded-full text-sm font-semibold",children:"\u2728 Coming Soon"})})]})]}),(0,E.jsx)("div",{className:"card p-6 mb-6 bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/30 dark:to-pink-900/30 border-2 border-purple-100 dark:border-purple-700",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"text-4xl mb-3",children:"\ud83d\udc9c"}),(0,E.jsx)("h3",{className:"font-display text-2xl text-gradient mb-3",children:"You're Part of Something Special"}),(0,E.jsx)("p",{className:"text-text-secondary leading-relaxed mb-4",children:"Hey bestie! We just wanted to say\u2014you being here means everything. Every check-in you create, every friend you add, every safe moment you share... you're part of a community that's got each other's backs. We're building this together, and we couldn't do it without amazing people like you. You're not just using an app\u2014you're one of the besties. \ud83d\udc95"}),(0,E.jsx)("p",{className:"text-sm text-primary font-semibold",children:"Keep slaying safely, queen! \ud83d\udc51\u2728"})]})}),!(null!==l&&void 0!==l&&null!==(s=l.donationStats)&&void 0!==s&&s.isActive)&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)("div",{className:"text-center mb-4",children:[(0,E.jsx)("h2",{className:"text-2xl font-display text-gradient mb-2",children:"Want to help us out? \ud83d\udc9c"}),(0,E.jsx)("p",{className:"text-text-secondary text-sm",children:"Here are all the ways you can support Besties and keep safety accessible for everyone"})]}),(0,E.jsx)(me.A,{}),(0,E.jsxs)("div",{className:"flex items-center gap-4 my-6",children:[(0,E.jsx)("div",{className:"flex-1 h-px bg-gray-300"}),(0,E.jsx)("span",{className:"text-text-secondary font-semibold",children:"OR"}),(0,E.jsx)("div",{className:"flex-1 h-px bg-gray-300"})]}),(0,E.jsx)("div",{className:"card p-6 mb-6 bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-900/30 dark:to-purple-900/30 border-2 border-blue-100 dark:border-blue-700",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"text-4xl mb-3",children:"\ud83d\udc6f\u200d\u2640\ufe0f"}),(0,E.jsx)("h3",{className:"font-display text-2xl text-gradient mb-3",children:"Grow the Squad!"}),(0,E.jsx)("p",{className:"text-text-secondary leading-relaxed mb-4",children:"Love Besties? Invite your friends! The more people who join, the stronger our safety network becomes. Plus, it helps us keep the app free for everyone. Share the love! \ud83d\udc96"}),(0,E.jsx)("button",{onClick:()=>{z.A.light(),g(!0)},className:"btn btn-secondary w-full text-lg py-3",children:"\ud83c\udf89 Invite Friends"}),(0,E.jsx)("p",{className:"text-xs text-text-secondary mt-3",children:"Every new friend makes Besties better for everyone!"})]})})]})]}),(0,E.jsx)(ve,{hasActiveAlert:d.some(e=>"alerted"===e.status)}),(0,E.jsx)(be,{currentUser:o,userData:l}),m&&(0,E.jsx)(xe,{onClose:()=>g(!1)})]})},Ie=(0,r.lazy)(()=>n.e(683).then(n.bind(n,6683))),Ee=(0,r.lazy)(()=>n.e(392).then(n.bind(n,6392))),Se=(0,r.lazy)(()=>Promise.all([n.e(977),n.e(48)]).then(n.bind(n,2048))),Ne=(0,r.lazy)(()=>n.e(321).then(n.bind(n,321))),Te=(0,r.lazy)(()=>Promise.all([n.e(977),n.e(235)]).then(n.bind(n,6235))),Ce=(0,r.lazy)(()=>n.e(858).then(n.bind(n,2858))),Ae=(0,r.lazy)(()=>n.e(492).then(n.bind(n,1492))),je=(0,r.lazy)(()=>n.e(206).then(n.bind(n,8206))),Pe=(0,r.lazy)(()=>Promise.all([n.e(639),n.e(211)]).then(n.bind(n,4211))),De=(0,r.lazy)(()=>n.e(385).then(n.bind(n,1385))),Re=(0,r.lazy)(()=>n.e(265).then(n.bind(n,3265))),Oe=(0,r.lazy)(()=>n.e(88).then(n.bind(n,4088))),Me=(0,r.lazy)(()=>n.e(774).then(n.bind(n,2774))),Le=(0,r.lazy)(()=>n.e(619).then(n.bind(n,1619))),Fe=(0,r.lazy)(()=>n.e(237).then(n.bind(n,6237))),Ue=(0,r.lazy)(()=>n.e(338).then(n.bind(n,5338))),Ve=(0,r.lazy)(()=>n.e(495).then(n.bind(n,5495))),Be=(0,r.lazy)(()=>n.e(759).then(n.bind(n,3759))),ze=(0,r.lazy)(()=>n.e(69).then(n.bind(n,7069))),qe=(0,r.lazy)(()=>n.e(768).then(n.bind(n,7768))),Ke=(0,r.lazy)(()=>n.e(317).then(n.bind(n,5317))),He=(0,r.lazy)(()=>n.e(738).then(n.bind(n,5738))),We=(0,r.lazy)(()=>n.e(475).then(n.bind(n,475))),Ge=(0,r.lazy)(()=>n.e(102).then(n.bind(n,9102))),Qe=(0,r.lazy)(()=>n.e(138).then(n.bind(n,5138))),Ye=()=>(0,E.jsx)("div",{className:"min-h-screen bg-pattern flex items-center justify-center",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"spinner mb-4"}),(0,E.jsx)("h2",{className:"font-display text-2xl text-primary",children:"Loading..."})]})});function Je(){const e=(0,a.zy)();return(0,r.useEffect)(()=>{I.A.trackPageView(e.pathname)},[e]),null}function Xe(e){let{user:t,children:n}=e;const r=(0,a.zy)();if(!t){const e=new URLSearchParams(r.search).get("invite");return e?(0,E.jsx)(a.C5,{to:"/login?invite=".concat(e)}):(0,E.jsx)(a.C5,{to:"/login"})}return n}const $e=function(){const[e,t]=(0,r.useState)(!0),[n,i]=(0,r.useState)(null);return(0,r.useEffect)(()=>{const e=x.auth.onAuthStateChanged(e=>{i(e),t(!1)});return e},[]),e?(0,E.jsx)("div",{className:"min-h-screen bg-pattern flex items-center justify-center",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("div",{className:"spinner mb-4"}),(0,E.jsx)("h2",{className:"font-display text-2xl text-primary",children:"Besties"}),(0,E.jsx)("p",{className:"text-text-secondary",children:"Loading..."})]})}):(0,E.jsx)(N,{children:(0,E.jsx)(_.L,{children:(0,E.jsx)(k.OJ,{children:(0,E.jsxs)(p,{children:[(0,E.jsx)(Je,{}),(0,E.jsx)(C,{}),(0,E.jsx)(P,{}),(0,E.jsx)(D,{}),n&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(U,{}),(0,E.jsx)("div",{className:"fixed top-16 right-4 z-50",children:(0,E.jsx)(R.A,{})})]}),n&&(0,E.jsx)(O,{}),(0,E.jsxs)("div",{className:"App pb-20 md:pb-0",children:[(0,E.jsx)(r.Suspense,{fallback:(0,E.jsx)(Ye,{}),children:(0,E.jsxs)(a.BV,{children:[(0,E.jsx)(a.qh,{path:"/login",element:n?(0,E.jsx)(a.C5,{to:"/"}):(0,E.jsx)(B,{})}),(0,E.jsx)(a.qh,{path:"/privacy",element:(0,E.jsx)(Ue,{})}),(0,E.jsx)(a.qh,{path:"/terms",element:(0,E.jsx)(Ve,{})}),(0,E.jsx)(a.qh,{path:"/alert/:alertId",element:(0,E.jsx)(ze,{})}),(0,E.jsx)(a.qh,{path:"/subscription-success",element:n?(0,E.jsx)(qe,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/subscription-cancel",element:n?(0,E.jsx)(Ke,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/onboarding",element:(0,E.jsx)(Xe,{user:n,children:(0,E.jsx)(Ie,{})})}),(0,E.jsx)(a.qh,{path:"/",element:(0,E.jsx)(Xe,{user:n,children:(0,E.jsx)(_e,{})})}),(0,E.jsx)(a.qh,{path:"/create",element:n?(0,E.jsx)(Ee,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/profile",element:n?(0,E.jsx)(Se,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/user/:userId",element:n?(0,E.jsx)(Ne,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/edit-profile",element:n?(0,E.jsx)(je,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/besties",element:n?(0,E.jsx)(Te,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/settings",element:n?(0,E.jsx)(Ce,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/badges",element:n?(0,E.jsx)(Ae,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/history",element:n?(0,E.jsx)(Pe,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/templates",element:n?(0,E.jsx)(De,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/favorites",element:n?(0,E.jsx)(Oe,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/export-data",element:n?(0,E.jsx)(Me,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/social-feed",element:n?(0,E.jsx)(Fe,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/about",element:n?(0,E.jsx)(He,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/circle-health",element:n?(0,E.jsx)(Ge,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/data-policy",element:n?(0,E.jsx)(Qe,{}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/dev-analytics",element:n?(0,E.jsx)(T,{children:(0,E.jsx)(Re,{})}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/monitoring",element:n?(0,E.jsx)(T,{children:(0,E.jsx)(Le,{})}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/error-dashboard",element:n?(0,E.jsx)(T,{children:(0,E.jsx)(Be,{})}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"/admin/backfill",element:n?(0,E.jsx)(T,{children:(0,E.jsx)(We,{})}):(0,E.jsx)(a.C5,{to:"/login"})}),(0,E.jsx)(a.qh,{path:"*",element:(0,E.jsx)(a.C5,{to:"/"})})]})}),(0,E.jsx)(w.l$,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#2D3748",fontFamily:"Quicksand, sans-serif",fontWeight:"600"},success:{iconTheme:{primary:"#4CAF50",secondary:"#fff"}},error:{iconTheme:{primary:"#FF6B35",secondary:"#fff"}}}})]})]})})})})};s.createRoot(document.getElementById("root")).render((0,E.jsx)(r.StrictMode,{children:(0,E.jsx)($e,{})}))})();
//# sourceMappingURL=main.5d848948.js.map